<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>ğŸ‘€Code-4-Machine-Learning | â­ï¸é½ä¸‹æ— è´°â­ï¸</title><meta name="author" content="â›âWeidowsâ â"><meta name="copyright" content="â›âWeidowsâ â"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta name="description" content="åº æ­¤æ–‡ä¸ºå…¶ä»–æ–‡ç« çš„ä»£ç éƒ¨åˆ†:  ğŸ¥µç¡¬å•ƒ-Machine-Learning  ä¹Ÿæä¾›äº† notebook å½¢å¼: ä»£ç åœ°å€  æ•°æ®é¢„å¤„ç†æ–¹æ³• æ ‡å‡†åŒ–-å‡å€¼ç§»é™¤ # æ•°æ®é¢„å¤„ç†ä¹‹ï¼šå‡å€¼ç§»é™¤ç¤ºä¾‹import numpy as npimport sklearn.preprocessing as sp# æ ·æœ¬æ•°æ®raw_samples &#x3D; np.array([    [3.0, -1.0, 2.0],"><meta property="og:type" content="article"><meta property="og:title" content="ğŸ‘€Code-4-Machine-Learning"><meta property="og:url" content="https://blog.weidows.tech/post/lang/python/code/ML/"><meta property="og:site_name" content="â­ï¸é½ä¸‹æ— è´°â­ï¸"><meta property="og:description" content="åº æ­¤æ–‡ä¸ºå…¶ä»–æ–‡ç« çš„ä»£ç éƒ¨åˆ†:  ğŸ¥µç¡¬å•ƒ-Machine-Learning  ä¹Ÿæä¾›äº† notebook å½¢å¼: ä»£ç åœ°å€  æ•°æ®é¢„å¤„ç†æ–¹æ³• æ ‡å‡†åŒ–-å‡å€¼ç§»é™¤ # æ•°æ®é¢„å¤„ç†ä¹‹ï¼šå‡å€¼ç§»é™¤ç¤ºä¾‹import numpy as npimport sklearn.preprocessing as sp# æ ·æœ¬æ•°æ®raw_samples &#x3D; np.array([    [3.0, -1.0, 2.0],"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://pan.weidows.tech/d/local/blog/RsEzqc.png"><meta property="article:published_time" content="2022-04-11T07:07:22.000Z"><meta property="article:modified_time" content="2024-08-07T05:42:09.000Z"><meta property="article:author" content="â›âWeidowsâ â"><meta property="article:tag" content="äººå·¥æ™ºèƒ½"><meta property="article:tag" content="ä¿¡æ¯è®º"><meta property="article:tag" content="python"><meta property="article:tag" content="æœºå™¨å­¦ä¹ "><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://pan.weidows.tech/d/local/blog/RsEzqc.png"><link rel="shortcut icon" href="https://pan.weidows.tech/d/local/img/avatar/avatar.png"><link rel="canonical" href="https://blog.weidows.tech/post/lang/python/code/ML/"><link rel="preconnect" href="//fastly.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="baidu-site-verification" content="codeva-S90fjC0lEU"><link rel="stylesheet" href="/css/index.css?v=4.9.0"><link rel="stylesheet" href="https://unpkg.com/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://unpkg.com/@fancyapps/ui@5.0.19/dist/fancybox/fancybox.css" media="print" onload='this.media="all"'><script async src="https://www.googletagmanager.com/gtag/js?id=G-BHH5BNEG3S"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-BHH5BNEG3S")</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}","hits_stats":"å…±æ‰¾åˆ° ${hits} ç¯‡æ–‡ç« "}},
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated.(è¦å–è¿™ç¯‡è¿‡æœŸçš„çº¯ç‰›å¥¶å—~)"},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  relativeDate: {
    homepage: true,
    post: true
  },
  runtime: 'å¤©',
  dateSuffix: {
    just: 'åˆšåˆš',
    min: 'åˆ†é’Ÿå‰',
    hour: 'å°æ—¶å‰',
    day: 'å¤©å‰',
    month: 'ä¸ªæœˆå‰'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://unpkg.com/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://unpkg.com/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"ğŸ‘€Code-4-Machine-Learning",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-08-07 13:42:09"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
    win.getCSS = (url,id = false) => new Promise((resolve, reject) => {
      const link = document.createElement('link')
      link.rel = 'stylesheet'
      link.href = url
      if (id) link.id = id
      link.onerror = reject
      link.onload = link.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        link.onload = link.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(link)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><script src="https://cubism.live2d.com/sdk-web/cubismcore/live2dcubismcore.min.js"></script><script src="https://fastly.jsdelivr.net/combine/gh/dylanNew/live2d/webgl/Live2D/lib/live2d.min.js,npm/pixi.js@6.5.2/dist/browser/pixi.min.js,npm/pixi-live2d-display/dist/index.min.js,gh/Weidows-projects/Live2dLoader/dist/Live2dLoader.min.js"></script><meta name="baidu-site-verification" content="codeva-hhGzt89VUk"><script>let HEXO_MMEDIA_DATA = { js: [], css: [], aplayerData: [], metingData: [], artPlayerData: [], dplayerData: []};</script><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

document.addEventListener('pjax:send', () => {
  Pace.restart()
})</script><link rel="stylesheet" href="https://unpkg.com/pace-js@1.2.4/themes/blue/pace-theme-minimal.css"><script src="https://unpkg.com/pace-js@1.2.4/pace.min.js"></script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://pan.weidows.tech/d/local/img/avatar/avatar.png" onerror='onerror=null,src="https://pan.weidows.tech/d/local/img/404.jpg"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">151</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">225</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">49</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-plane"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-car"></i><span> å¼€å¾€</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-home"></i><span> ä¼ é€é—¨</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.weidows.tech"><i class="fa-fw fas fa-rocket"></i><span> Vercel-site</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://weidows.github.io"><i class="fa-fw fas fa-shower"></i><span> GitHub-site</span></a></li><li><a class="site-page child" href="/tags"><i class="fa-fw fas fa-tags"></i><span> æ ‡ ç­¾</span></a></li><li><a class="site-page child" href="/categories"><i class="fa-fw fas fa-folder-open"></i><span> åˆ† ç±»</span></a></li><li><a class="site-page child" href="/archives"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></li><li><a class="site-page child" href="/tags/charts"><i class="fa-fw fas fa-signal"></i><span> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child" href="/"><span>----------</span></a></li><li><a class="site-page child" href="/post/experience/QA"><span>Q-A</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.notion.so/weidows/03f1a8bbc340412a897705d7440b5484"><span>Notion</span></a></li><li><a class="site-page child" href="/tags/Weidows-projects"><span>Weidows-projects</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> å…´è¶£çˆ±å¥½</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://bangumi.tv/user/823155"><i class="fa-fw fas fa-laptop"></i><span> Bangumi</span></a></li><li><a class="site-page child" href="/tags/games"><i class="fa-fw fas fa-gamepad"></i><span> Steam</span></a></li><li><a class="site-page child" href="/artitalk"><i class="fa-fw fa fa-comment"></i><span> è¯´è¯´</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/link"><i class="fa-fw fas fa-link"></i><span> å‹äººå¸</span></a></li><li><a class="site-page child" href="/tags/comment"><i class="fa-fw fas fa-comments"></i><span> ç•™è¨€æ¿</span></a></li><li><a class="site-page child" href="/tags/resume"><i class="fa-fw fas fa-user"></i><span> ç®€ğŸ‘¶å†</span></a></li></ul></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://pan.weidows.tech/d/local/blog/RsEzqc.png)"><nav id="nav"><span id="blog-info"><a href="/" title="â­ï¸é½ä¸‹æ— è´°â­ï¸"><span class="site-name">â­ï¸é½ä¸‹æ— è´°â­ï¸</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-plane"></i><span> é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.travellings.cn/go.html"><i class="fa-fw fas fa-car"></i><span> å¼€å¾€</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-home"></i><span> ä¼ é€é—¨</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="https://blog.weidows.tech"><i class="fa-fw fas fa-rocket"></i><span> Vercel-site</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://weidows.github.io"><i class="fa-fw fas fa-shower"></i><span> GitHub-site</span></a></li><li><a class="site-page child" href="/tags"><i class="fa-fw fas fa-tags"></i><span> æ ‡ ç­¾</span></a></li><li><a class="site-page child" href="/categories"><i class="fa-fw fas fa-folder-open"></i><span> åˆ† ç±»</span></a></li><li><a class="site-page child" href="/archives"><i class="fa-fw fas fa-archive"></i><span> æ—¶é—´è½´</span></a></li><li><a class="site-page child" href="/tags/charts"><i class="fa-fw fas fa-signal"></i><span> æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child" href="/"><span>----------</span></a></li><li><a class="site-page child" href="/post/experience/QA"><span>Q-A</span></a></li><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://www.notion.so/weidows/03f1a8bbc340412a897705d7440b5484"><span>Notion</span></a></li><li><a class="site-page child" href="/tags/Weidows-projects"><span>Weidows-projects</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-list"></i><span> å…´è¶£çˆ±å¥½</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener external nofollow noreferrer" href="https://bangumi.tv/user/823155"><i class="fa-fw fas fa-laptop"></i><span> Bangumi</span></a></li><li><a class="site-page child" href="/tags/games"><i class="fa-fw fas fa-gamepad"></i><span> Steam</span></a></li><li><a class="site-page child" href="/artitalk"><i class="fa-fw fa fa-comment"></i><span> è¯´è¯´</span></a></li></ul></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fa-fw fas fa-heart"></i><span> å…³äº</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/tags/link"><i class="fa-fw fas fa-link"></i><span> å‹äººå¸</span></a></li><li><a class="site-page child" href="/tags/comment"><i class="fa-fw fas fa-comments"></i><span> ç•™è¨€æ¿</span></a></li><li><a class="site-page child" href="/tags/resume"><i class="fa-fw fas fa-user"></i><span> ç®€ğŸ‘¶å†</span></a></li></ul></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" rel="external nofollow noreferrer"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">ğŸ‘€Code-4-Machine-Learning</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2022-04-11T07:07:22.000Z" title="å‘è¡¨äº 2022-04-11 15:07:22">2022-04-11</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2024-08-07T05:42:09.000Z" title="æ›´æ–°äº 2024-08-07 13:42:09">2024-08-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/lang/">lang</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/lang/python/">python</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/lang/python/code/">code</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">16.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»æ—¶é•¿:</span><span>91åˆ†é’Ÿ</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="ğŸ‘€Code-4-Machine-Learning"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="åº">åº</h2><p>æ­¤æ–‡ä¸ºå…¶ä»–æ–‡ç« çš„ä»£ç éƒ¨åˆ†:</p><blockquote><p><a href="../../AI/ML">ğŸ¥µç¡¬å•ƒ-Machine-Learning</a></p></blockquote><p>ä¹Ÿæä¾›äº† notebook å½¢å¼: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/Weidows-projects/public-post/blob/main/notebook/ML/_ML.ipynb">ä»£ç åœ°å€</a></p><p><a><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="https://pan.weidows.tech/d/local/img/divider.png" alt="åˆ†å‰²çº¿"></a></p><h2 id="æ•°æ®é¢„å¤„ç†æ–¹æ³•">æ•°æ®é¢„å¤„ç†æ–¹æ³•</h2><h3 id="æ ‡å‡†åŒ–-å‡å€¼ç§»é™¤">æ ‡å‡†åŒ–-å‡å€¼ç§»é™¤</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ•°æ®é¢„å¤„ç†ä¹‹ï¼šå‡å€¼ç§»é™¤ç¤ºä¾‹</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sklearn.preprocessing <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ·æœ¬æ•°æ®</span></span><br><span class="line">raw_samples = np.array([</span><br><span class="line">    [<span class="number">3.0</span>, -<span class="number">1.0</span>, <span class="number">2.0</span>],\</span><br><span class="line">    [<span class="number">0.0</span>, <span class="number">4.0</span>, <span class="number">3.0</span>], \</span><br><span class="line">    [<span class="number">1.0</span>, -<span class="number">4.0</span>, <span class="number">2.0</span>]]\</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ±‚æ¯åˆ—çš„å¹³å‡å€¼ axis=0ä¸ºåˆ—, =1ä¸ºè¡Œ ä¸å¡«å°±è®¡ç®—æ‰€æœ‰å€¼</span></span><br><span class="line"><span class="built_in">print</span>(raw_samples.mean(axis=<span class="number">0</span>))</span><br><span class="line"><span class="comment"># æ±‚æ¯åˆ—æ ‡å‡†å·®</span></span><br><span class="line"><span class="built_in">print</span>(raw_samples.std(axis=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line">std_samples = raw_samples.copy()  <span class="comment"># å¤åˆ¶æ ·æœ¬æ•°æ®</span></span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> std_samples.T:  <span class="comment"># .Tä¸ºè½¬ç½®,éå†æ¯åˆ—</span></span><br><span class="line">    col_mean = col.mean()  <span class="comment"># è®¡ç®—å¹³å‡æ•°</span></span><br><span class="line">    col_std = col.std()  <span class="comment"># æ±‚æ ‡å‡†å·®</span></span><br><span class="line">    col -= col_mean  <span class="comment"># å‡å¹³å‡å€¼</span></span><br><span class="line">    col /= col_std  <span class="comment"># é™¤æ ‡å‡†å·®</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡å€¼æ— é™è¶‹è¿‘0,ä½†å¯èƒ½ä¸æ˜¯0</span></span><br><span class="line"><span class="built_in">print</span>(std_samples.mean(axis=<span class="number">0</span>))</span><br><span class="line"><span class="built_in">print</span>(std_samples.std(axis=<span class="number">0</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># scale æ ‡å‡†ç§»é™¤,ä¸ä¸Šé¢åŠŸèƒ½ç›¸åŒ</span></span><br><span class="line">std_samples = sp.scale(raw_samples)</span><br><span class="line"><span class="built_in">print</span>(std_samples.mean(axis=<span class="number">0</span>))</span><br><span class="line"><span class="built_in">print</span>(std_samples.std(axis=<span class="number">0</span>))</span><br></pre></td></tr></table></figure><pre><code>[ 1.33333333 -0.33333333  2.33333333]
[1.24721913 3.29983165 0.47140452]
[ 5.55111512e-17  0.00000000e+00 -2.96059473e-16]
[1. 1. 1.]
[ 5.55111512e-17  0.00000000e+00 -2.96059473e-16]
[1. 1. 1.]
</code></pre><h3 id="èŒƒå›´ç¼©æ”¾">èŒƒå›´ç¼©æ”¾</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ•°æ®é¢„å¤„ç†ä¹‹ï¼šèŒƒå›´ç¼©æ”¾</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sklearn.preprocessing <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ·æœ¬æ•°æ®</span></span><br><span class="line">raw_samples = np.array([</span><br><span class="line">    [<span class="number">1.0</span>, <span class="number">2.0</span>, <span class="number">3.0</span>],\</span><br><span class="line">    [<span class="number">4.0</span>, <span class="number">5.0</span>, <span class="number">6.0</span>],\</span><br><span class="line">    [<span class="number">7.0</span>, <span class="number">8.0</span>, <span class="number">9.0</span>]]).astype(<span class="string">&quot;float64&quot;</span>)</span><br><span class="line"></span><br><span class="line">mms_samples = raw_samples.copy()  <span class="comment"># å¤åˆ¶æ ·æœ¬æ•°æ®</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> col <span class="keyword">in</span> mms_samples.T:</span><br><span class="line">    col_min = col.<span class="built_in">min</span>()</span><br><span class="line">    col_max = col.<span class="built_in">max</span>()</span><br><span class="line">    col -= col_min</span><br><span class="line">    col /= (col_max - col_min)</span><br><span class="line"><span class="built_in">print</span>(mms_samples)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®ç»™å®šèŒƒå›´åˆ›å»ºä¸€ä¸ªèŒƒå›´ç¼©æ”¾å™¨å¯¹è±¡</span></span><br><span class="line"><span class="comment"># ä½¿ç”¨èŒƒå›´ç¼©æ”¾å™¨å®ç°ç‰¹å¾å€¼èŒƒå›´ç¼©æ”¾</span></span><br><span class="line">mms_samples = sp.MinMaxScaler(feature_range=(<span class="number">0</span>, <span class="number">1</span>))\</span><br><span class="line">  .fit_transform(raw_samples)  <span class="comment"># ç¼©æ”¾</span></span><br><span class="line"><span class="built_in">print</span>(mms_samples)</span><br></pre></td></tr></table></figure><pre><code>[[0.  0.  0. ]
 [0.5 0.5 0.5]
 [1.  1.  1. ]]
[[0.  0.  0. ]
 [0.5 0.5 0.5]
 [1.  1.  1. ]]
</code></pre><h3 id="å½’ä¸€åŒ–">å½’ä¸€åŒ–</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sklearn.preprocessing <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ·æœ¬æ•°æ®</span></span><br><span class="line">raw_samples = np.array([</span><br><span class="line">    [<span class="number">10.0</span>, <span class="number">20.0</span>, <span class="number">5.0</span>],\</span><br><span class="line">    [<span class="number">8.0</span>, <span class="number">10.0</span>, <span class="number">1.0</span>]])</span><br><span class="line"></span><br><span class="line">nor_samples = raw_samples.copy()</span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> nor_samples:</span><br><span class="line">    row /= <span class="built_in">abs</span>(row).<span class="built_in">sum</span>()  <span class="comment"># å…ˆå¯¹è¡Œæ±‚ç»å¯¹å€¼ï¼Œå†æ±‚å’Œï¼Œå†é™¤ä»¥ç»å¯¹å€¼ä¹‹å’Œ</span></span><br><span class="line"><span class="built_in">print</span>(nor_samples)  <span class="comment"># æ‰“å°ç»“æœ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># norm=l1  /=ç»å¯¹å€¼ä¹‹å’Œ</span></span><br><span class="line"><span class="comment"># norm=l2  /=å¹³æ–¹ä¹‹å’Œ</span></span><br><span class="line">nor_samples = sp.normalize(raw_samples.copy(), norm=<span class="string">&#x27;l1&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(nor_samples)  <span class="comment"># æ‰“å°ç»“æœ</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>[[0.28571429 0.57142857 0.14285714]
 [0.42105263 0.52631579 0.05263158]]
[[0.28571429 0.57142857 0.14285714]
 [0.42105263 0.52631579 0.05263158]]
</code></pre><h3 id="äºŒå€¼åŒ–">äºŒå€¼åŒ–</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># äºŒå€¼åŒ–</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sklearn.preprocessing <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line">raw_samples = np.array([[<span class="number">65.5</span>, <span class="number">89.0</span>, <span class="number">73.0</span>],\</span><br><span class="line">                        [<span class="number">55.0</span>, <span class="number">99.0</span>, <span class="number">98.5</span>],\</span><br><span class="line">                        [<span class="number">45.0</span>, <span class="number">22.5</span>, <span class="number">60.0</span>]])</span><br><span class="line"></span><br><span class="line">bin_samples = raw_samples.copy()  <span class="comment"># å¤åˆ¶æ•°ç»„</span></span><br><span class="line"><span class="comment"># ç”Ÿæˆæ©ç æ•°ç»„</span></span><br><span class="line">mask1 = bin_samples &lt; <span class="number">60</span></span><br><span class="line"><span class="built_in">print</span>(mask1)</span><br><span class="line">mask2 = bin_samples &gt;= <span class="number">60</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é€šè¿‡æ©ç è¿›è¡ŒäºŒå€¼åŒ–å¤„ç† (åªè½¬æ¢Trueçš„ä½ç½®)</span></span><br><span class="line">bin_samples[mask1] = <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(bin_samples)</span><br><span class="line">bin_samples[mask2] = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(bin_samples)  <span class="comment"># æ‰“å°ç»“æœ</span></span><br><span class="line"></span><br><span class="line">bin_transformer = sp.Binarizer(threshold=<span class="number">60</span> - <span class="number">1</span>)  <span class="comment"># åˆ›å»ºäºŒå€¼åŒ–å¯¹è±¡(æ³¨æ„è¾¹ç•Œå€¼)</span></span><br><span class="line">bin_samples = bin_transformer.transform(raw_samples.copy())  <span class="comment"># äºŒå€¼åŒ–é¢„å¤„ç†</span></span><br><span class="line"><span class="built_in">print</span>(bin_samples)</span><br></pre></td></tr></table></figure><pre><code>[[False False False]
 [ True False False]
 [ True  True False]]
[[65.5 89.  73. ]
 [ 0.  99.  98.5]
 [ 0.   0.  60. ]]
[[1. 1. 1.]
 [0. 1. 1.]
 [0. 0. 1.]]
[[1. 1. 1.]
 [0. 1. 1.]
 [0. 0. 1.]]
</code></pre><h3 id="ç‹¬çƒ­ç¼–ç ç¤ºä¾‹">ç‹¬çƒ­ç¼–ç ç¤ºä¾‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sklearn.preprocessing <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line">raw_samples = np.array([[<span class="number">1</span>, <span class="number">3</span>, <span class="number">2</span>],\</span><br><span class="line">                        [<span class="number">7</span>, <span class="number">5</span>, <span class="number">4</span>],\</span><br><span class="line">                        [<span class="number">1</span>, <span class="number">8</span>, <span class="number">6</span>],\</span><br><span class="line">                        [<span class="number">7</span>, <span class="number">3</span>, <span class="number">9</span>]])</span><br><span class="line"></span><br><span class="line">one_hot_encoder = sp.OneHotEncoder(</span><br><span class="line">    sparse=<span class="literal">False</span>,  <span class="comment"># æ˜¯å¦é‡‡ç”¨ç¨€ç–æ ¼å¼</span></span><br><span class="line">    dtype=<span class="string">&quot;int32&quot;</span>,</span><br><span class="line">    categories=<span class="string">&quot;auto&quot;</span>)  <span class="comment"># è‡ªåŠ¨ç¼–ç </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œç‹¬çƒ­ç¼–ç </span></span><br><span class="line">oh_samples = one_hot_encoder.fit_transform(raw_samples.copy())</span><br><span class="line"><span class="built_in">print</span>(oh_samples)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(one_hot_encoder.inverse_transform(oh_samples))  <span class="comment"># è§£ç </span></span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>[[1 0 1 0 0 1 0 0 0]
 [0 1 0 1 0 0 1 0 0]
 [1 0 0 0 1 0 0 1 0]
 [0 1 1 0 0 0 0 0 1]]
[[1 3 2]
 [7 5 4]
 [1 8 6]
 [7 3 9]]
</code></pre><h3 id="æ ‡ç­¾ç¼–ç ">æ ‡ç­¾ç¼–ç </h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sklearn.preprocessing <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line">raw_samples = np.array([<span class="string">&#x27;audi&#x27;</span>, <span class="string">&#x27;ford&#x27;</span>, <span class="string">&#x27;audi&#x27;</span>, <span class="string">&#x27;bmw&#x27;</span>, <span class="string">&#x27;ford&#x27;</span>, <span class="string">&#x27;bmw&#x27;</span>])</span><br><span class="line"></span><br><span class="line">lb_encoder = sp.LabelEncoder()  <span class="comment"># å®šä¹‰æ ‡ç­¾ç¼–ç å¯¹è±¡</span></span><br><span class="line">lb_samples = lb_encoder.fit_transform(raw_samples.copy())  <span class="comment"># æ‰§è¡Œæ ‡ç­¾ç¼–ç </span></span><br><span class="line"><span class="built_in">print</span>(lb_samples)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(lb_encoder.inverse_transform(lb_samples))  <span class="comment"># é€†å‘è½¬æ¢</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>[0 2 0 1 2 1]
['audi' 'ford' 'audi' 'bmw' 'ford' 'bmw']
</code></pre><h2 id="åŸºæœ¬é—®é¢˜">åŸºæœ¬é—®é¢˜</h2><h3 id="å›å½’é—®é¢˜">å›å½’é—®é¢˜</h3><h4 id="çº¿æ€§å›å½’">çº¿æ€§å›å½’</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> mp</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> axes3d</span><br><span class="line"><span class="keyword">import</span> sklearn.preprocessing <span class="keyword">as</span> sp</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒæ•°æ®é›†</span></span><br><span class="line">train_x = np.array([<span class="number">0.5</span>, <span class="number">0.6</span>, <span class="number">0.8</span>, <span class="number">1.1</span>, <span class="number">1.4</span>])  <span class="comment"># è¾“å…¥é›†</span></span><br><span class="line">train_y = np.array([<span class="number">5.0</span>, <span class="number">5.5</span>, <span class="number">6.0</span>, <span class="number">6.8</span>, <span class="number">7.0</span>])  <span class="comment"># è¾“å‡ºé›†</span></span><br><span class="line"></span><br><span class="line">n_epochs = <span class="number">30</span>  <span class="comment"># è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">l_rate = <span class="number">0.01</span>  <span class="comment"># å­¦ä¹ ç‡</span></span><br><span class="line">epochs = []  <span class="comment"># è®°å½•è¿­ä»£æ¬¡æ•°</span></span><br><span class="line">losses = []  <span class="comment"># è®°å½•æŸå¤±å€¼</span></span><br><span class="line"></span><br><span class="line">w0, w1 = [<span class="number">1</span>], [<span class="number">1</span>]  <span class="comment"># æ¨¡å‹åˆå§‹å€¼</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, n_epochs + <span class="number">1</span>):</span><br><span class="line">    epochs.append(i)  <span class="comment"># è®°å½•ç¬¬å‡ æ¬¡è¿­ä»£</span></span><br><span class="line"></span><br><span class="line">    y = w0[-<span class="number">1</span>] + w1[-<span class="number">1</span>] * train_x  <span class="comment"># å–å‡ºæœ€æ–°çš„w0,w1è®¡ç®—çº¿æ€§æ–¹ç¨‹è¾“å‡º</span></span><br><span class="line">    <span class="comment"># æŸå¤±å‡½æ•°(å‡æ–¹å·®)</span></span><br><span class="line">    loss = (((train_y - y)**<span class="number">2</span>).<span class="built_in">sum</span>()) / <span class="number">2</span></span><br><span class="line">    losses.append(loss)  <span class="comment"># è®°å½•æ¯æ¬¡è¿­ä»£çš„æŸå¤±å€¼</span></span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;%d: w0=%f, w1=%f, loss=%f&quot;</span> % (i, w0[-<span class="number">1</span>], w1[-<span class="number">1</span>], loss))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># è®¡ç®—w0,w1çš„åå¯¼æ•°</span></span><br><span class="line">    d0 = -(train_y - y).<span class="built_in">sum</span>()</span><br><span class="line">    d1 = -(train_x * (train_y - y)).<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># æ›´æ–°w0,w1</span></span><br><span class="line">    w0.append(w0[-<span class="number">1</span>] - (d0 * l_rate))</span><br><span class="line">    w1.append(w1[-<span class="number">1</span>] - (d1 * l_rate))</span><br><span class="line"></span><br><span class="line"><span class="comment">###################### è®­ç»ƒè¿‡ç¨‹å¯è§†åŒ– ######################</span></span><br><span class="line"><span class="comment">## æŸå¤±å‡½æ•°æ”¶æ•›è¿‡ç¨‹</span></span><br><span class="line">w0 = np.array(w0[:-<span class="number">1</span>])</span><br><span class="line">w1 = np.array(w1[:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">mp.figure(<span class="string">&quot;Losses&quot;</span>, facecolor=<span class="string">&quot;lightgray&quot;</span>)  <span class="comment"># åˆ›å»ºä¸€ä¸ªçª—ä½“</span></span><br><span class="line">mp.title(<span class="string">&quot;epoch&quot;</span>, fontsize=<span class="number">20</span>)</span><br><span class="line">mp.ylabel(<span class="string">&quot;loss&quot;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">mp.grid(linestyle=<span class="string">&quot;:&quot;</span>)  <span class="comment"># ç½‘æ ¼çº¿ï¼šè™šçº¿</span></span><br><span class="line">mp.plot(epochs, losses, c=<span class="string">&quot;blue&quot;</span>, label=<span class="string">&quot;loss&quot;</span>)</span><br><span class="line">mp.legend()  <span class="comment"># å›¾ä¾‹</span></span><br><span class="line">mp.tight_layout()  <span class="comment"># ç´§å‡‘æ ¼å¼</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## æ˜¾ç¤ºæ¨¡å‹ç›´çº¿</span></span><br><span class="line">pred_y = w0[-<span class="number">1</span>] + w1[-<span class="number">1</span>] * train_x  <span class="comment"># æ ¹æ®xé¢„æµ‹y</span></span><br><span class="line">mp.figure(<span class="string">&quot;Linear Regression&quot;</span>, facecolor=<span class="string">&quot;lightgray&quot;</span>)</span><br><span class="line">mp.title(<span class="string">&quot;Linear Regression&quot;</span>, fontsize=<span class="number">20</span>)</span><br><span class="line">mp.xlabel(<span class="string">&quot;x&quot;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">mp.ylabel(<span class="string">&quot;y&quot;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">mp.grid(linestyle=<span class="string">&quot;:&quot;</span>)</span><br><span class="line">mp.scatter(train_x, train_y, c=<span class="string">&quot;blue&quot;</span>, label=<span class="string">&quot;Traing&quot;</span>)  <span class="comment"># ç»˜åˆ¶æ ·æœ¬æ•£ç‚¹å›¾</span></span><br><span class="line">mp.plot(train_x, pred_y, c=<span class="string">&quot;red&quot;</span>, label=<span class="string">&quot;Regression&quot;</span>)</span><br><span class="line">mp.legend()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ˜¾ç¤ºæ¢¯åº¦ä¸‹é™è¿‡ç¨‹(å¤åˆ¶ç²˜è´´å³å¯ï¼Œä¸éœ€è¦ç¼–å†™)</span></span><br><span class="line"><span class="comment"># è®¡ç®—æŸå¤±å‡½æ•°æ›²é¢ä¸Šçš„ç‚¹ loss = f(w0, w1)</span></span><br><span class="line">arr1 = np.linspace(<span class="number">0</span>, <span class="number">10</span>, <span class="number">500</span>)  <span class="comment"># 0~9é—´äº§ç”Ÿ500ä¸ªå…ƒç´ çš„å‡åŒ€åˆ—è¡¨</span></span><br><span class="line">arr2 = np.linspace(<span class="number">0</span>, <span class="number">3.5</span>, <span class="number">500</span>)  <span class="comment"># 0~3.5é—´äº§ç”Ÿ500ä¸ªå…ƒç´ çš„å‡åŒ€åˆ—è¡¨</span></span><br><span class="line"></span><br><span class="line">grid_w0, grid_w1 = np.meshgrid(arr1, arr2)  <span class="comment"># äº§ç”ŸäºŒç»´çŸ©é˜µ</span></span><br><span class="line"></span><br><span class="line">flat_w0, flat_w1 = grid_w0.ravel(), grid_w1.ravel()  <span class="comment"># äºŒç»´çŸ©é˜µæ‰å¹³åŒ–</span></span><br><span class="line">loss_metrix = train_y.reshape(-<span class="number">1</span>, <span class="number">1</span>)  <span class="comment"># ç”Ÿæˆè¯¯å·®çŸ©é˜µï¼ˆ-1,1ï¼‰è¡¨ç¤ºè‡ªåŠ¨è®¡ç®—ç»´åº¦</span></span><br><span class="line">outer = np.outer(train_x, flat_w1)  <span class="comment"># æ±‚å¤–ç§¯ï¼ˆtrain_xå’Œflat_w1å…ƒç´ ä¸¤ä¸¤ç›¸ä¹˜çš„æ–°çŸ©é˜µï¼‰</span></span><br><span class="line"><span class="comment"># è®¡ç®—æŸå¤±ï¼š((w0 + w1*x - y)**2)/2</span></span><br><span class="line">flat_loss = (((flat_w0 + outer - loss_metrix)**<span class="number">2</span>).<span class="built_in">sum</span>(axis=<span class="number">0</span>)) / <span class="number">2</span></span><br><span class="line">grid_loss = flat_loss.reshape(grid_w0.shape)</span><br><span class="line"></span><br><span class="line">mp.figure(<span class="string">&#x27;Loss Function&#x27;</span>)</span><br><span class="line">ax = mp.axes(projection=<span class="string">&#x27;3d&#x27;</span>)</span><br><span class="line">mp.title(<span class="string">&#x27;Loss Function&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">&#x27;w0&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">&#x27;w1&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">ax.set_zlabel(<span class="string">&#x27;loss&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">ax.plot_surface(grid_w0,</span><br><span class="line">                grid_w1,</span><br><span class="line">                grid_loss,</span><br><span class="line">                rstride=<span class="number">10</span>,</span><br><span class="line">                cstride=<span class="number">10</span>,</span><br><span class="line">                cmap=<span class="string">&#x27;jet&#x27;</span>)</span><br><span class="line">ax.plot(w0, w1, losses, <span class="string">&#x27;o-&#x27;</span>, c=<span class="string">&#x27;orangered&#x27;</span>, label=<span class="string">&#x27;BGD&#x27;</span>, zorder=<span class="number">5</span>)</span><br><span class="line">mp.legend(loc=<span class="string">&#x27;lower left&#x27;</span>)</span><br><span class="line"></span><br><span class="line">mp.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>1: w0=1.000000, w1=1.000000, loss=44.175000
2: w0=1.209000, w1=1.190600, loss=36.538828
3: w0=1.399164, w1=1.363579, loss=30.231687
4: w0=1.572208, w1=1.520546, loss=25.022227
5: w0=1.729693, w1=1.662961, loss=20.719373
6: w0=1.873039, w1=1.792151, loss=17.165309
7: w0=2.003532, w1=1.909325, loss=14.229691
8: w0=2.122345, w1=2.015577, loss=11.804865
9: w0=2.230542, w1=2.111905, loss=9.801916
10: w0=2.329091, w1=2.199215, loss=8.147408
11: w0=2.418871, w1=2.278330, loss=6.780688
12: w0=2.500681, w1=2.349997, loss=5.651660
13: w0=2.575247, w1=2.414898, loss=4.718950
14: w0=2.643230, w1=2.473648, loss=3.948384
15: w0=2.705228, w1=2.526811, loss=3.311740
16: w0=2.761786, w1=2.574896, loss=2.785706
17: w0=2.813402, w1=2.618367, loss=2.351029
18: w0=2.860524, w1=2.657645, loss=1.991807
19: w0=2.903561, w1=2.693114, loss=1.694907
20: w0=2.942886, w1=2.725122, loss=1.449482
21: w0=2.978836, w1=2.753985, loss=1.246572
22: w0=3.011719, w1=2.779990, loss=1.078777
23: w0=3.041814, w1=2.803399, loss=0.939987
24: w0=3.069373, w1=2.824449, loss=0.825153
25: w0=3.094629, w1=2.843355, loss=0.730107
26: w0=3.117790, w1=2.860315, loss=0.651405
27: w0=3.139046, w1=2.875507, loss=0.586204
28: w0=3.158572, w1=2.889091, loss=0.532154
29: w0=3.176523, w1=2.901216, loss=0.487315
30: w0=3.193044, w1=2.912016, loss=0.450086
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_13_1.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_13_2.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_13_3.png" alt="png"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆ©ç”¨LinearRegressionå®ç°çº¿æ€§å›å½’</span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sklearn.linear_model <span class="keyword">as</span> lm  <span class="comment"># çº¿æ€§æ¨¡å‹# çº¿æ€§æ¨¡å‹</span></span><br><span class="line"><span class="keyword">import</span> sklearn.metrics <span class="keyword">as</span> sm  <span class="comment"># æ¨¡å‹æ€§èƒ½è¯„ä»·æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> mp</span><br><span class="line"></span><br><span class="line">train_x = np.array([[<span class="number">0.5</span>], [<span class="number">0.6</span>], [<span class="number">0.8</span>], [<span class="number">1.1</span>], [<span class="number">1.4</span>]])  <span class="comment"># è¾“å…¥é›†</span></span><br><span class="line">train_y = np.array([<span class="number">5.0</span>, <span class="number">5.5</span>, <span class="number">6.0</span>, <span class="number">6.8</span>, <span class="number">7.0</span>])  <span class="comment"># è¾“å‡ºé›†</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºçº¿æ€§å›å½’å™¨</span></span><br><span class="line">line_model = lm.LinearRegression()</span><br><span class="line"><span class="comment"># ç”¨å·²çŸ¥è¾“å…¥ã€è¾“å‡ºæ•°æ®é›†è®­ç»ƒå›å½’å™¨</span></span><br><span class="line">line_model.fit(train_x, train_y)</span><br><span class="line"><span class="comment"># æ ¹æ®è®­ç»ƒæ¨¡å‹é¢„æµ‹è¾“å‡º</span></span><br><span class="line">pred_y = line_model.predict(train_x)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;coef_:&quot;</span>, line_model.coef_)  <span class="comment"># ç³»æ•°</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;intercept_:&quot;</span>, line_model.intercept_)  <span class="comment"># æˆªè·</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–å›å½’æ›²çº¿</span></span><br><span class="line">mp.figure(<span class="string">&#x27;Linear Regression&#x27;</span>, facecolor=<span class="string">&#x27;lightgray&#x27;</span>)</span><br><span class="line">mp.title(<span class="string">&#x27;Linear Regression&#x27;</span>, fontsize=<span class="number">20</span>)</span><br><span class="line">mp.xlabel(<span class="string">&#x27;x&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">mp.ylabel(<span class="string">&#x27;y&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">mp.tick_params(labelsize=<span class="number">10</span>)</span><br><span class="line">mp.grid(linestyle=<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶æ ·æœ¬ç‚¹</span></span><br><span class="line">mp.scatter(train_x, train_y, c=<span class="string">&#x27;blue&#x27;</span>, alpha=<span class="number">0.8</span>, s=<span class="number">60</span>, label=<span class="string">&#x27;Sample&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»˜åˆ¶æ‹Ÿåˆç›´çº¿</span></span><br><span class="line">mp.plot(</span><br><span class="line">    train_x,  <span class="comment"># xåæ ‡æ•°æ®</span></span><br><span class="line">    pred_y,  <span class="comment"># yåæ ‡æ•°æ®</span></span><br><span class="line">    c=<span class="string">&#x27;orangered&#x27;</span>,</span><br><span class="line">    label=<span class="string">&#x27;Regression Line&#x27;</span>)</span><br><span class="line"></span><br><span class="line">mp.legend()  <span class="comment"># å·¦ä¸Šè§’çš„å›¾ä¾‹</span></span><br><span class="line">mp.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>coef_: [2.2189781]
intercept_: 4.107299270072994
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_14_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets, linear_model, model_selection</span><br><span class="line"></span><br><span class="line"><span class="comment"># science kit learn è‡ªå¸¦çš„ç³–å°¿ç—…æ•°æ®</span></span><br><span class="line">X, y = datasets.load_diabetes(return_X_y=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 442 * 10 å¤§å°çš„äºŒç»´æ•°ç»„</span></span><br><span class="line"><span class="built_in">print</span>(X.shape)</span><br><span class="line"><span class="comment"># No.1 * 10</span></span><br><span class="line"><span class="built_in">print</span>(X[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># åªå–ç¬¬äºŒç»´çš„ç¬¬ä¸‰åˆ—ä½œä¸ºç‰¹å¾è¾“å…¥ (ä¹Ÿå°±æ˜¯0.06169621è¿™ä¸€åˆ—)</span></span><br><span class="line">X = X[:, np.newaxis, <span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># train : test = 2 : 1</span></span><br><span class="line">X_train, X_test, y_train, y_test = model_selection.train_test_split(</span><br><span class="line">    X, y, test_size=<span class="number">0.33</span>)</span><br><span class="line"></span><br><span class="line">model = linear_model.LinearRegression()</span><br><span class="line">model.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line"></span><br><span class="line">plt.scatter(X_test, y_test, color=<span class="string">&#x27;black&#x27;</span>)</span><br><span class="line">plt.plot(X_test, y_pred, color=<span class="string">&#x27;blue&#x27;</span>, linewidth=<span class="number">3</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><pre><code>(442, 10)
[ 0.03807591  0.05068012  0.06169621  0.02187235 -0.0442235  -0.03482076
 -0.04340085 -0.00259226  0.01990842 -0.01764613]
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_15_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">pumpkins = pd.read_csv(<span class="string">&#x27;./_data_set/US-pumpkins.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pumpkins = pumpkins[pumpkins[<span class="string">&#x27;Package&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;bushel&#x27;</span>,</span><br><span class="line">                                                     <span class="keyword">case</span>=<span class="literal">True</span>,</span><br><span class="line">                                                     regex=<span class="literal">True</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># pumpkins.head()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># pumpkins.isnull().sum()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A set of new columns for a new dataframe. Filter out nonmatching columns</span></span><br><span class="line">pumpkins = pumpkins.drop([</span><br><span class="line">    c <span class="keyword">for</span> c <span class="keyword">in</span> pumpkins.columns <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> [</span><br><span class="line">        <span class="string">&#x27;Package&#x27;</span>, <span class="string">&#x27;Variety&#x27;</span>, <span class="string">&#x27;City Name&#x27;</span>, <span class="string">&#x27;Month&#x27;</span>, <span class="string">&#x27;Low Price&#x27;</span>, <span class="string">&#x27;High Price&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Date&#x27;</span></span><br><span class="line">    ]</span><br><span class="line">],</span><br><span class="line">                         axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get an average between low and high price for the base pumpkin price</span></span><br><span class="line">price = (pumpkins[<span class="string">&#x27;Low Price&#x27;</span>] + pumpkins[<span class="string">&#x27;High Price&#x27;</span>]) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a new dataframe with this basic data</span></span><br><span class="line">new_pumpkins = pd.DataFrame(&#123;</span><br><span class="line">    <span class="comment"># Convert the date to its month only</span></span><br><span class="line">    <span class="string">&#x27;Month&#x27;</span>:</span><br><span class="line">    pd.DatetimeIndex(pumpkins[<span class="string">&#x27;Date&#x27;</span>]).month,</span><br><span class="line">    <span class="string">&#x27;DayOfYear&#x27;</span>:</span><br><span class="line">    pd.to_datetime(pumpkins[<span class="string">&#x27;Date&#x27;</span>]).apply(</span><br><span class="line">        <span class="keyword">lambda</span> dt: (dt - datetime(dt.year, <span class="number">1</span>, <span class="number">1</span>)).days),</span><br><span class="line">    <span class="string">&#x27;Variety&#x27;</span>:</span><br><span class="line">    pumpkins[<span class="string">&#x27;Variety&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;City&#x27;</span>:</span><br><span class="line">    pumpkins[<span class="string">&#x27;City Name&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Package&#x27;</span>:</span><br><span class="line">    pumpkins[<span class="string">&#x27;Package&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Low Price&#x27;</span>:</span><br><span class="line">    pumpkins[<span class="string">&#x27;Low Price&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;High Price&#x27;</span>:</span><br><span class="line">    pumpkins[<span class="string">&#x27;High Price&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Price&#x27;</span>:</span><br><span class="line">    price</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Convert the price if the Package contains fractional bushel values</span></span><br><span class="line"><span class="comment"># loc éå†Packageåˆ—ä¸­åŒ…å« &#x27;1 1/9&#x27; çš„è¡Œ, å¯¹æ¯è¡Œçš„ Price åˆ—è¿›è¡Œæ“ä½œ</span></span><br><span class="line">new_pumpkins.loc[new_pumpkins[<span class="string">&#x27;Package&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;1 1/9&#x27;</span>),</span><br><span class="line">                 <span class="string">&#x27;Price&#x27;</span>] = price / (<span class="number">1</span> + <span class="number">1</span> / <span class="number">9</span>)</span><br><span class="line">new_pumpkins.loc[new_pumpkins[<span class="string">&#x27;Package&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;1/2&#x27;</span>),</span><br><span class="line">                 <span class="string">&#x27;Price&#x27;</span>] = price / (<span class="number">1</span> / <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ•£ç‚¹å›¾</span></span><br><span class="line">plt.scatter(new_pumpkins.Price, new_pumpkins.Month)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Price&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Month&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æŸ±çŠ¶å›¾</span></span><br><span class="line">new_pumpkins.groupby([<span class="string">&#x27;Month&#x27;</span>])[<span class="string">&#x27;Price&#x27;</span>].mean().plot(kind=<span class="string">&#x27;bar&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Month&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ax = <span class="literal">None</span></span><br><span class="line">colors = [<span class="string">&#x27;red&#x27;</span>, <span class="string">&#x27;blue&#x27;</span>, <span class="string">&#x27;green&#x27;</span>, <span class="string">&#x27;yellow&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i, var <span class="keyword">in</span> <span class="built_in">enumerate</span>(new_pumpkins[<span class="string">&#x27;Variety&#x27;</span>].unique()):</span><br><span class="line">    ax = new_pumpkins[new_pumpkins[<span class="string">&#x27;Variety&#x27;</span>] == var].plot.scatter(<span class="string">&#x27;DayOfYear&#x27;</span>,</span><br><span class="line">                                                                   <span class="string">&#x27;Price&#x27;</span>,</span><br><span class="line">                                                                   ax=ax,</span><br><span class="line">                                                                   c=colors[i],</span><br><span class="line">                                                                   label=var)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_16_0.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_16_1.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_16_2.png" alt="png"></p><h4 id="å¤šé¡¹å¼å›å½’">å¤šé¡¹å¼å›å½’</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score, mean_squared_error, mean_absolute_error</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures</span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> make_pipeline</span><br><span class="line"></span><br><span class="line">pumpkins = pd.read_csv(<span class="string">&#x27;./_data_set/US-pumpkins.csv&#x27;</span>)</span><br><span class="line">pumpkins = pumpkins[pumpkins[<span class="string">&#x27;Package&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;bushel&#x27;</span>,</span><br><span class="line">                                                     <span class="keyword">case</span>=<span class="literal">True</span>,</span><br><span class="line">                                                     regex=<span class="literal">True</span>)]</span><br><span class="line">pumpkins = pumpkins.drop([</span><br><span class="line">    c <span class="keyword">for</span> c <span class="keyword">in</span> pumpkins.columns <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span> [</span><br><span class="line">        <span class="string">&#x27;Package&#x27;</span>, <span class="string">&#x27;Variety&#x27;</span>, <span class="string">&#x27;City Name&#x27;</span>, <span class="string">&#x27;Month&#x27;</span>, <span class="string">&#x27;Low Price&#x27;</span>, <span class="string">&#x27;High Price&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;Date&#x27;</span></span><br><span class="line">    ]</span><br><span class="line">],</span><br><span class="line">                         axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">price = (pumpkins[<span class="string">&#x27;Low Price&#x27;</span>] + pumpkins[<span class="string">&#x27;High Price&#x27;</span>]) / <span class="number">2</span></span><br><span class="line"></span><br><span class="line">new_pumpkins = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;Month&#x27;</span>:</span><br><span class="line">    pd.DatetimeIndex(pumpkins[<span class="string">&#x27;Date&#x27;</span>]).month,</span><br><span class="line">    <span class="string">&#x27;DayOfYear&#x27;</span>:</span><br><span class="line">    pd.to_datetime(pumpkins[<span class="string">&#x27;Date&#x27;</span>]).apply(</span><br><span class="line">        <span class="keyword">lambda</span> dt: (dt - datetime(dt.year, <span class="number">1</span>, <span class="number">1</span>)).days),</span><br><span class="line">    <span class="string">&#x27;Variety&#x27;</span>:</span><br><span class="line">    pumpkins[<span class="string">&#x27;Variety&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;City&#x27;</span>:</span><br><span class="line">    pumpkins[<span class="string">&#x27;City Name&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Package&#x27;</span>:</span><br><span class="line">    pumpkins[<span class="string">&#x27;Package&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Low Price&#x27;</span>:</span><br><span class="line">    pumpkins[<span class="string">&#x27;Low Price&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;High Price&#x27;</span>:</span><br><span class="line">    pumpkins[<span class="string">&#x27;High Price&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Price&#x27;</span>:</span><br><span class="line">    price</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">new_pumpkins.loc[new_pumpkins[<span class="string">&#x27;Package&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;1 1/9&#x27;</span>),</span><br><span class="line">                 <span class="string">&#x27;Price&#x27;</span>] = price / <span class="number">1.1</span></span><br><span class="line">new_pumpkins.loc[new_pumpkins[<span class="string">&#x27;Package&#x27;</span>].<span class="built_in">str</span>.contains(<span class="string">&#x27;1/2&#x27;</span>),</span><br><span class="line">                 <span class="string">&#x27;Price&#x27;</span>] = price * <span class="number">2</span></span><br><span class="line"></span><br><span class="line">pie_pumpkins = new_pumpkins[new_pumpkins[<span class="string">&#x27;Variety&#x27;</span>] == <span class="string">&#x27;PIE TYPE&#x27;</span>]</span><br><span class="line"></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(</span><br><span class="line">    pie_pumpkins[<span class="string">&#x27;DayOfYear&#x27;</span>].to_numpy().reshape(-<span class="number">1</span>, <span class="number">1</span>),</span><br><span class="line">    pie_pumpkins[<span class="string">&#x27;Price&#x27;</span>],</span><br><span class="line">    test_size=<span class="number">0.2</span>,</span><br><span class="line">    random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">pipeline = make_pipeline(PolynomialFeatures(<span class="number">2</span>), LinearRegression())</span><br><span class="line"></span><br><span class="line">pipeline.fit(X_train, y_train)</span><br><span class="line"></span><br><span class="line">pred = pipeline.predict(X_test)</span><br><span class="line"></span><br><span class="line">mse = np.sqrt(mean_squared_error(y_test, pred))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;Mean error: <span class="subst">&#123;mse:<span class="number">3.3</span>&#125;</span> (<span class="subst">&#123;mse/np.mean(pred)*<span class="number">100</span>:<span class="number">3.3</span>&#125;</span>%)&#x27;</span>)</span><br><span class="line"></span><br><span class="line">score = pipeline.score(X_train, y_train)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Model determination: &#x27;</span>, score)</span><br><span class="line"></span><br><span class="line">plt.scatter(X_test, y_test)</span><br><span class="line">plt.plot(<span class="built_in">sorted</span>(X_test), pipeline.predict(<span class="built_in">sorted</span>(X_test)))</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>Mean error: 2.73 (17.0%)
Model determination:  0.07639977655280084





[&lt;matplotlib.lines.Line2D at 0x19b75ee76d0&gt;]
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_18_2.png" alt="png"></p><h3 id="å†³ç­–æ ‘-éšæœºæ£®æ—">å†³ç­–æ ‘-éšæœºæ£®æ—</h3><h4 id="å†³ç­–æ ‘åˆ†ç±»">å†³ç­–æ ‘åˆ†ç±»</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> tree</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line"><span class="keyword">import</span> pydotplus</span><br><span class="line"></span><br><span class="line">mpl.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;simHei&#x27;</span>]</span><br><span class="line">mpl.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">iris_feature_E = <span class="string">&#x27;sepal length&#x27;</span>, <span class="string">&#x27;sepal width&#x27;</span>, <span class="string">&#x27;petal length&#x27;</span>, <span class="string">&#x27;petal width&#x27;</span></span><br><span class="line">iris_feature = <span class="string">&#x27;èŠ±è¼é•¿åº¦&#x27;</span>, <span class="string">&#x27;èŠ±è¼å®½åº¦&#x27;</span>, <span class="string">&#x27;èŠ±ç“£é•¿åº¦&#x27;</span>, <span class="string">&#x27;èŠ±ç“£å®½åº¦&#x27;</span></span><br><span class="line">iris_class = <span class="string">&#x27;Iris-setosa&#x27;</span>, <span class="string">&#x27;Iris-versicolor&#x27;</span>, <span class="string">&#x27;Iris-virginica&#x27;</span></span><br><span class="line"></span><br><span class="line">path = <span class="string">&#x27;./_data_set/iris_classification/iris.data&#x27;</span>  <span class="comment"># æ•°æ®æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">data = pd.read_csv(path, header=<span class="literal">None</span>)</span><br><span class="line">x = data[<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">4</span>))]</span><br><span class="line"><span class="comment"># y = pd.Categorical(data[4]).codes</span></span><br><span class="line">y = LabelEncoder().fit_transform(data[<span class="number">4</span>])</span><br><span class="line"><span class="comment"># ä¸ºäº†å¯è§†åŒ–ï¼Œä»…ä½¿ç”¨å‰ä¸¤åˆ—ç‰¹å¾</span></span><br><span class="line">x = x[[<span class="number">0</span>, <span class="number">1</span>]]</span><br><span class="line"><span class="comment"># x = x.iloc[:, :2]</span></span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(x,</span><br><span class="line">                                                    y,</span><br><span class="line">                                                    test_size=<span class="number">0.3</span>,</span><br><span class="line">                                                    random_state=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å†³ç­–æ ‘å‚æ•°ä¼°è®¡</span></span><br><span class="line"><span class="comment"># min_samples_split = 10ï¼šå¦‚æœè¯¥ç»“ç‚¹åŒ…å«çš„æ ·æœ¬æ•°ç›®å¤§äº10ï¼Œåˆ™(æœ‰å¯èƒ½)å¯¹å…¶åˆ†æ”¯</span></span><br><span class="line"><span class="comment"># min_samples_leaf = 10ï¼šè‹¥å°†æŸç»“ç‚¹åˆ†æ”¯åï¼Œå¾—åˆ°çš„æ¯ä¸ªå­ç»“ç‚¹æ ·æœ¬æ•°ç›®éƒ½å¤§äº10ï¼Œåˆ™å®Œæˆåˆ†æ”¯ï¼›å¦åˆ™ï¼Œä¸è¿›è¡Œåˆ†æ”¯</span></span><br><span class="line">model = DecisionTreeClassifier(criterion=<span class="string">&#x27;entropy&#x27;</span>)</span><br><span class="line">model.fit(x_train, y_train)</span><br><span class="line">y_train_pred = model.predict(x_train)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;è®­ç»ƒé›†æ­£ç¡®ç‡ï¼š&#x27;</span>, accuracy_score(y_train, y_train_pred))</span><br><span class="line">y_test_hat = model.predict(x_test)  <span class="comment"># æµ‹è¯•æ•°æ®</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;æµ‹è¯•é›†æ­£ç¡®ç‡ï¼š&#x27;</span>, accuracy_score(y_test, y_test_hat))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜</span></span><br><span class="line"><span class="comment"># dot -Tpng my.dot -o my.png</span></span><br><span class="line"><span class="comment"># 1ã€è¾“å‡º</span></span><br><span class="line"><span class="comment"># with open(&#x27;iris.dot&#x27;, &#x27;w&#x27;) as f:</span></span><br><span class="line"><span class="comment">#     tree.export_graphviz(model, out_file=f, feature_names=iris_feature_E[0:2], class_names=iris_class,</span></span><br><span class="line"><span class="comment">#                          filled=True, rounded=True, special_characters=True)</span></span><br><span class="line">tree.export_graphviz(model,</span><br><span class="line">                     out_file=<span class="string">&#x27;./_data_set/iris_classification/iris.dot&#x27;</span>,</span><br><span class="line">                     feature_names=iris_feature_E[<span class="number">0</span>:<span class="number">2</span>],</span><br><span class="line">                     class_names=iris_class,</span><br><span class="line">                     filled=<span class="literal">True</span>,</span><br><span class="line">                     rounded=<span class="literal">True</span>,</span><br><span class="line">                     special_characters=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 2ã€ç»™å®šæ–‡ä»¶å</span></span><br><span class="line"><span class="comment"># tree.export_graphviz(model, out_file=&#x27;iris.dot&#x27;)</span></span><br><span class="line"><span class="comment"># tree.export_graphviz(model, out_file=&#x27;iris.dot&#x27;)</span></span><br><span class="line"><span class="comment"># 3ã€è¾“å‡ºä¸ºpdfæ ¼å¼</span></span><br><span class="line">dot_data = tree.export_graphviz(model,</span><br><span class="line">                                out_file=<span class="literal">None</span>,</span><br><span class="line">                                feature_names=iris_feature_E[<span class="number">0</span>:<span class="number">2</span>],</span><br><span class="line">                                class_names=iris_class,</span><br><span class="line">                                filled=<span class="literal">True</span>,</span><br><span class="line">                                rounded=<span class="literal">True</span>,</span><br><span class="line">                                special_characters=<span class="literal">True</span>)</span><br><span class="line">graph = pydotplus.graph_from_dot_data(dot_data)</span><br><span class="line">graph.write_pdf(<span class="string">&#x27;./_data_set/iris_classification/iris.pdf&#x27;</span>)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;./_data_set/iris_classification/iris.png&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>)</span><br><span class="line">f.write(graph.create_png())</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”»å›¾</span></span><br><span class="line">N, M = <span class="number">50</span>, <span class="number">50</span>  <span class="comment"># æ¨ªçºµå„é‡‡æ ·å¤šå°‘ä¸ªå€¼</span></span><br><span class="line">x1_min, x2_min = x.<span class="built_in">min</span>()</span><br><span class="line">x1_max, x2_max = x.<span class="built_in">max</span>()</span><br><span class="line">t1 = np.linspace(x1_min, x1_max, N)</span><br><span class="line">t2 = np.linspace(x2_min, x2_max, M)</span><br><span class="line">x1, x2 = np.meshgrid(t1, t2)  <span class="comment"># ç”Ÿæˆç½‘æ ¼é‡‡æ ·ç‚¹</span></span><br><span class="line">x_show = np.stack((x1.flat, x2.flat), axis=<span class="number">1</span>)  <span class="comment"># æµ‹è¯•ç‚¹</span></span><br><span class="line"><span class="built_in">print</span>(x_show.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;x_show = \n&#x27;</span>, x_show)</span><br><span class="line"></span><br><span class="line">cm_light = mpl.colors.ListedColormap([<span class="string">&#x27;#A0FFA0&#x27;</span>, <span class="string">&#x27;#FFA0A0&#x27;</span>, <span class="string">&#x27;#A0A0FF&#x27;</span>])</span><br><span class="line">cm_dark = mpl.colors.ListedColormap([<span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;b&#x27;</span>])</span><br><span class="line">y_show_hat = model.predict(x_show)  <span class="comment"># é¢„æµ‹å€¼</span></span><br><span class="line"><span class="built_in">print</span>(y_show_hat.shape)</span><br><span class="line"><span class="built_in">print</span>(y_show_hat)</span><br><span class="line">y_show_hat = y_show_hat.reshape(x1.shape)  <span class="comment"># ä½¿ä¹‹ä¸è¾“å…¥çš„å½¢çŠ¶ç›¸åŒ</span></span><br><span class="line"><span class="built_in">print</span>(y_show_hat)</span><br><span class="line">plt.figure(facecolor=<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">plt.pcolormesh(x1, x2, y_show_hat, cmap=cm_light, shading=<span class="string">&#x27;auto&#x27;</span>)  <span class="comment"># é¢„æµ‹å€¼çš„æ˜¾ç¤º</span></span><br><span class="line">plt.scatter(x_test[<span class="number">0</span>],</span><br><span class="line">            x_test[<span class="number">1</span>],</span><br><span class="line">            c=y_test.ravel(),</span><br><span class="line">            edgecolors=<span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">            s=<span class="number">100</span>,</span><br><span class="line">            zorder=<span class="number">10</span>,</span><br><span class="line">            cmap=cm_dark,</span><br><span class="line">            marker=<span class="string">&#x27;*&#x27;</span>)  <span class="comment"># æµ‹è¯•æ•°æ®</span></span><br><span class="line">plt.scatter(x[<span class="number">0</span>], x[<span class="number">1</span>], c=y.ravel(), edgecolors=<span class="string">&#x27;k&#x27;</span>, s=<span class="number">20</span>,</span><br><span class="line">            cmap=cm_dark)  <span class="comment"># å…¨éƒ¨æ•°æ®</span></span><br><span class="line">plt.xlabel(iris_feature[<span class="number">0</span>], fontsize=<span class="number">13</span>)</span><br><span class="line">plt.ylabel(iris_feature[<span class="number">1</span>], fontsize=<span class="number">13</span>)</span><br><span class="line">plt.xlim(x1_min, x1_max)</span><br><span class="line">plt.ylim(x2_min, x2_max)</span><br><span class="line">plt.grid(b=<span class="literal">True</span>, ls=<span class="string">&#x27;:&#x27;</span>, color=<span class="string">&#x27;#606060&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;é¸¢å°¾èŠ±æ•°æ®çš„å†³ç­–æ ‘åˆ†ç±»&#x27;</span>, fontsize=<span class="number">15</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®­ç»ƒé›†ä¸Šçš„é¢„æµ‹ç»“æœ</span></span><br><span class="line">y_test = y_test.reshape(-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(y_test_hat)</span><br><span class="line"><span class="built_in">print</span>(y_test)</span><br><span class="line">result = (y_test_hat == y_test)  <span class="comment"># Trueåˆ™é¢„æµ‹æ­£ç¡®ï¼ŒFalseåˆ™é¢„æµ‹é”™è¯¯</span></span><br><span class="line">acc = np.mean(result)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;å‡†ç¡®åº¦: %.2f%%&#x27;</span> % (<span class="number">100</span> * acc))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿‡æ‹Ÿåˆï¼šé”™è¯¯ç‡</span></span><br><span class="line">depth = np.arange(<span class="number">1</span>, <span class="number">15</span>)</span><br><span class="line">err_train_list = []</span><br><span class="line">err_test_list = []</span><br><span class="line">clf = DecisionTreeClassifier(criterion=<span class="string">&#x27;entropy&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> depth:</span><br><span class="line">    clf.set_params(max_depth=d)</span><br><span class="line">    clf.fit(x_train, y_train)</span><br><span class="line">    y_train_pred = clf.predict(x_train)</span><br><span class="line">    err_train = <span class="number">1</span> - accuracy_score(y_train, y_train_pred)</span><br><span class="line">    err_train_list.append(err_train)</span><br><span class="line">    y_test_pred = clf.predict(x_test)</span><br><span class="line">    err_test = <span class="number">1</span> - accuracy_score(y_test, y_test_pred)</span><br><span class="line">    err_test_list.append(err_test)</span><br><span class="line">    <span class="built_in">print</span>(d, <span class="string">&#x27; æµ‹è¯•é›†é”™è¯¯ç‡: %.2f%%&#x27;</span> % (<span class="number">100</span> * err_test))</span><br><span class="line">plt.figure(facecolor=<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">plt.plot(depth,</span><br><span class="line">         err_test_list,</span><br><span class="line">         <span class="string">&#x27;ro-&#x27;</span>,</span><br><span class="line">         markeredgecolor=<span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">         lw=<span class="number">2</span>,</span><br><span class="line">         label=<span class="string">&#x27;æµ‹è¯•é›†é”™è¯¯ç‡&#x27;</span>)</span><br><span class="line">plt.plot(depth,</span><br><span class="line">         err_train_list,</span><br><span class="line">         <span class="string">&#x27;go-&#x27;</span>,</span><br><span class="line">         markeredgecolor=<span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">         lw=<span class="number">2</span>,</span><br><span class="line">         label=<span class="string">&#x27;è®­ç»ƒé›†é”™è¯¯ç‡&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;å†³ç­–æ ‘æ·±åº¦&#x27;</span>, fontsize=<span class="number">13</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;é”™è¯¯ç‡&#x27;</span>, fontsize=<span class="number">13</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;lower left&#x27;</span>, fontsize=<span class="number">13</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;å†³ç­–æ ‘æ·±åº¦ä¸è¿‡æ‹Ÿåˆ&#x27;</span>, fontsize=<span class="number">15</span>)</span><br><span class="line">plt.grid(b=<span class="literal">True</span>, ls=<span class="string">&#x27;:&#x27;</span>, color=<span class="string">&#x27;#606060&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><pre><code>è®­ç»ƒé›†æ­£ç¡®ç‡ï¼š 0.9523809523809523
æµ‹è¯•é›†æ­£ç¡®ç‡ï¼š 0.6222222222222222
(2500, 2)
x_show =
 [[4.3        2.        ]
 [4.37346939 2.        ]
 [4.44693878 2.        ]
 ...
 [7.75306122 4.4       ]
 [7.82653061 4.4       ]
 [7.9        4.4       ]]
(2500,)
[0 0 0 ... 2 2 2]
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_20_1.png" alt="png"></p><pre><code>[0 1 2 0 2 2 1 0 0 2 2 0 1 2 1 0 2 1 0 0 1 0 2 0 2 1 0 0 1 1 2 2 2 2 1 0 1
 0 2 1 2 0 1 1 1]
[0 1 1 0 2 1 2 0 0 2 1 0 2 1 1 0 1 1 0 0 1 1 1 0 2 1 0 0 1 2 1 2 1 2 2 0 1
 0 1 2 2 0 2 2 1]
å‡†ç¡®åº¦: 62.22%
1  æµ‹è¯•é›†é”™è¯¯ç‡: 44.44%
2  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%
3  æµ‹è¯•é›†é”™è¯¯ç‡: 20.00%
4  æµ‹è¯•é›†é”™è¯¯ç‡: 24.44%
5  æµ‹è¯•é›†é”™è¯¯ç‡: 24.44%
6  æµ‹è¯•é›†é”™è¯¯ç‡: 28.89%
7  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%
8  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%
9  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%
10  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%
11  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%
12  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%
13  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%
14  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_20_3.png" alt="png"></p><h4 id="éšæœºæ£®æ—">éšæœºæ£®æ—</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.tree <span class="keyword">import</span> DecisionTreeClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"></span><br><span class="line">mpl.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">mpl.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">iris_feature = <span class="string">u&#x27;èŠ±è¼é•¿åº¦&#x27;</span>, <span class="string">u&#x27;èŠ±è¼å®½åº¦&#x27;</span>, <span class="string">u&#x27;èŠ±ç“£é•¿åº¦&#x27;</span>, <span class="string">u&#x27;èŠ±ç“£å®½åº¦&#x27;</span></span><br><span class="line">path = <span class="string">&#x27;./_data_set/iris_classification/iris.data&#x27;</span>  <span class="comment"># æ•°æ®æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">data = pd.read_csv(path, header=<span class="literal">None</span>)</span><br><span class="line">x_prime = data[<span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">4</span>))]</span><br><span class="line">y = pd.Categorical(data[<span class="number">4</span>]).codes</span><br><span class="line">x_prime_train, x_prime_test, y_train, y_test = train_test_split(x_prime,</span><br><span class="line">                                                                y,</span><br><span class="line">                                                                train_size=<span class="number">0.7</span>,</span><br><span class="line">                                                                random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">feature_pairs = [[<span class="number">0</span>, <span class="number">1</span>], [<span class="number">0</span>, <span class="number">2</span>], [<span class="number">0</span>, <span class="number">3</span>], [<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1</span>, <span class="number">3</span>], [<span class="number">2</span>, <span class="number">3</span>]]</span><br><span class="line">plt.figure(figsize=(<span class="number">8</span>, <span class="number">6</span>), facecolor=<span class="string">&#x27;#FFFFFF&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i, pair <span class="keyword">in</span> <span class="built_in">enumerate</span>(feature_pairs):</span><br><span class="line">    <span class="comment"># å‡†å¤‡æ•°æ®</span></span><br><span class="line">    x_train = x_prime_train[pair]</span><br><span class="line">    x_test = x_prime_test[pair]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># å†³ç­–æ ‘å­¦ä¹ </span></span><br><span class="line">    model = DecisionTreeClassifier(criterion=<span class="string">&#x27;entropy&#x27;</span>, min_samples_leaf=<span class="number">3</span>)</span><br><span class="line">    model.fit(x_train, y_train)</span><br><span class="line"></span><br><span class="line">    N, M = <span class="number">500</span>, <span class="number">500</span>  <span class="comment"># æ¨ªçºµå„é‡‡æ ·å¤šå°‘ä¸ªå€¼</span></span><br><span class="line">    x1_min, x2_min = x_train.<span class="built_in">min</span>()</span><br><span class="line">    x1_max, x2_max = x_train.<span class="built_in">max</span>()</span><br><span class="line">    t1 = np.linspace(x1_min, x1_max, N)</span><br><span class="line">    t2 = np.linspace(x2_min, x2_max, M)</span><br><span class="line">    x1, x2 = np.meshgrid(t1, t2)  <span class="comment"># ç”Ÿæˆç½‘æ ¼é‡‡æ ·ç‚¹</span></span><br><span class="line">    x_show = np.stack((x1.flat, x2.flat), axis=<span class="number">1</span>)  <span class="comment"># æµ‹è¯•ç‚¹</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># è®­ç»ƒé›†ä¸Šçš„é¢„æµ‹ç»“æœ</span></span><br><span class="line">    y_train_pred = model.predict(x_train)</span><br><span class="line">    acc_train = accuracy_score(y_train, y_train_pred)</span><br><span class="line">    y_test_pred = model.predict(x_test)</span><br><span class="line">    acc_test = accuracy_score(y_test, y_test_pred)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ç‰¹å¾ï¼š&#x27;</span>, iris_feature[pair[<span class="number">0</span>]], <span class="string">&#x27; + &#x27;</span>, iris_feature[pair[<span class="number">1</span>]])</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\tè®­ç»ƒé›†å‡†ç¡®ç‡: %.4f%%&#x27;</span> % (<span class="number">100</span> * acc_train))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;\tæµ‹è¯•é›†å‡†ç¡®ç‡: %.4f%%\n&#x27;</span> % (<span class="number">100</span> * acc_test))</span><br><span class="line"></span><br><span class="line">    cm_light = mpl.colors.ListedColormap([<span class="string">&#x27;#A0FFA0&#x27;</span>, <span class="string">&#x27;#FFA0A0&#x27;</span>, <span class="string">&#x27;#A0A0FF&#x27;</span>])</span><br><span class="line">    cm_dark = mpl.colors.ListedColormap([<span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;b&#x27;</span>])</span><br><span class="line">    y_hat = model.predict(x_show)</span><br><span class="line">    y_hat = y_hat.reshape(x1.shape)</span><br><span class="line">    plt.subplot(<span class="number">2</span>, <span class="number">3</span>, i + <span class="number">1</span>)</span><br><span class="line">    plt.contour(x1,</span><br><span class="line">                x2,</span><br><span class="line">                y_hat,</span><br><span class="line">                colors=<span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">                levels=[<span class="number">0</span>, <span class="number">1</span>],</span><br><span class="line">                antialiased=<span class="literal">True</span>,</span><br><span class="line">                linewidths=<span class="number">1</span>)</span><br><span class="line">    plt.pcolormesh(x1, x2, y_hat, cmap=cm_light, shading=<span class="string">&#x27;auto&#x27;</span>)  <span class="comment"># é¢„æµ‹å€¼</span></span><br><span class="line">    plt.scatter(x_train[pair[<span class="number">0</span>]],</span><br><span class="line">                x_train[pair[<span class="number">1</span>]],</span><br><span class="line">                c=y_train,</span><br><span class="line">                s=<span class="number">20</span>,</span><br><span class="line">                edgecolors=<span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">                cmap=cm_dark,</span><br><span class="line">                label=<span class="string">u&#x27;è®­ç»ƒé›†&#x27;</span>)</span><br><span class="line">    plt.scatter(x_test[pair[<span class="number">0</span>]],</span><br><span class="line">                x_test[pair[<span class="number">1</span>]],</span><br><span class="line">                c=y_test,</span><br><span class="line">                s=<span class="number">80</span>,</span><br><span class="line">                marker=<span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">                edgecolors=<span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">                cmap=cm_dark,</span><br><span class="line">                label=<span class="string">u&#x27;æµ‹è¯•é›†&#x27;</span>)</span><br><span class="line">    plt.xlabel(iris_feature[pair[<span class="number">0</span>]], fontsize=<span class="number">12</span>)</span><br><span class="line">    plt.ylabel(iris_feature[pair[<span class="number">1</span>]], fontsize=<span class="number">12</span>)</span><br><span class="line">    <span class="comment"># plt.legend(loc=&#x27;upper right&#x27;, fancybox=True, framealpha=0.3)</span></span><br><span class="line">    plt.xlim(x1_min, x1_max)</span><br><span class="line">    plt.ylim(x2_min, x2_max)</span><br><span class="line">    plt.grid(b=<span class="literal">True</span>, ls=<span class="string">&#x27;:&#x27;</span>, color=<span class="string">&#x27;#606060&#x27;</span>)</span><br><span class="line">plt.suptitle(<span class="string">u&#x27;å†³ç­–æ ‘å¯¹é¸¢å°¾èŠ±æ•°æ®ä¸¤ç‰¹å¾ç»„åˆçš„åˆ†ç±»ç»“æœ&#x27;</span>, fontsize=<span class="number">15</span>)</span><br><span class="line">plt.tight_layout(<span class="number">1</span>, rect=(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.94</span>))  <span class="comment"># (left, bottom, right, top)</span></span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>ç‰¹å¾ï¼š èŠ±è¼é•¿åº¦  +  èŠ±è¼å®½åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 85.7143%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 71.1111%

ç‰¹å¾ï¼š èŠ±è¼é•¿åº¦  +  èŠ±ç“£é•¿åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 96.1905%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 91.1111%

ç‰¹å¾ï¼š èŠ±è¼é•¿åº¦  +  èŠ±ç“£å®½åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 96.1905%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 86.6667%

ç‰¹å¾ï¼š èŠ±è¼å®½åº¦  +  èŠ±ç“£é•¿åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 97.1429%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 95.5556%

ç‰¹å¾ï¼š èŠ±è¼å®½åº¦  +  èŠ±ç“£å®½åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 96.1905%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 84.4444%

ç‰¹å¾ï¼š èŠ±ç“£é•¿åº¦  +  èŠ±ç“£å®½åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 98.0952%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 97.7778%



C:\Users\utsuk\AppData\Local\Temp\ipykernel_25000\2108356862.py:83: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.
  plt.tight_layout(1, rect=(0, 0, 1, 0.94))  # (left, bottom, right, top)
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_22_2.png" alt="png"></p><h4 id="å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’">å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestRegressor</span><br><span class="line"></span><br><span class="line">N = <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [-3,3)</span></span><br><span class="line">x = np.random.rand(N) * <span class="number">6</span> - <span class="number">3</span></span><br><span class="line">x.sort()</span><br><span class="line">y = np.sin(x) + np.random.randn(N) * <span class="number">0.05</span></span><br><span class="line">x = x.reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># model = DecisionTreeRegressor(criterion=&#x27;mse&#x27;, max_depth=10)</span></span><br><span class="line">model = RandomForestRegressor(n_estimators=<span class="number">20</span>, criterion=<span class="string">&#x27;mse&#x27;</span>, max_depth=<span class="number">10</span>)</span><br><span class="line">model.fit(x, y)</span><br><span class="line">x_test = np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">50</span>).reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">y_hat = model.predict(x_test)</span><br><span class="line"></span><br><span class="line">mpl.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">mpl.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line">plt.figure(facecolor=<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">plt.plot(x, y, <span class="string">&#x27;r*&#x27;</span>, markersize=<span class="number">10</span>, markeredgecolor=<span class="string">&#x27;k&#x27;</span>, label=<span class="string">&#x27;å®é™…å€¼&#x27;</span>)</span><br><span class="line">plt.plot(x_test, y_hat, <span class="string">&#x27;g-&#x27;</span>, linewidth=<span class="number">2</span>, label=<span class="string">&#x27;é¢„æµ‹å€¼&#x27;</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper left&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line">plt.grid(b=<span class="literal">True</span>, ls=<span class="string">&#x27;:&#x27;</span>, color=<span class="string">&#x27;#606060&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’&#x27;</span>, fontsize=<span class="number">15</span>)</span><br><span class="line">plt.tight_layout(<span class="number">2</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ¯”è¾ƒå†³ç­–æ ‘çš„æ·±åº¦å½±å“</span></span><br><span class="line">depth = [<span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>, <span class="number">10</span>]</span><br><span class="line">clr = <span class="string">&#x27;rgbmy&#x27;</span></span><br><span class="line"><span class="comment"># model = DecisionTreeRegressor(criterion=&#x27;mse&#x27;)</span></span><br><span class="line">model = RandomForestRegressor(n_estimators=<span class="number">20</span>, criterion=<span class="string">&#x27;mse&#x27;</span>)</span><br><span class="line">plt.figure(facecolor=<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">plt.plot(x, y, <span class="string">&#x27;ro&#x27;</span>, ms=<span class="number">5</span>, mec=<span class="string">&#x27;k&#x27;</span>, label=<span class="string">&#x27;å®é™…å€¼&#x27;</span>)</span><br><span class="line">x_test = np.linspace(-<span class="number">3</span>, <span class="number">3</span>, <span class="number">50</span>).reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> d, c <span class="keyword">in</span> <span class="built_in">zip</span>(depth, clr):</span><br><span class="line">    model.set_params(max_depth=d)</span><br><span class="line">    model.fit(x, y)</span><br><span class="line">    y_hat = model.predict(x_test)</span><br><span class="line">    plt.plot(x_test,</span><br><span class="line">             y_hat,</span><br><span class="line">             <span class="string">&#x27;-&#x27;</span>,</span><br><span class="line">             color=c,</span><br><span class="line">             linewidth=<span class="number">2</span>,</span><br><span class="line">             markeredgecolor=<span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">             label=<span class="string">&#x27;Depth=%d&#x27;</span> % d)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;upper left&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;X&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Y&#x27;</span>)</span><br><span class="line">plt.grid(b=<span class="literal">True</span>, ls=<span class="string">&#x27;:&#x27;</span>, color=<span class="string">&#x27;#606060&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’&#x27;</span>, fontsize=<span class="number">15</span>)</span><br><span class="line">plt.tight_layout(<span class="number">2</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><pre><code>[[-2.95013857]
 [-2.91406777]
 [-2.90709403]
 [-2.90375999]
 [-2.87745415]
 [-2.86685497]
 [-2.84070033]
 [-2.81375697]
 [-2.77943784]
 [-2.77745775]
 [-2.66347611]
 [-2.65986762]
 [-2.64217075]
 [-2.63778267]
 [-2.63639243]
 [-2.60165162]
 [-2.48896096]
 [-2.43041085]
 [-2.39941506]
 [-2.38779079]
 [-2.37856289]
 [-2.32809632]
 [-2.29426051]
 [-2.25524085]
 [-2.23914776]
 [-2.16578847]
 [-2.0055294 ]
 [-1.9885004 ]
 [-1.73199798]
 [-1.61893958]
 [-1.58908223]
 [-1.54966302]
 [-1.49074428]
 [-1.46530843]
 [-1.40362808]
 [-1.3935955 ]
 [-1.3928819 ]
 [-1.37684247]
 [-1.3377295 ]
 [-1.33035029]
 [-1.24577529]
 [-1.15561278]
 [-1.12976361]
 [-0.92771942]
 [-0.91536325]
 [-0.83851709]
 [-0.54828961]
 [-0.54587447]
 [-0.54456521]
 [-0.51610774]
 [-0.38078143]
 [-0.27298529]
 [-0.20898971]
 [-0.20866835]
 [ 0.01703485]
 [ 0.03203468]
 [ 0.06107388]
 [ 0.07358949]
 [ 0.07361575]
 [ 0.10676155]
 [ 0.15818226]
 [ 0.20123638]
 [ 0.3410772 ]
 [ 0.45680655]
 [ 0.52384169]
 [ 0.65741898]
 [ 0.68306354]
 [ 0.82845395]
 [ 0.83952908]
 [ 0.99278446]
 [ 1.04865533]
 [ 1.16809926]
 [ 1.21294563]
 [ 1.44659934]
 [ 1.47606149]
 [ 1.48031876]
 [ 1.54476213]
 [ 1.54542061]
 [ 1.60452852]
 [ 1.85706958]
 [ 1.9814776 ]
 [ 2.07801869]
 [ 2.08420295]
 [ 2.08974078]
 [ 2.09458999]
 [ 2.21547939]
 [ 2.2354401 ]
 [ 2.2824592 ]
 [ 2.39313024]
 [ 2.4822308 ]
 [ 2.5275393 ]
 [ 2.56392915]
 [ 2.63696096]
 [ 2.65318554]
 [ 2.66286196]
 [ 2.67531127]
 [ 2.69337798]
 [ 2.78329004]
 [ 2.83409465]
 [ 2.94897411]]
[-0.16517944 -0.2651016  -0.26383212 -0.2408083  -0.21137157 -0.30729908
 -0.24489794 -0.42738593 -0.39536257 -0.34762803 -0.55252409 -0.40629331
 -0.47658554 -0.47459876 -0.50897455 -0.58933727 -0.57144697 -0.61564276
 -0.76543047 -0.64009055 -0.79612233 -0.77625958 -0.82824783 -0.74228023
 -0.6882561  -0.85479709 -0.9210133  -0.88824326 -0.94228155 -1.04205908
 -1.01456756 -1.0150173  -1.01319155 -0.93942161 -1.0101109  -1.00949492
 -1.00669835 -1.02762794 -0.90526463 -1.04873446 -0.98356087 -0.96345712
 -0.90790305 -0.78617335 -0.8215092  -0.7756252  -0.62805774 -0.61416394
 -0.55438357 -0.54877048 -0.24409899 -0.24654351 -0.22139215 -0.31816396
 -0.00948097  0.03731195  0.07871564  0.06089414  0.091661    0.10130855
  0.05916354  0.284293    0.32301758  0.47390064  0.43774825  0.59439442
  0.62285701  0.78479681  0.7888438   0.91498224  0.91654605  0.84583033
  0.90598404  0.99494553  1.05048367  0.97256267  1.04768316  1.09246729
  0.92367061  0.97097779  0.98148804  0.86766162  0.87249721  0.81545132
  0.80772307  0.75639662  0.73792794  0.75909448  0.71239606  0.63892773
  0.6373865   0.53978973  0.47836416  0.47544309  0.4156747   0.46233128
  0.43384357  0.32001956  0.2980857   0.16211947]


C:\Users\utsuk\AppData\Local\Temp\ipykernel_25000\2984870596.py:33: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.
  plt.tight_layout(2)
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_24_2.png" alt="png"></p><pre><code>C:\Users\utsuk\AppData\Local\Temp\ipykernel_25000\2984870596.py:60: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.
  plt.tight_layout(2)
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_24_4.png" alt="png"></p><h3 id="åˆ†ç±»é—®é¢˜">åˆ†ç±»é—®é¢˜</h3><h4 id="é€»è¾‘å›å½’">é€»è¾‘å›å½’</h4><h5 id="äºŒåˆ†ç±»">äºŒåˆ†ç±»</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sklearn.linear_model <span class="keyword">as</span> lm</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> mp</span><br><span class="line"></span><br><span class="line">x = np.array([[<span class="number">3</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">5</span>], [<span class="number">1</span>, <span class="number">8</span>], [<span class="number">6</span>, <span class="number">4</span>],\</span><br><span class="line">              [<span class="number">5</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">5</span>], [<span class="number">4</span>, <span class="number">7</span>], [<span class="number">4</span>, -<span class="number">1</span>]])</span><br><span class="line">y = np.array([<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé€»è¾‘åˆ†ç±»å™¨å¯¹è±¡</span></span><br><span class="line"><span class="comment"># Cå‚æ•°ï¼šæ­£åˆ™å¼ºåº¦ï¼Œè¶Šå¤§æ‹Ÿåˆæ•ˆæœè¶Šå°ï¼Œé€šè¿‡è°ƒæ•´è¯¥å‚æ•°é˜²æ­¢è¿‡æ‹Ÿåˆ</span></span><br><span class="line"><span class="comment"># solverå‚æ•°ï¼šé€»è¾‘å‡½æ•°ä¸­æŒ‡æ•°çš„å‡½æ•°å…³ç³»ï¼ˆliblinearè¡¨ç¤ºçº¿æ€§å…³ç³»ï¼‰</span></span><br><span class="line">model = lm.LogisticRegression()</span><br><span class="line">model.fit(x, y)  <span class="comment"># è®­ç»ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢„æµ‹</span></span><br><span class="line">test_x = np.array([[<span class="number">3</span>, <span class="number">9</span>], [<span class="number">6</span>, <span class="number">1</span>]])</span><br><span class="line">test_y = model.predict(test_x)  <span class="comment"># é¢„æµ‹</span></span><br><span class="line"><span class="built_in">print</span>(test_y)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æ˜¾ç¤ºåæ ‡çš„è¾¹ç•Œ</span></span><br><span class="line"><span class="comment"># x[:, 0].min()   x ä¸­æ‰€æœ‰æ•°ç»„çš„ç¬¬ä¸€ä½</span></span><br><span class="line">left = x[:, <span class="number">0</span>].<span class="built_in">min</span>() - <span class="number">1</span></span><br><span class="line">right = x[:, <span class="number">0</span>].<span class="built_in">max</span>() + <span class="number">1</span></span><br><span class="line">buttom = x[:, <span class="number">1</span>].<span class="built_in">min</span>() - <span class="number">1</span></span><br><span class="line">top = x[:, <span class="number">1</span>].<span class="built_in">max</span>() + <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># äº§ç”Ÿç½‘æ ¼åŒ–çŸ©é˜µ</span></span><br><span class="line">grid_x, grid_y = np.meshgrid(np.arange(left, right, <span class="number">0.01</span>),</span><br><span class="line">                             np.arange(buttom, top, <span class="number">0.01</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;grid_x.shape:&quot;</span>, grid_x.shape)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;grid_y.shape:&quot;</span>, grid_y.shape)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å°†x,yåæ ‡åˆå¹¶æˆä¸¤åˆ—</span></span><br><span class="line">mesh_x = np.column_stack((grid_x.ravel(), grid_y.ravel()))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;mesh_x.shape:&quot;</span>, mesh_x.shape)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®æ¯ä¸ªç‚¹çš„xyåæ ‡è¿›è¡Œé¢„æµ‹ï¼Œå¹¶è¿˜åŸæˆäºŒç»´å½¢çŠ¶</span></span><br><span class="line">mesh_z = model.predict(mesh_x)</span><br><span class="line">mesh_z = mesh_z.reshape(grid_x.shape)</span><br><span class="line"></span><br><span class="line">mp.figure(<span class="string">&#x27;Logistic Regression&#x27;</span>, facecolor=<span class="string">&#x27;lightgray&#x27;</span>)</span><br><span class="line">mp.title(<span class="string">&#x27;Logistic Regression&#x27;</span>, fontsize=<span class="number">20</span>)</span><br><span class="line">mp.xlabel(<span class="string">&#x27;x&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">mp.ylabel(<span class="string">&#x27;y&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">mp.tick_params(labelsize=<span class="number">10</span>)</span><br><span class="line">mp.pcolormesh(grid_x, grid_y, mesh_z, cmap=<span class="string">&#x27;gray&#x27;</span>, shading=<span class="string">&#x27;auto&#x27;</span>)</span><br><span class="line">mp.scatter(</span><br><span class="line">    x[:, <span class="number">0</span>],  <span class="comment"># æ ·æœ¬xåæ ‡</span></span><br><span class="line">    x[:, <span class="number">1</span>],  <span class="comment"># æ ·æœ¬yåæ ‡</span></span><br><span class="line">    c=y,</span><br><span class="line">    cmap=<span class="string">&#x27;brg&#x27;</span>,</span><br><span class="line">    s=<span class="number">80</span>)</span><br><span class="line">mp.scatter(test_x[:, <span class="number">0</span>], test_x[:, <span class="number">1</span>], c=<span class="string">&quot;red&quot;</span>, marker=<span class="string">&#x27;s&#x27;</span>, s=<span class="number">80</span>)</span><br><span class="line">mp.show()</span><br></pre></td></tr></table></figure><pre><code>[1 0]
grid_x.shape: (1100, 700)
grid_y.shape: (1100, 700)
mesh_x.shape: (770000, 2)
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_27_1.png" alt="png"></p><h5 id="å¤šåˆ†ç±»">å¤šåˆ†ç±»</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sklearn.linear_model <span class="keyword">as</span> lm</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> mp</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å…¥</span></span><br><span class="line">x = np.array([[<span class="number">4</span>, <span class="number">7</span>], [<span class="number">3.5</span>, <span class="number">8</span>], [<span class="number">3.1</span>, <span class="number">6.2</span>], [<span class="number">0.5</span>, <span class="number">1</span>], [<span class="number">1</span>, <span class="number">2</span>], [<span class="number">1.2</span>, <span class="number">1.9</span>],</span><br><span class="line">              [<span class="number">6</span>, <span class="number">2</span>], [<span class="number">5.7</span>, <span class="number">1.5</span>], [<span class="number">5.4</span>, <span class="number">2.2</span>]])</span><br><span class="line"><span class="comment"># è¾“å‡ºï¼ˆå¤šä¸ªç±»åˆ«ï¼‰</span></span><br><span class="line">y = np.array([<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºé€»è¾‘åˆ†ç±»å™¨å¯¹è±¡</span></span><br><span class="line">model = lm.LogisticRegression(C=<span class="number">200</span>)  <span class="comment"># è°ƒæ•´è¯¥å€¼ä¸º1çœ‹æ•ˆæœ</span></span><br><span class="line">model.fit(x, y)  <span class="comment"># è®­ç»ƒ</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åæ ‡è½´èŒƒå›´</span></span><br><span class="line">left = x[:, <span class="number">0</span>].<span class="built_in">min</span>() - <span class="number">1</span></span><br><span class="line">right = x[:, <span class="number">0</span>].<span class="built_in">max</span>() + <span class="number">1</span></span><br><span class="line">h = <span class="number">0.005</span></span><br><span class="line"></span><br><span class="line">buttom = x[:, <span class="number">1</span>].<span class="built_in">min</span>() - <span class="number">1</span></span><br><span class="line">top = x[:, <span class="number">1</span>].<span class="built_in">max</span>() + <span class="number">1</span></span><br><span class="line">v = <span class="number">0.005</span></span><br><span class="line"></span><br><span class="line">grid_x, grid_y = np.meshgrid(np.arange(left, right, h),</span><br><span class="line">                             np.arange(buttom, top, v))</span><br><span class="line"></span><br><span class="line">mesh_x = np.column_stack((grid_x.ravel(), grid_y.ravel()))</span><br><span class="line">mesh_z = model.predict(mesh_x)</span><br><span class="line">mesh_z = mesh_z.reshape(grid_x.shape)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–</span></span><br><span class="line">mp.figure(<span class="string">&#x27;Logistic Classification&#x27;</span>, facecolor=<span class="string">&#x27;lightgray&#x27;</span>)</span><br><span class="line">mp.title(<span class="string">&#x27;Logistic Classification&#x27;</span>, fontsize=<span class="number">20</span>)</span><br><span class="line">mp.xlabel(<span class="string">&#x27;x&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">mp.ylabel(<span class="string">&#x27;y&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">mp.tick_params(labelsize=<span class="number">10</span>)</span><br><span class="line">mp.pcolormesh(grid_x, grid_y, mesh_z, cmap=<span class="string">&#x27;gray&#x27;</span>, shading=<span class="string">&#x27;auto&#x27;</span>)</span><br><span class="line">mp.scatter(x[:, <span class="number">0</span>], x[:, <span class="number">1</span>], c=y, cmap=<span class="string">&#x27;brg&#x27;</span>, s=<span class="number">80</span>)</span><br><span class="line">mp.show()</span><br></pre></td></tr></table></figure><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_29_0.png" alt="png"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> r2_score, mean_squared_error, mean_absolute_error</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> PolynomialFeatures, LabelEncoder</span><br><span class="line"><span class="keyword">from</span> sklearn.pipeline <span class="keyword">import</span> make_pipeline</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line">pumpkins = pd.read_csv(<span class="string">&#x27;./_data_set/US-pumpkins.csv&#x27;</span>)</span><br><span class="line"><span class="comment"># pumpkins = pumpkins[pumpkins[&#x27;Package&#x27;].str.contains(&#x27;bushel&#x27;,</span></span><br><span class="line"><span class="comment">#                                                      case=True,</span></span><br><span class="line"><span class="comment">#                                                      regex=True)]</span></span><br><span class="line"></span><br><span class="line">new_pumpkins = pumpkins.drop([</span><br><span class="line">    c <span class="keyword">for</span> c <span class="keyword">in</span> pumpkins.columns <span class="keyword">if</span> c <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line">    [<span class="string">&#x27;Color&#x27;</span>, <span class="string">&#x27;Origin&#x27;</span>, <span class="string">&#x27;Item Size&#x27;</span>, <span class="string">&#x27;Variety&#x27;</span>, <span class="string">&#x27;City Name&#x27;</span>, <span class="string">&#x27;Package&#x27;</span>]</span><br><span class="line">],</span><br><span class="line">                             axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">new_pumpkins.dropna(inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">new_pumpkins = new_pumpkins.apply(LabelEncoder().fit_transform)</span><br><span class="line"></span><br><span class="line"><span class="comment"># é¢œè‰²æ•°æ®ä¸å…¶ä»–åˆ—çš„å…³ç³»</span></span><br><span class="line">sns.PairGrid(new_pumpkins).<span class="built_in">map</span>(sns.scatterplot)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†ç±»æ•£ç‚¹å›¾</span></span><br><span class="line"><span class="comment"># sns.swarmplot(x=&quot;Color&quot;, y=&quot;Item Size&quot;, data=new_pumpkins)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å°æç´å›¾</span></span><br><span class="line">sns.catplot(x=<span class="string">&quot;Color&quot;</span>, y=<span class="string">&quot;Item Size&quot;</span>, kind=<span class="string">&quot;violin&quot;</span>, data=new_pumpkins)</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x19b7ed39fd0&gt;
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_30_1.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_30_2.png" alt="png"></p><h4 id="æ”¯æŒå‘é‡æœº-SVM">æ”¯æŒå‘é‡æœº-SVM</h4><h5 id="æ ¸å‡½æ•°">æ ¸å‡½æ•°</h5><ol><li><p>çº¿æ€§</p></li><li><p>å¾„å‘åŸº-é«˜æ–¯</p></li></ol><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> GridSearchCV</span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">iris_feature = <span class="string">&#x27;èŠ±è¼é•¿åº¦&#x27;</span>, <span class="string">&#x27;èŠ±è¼å®½åº¦&#x27;</span>, <span class="string">&#x27;èŠ±ç“£é•¿åº¦&#x27;</span>, <span class="string">&#x27;èŠ±ç“£å®½åº¦&#x27;</span></span><br><span class="line">path = <span class="string">&#x27;./_data_set/iris_classification/iris.data&#x27;</span>  <span class="comment"># æ•°æ®æ–‡ä»¶è·¯å¾„</span></span><br><span class="line">data = pd.read_csv(path, header=<span class="literal">None</span>)</span><br><span class="line">x, y = data[[<span class="number">0</span>, <span class="number">1</span>]], pd.Categorical(data[<span class="number">4</span>]).codes</span><br><span class="line">x_train, x_test, y_train, y_test = train_test_split(x,</span><br><span class="line">                                                    y,</span><br><span class="line">                                                    random_state=<span class="number">1</span>,</span><br><span class="line">                                                    test_size=<span class="number">0.4</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†ç±»å™¨</span></span><br><span class="line"><span class="comment"># svm_clf = svm.SVC(C=10, gamma=1, kernel=&#x27;rbf&#x27;, decision_function_shape=&#x27;ovo&#x27;)</span></span><br><span class="line"><span class="comment"># svm_clf = svm.SVC(C=3, kernel=&#x27;poly&#x27;, degree=3)</span></span><br><span class="line">svm_clf = svm.SVC(C=<span class="number">3</span>, kernel=<span class="string">&#x27;linear&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;GridSearchCV begin...&#x27;</span>)</span><br><span class="line">t = time()</span><br><span class="line">clf = svm_clf</span><br><span class="line"><span class="comment"># clf = GridSearchCV(svm_clf, param_grid=&#123;&#x27;gamma&#x27;:np.logspace(-2, 2, 10), &#x27;C&#x27;:np.logspace(-2, 2, 10)&#125;, cv=3)</span></span><br><span class="line">clf.fit(x_train, y_train.ravel())</span><br><span class="line">t_end = time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;è€—æ—¶ï¼š%dç§’&#x27;</span> % (t_end - t))</span><br><span class="line"><span class="comment"># print(&#x27;æœ€ä¼˜å‚æ•°ï¼š&#x27;, clf.best_params_)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å‡†ç¡®ç‡</span></span><br><span class="line"><span class="built_in">print</span>(clf.score(x_train, y_train))  <span class="comment"># ç²¾åº¦</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;è®­ç»ƒé›†å‡†ç¡®ç‡ï¼š&#x27;</span>, accuracy_score(y_train, clf.predict(x_train)))</span><br><span class="line"><span class="built_in">print</span>(clf.score(x_test, y_test))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;æµ‹è¯•é›†å‡†ç¡®ç‡ï¼š&#x27;</span>, accuracy_score(y_test, clf.predict(x_test)))</span><br><span class="line"></span><br><span class="line"><span class="comment"># decision_function</span></span><br><span class="line"><span class="built_in">print</span>(x_train[:<span class="number">5</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;decision_function:\n&#x27;</span>, clf.decision_function(x_train))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\npredict:\n&#x27;</span>, clf.predict(x_train))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç”»å›¾</span></span><br><span class="line">x1_min, x2_min = x.<span class="built_in">min</span>()</span><br><span class="line">x1_max, x2_max = x.<span class="built_in">max</span>()</span><br><span class="line">x1, x2 = np.mgrid[x1_min:x1_max:<span class="number">300j</span>, x2_min:x2_max:<span class="number">300j</span>]  <span class="comment"># ç”Ÿæˆç½‘æ ¼é‡‡æ ·ç‚¹</span></span><br><span class="line">grid_test = np.stack((x1.flat, x2.flat), axis=<span class="number">1</span>)  <span class="comment"># æµ‹è¯•ç‚¹</span></span><br><span class="line">grid_hat = clf.predict(grid_test)  <span class="comment"># é¢„æµ‹åˆ†ç±»å€¼</span></span><br><span class="line">grid_hat = grid_hat.reshape(x1.shape)  <span class="comment"># ä½¿ä¹‹ä¸è¾“å…¥çš„å½¢çŠ¶ç›¸åŒ</span></span><br><span class="line">mpl.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">mpl.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">cm_light = mpl.colors.ListedColormap([<span class="string">&#x27;#A0FFA0&#x27;</span>, <span class="string">&#x27;#FFA0A0&#x27;</span>, <span class="string">&#x27;#A0A0FF&#x27;</span>])</span><br><span class="line">cm_dark = mpl.colors.ListedColormap([<span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;b&#x27;</span>])</span><br><span class="line">plt.figure(facecolor=<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">plt.pcolormesh(x1, x2, grid_hat, cmap=cm_light, shading=<span class="string">&#x27;auto&#x27;</span>)</span><br><span class="line">plt.scatter(x[<span class="number">0</span>], x[<span class="number">1</span>], c=y, edgecolors=<span class="string">&#x27;k&#x27;</span>, s=<span class="number">50</span>, cmap=cm_dark)  <span class="comment"># æ ·æœ¬</span></span><br><span class="line">plt.scatter(x_test[<span class="number">0</span>], x_test[<span class="number">1</span>], s=<span class="number">120</span>, facecolors=<span class="string">&#x27;none&#x27;</span>,</span><br><span class="line">            zorder=<span class="number">10</span>)  <span class="comment"># åœˆä¸­æµ‹è¯•é›†æ ·æœ¬</span></span><br><span class="line">plt.xlabel(iris_feature[<span class="number">0</span>], fontsize=<span class="number">13</span>)</span><br><span class="line">plt.ylabel(iris_feature[<span class="number">1</span>], fontsize=<span class="number">13</span>)</span><br><span class="line">plt.xlim(x1_min, x1_max)</span><br><span class="line">plt.ylim(x2_min, x2_max)</span><br><span class="line">plt.title(<span class="string">&#x27;é¸¢å°¾èŠ±SVMäºŒç‰¹å¾åˆ†ç±»&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.grid(b=<span class="literal">True</span>, ls=<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">plt.tight_layout(pad=<span class="number">1.5</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><pre><code>GridSearchCV begin...
è€—æ—¶ï¼š0ç§’
0.7888888888888889
è®­ç»ƒé›†å‡†ç¡®ç‡ï¼š 0.7888888888888889
0.7833333333333333
æµ‹è¯•é›†å‡†ç¡®ç‡ï¼š 0.7833333333333333
       0    1
11   4.8  3.4
113  5.7  2.5
123  6.3  2.7
12   4.8  3.0
2    4.7  3.2
decision_function:
 [[ 2.27077043  0.77466667 -0.23050192]
 [-0.26084184  2.25751125  1.0560141 ]
 [-0.28293421  2.25843306  1.22796515]
 [ 2.24308998  0.92588576 -0.2355186 ]
 [ 2.26643883  0.80879936 -0.24170145]
 [-0.28069428  1.23581332  2.24817619]
 [ 2.28018898  0.76457517 -0.24714914]
 [-0.25832462  1.21350955  2.20811726]
 [-0.27289547  1.20094518  2.249947  ]
 [-0.28479994  1.2318958   2.26058535]
 [-0.23449614  2.22389578  1.08207816]
 [-0.27824598  1.19362022  2.2618816 ]
 [-0.24940836  1.20624284  2.19142888]
 [ 2.2732283  -0.2577432   0.82271427]
 [-0.2872948   2.27977562  1.1680301 ]
 [-0.28016055  1.24346593  2.23969255]
 [-0.28069428  1.23581332  2.24817619]
 [-0.17539161  2.25364746  0.77515212]
 [-0.25325305  1.14281388  2.23566431]
 [-0.2421088   2.25159667  0.90072452]
 [ 2.24374936 -0.23761503  0.93581753]
 [ 2.24150985  0.87804111 -0.2241573 ]
 [ 2.28041834 -0.27382086  0.86293615]
 [-0.27824598  1.19362022  2.2618816 ]
 [ 2.27361996  0.84008337 -0.26180365]
 [-0.26919985  2.24943754  1.18347413]
 [-0.28629221  2.26101768  1.23745359]
 [-0.23808639  1.19803786  2.16960812]
 [ 2.24670891 -0.21840299  0.83780678]
 [ 2.23817757  0.82105098 -0.19112107]
 [-0.2549617   2.24213564  1.1247623 ]
 [ 2.24150985  0.87804111 -0.2241573 ]
 [-0.30409023  1.27536123  2.28319903]
 [-0.27073104  1.23503534  2.2197061 ]
 [-0.30441277  1.26883084  2.28803158]
 [-0.28752494  1.24411663  2.25991942]
 [-0.29292012  2.28000741  1.22212062]
 [-0.23176304  1.04104242  2.22722296]
 [-0.28694643  1.15125962  2.28088265]
 [-0.19956441  2.19653578  1.01742803]
 [ 2.26878977 -0.27918692  1.16597018]
 [-0.2549617   2.24213564  1.1247623 ]
 [ 2.18519501  1.23494087 -0.26146238]
 [-0.2512831   2.2597216   0.89408741]
 [-0.29066599  1.240849    2.26933123]
 [ 2.25729439 -0.2129225   0.79411601]
 [-0.29441953  1.26382422  2.26345809]
 [ 2.26377705 -0.22976306  0.79617407]
 [ 2.27077043  0.77466667 -0.23050192]
 [-0.2445374   1.07681969  2.23683943]
 [-0.21840757  2.21786592  1.00447438]
 [-0.28524498  1.22203776  2.26581127]
 [ 2.24947915  0.81045802 -0.20787766]
 [ 2.2684482  -0.24915018  0.81973595]
 [-0.20907334  1.12013512  2.17603067]
 [ 2.26728139  0.82893904 -0.24984081]
 [-0.2549617   2.24213564  1.1247623 ]
 [ 2.25207771  0.85867453 -0.23431088]
 [-0.28069428  1.23581332  2.24817619]
 [ 1.05055292  2.22662497 -0.23240122]
 [ 2.2722284   0.7997718  -0.24896247]
 [-0.26723747  1.19201787  2.24286157]
 [ 2.27827649  0.82682975 -0.26630655]
 [-0.17333043  2.16553945  1.02939988]
 [ 2.26890439  0.89311197 -0.26243597]
 [-0.2512831   2.2597216   0.89408741]
 [-0.23341849  2.27309387  0.7709214 ]
 [ 2.25617562 -0.22437834  0.81410784]
 [ 2.22986475  0.96247553 -0.22562355]
 [ 0.93771503  2.24006469 -0.23365567]
 [ 2.28631446 -0.25590025  0.75474384]
 [-0.23808639  1.19803786  2.16960812]
 [-0.2646401   1.23019768  2.20613126]
 [ 2.25729439 -0.2129225   0.79411601]
 [-0.28479994  1.2318958   2.26058535]
 [-0.22087216  2.20491832  1.08971052]
 [-0.29260626  2.28238001  1.20719635]
 [-0.29101034  1.23272406  2.27341138]
 [-0.2549617   2.24213564  1.1247623 ]
 [ 2.19974418 -0.17699012  0.91119813]
 [ 2.21209755  1.01040036 -0.21350121]
 [-0.27849238  2.26059076  1.19977637]
 [-0.26997469  2.24280567  1.20408124]
 [-0.29874557  1.25977449  2.27874043]
 [-0.25377271  2.24886239  1.06528288]
 [-0.27961589  2.2500049   1.22933155]
 [-0.27219081  1.21466357  2.24182934]
 [-0.2884762   2.2710352   1.22512174]
 [-0.28479994  1.2318958   2.26058535]
 [ 2.24150985  0.87804111 -0.2241573 ]]

predict:
 [0 1 1 0 0 2 0 2 2 2 1 2 2 0 1 2 2 1 2 1 0 0 0 2 0 1 1 2 0 0 1 0 2 2 2 2 1
 2 2 1 0 1 0 1 2 0 2 0 0 2 1 2 0 0 2 0 1 0 2 1 0 2 0 1 0 1 1 0 0 1 0 2 2 0
 2 1 1 2 1 0 0 1 1 2 1 1 2 1 2 0]
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_32_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> svm</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> stats</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">extend</span>(<span class="params">a, b, r=<span class="number">0.01</span></span>):</span><br><span class="line">    <span class="keyword">return</span> a * (<span class="number">1</span> + r) - b * r, -a * r + b * (<span class="number">1</span> + r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">np.random.seed(<span class="number">0</span>)</span><br><span class="line">N = <span class="number">200</span></span><br><span class="line">x = np.empty((<span class="number">4</span> * N, <span class="number">2</span>))</span><br><span class="line">means = [(-<span class="number">1</span>, <span class="number">1</span>), (<span class="number">1</span>, <span class="number">1</span>), (<span class="number">1</span>, -<span class="number">1</span>), (-<span class="number">1</span>, -<span class="number">1</span>)]</span><br><span class="line">sigmas = [</span><br><span class="line">    np.eye(<span class="number">2</span>), <span class="number">2</span> * np.eye(<span class="number">2</span>),</span><br><span class="line">    np.diag((<span class="number">1</span>, <span class="number">2</span>)),</span><br><span class="line">    np.array(((<span class="number">3</span>, <span class="number">2</span>), (<span class="number">2</span>, <span class="number">3</span>)))</span><br><span class="line">]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    mn = stats.multivariate_normal(means[i], sigmas[i] * <span class="number">0.07</span>)</span><br><span class="line">    x[i * N:(i + <span class="number">1</span>) * N, :] = mn.rvs(N)</span><br><span class="line">a = np.array((<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)).reshape((-<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">y = np.tile(a, N).flatten()</span><br><span class="line">clf = svm.SVC(C=<span class="number">1</span>, kernel=<span class="string">&#x27;rbf&#x27;</span>, gamma=<span class="number">1</span>, decision_function_shape=<span class="string">&#x27;ovo&#x27;</span>)</span><br><span class="line"><span class="comment"># clf = svm.SVC(C=1, kernel=&#x27;linear&#x27;, decision_function_shape=&#x27;ovr&#x27;)</span></span><br><span class="line">clf.fit(x, y)</span><br><span class="line">y_hat = clf.predict(x)</span><br><span class="line">acc = accuracy_score(y, y_hat)</span><br><span class="line">np.set_printoptions(suppress=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬ä¸ªæ•°ï¼š%dï¼Œæ­£ç¡®ç‡ï¼š%.2f%%&#x27;</span> % (<span class="built_in">round</span>(acc * <span class="number">4</span> * N), <span class="number">100</span> * acc))</span><br><span class="line"><span class="comment"># decision_function</span></span><br><span class="line"><span class="built_in">print</span>(clf.decision_function(x))</span><br><span class="line"><span class="built_in">print</span>(y_hat)</span><br><span class="line"></span><br><span class="line">x1_min, x2_min = np.<span class="built_in">min</span>(x, axis=<span class="number">0</span>)</span><br><span class="line">x1_max, x2_max = np.<span class="built_in">max</span>(x, axis=<span class="number">0</span>)</span><br><span class="line">x1_min, x1_max = extend(x1_min, x1_max)</span><br><span class="line">x2_min, x2_max = extend(x2_min, x2_max)</span><br><span class="line">x1, x2 = np.mgrid[x1_min:x1_max:<span class="number">500j</span>, x2_min:x2_max:<span class="number">500j</span>]</span><br><span class="line">x_test = np.stack((x1.flat, x2.flat), axis=<span class="number">1</span>)</span><br><span class="line">y_test = clf.predict(x_test)</span><br><span class="line">y_test = y_test.reshape(x1.shape)</span><br><span class="line">cm_light = mpl.colors.ListedColormap(</span><br><span class="line">    [<span class="string">&#x27;#FF8080&#x27;</span>, <span class="string">&#x27;#80FF80&#x27;</span>, <span class="string">&#x27;#8080FF&#x27;</span>, <span class="string">&#x27;#F0F080&#x27;</span>])</span><br><span class="line">cm_dark = mpl.colors.ListedColormap([<span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;y&#x27;</span>])</span><br><span class="line">mpl.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">mpl.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line">plt.figure(facecolor=<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">plt.pcolormesh(x1, x2, y_test, cmap=cm_light, shading=<span class="string">&#x27;auto&#x27;</span>)</span><br><span class="line">plt.contour(x1, x2, y_test, levels=(<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>), colors=<span class="string">&#x27;k&#x27;</span>, linestyles=<span class="string">&#x27;--&#x27;</span>)</span><br><span class="line">plt.scatter(x[:, <span class="number">0</span>],</span><br><span class="line">            x[:, <span class="number">1</span>],</span><br><span class="line">            s=<span class="number">20</span>,</span><br><span class="line">            c=y,</span><br><span class="line">            cmap=cm_dark,</span><br><span class="line">            edgecolors=<span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">            alpha=<span class="number">0.7</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;$X_1$&#x27;</span>, fontsize=<span class="number">11</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;$X_2$&#x27;</span>, fontsize=<span class="number">11</span>)</span><br><span class="line">plt.xlim((x1_min, x1_max))</span><br><span class="line">plt.ylim((x2_min, x2_max))</span><br><span class="line">plt.grid(b=<span class="literal">True</span>)</span><br><span class="line">plt.tight_layout(pad=<span class="number">2.5</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;SVMå¤šåˆ†ç±»æ–¹æ³•ï¼šOne/One or One/Other&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬ä¸ªæ•°ï¼š793ï¼Œæ­£ç¡®ç‡ï¼š99.12%
[[ 1.30403817  1.18371967  1.61069453  0.53379555  0.10282667 -0.6639782 ]
 [ 1.20484592  1.00041165  1.13023042  0.32840742  0.16888308 -0.33559223]
 [ 1.28448754  1.15305262  1.24310512  0.59725054 -0.31474389 -0.97622623]
 ...
 [-0.23584035 -0.08224918 -1.09483656  0.1554822  -1.12200744 -1.12840424]
 [ 0.2447751   0.34444513 -1.55255237  0.17064062 -1.24348982 -1.41973039]
 [-0.03070327 -0.15566364 -1.9254549  -0.09600454 -1.23897289 -1.44257329]]
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_33_1.png" alt="png"></p><h4 id="æœ´ç´ è´å¶æ–¯">æœ´ç´ è´å¶æ–¯</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NBClassify</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, fillNa=<span class="number">1</span></span>):</span><br><span class="line">        <span class="variable language_">self</span>.fillNa = <span class="number">1</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">train</span>(<span class="params">self, trainSet</span>):</span><br><span class="line">        <span class="comment"># è®¡ç®—æ¯ç§ç±»åˆ«çš„æ¦‚ç‡</span></span><br><span class="line">        <span class="comment"># ä¿å­˜æ‰€æœ‰tagçš„æ‰€æœ‰ç§ç±»ï¼ŒåŠå®ƒä»¬å‡ºç°çš„é¢‘æ¬¡</span></span><br><span class="line">        dictTag = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> subTuple <span class="keyword">in</span> trainSet:</span><br><span class="line">            dictTag[<span class="built_in">str</span>(</span><br><span class="line">                subTuple[<span class="number">1</span>])] = <span class="number">1</span> <span class="keyword">if</span> <span class="built_in">str</span>(subTuple[<span class="number">1</span>]) <span class="keyword">not</span> <span class="keyword">in</span> dictTag.keys(</span><br><span class="line">                ) <span class="keyword">else</span> dictTag[<span class="built_in">str</span>(subTuple[<span class="number">1</span>])] + <span class="number">1</span></span><br><span class="line">        <span class="comment"># ä¿å­˜æ¯ä¸ªtagæœ¬èº«çš„æ¦‚ç‡</span></span><br><span class="line">        tagProbablity = &#123;&#125;</span><br><span class="line">        totalFreq = <span class="built_in">sum</span>([value <span class="keyword">for</span> value <span class="keyword">in</span> dictTag.values()])</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> dictTag.items():</span><br><span class="line">            tagProbablity[key] = value / totalFreq</span><br><span class="line">        <span class="comment"># print(tagProbablity)</span></span><br><span class="line">        <span class="variable language_">self</span>.tagProbablity = tagProbablity</span><br><span class="line">        <span class="comment">##############################################################################</span></span><br><span class="line">        <span class="comment"># è®¡ç®—ç‰¹å¾çš„æ¡ä»¶æ¦‚ç‡</span></span><br><span class="line">        <span class="comment"># ä¿å­˜ç‰¹å¾å±æ€§åŸºæœ¬ä¿¡æ¯&#123;ç‰¹å¾1:&#123;å€¼1:å‡ºç°5æ¬¡, å€¼2:å‡ºç°1æ¬¡&#125;, ç‰¹å¾2:&#123;å€¼1:å‡ºç°1æ¬¡, å€¼2:å‡ºç°5æ¬¡&#125;&#125;</span></span><br><span class="line">        dictFeaturesBase = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> subTuple <span class="keyword">in</span> trainSet:</span><br><span class="line">            <span class="keyword">for</span> key, value <span class="keyword">in</span> subTuple[<span class="number">0</span>].items():</span><br><span class="line">                <span class="keyword">if</span> key <span class="keyword">not</span> <span class="keyword">in</span> dictFeaturesBase.keys():</span><br><span class="line">                    dictFeaturesBase[key] = &#123;value: <span class="number">1</span>&#125;</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">if</span> value <span class="keyword">not</span> <span class="keyword">in</span> dictFeaturesBase[key].keys():</span><br><span class="line">                        dictFeaturesBase[key][value] = <span class="number">1</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        dictFeaturesBase[key][value] += <span class="number">1</span></span><br><span class="line">        <span class="comment"># dictFeaturesBase = &#123;</span></span><br><span class="line">        <span class="comment"># &#x27;èŒä¸š&#x27;: &#123;&#x27;å†œå¤«&#x27;: 1, &#x27;æ•™å¸ˆ&#x27;: 2, &#x27;å»ºç­‘å·¥äºº&#x27;: 2, &#x27;æŠ¤å£«&#x27;: 1&#125;,</span></span><br><span class="line">        <span class="comment"># &#x27;ç—‡çŠ¶&#x27;: &#123;&#x27;æ‰“å–·åš&#x27;: 3, &#x27;å¤´ç—›&#x27;: 3&#125;</span></span><br><span class="line">        <span class="comment"># &#125;</span></span><br><span class="line">        dictFeatures = &#123;&#125;.fromkeys([key <span class="keyword">for</span> key <span class="keyword">in</span> dictTag])</span><br><span class="line">        <span class="keyword">for</span> key <span class="keyword">in</span> dictFeatures.keys():</span><br><span class="line">            dictFeatures[key] = &#123;&#125;.fromkeys([key <span class="keyword">for</span> key <span class="keyword">in</span> dictFeaturesBase])</span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> dictFeatures.items():</span><br><span class="line">            <span class="keyword">for</span> subkey <span class="keyword">in</span> value.keys():</span><br><span class="line">                value[subkey] = &#123;&#125;.fromkeys(</span><br><span class="line">                    [x <span class="keyword">for</span> x <span class="keyword">in</span> dictFeaturesBase[subkey].keys()])</span><br><span class="line">        <span class="comment"># dictFeatures = &#123;</span></span><br><span class="line">        <span class="comment">#  &#x27;æ„Ÿå†’ &#x27;: &#123;&#x27;ç—‡çŠ¶&#x27;: &#123;&#x27;æ‰“å–·åš&#x27;: None, &#x27;å¤´ç—›&#x27;: None&#125;, &#x27;èŒä¸š&#x27;: &#123;&#x27;æŠ¤å£«&#x27;: None, &#x27;å†œå¤«&#x27;: None, &#x27;å»ºç­‘å·¥äºº&#x27;: None, &#x27;æ•™å¸ˆ&#x27;: None&#125;&#125;,</span></span><br><span class="line">        <span class="comment">#  &#x27;è„‘éœ‡è¡&#x27;: &#123;&#x27;ç—‡çŠ¶&#x27;: &#123;&#x27;æ‰“å–·åš&#x27;: None, &#x27;å¤´ç—›&#x27;: None&#125;, &#x27;èŒä¸š&#x27;: &#123;&#x27;æŠ¤å£«&#x27;: None, &#x27;å†œå¤«&#x27;: None, &#x27;å»ºç­‘å·¥äºº&#x27;: None, &#x27;æ•™å¸ˆ&#x27;: None&#125;&#125;,</span></span><br><span class="line">        <span class="comment">#  &#x27;è¿‡æ• &#x27;: &#123;&#x27;ç—‡çŠ¶&#x27;: &#123;&#x27;æ‰“å–·åš&#x27;: None, &#x27;å¤´ç—›&#x27;: None&#125;, &#x27;èŒä¸š&#x27;: &#123;&#x27;æŠ¤å£«&#x27;: None, &#x27;å†œå¤«&#x27;: None, &#x27;å»ºç­‘å·¥äºº&#x27;: None, &#x27;æ•™å¸ˆ&#x27;: None&#125;&#125;</span></span><br><span class="line">        <span class="comment">#  &#125;</span></span><br><span class="line">        <span class="comment"># initialise dictFeatures</span></span><br><span class="line">        <span class="keyword">for</span> subTuple <span class="keyword">in</span> trainSet:</span><br><span class="line">            <span class="keyword">for</span> key, value <span class="keyword">in</span> subTuple[<span class="number">0</span>].items():</span><br><span class="line">                dictFeatures[subTuple[<span class="number">1</span>]][key][value] = <span class="number">1</span> <span class="keyword">if</span> dictFeatures[</span><br><span class="line">                    subTuple[<span class="number">1</span>]][key][value] == <span class="literal">None</span> <span class="keyword">else</span> dictFeatures[</span><br><span class="line">                        subTuple[<span class="number">1</span>]][key][value] + <span class="number">1</span></span><br><span class="line">        <span class="comment"># print(dictFeatures)</span></span><br><span class="line">        <span class="comment"># å°†é©¯è‰¯æ ·æœ¬ä¸­æ²¡æœ‰çš„é¡¹ç›®ï¼Œç”±Noneæ”¹ä¸ºä¸€ä¸ªéå¸¸å°çš„æ•°å€¼ï¼Œè¡¨ç¤ºå…¶æ¦‚ç‡æå°è€Œå¹¶éæ˜¯é›¶</span></span><br><span class="line">        <span class="keyword">for</span> tag, featuresDict <span class="keyword">in</span> dictFeatures.items():</span><br><span class="line">            <span class="keyword">for</span> featureName, fetureValueDict <span class="keyword">in</span> featuresDict.items():</span><br><span class="line">                <span class="keyword">for</span> featureKey, featureValues <span class="keyword">in</span> fetureValueDict.items():</span><br><span class="line">                    <span class="keyword">if</span> featureValues == <span class="literal">None</span>:</span><br><span class="line">                        fetureValueDict[featureKey] = <span class="number">1</span></span><br><span class="line">        <span class="comment"># ç”±ç‰¹å¾é¢‘ç‡è®¡ç®—ç‰¹å¾çš„æ¡ä»¶æ¦‚ç‡P(feature|tag)</span></span><br><span class="line">        <span class="keyword">for</span> tag, featuresDict <span class="keyword">in</span> dictFeatures.items():</span><br><span class="line">            <span class="keyword">for</span> featureName, fetureValueDict <span class="keyword">in</span> featuresDict.items():</span><br><span class="line">                totalCount = <span class="built_in">sum</span>(</span><br><span class="line">                    [x <span class="keyword">for</span> x <span class="keyword">in</span> fetureValueDict.values() <span class="keyword">if</span> x != <span class="literal">None</span>])</span><br><span class="line">                <span class="keyword">for</span> featureKey, featureValues <span class="keyword">in</span> fetureValueDict.items():</span><br><span class="line">                    fetureValueDict[</span><br><span class="line">                        featureKey] = featureValues / totalCount <span class="keyword">if</span> featureValues != <span class="literal">None</span> <span class="keyword">else</span> <span class="literal">None</span></span><br><span class="line">        <span class="variable language_">self</span>.featuresProbablity = dictFeatures</span><br><span class="line">        <span class="comment">##############################################################################</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">classify</span>(<span class="params">self, featureDict</span>):</span><br><span class="line">        resultDict = &#123;&#125;</span><br><span class="line">        <span class="comment"># è®¡ç®—æ¯ä¸ªtagçš„æ¡ä»¶æ¦‚ç‡</span></span><br><span class="line">        <span class="keyword">for</span> key, value <span class="keyword">in</span> <span class="variable language_">self</span>.tagProbablity.items():</span><br><span class="line">            iNumList = []</span><br><span class="line">            <span class="keyword">for</span> f, v <span class="keyword">in</span> featureDict.items():</span><br><span class="line">                <span class="keyword">if</span> <span class="variable language_">self</span>.featuresProbablity[key][f][v]:</span><br><span class="line">                    iNumList.append(<span class="variable language_">self</span>.featuresProbablity[key][f][v])</span><br><span class="line">            conditionPr = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> iNum <span class="keyword">in</span> iNumList:</span><br><span class="line">                conditionPr *= iNum</span><br><span class="line">            resultDict[key] = value * conditionPr</span><br><span class="line">        <span class="comment"># å¯¹æ¯”æ¯ä¸ªtagçš„æ¡ä»¶æ¦‚ç‡çš„å¤§å°</span></span><br><span class="line">        resultList = <span class="built_in">sorted</span>(resultDict.items(),</span><br><span class="line">                            key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>],</span><br><span class="line">                            reverse=<span class="literal">True</span>)</span><br><span class="line">        <span class="keyword">return</span> resultList[<span class="number">0</span>][<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    trainSet = [</span><br><span class="line">        (&#123;</span><br><span class="line">            <span class="string">&quot;ç—‡çŠ¶&quot;</span>: <span class="string">&quot;æ‰“å–·åš&quot;</span>,</span><br><span class="line">            <span class="string">&quot;èŒä¸š&quot;</span>: <span class="string">&quot;æŠ¤å£«&quot;</span></span><br><span class="line">        &#125;, <span class="string">&quot;æ„Ÿå†’ &quot;</span>),</span><br><span class="line">        (&#123;</span><br><span class="line">            <span class="string">&quot;ç—‡çŠ¶&quot;</span>: <span class="string">&quot;æ‰“å–·åš&quot;</span>,</span><br><span class="line">            <span class="string">&quot;èŒä¸š&quot;</span>: <span class="string">&quot;å†œå¤«&quot;</span></span><br><span class="line">        &#125;, <span class="string">&quot;è¿‡æ• &quot;</span>),</span><br><span class="line">        (&#123;</span><br><span class="line">            <span class="string">&quot;ç—‡çŠ¶&quot;</span>: <span class="string">&quot;å¤´ç—›&quot;</span>,</span><br><span class="line">            <span class="string">&quot;èŒä¸š&quot;</span>: <span class="string">&quot;å»ºç­‘å·¥äºº&quot;</span></span><br><span class="line">        &#125;, <span class="string">&quot;è„‘éœ‡è¡&quot;</span>),</span><br><span class="line">        (&#123;</span><br><span class="line">            <span class="string">&quot;ç—‡çŠ¶&quot;</span>: <span class="string">&quot;å¤´ç—›&quot;</span>,</span><br><span class="line">            <span class="string">&quot;èŒä¸š&quot;</span>: <span class="string">&quot;å»ºç­‘å·¥äºº&quot;</span></span><br><span class="line">        &#125;, <span class="string">&quot;æ„Ÿå†’ &quot;</span>),</span><br><span class="line">        (&#123;</span><br><span class="line">            <span class="string">&quot;ç—‡çŠ¶&quot;</span>: <span class="string">&quot;æ‰“å–·åš&quot;</span>,</span><br><span class="line">            <span class="string">&quot;èŒä¸š&quot;</span>: <span class="string">&quot;æ•™å¸ˆ&quot;</span></span><br><span class="line">        &#125;, <span class="string">&quot;æ„Ÿå†’ &quot;</span>),</span><br><span class="line">        (&#123;</span><br><span class="line">            <span class="string">&quot;ç—‡çŠ¶&quot;</span>: <span class="string">&quot;å¤´ç—›&quot;</span>,</span><br><span class="line">            <span class="string">&quot;èŒä¸š&quot;</span>: <span class="string">&quot;æ•™å¸ˆ&quot;</span></span><br><span class="line">        &#125;, <span class="string">&quot;è„‘éœ‡è¡&quot;</span>),</span><br><span class="line">    ]</span><br><span class="line">    monitor = NBClassify()</span><br><span class="line">    <span class="comment"># trainSet is something like that [(featureDict, tag), ]</span></span><br><span class="line">    monitor.train(trainSet)</span><br><span class="line">    <span class="comment"># æ‰“å–·åšçš„å»ºç­‘å·¥äºº</span></span><br><span class="line">    <span class="comment"># è¯·é—®ä»–æ‚£ä¸Šæ„Ÿå†’çš„æ¦‚ç‡æœ‰å¤šå¤§ï¼Ÿ</span></span><br><span class="line">    result = monitor.classify(&#123;<span class="string">&quot;ç—‡çŠ¶&quot;</span>: <span class="string">&quot;æ‰“å–·åš&quot;</span>, <span class="string">&quot;èŒä¸š&quot;</span>: <span class="string">&quot;å»ºç­‘å·¥äºº&quot;</span>&#125;)</span><br><span class="line">    <span class="built_in">print</span>(result)</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>æ„Ÿå†’
</code></pre><h4 id="å¤šå…ƒé—®é¢˜-èœè‚´åˆ†ç±»">å¤šå…ƒé—®é¢˜-èœè‚´åˆ†ç±»</h4><h5 id="æ•°æ®åŠ è½½ä¸æ¸…æ´—">æ•°æ®åŠ è½½ä¸æ¸…æ´—</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> imblearn.over_sampling <span class="keyword">import</span> SMOTE</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;./_data_set/cuisines_classification/cuisines.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line">df.head()</span><br><span class="line"></span><br><span class="line"><span class="comment"># df.info()</span></span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Unnamed: 0</th><th>cuisine</th><th>almond</th><th>angelica</th><th>anise</th><th>anise_seed</th><th>apple</th><th>apple_brandy</th><th>apricot</th><th>armagnac</th><th>...</th><th>whiskey</th><th>white_bread</th><th>white_wine</th><th>whole_grain_wheat_flour</th><th>wine</th><th>wood</th><th>yam</th><th>yeast</th><th>yogurt</th><th>zucchini</th></tr></thead><tbody><tr><th>0</th><td>65</td><td>indian</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>...</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>1</th><td>66</td><td>indian</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>...</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>2</th><td>67</td><td>indian</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>...</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>3</th><td>68</td><td>indian</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>...</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>4</th><td>69</td><td>indian</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>...</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td></tr></tbody></table><p>5 rows Ã— 385 columns</p></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># èœè‚´æˆåˆ†åˆ†æ</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">create_ingredient_df</span>(<span class="params">df</span>):</span><br><span class="line">    ingredient_df = df.T.drop([<span class="string">&#x27;cuisine&#x27;</span>,</span><br><span class="line">                               <span class="string">&#x27;Unnamed: 0&#x27;</span>]).<span class="built_in">sum</span>(axis=<span class="number">1</span>).to_frame(<span class="string">&#x27;value&#x27;</span>)</span><br><span class="line">    ingredient_df = ingredient_df[(ingredient_df.T != <span class="number">0</span>).<span class="built_in">any</span>()]</span><br><span class="line">    ingredient_df = ingredient_df.sort_values(by=<span class="string">&#x27;value&#x27;</span>,</span><br><span class="line">                                              ascending=<span class="literal">False</span>,</span><br><span class="line">                                              inplace=<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">return</span> ingredient_df</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ†æåŸæ–™ä½¿ç”¨ç‡å‰å</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> [<span class="string">&quot;thai&quot;</span>, <span class="string">&quot;japanese&quot;</span>, <span class="string">&quot;chinese&quot;</span>, <span class="string">&quot;indian&quot;</span>, <span class="string">&quot;korean&quot;</span>]:</span><br><span class="line">    ingredient_df = create_ingredient_df(df[(df.cuisine == i)])</span><br><span class="line">    ingredient_df.head(<span class="number">10</span>).plot.barh().set_title(i)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ æ‰å¹¶ä¸é‡è¦çš„ç‰¹å¾</span></span><br><span class="line">feature_df = df.drop([<span class="string">&#x27;cuisine&#x27;</span>, <span class="string">&#x27;Unnamed: 0&#x27;</span>, <span class="string">&#x27;rice&#x27;</span>, <span class="string">&#x27;garlic&#x27;</span>, <span class="string">&#x27;ginger&#x27;</span>],</span><br><span class="line">                     axis=<span class="number">1</span>)</span><br><span class="line">labels_df = df.cuisine</span><br></pre></td></tr></table></figure><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_38_0.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_38_1.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_38_2.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_38_3.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_38_4.png" alt="png"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># èœè‚´æ ·æœ¬ä¸å‡,å¹³è¡¡æ•°æ®é›†</span></span><br><span class="line">transformed_feature_df, transformed_label_df = SMOTE().fit_resample(</span><br><span class="line">    feature_df, labels_df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># çƒ‚æ–¹æ³•å±•ç¤º</span></span><br><span class="line"><span class="comment"># for i in [&quot;thai&quot;, &quot;japanese&quot;, &quot;chinese&quot;, &quot;indian&quot;, &quot;korean&quot;]:</span></span><br><span class="line"><span class="comment">#     print(i, df.loc[df[&#x27;cuisine&#x27;] == i].shape)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># nicer one</span></span><br><span class="line"><span class="built_in">print</span>(</span><br><span class="line">    <span class="string">f&#x27;===================== old label count: ===================== \n<span class="subst">&#123;labels_df.value_counts()&#125;</span>\</span></span><br><span class="line"><span class="string">    \n===================== new label count: ===================== \n<span class="subst">&#123;transformed_label_df.value_counts()&#125;</span>&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">transformed_df = pd.concat([transformed_label_df, transformed_feature_df],</span><br><span class="line">                           axis=<span class="number">1</span>,</span><br><span class="line">                           join=<span class="string">&#x27;outer&#x27;</span>)</span><br><span class="line"><span class="comment"># transformed_df.head()</span></span><br><span class="line">transformed_df.info()</span><br><span class="line">transformed_df.to_csv(<span class="string">&quot;./_data_set/cuisines_classification/cleaned_cuisines.csv&quot;</span>)</span><br></pre></td></tr></table></figure><pre><code>===================== old label count: =====================
korean      799
indian      598
chinese     442
japanese    320
thai        289
Name: cuisine, dtype: int64
===================== new label count: =====================
indian      799
thai        799
chinese     799
japanese    799
korean      799
Name: cuisine, dtype: int64
&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 3995 entries, 0 to 3994
Columns: 381 entries, cuisine to zucchini
dtypes: int64(380), object(1)
memory usage: 11.6+ MB
</code></pre><h5 id="åˆ†ç±»-1">åˆ†ç±»-1</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split, cross_val_score</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, confusion_matrix, classification_report, precision_recall_curve</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">cuisines_df = pd.read_csv(</span><br><span class="line">    <span class="string">&quot;./_data_set/cuisines_classification/cleaned_cuisines.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line">cuisines_df.head()</span><br></pre></td></tr></table></figure><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>Unnamed: 0</th><th>cuisine</th><th>almond</th><th>angelica</th><th>anise</th><th>anise_seed</th><th>apple</th><th>apple_brandy</th><th>apricot</th><th>armagnac</th><th>...</th><th>whiskey</th><th>white_bread</th><th>white_wine</th><th>whole_grain_wheat_flour</th><th>wine</th><th>wood</th><th>yam</th><th>yeast</th><th>yogurt</th><th>zucchini</th></tr></thead><tbody><tr><th>0</th><td>0</td><td>indian</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>...</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>1</th><td>1</td><td>indian</td><td>1</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>...</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>2</th><td>2</td><td>indian</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>...</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>3</th><td>3</td><td>indian</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>...</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td></tr><tr><th>4</th><td>4</td><td>indian</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>...</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>0</td><td>1</td><td>0</td></tr></tbody></table><p>5 rows Ã— 382 columns</p></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">cuisines_label_df = cuisines_df[<span class="string">&#x27;cuisine&#x27;</span>]</span><br><span class="line">cuisines_feature_df = cuisines_df.drop([<span class="string">&#x27;Unnamed: 0&#x27;</span>, <span class="string">&#x27;cuisine&#x27;</span>], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(cuisines_feature_df,</span><br><span class="line">                                                    cuisines_label_df,</span><br><span class="line">                                                    test_size=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">1137      korean</span></span><br><span class="line"><span class="string">428         thai</span></span><br><span class="line"><span class="string">191       indian</span></span><br><span class="line"><span class="string">1336      korean</span></span><br><span class="line"><span class="string">3947        thai</span></span><br><span class="line"><span class="string">          ...</span></span><br><span class="line"><span class="string">3335    japanese</span></span><br><span class="line"><span class="string">3539        thai</span></span><br><span class="line"><span class="string">436         thai</span></span><br><span class="line"><span class="string">1875      indian</span></span><br><span class="line"><span class="string">3079    japanese</span></span><br><span class="line"><span class="string">Name: cuisine, Length: 2796, dtype: object</span></span><br><span class="line"><span class="string">[&#x27;korean&#x27; &#x27;thai&#x27; &#x27;indian&#x27; ... &#x27;thai&#x27; &#x27;indian&#x27; &#x27;japanese&#x27;]</span></span><br><span class="line"><span class="string"> &quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># print(y_train)</span></span><br><span class="line"><span class="comment"># print(np.ravel(y_train))</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># lbfgs = LogisticRegression(solver=&#x27;lbfgs&#x27;)</span></span><br><span class="line">model = LogisticRegression(multi_class=<span class="string">&#x27;ovr&#x27;</span>,</span><br><span class="line">                           solver=<span class="string">&#x27;liblinear&#x27;</span>).fit(X_train, np.ravel(y_train))</span><br><span class="line"></span><br><span class="line">accuracy = model.score(X_test, y_test)</span><br><span class="line"></span><br><span class="line"><span class="comment"># print(&quot;Accuracy is &#123;&#125;&quot;.format(accuracy))</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Accuracy is <span class="subst">&#123;accuracy&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><pre><code>Accuracy is 0.7906588824020017
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># [é€‰æ‹©æ€§ test] é’ˆå¯¹æŸä¸€è¡Œæµ‹è¯•</span></span><br><span class="line"></span><br><span class="line">line_num = <span class="number">50</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;ingredients: <span class="subst">&#123;X_test.iloc[line_num][X_test.iloc[line_num]!=<span class="number">0</span>].keys()&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;cuisine: <span class="subst">&#123;y_test.iloc[line_num]&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">test = X_test.iloc[line_num].values.reshape(-<span class="number">1</span>, <span class="number">1</span>).T</span><br><span class="line">proba = model.predict_proba(test)</span><br><span class="line">classes = model.classes_</span><br><span class="line">resultdf = pd.DataFrame(data=proba, columns=classes)</span><br><span class="line"></span><br><span class="line">topPrediction = resultdf.T.sort_values(by=[<span class="number">0</span>], ascending=[<span class="literal">False</span>])</span><br><span class="line">topPrediction.head()</span><br></pre></td></tr></table></figure><pre><code>ingredients: Index(['butter', 'cayenne', 'cheese', 'cinnamon', 'coriander', 'onion',
       'tomato', 'turmeric'],
      dtype='object')
cuisine: indian


D:\Scoop\apps\anaconda3\current\lib\site-packages\sklearn\base.py:450: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
  warnings.warn(
</code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>0</th></tr></thead><tbody><tr><th>indian</th><td>0.962110</td></tr><tr><th>thai</th><td>0.021403</td></tr><tr><th>korean</th><td>0.011124</td></tr><tr><th>japanese</th><td>0.003710</td></tr><tr><th>chinese</th><td>0.001653</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">y_pred = model.predict(X_test)</span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, y_pred))</span><br></pre></td></tr></table></figure><pre><code>              precision    recall  f1-score   support

     chinese       0.76      0.68      0.72       242
      indian       0.91      0.93      0.92       239
    japanese       0.72      0.76      0.74       222
      korean       0.84      0.80      0.82       264
        thai       0.77      0.84      0.80       232

    accuracy                           0.80      1199
   macro avg       0.80      0.80      0.80      1199
weighted avg       0.80      0.80      0.80      1199
</code></pre><h5 id="åˆ†ç±»-2">åˆ†ç±»-2</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> KNeighborsClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier, AdaBoostClassifier</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split, cross_val_score</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, confusion_matrix, classification_report, precision_recall_curve</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">cuisines_df = pd.read_csv(</span><br><span class="line">    <span class="string">&quot;./_data_set/cuisines_classification/cleaned_cuisines.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line">cuisines_label_df = cuisines_df[<span class="string">&#x27;cuisine&#x27;</span>]</span><br><span class="line">cuisines_feature_df = cuisines_df.drop([<span class="string">&#x27;Unnamed: 0&#x27;</span>, <span class="string">&#x27;cuisine&#x27;</span>], axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(cuisines_feature_df,</span><br><span class="line">                                                    cuisines_label_df,</span><br><span class="line">                                                    test_size=<span class="number">0.3</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ­£åˆ™åŒ–ç³»æ•°</span></span><br><span class="line">C = <span class="number">10</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºä¸åŒçš„åˆ†ç±»å™¨</span></span><br><span class="line">classifiers = &#123;</span><br><span class="line">    <span class="comment"># çº¿æ€§ SVC åˆ†ç±»å™¨</span></span><br><span class="line">    <span class="string">&#x27;Linear SVC&#x27;</span>: SVC(kernel=<span class="string">&#x27;linear&#x27;</span>, C=C, probability=<span class="literal">True</span>, random_state=<span class="number">0</span>),</span><br><span class="line">    <span class="comment"># K-è¿‘é‚»åˆ†ç±»å™¨</span></span><br><span class="line">    <span class="string">&#x27;KNN classifier&#x27;</span>: KNeighborsClassifier(C),</span><br><span class="line">    <span class="comment"># Support Vector åˆ†ç±»å™¨</span></span><br><span class="line">    <span class="string">&#x27;SVC&#x27;</span>: SVC(),</span><br><span class="line">    <span class="comment"># é›†æˆåˆ†ç±»å™¨, éšæœºæ£®æ— ä¸ ADA</span></span><br><span class="line">    <span class="string">&#x27;RFST&#x27;</span>: RandomForestClassifier(n_estimators=<span class="number">100</span>),</span><br><span class="line">    <span class="string">&#x27;ADA&#x27;</span>: AdaBoostClassifier(n_estimators=<span class="number">100</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index, (name, classifier) <span class="keyword">in</span> <span class="built_in">enumerate</span>(classifiers.items()):</span><br><span class="line">    classifier.fit(X_train, np.ravel(y_train))</span><br><span class="line"></span><br><span class="line">    y_pred = classifier.predict(X_test)</span><br><span class="line">    accuracy = accuracy_score(y_test, y_pred)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Accuracy (train) for %s: %0.1f%%&quot;</span> % (name, accuracy * <span class="number">100</span>))</span><br><span class="line">    <span class="built_in">print</span>(classification_report(y_test, y_pred))</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>Accuracy (train) for Linear SVC: 80.2%
              precision    recall  f1-score   support

     chinese       0.73      0.76      0.74       250
      indian       0.86      0.89      0.88       235
    japanese       0.78      0.78      0.78       245
      korean       0.88      0.74      0.80       227
        thai       0.78      0.84      0.81       242

    accuracy                           0.80      1199
   macro avg       0.81      0.80      0.80      1199
weighted avg       0.81      0.80      0.80      1199

Accuracy (train) for KNN classifier: 73.6%
              precision    recall  f1-score   support

     chinese       0.71      0.73      0.72       250
      indian       0.80      0.86      0.83       235
    japanese       0.67      0.80      0.73       245
      korean       0.91      0.51      0.65       227
        thai       0.69      0.77      0.73       242

    accuracy                           0.74      1199
   macro avg       0.76      0.73      0.73      1199
weighted avg       0.75      0.74      0.73      1199

Accuracy (train) for SVC: 82.8%
              precision    recall  f1-score   support

     chinese       0.77      0.81      0.79       250
      indian       0.88      0.93      0.90       235
    japanese       0.82      0.76      0.79       245
      korean       0.90      0.77      0.83       227
        thai       0.79      0.88      0.83       242

    accuracy                           0.83      1199
   macro avg       0.83      0.83      0.83      1199
weighted avg       0.83      0.83      0.83      1199

Accuracy (train) for RFST: 84.5%
              precision    recall  f1-score   support

     chinese       0.82      0.81      0.82       250
      indian       0.85      0.93      0.89       235
    japanese       0.86      0.81      0.83       245
      korean       0.90      0.83      0.86       227
        thai       0.81      0.85      0.83       242

    accuracy                           0.84      1199
   macro avg       0.85      0.85      0.85      1199
weighted avg       0.85      0.84      0.84      1199

Accuracy (train) for ADA: 69.3%
              precision    recall  f1-score   support

     chinese       0.64      0.42      0.51       250
      indian       0.81      0.85      0.83       235
    japanese       0.65      0.61      0.63       245
      korean       0.62      0.82      0.71       227
        thai       0.73      0.79      0.76       242

    accuracy                           0.69      1199
   macro avg       0.69      0.70      0.69      1199
weighted avg       0.69      0.69      0.68      1199
</code></pre><h3 id="èšç±»é—®é¢˜">èšç±»é—®é¢˜</h3><h4 id="èšç±»å…¥é—¨-æ•°æ®åˆ†å¸ƒ">èšç±»å…¥é—¨-æ•°æ®åˆ†å¸ƒ</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&quot;./_data_set/Clustering/nigerian-songs.csv&quot;</span>)</span><br><span class="line"><span class="comment"># df.head()</span></span><br><span class="line">df.info()</span><br><span class="line"><span class="comment"># object ç±»å‹é™¤å¤–</span></span><br><span class="line">df.describe()</span><br></pre></td></tr></table></figure><pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 530 entries, 0 to 529
Data columns (total 16 columns):
 #   Column            Non-Null Count  Dtype
---  ------            --------------  -----
 0   name              530 non-null    object
 1   album             530 non-null    object
 2   artist            530 non-null    object
 3   artist_top_genre  530 non-null    object
 4   release_date      530 non-null    int64
 5   length            530 non-null    int64
 6   popularity        530 non-null    int64
 7   danceability      530 non-null    float64
 8   acousticness      530 non-null    float64
 9   energy            530 non-null    float64
 10  instrumentalness  530 non-null    float64
 11  liveness          530 non-null    float64
 12  loudness          530 non-null    float64
 13  speechiness       530 non-null    float64
 14  tempo             530 non-null    float64
 15  time_signature    530 non-null    int64
dtypes: float64(8), int64(4), object(4)
memory usage: 66.4+ KB
</code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>release_date</th><th>length</th><th>popularity</th><th>danceability</th><th>acousticness</th><th>energy</th><th>instrumentalness</th><th>liveness</th><th>loudness</th><th>speechiness</th><th>tempo</th><th>time_signature</th></tr></thead><tbody><tr><th>count</th><td>530.000000</td><td>530.000000</td><td>530.000000</td><td>530.000000</td><td>530.000000</td><td>530.000000</td><td>530.000000</td><td>530.000000</td><td>530.000000</td><td>530.000000</td><td>530.000000</td><td>530.000000</td></tr><tr><th>mean</th><td>2015.390566</td><td>222298.169811</td><td>17.507547</td><td>0.741619</td><td>0.265412</td><td>0.760623</td><td>0.016305</td><td>0.147308</td><td>-4.953011</td><td>0.130748</td><td>116.487864</td><td>3.986792</td></tr><tr><th>std</th><td>3.131688</td><td>39696.822259</td><td>18.992212</td><td>0.117522</td><td>0.208342</td><td>0.148533</td><td>0.090321</td><td>0.123588</td><td>2.464186</td><td>0.092939</td><td>23.518601</td><td>0.333701</td></tr><tr><th>min</th><td>1998.000000</td><td>89488.000000</td><td>0.000000</td><td>0.255000</td><td>0.000665</td><td>0.111000</td><td>0.000000</td><td>0.028300</td><td>-19.362000</td><td>0.027800</td><td>61.695000</td><td>3.000000</td></tr><tr><th>25%</th><td>2014.000000</td><td>199305.000000</td><td>0.000000</td><td>0.681000</td><td>0.089525</td><td>0.669000</td><td>0.000000</td><td>0.075650</td><td>-6.298750</td><td>0.059100</td><td>102.961250</td><td>4.000000</td></tr><tr><th>50%</th><td>2016.000000</td><td>218509.000000</td><td>13.000000</td><td>0.761000</td><td>0.220500</td><td>0.784500</td><td>0.000004</td><td>0.103500</td><td>-4.558500</td><td>0.097950</td><td>112.714500</td><td>4.000000</td></tr><tr><th>75%</th><td>2017.000000</td><td>242098.500000</td><td>31.000000</td><td>0.829500</td><td>0.403000</td><td>0.875750</td><td>0.000234</td><td>0.164000</td><td>-3.331000</td><td>0.177000</td><td>125.039250</td><td>4.000000</td></tr><tr><th>max</th><td>2020.000000</td><td>511738.000000</td><td>73.000000</td><td>0.966000</td><td>0.954000</td><td>0.995000</td><td>0.910000</td><td>0.811000</td><td>0.582000</td><td>0.514000</td><td>206.007000</td><td>5.000000</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">draw</span>(<span class="params">df</span>):</span><br><span class="line">    top = df[<span class="string">&#x27;artist_top_genre&#x27;</span>].value_counts()</span><br><span class="line">    plt.figure(figsize=(<span class="number">10</span>, <span class="number">7</span>))</span><br><span class="line">    sns.barplot(x=top[:<span class="number">5</span>].index, y=top[:<span class="number">5</span>].values)</span><br><span class="line">    plt.xticks(rotation=<span class="number">45</span>)</span><br><span class="line">    plt.title(<span class="string">&#x27;Top genres&#x27;</span>, color=<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">draw(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¿‡æ»¤æ‰ Missing</span></span><br><span class="line">new_df = df[df[<span class="string">&#x27;artist_top_genre&#x27;</span>] != <span class="string">&#x27;Missing&#x27;</span>]</span><br><span class="line">draw(new_df)</span><br><span class="line"></span><br><span class="line">featured_df = new_df[((new_df[<span class="string">&#x27;artist_top_genre&#x27;</span>] == <span class="string">&#x27;afro dancehall&#x27;</span>)</span><br><span class="line">                      | (new_df[<span class="string">&#x27;artist_top_genre&#x27;</span>] == <span class="string">&#x27;afropop&#x27;</span>)</span><br><span class="line">                      | (new_df[<span class="string">&#x27;artist_top_genre&#x27;</span>] == <span class="string">&#x27;nigerian pop&#x27;</span>))</span><br><span class="line">                     &amp; (new_df[<span class="string">&#x27;popularity&#x27;</span>] &gt; <span class="number">0</span>)]</span><br><span class="line">draw(featured_df)</span><br><span class="line"></span><br><span class="line">corrmat = featured_df.corr()</span><br><span class="line">f, ax = plt.subplots(figsize=(<span class="number">12</span>, <span class="number">9</span>))</span><br><span class="line">sns.heatmap(corrmat, vmax=<span class="number">.8</span>, square=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><pre><code>&lt;AxesSubplot:&gt;
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_50_1.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_50_2.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_50_3.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_50_4.png" alt="png"></p><h4 id="K-Means-ä¸è¡¡é‡æŒ‡æ ‡">K-Means-ä¸è¡¡é‡æŒ‡æ ‡</h4><h5 id="å…¥é—¨-éŸ³ä¹åˆ†ç±»">å…¥é—¨-éŸ³ä¹åˆ†ç±»</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># è¿™ç§æ ¼å¼å¯ä»¥è¿è¡Œ</span></span><br><span class="line">!pip install seaborn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&quot;./_data_set/Clustering/nigerian-songs.csv&quot;</span>)</span><br><span class="line">df.head()</span><br></pre></td></tr></table></figure><pre><code>Looking in indexes: http://mirrors.aliyun.com/pypi/simple/
Requirement already satisfied: seaborn in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (0.11.2)
Requirement already satisfied: scipy&gt;=1.0 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from seaborn) (1.7.1)
Requirement already satisfied: numpy&gt;=1.15 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from seaborn) (1.20.3)
Requirement already satisfied: pandas&gt;=0.23 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from seaborn) (1.4.2)
Requirement already satisfied: matplotlib&gt;=2.2 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from seaborn) (3.4.3)
Requirement already satisfied: python-dateutil&gt;=2.7 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (2.8.2)
Requirement already satisfied: cycler&gt;=0.10 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (0.11.0)
Requirement already satisfied: pyparsing&gt;=2.2.1 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (3.0.4)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (1.3.2)
Requirement already satisfied: pillow&gt;=6.2.0 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (9.0.1)
Requirement already satisfied: pytz&gt;=2020.1 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from pandas&gt;=0.23-&gt;seaborn) (2021.3)
Requirement already satisfied: six&gt;=1.5 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=2.2-&gt;seaborn) (1.16.0)
</code></pre><div><style scoped>.dataframe tbody tr th:only-of-type{vertical-align:middle}</style><table border="1" class="dataframe"><thead><tr style="text-align:right"><th></th><th>name</th><th>album</th><th>artist</th><th>artist_top_genre</th><th>release_date</th><th>length</th><th>popularity</th><th>danceability</th><th>acousticness</th><th>energy</th><th>instrumentalness</th><th>liveness</th><th>loudness</th><th>speechiness</th><th>tempo</th><th>time_signature</th></tr></thead><tbody><tr><th>0</th><td>Sparky</td><td>Mandy &amp; The Jungle</td><td>Cruel Santino</td><td>alternative r&amp;b</td><td>2019</td><td>144000</td><td>48</td><td>0.666</td><td>0.8510</td><td>0.420</td><td>0.534000</td><td>0.1100</td><td>-6.699</td><td>0.0829</td><td>133.015</td><td>5</td></tr><tr><th>1</th><td>shuga rush</td><td>EVERYTHING YOU HEARD IS TRUE</td><td>Odunsi (The Engine)</td><td>afropop</td><td>2020</td><td>89488</td><td>30</td><td>0.710</td><td>0.0822</td><td>0.683</td><td>0.000169</td><td>0.1010</td><td>-5.640</td><td>0.3600</td><td>129.993</td><td>3</td></tr><tr><th>2</th><td>LITT!</td><td>LITT!</td><td>AYLÃ˜</td><td>indie r&amp;b</td><td>2018</td><td>207758</td><td>40</td><td>0.836</td><td>0.2720</td><td>0.564</td><td>0.000537</td><td>0.1100</td><td>-7.127</td><td>0.0424</td><td>130.005</td><td>4</td></tr><tr><th>3</th><td>Confident / Feeling Cool</td><td>Enjoy Your Life</td><td>Lady Donli</td><td>nigerian pop</td><td>2019</td><td>175135</td><td>14</td><td>0.894</td><td>0.7980</td><td>0.611</td><td>0.000187</td><td>0.0964</td><td>-4.961</td><td>0.1130</td><td>111.087</td><td>4</td></tr><tr><th>4</th><td>wanted you</td><td>rare.</td><td>Odunsi (The Engine)</td><td>afropop</td><td>2018</td><td>152049</td><td>25</td><td>0.702</td><td>0.1160</td><td>0.833</td><td>0.910000</td><td>0.3480</td><td>-6.044</td><td>0.0447</td><td>105.115</td><td>4</td></tr></tbody></table></div><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fetured_df = df[((df[<span class="string">&#x27;artist_top_genre&#x27;</span>] == <span class="string">&#x27;afro dancehall&#x27;</span>)</span><br><span class="line">                 | (df[<span class="string">&#x27;artist_top_genre&#x27;</span>] == <span class="string">&#x27;afropop&#x27;</span>)</span><br><span class="line">                 | (df[<span class="string">&#x27;artist_top_genre&#x27;</span>] == <span class="string">&#x27;nigerian pop&#x27;</span>))</span><br><span class="line">                &amp; (df[<span class="string">&#x27;popularity&#x27;</span>] &gt; <span class="number">0</span>)]</span><br><span class="line"></span><br><span class="line">top = fetured_df[<span class="string">&#x27;artist_top_genre&#x27;</span>].value_counts()</span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">7</span>))</span><br><span class="line">sns.barplot(x=top.index, y=top.values)</span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Top genres&#x27;</span>, color=<span class="string">&#x27;blue&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç®±çº¿å›¾, å¯ä»¥ç›´è§‚çœ‹å‡ºæ•°æ®çš„åˆ†å¸ƒ</span></span><br><span class="line">plt.figure(figsize=(<span class="number">20</span>, <span class="number">20</span>), dpi=<span class="number">200</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 1)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;popularity&#x27;, data=df)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 2)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;acousticness&#x27;, data=df)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 3)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;energy&#x27;, data=df)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 4)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;instrumentalness&#x27;, data=df)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 5)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;liveness&#x27;, data=df)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 6)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;loudness&#x27;, data=df)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 7)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;speechiness&#x27;, data=df)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 8)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;tempo&#x27;, data=df)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 9)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;time_signature&#x27;, data=df)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 10)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;danceability&#x27;, data=df)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 11)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;length&#x27;, data=df)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  plt.subplot(4, 3, 12)</span></span><br><span class="line"><span class="string">  sns.boxplot(x=&#x27;release_date&#x27;, data=df)</span></span><br><span class="line"><span class="string"> &quot;&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i, v <span class="keyword">in</span> <span class="built_in">enumerate</span>([</span><br><span class="line">        <span class="string">&quot;popularity&quot;</span>, <span class="string">&quot;acousticness&quot;</span>, <span class="string">&quot;energy&quot;</span>, <span class="string">&quot;instrumentalness&quot;</span>, <span class="string">&quot;liveness&quot;</span>,</span><br><span class="line">        <span class="string">&quot;loudness&quot;</span>, <span class="string">&quot;speechiness&quot;</span>, <span class="string">&quot;tempo&quot;</span>, <span class="string">&quot;time_signature&quot;</span>, <span class="string">&quot;danceability&quot;</span>,</span><br><span class="line">        <span class="string">&quot;length&quot;</span>, <span class="string">&quot;release_date&quot;</span></span><br><span class="line">]):</span><br><span class="line">    plt.subplot(<span class="number">4</span>, <span class="number">3</span>, i + <span class="number">1</span>)</span><br><span class="line">    sns.boxplot(x=v, data=df)</span><br><span class="line">    <span class="comment"># plt.title(v)</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_53_0.png" alt="png"></p><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_53_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> metrics</span><br><span class="line"></span><br><span class="line">le = LabelEncoder()</span><br><span class="line"></span><br><span class="line">X = df.loc[:, (<span class="string">&#x27;artist_top_genre&#x27;</span>, <span class="string">&#x27;popularity&#x27;</span>, <span class="string">&#x27;danceability&#x27;</span>,</span><br><span class="line">               <span class="string">&#x27;acousticness&#x27;</span>, <span class="string">&#x27;loudness&#x27;</span>, <span class="string">&#x27;energy&#x27;</span>)]</span><br><span class="line">X[<span class="string">&#x27;artist_top_genre&#x27;</span>] = le.fit_transform(X[<span class="string">&#x27;artist_top_genre&#x27;</span>])</span><br><span class="line">y = le.transform(df[<span class="string">&#x27;artist_top_genre&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># èšä¸º3ç±»</span></span><br><span class="line">nclusters = <span class="number">3</span></span><br><span class="line">seed = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">km = KMeans(n_clusters=nclusters, random_state=seed).fit(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Predict the cluster for each data point</span></span><br><span class="line">y_cluster_kmeans = km.predict(X)</span><br><span class="line"><span class="built_in">print</span>(y_cluster_kmeans)</span><br><span class="line"></span><br><span class="line">score = metrics.silhouette_score(X, y_cluster_kmeans)</span><br><span class="line"><span class="comment"># score ä» [-1,1], è¶Šå¤§è¡¨ç¤ºèšç±»æ•ˆæœè¶Šå¥½</span></span><br><span class="line"><span class="built_in">print</span>(score)</span><br></pre></td></tr></table></figure><pre><code>[2 0 2 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 2 0 0 0 0 0 2 0 0 1 0 0 2 1 1 2 2 2 0
 2 0 1 2 2 2 0 1 1 2 1 0 0 0 0 1 1 1 1 1 2 0 2 1 0 2 0 1 2 1 2 1 1 1 1 2 1
 0 2 2 0 0 0 1 0 0 1 1 1 1 0 0 1 1 1 2 1 0 0 1 1 1 0 0 1 0 1 2 0 1 1 2 0 1
 1 1 1 1 1 1 0 1 0 1 0 1 0 2 1 2 0 1 1 1 0 0 1 1 0 2 0 1 1 0 0 0 1 1 0 1 0
 2 0 1 1 0 0 0 1 0 1 1 0 1 0 1 0 0 1 1 1 0 0 0 1 1 1 0 0 1 0 2 1 1 1 1 1 0
 1 1 1 1 0 2 0 0 0 0 0 0 1 1 2 1 1 1 1 1 2 1 1 0 0 1 1 1 1 1 0 0 1 0 1 0 0
 1 2 1 1 1 1 0 1 1 1 1 0 1 1 1 0 1 0 1 2 1 1 1 1 1 1 0 1 0 1 0 1 0 1 1 1 1
 2 0 0 1 1 0 0 0 1 0 0 1 1 1 2 1 1 2 0 0 1 0 1 1 0 1 1 1 0 2 1 1 2 2 2 0 2
 2 2 2 2 2 2 2 1 2 2 1 2 1 2 1 2 2 2 0 1 0 1 1 0 1 2 1 1 2 1 0 2 2 0 0 0 1
 0 1 0 1 1 1 1 2 1 1 2 2 1 0 2 0 2 1 1 2 2 2 0 0 2 2 1 1 0 0 0 1 1 1 1 1 1
 1 1 1 1 2 1 1 0 1 1 1 1 0 1 1 1 1 0 0 1 0 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1
 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 2 1 2 2 1 0 0 0 1 2 1 1 2 1 0 0 0 2 2 2 0 2
 2 2 0 2 2 0 1 0 1 2 0 1 1 1 1 1 1 0 1 1 0 0 1 0 1 0 1 1 1 1 1 1 1 1 1 0 1
 0 1 1 1 1 1 1 0 1 1 1 2 0 0 1 1 1 1 2 1 0 2 1 1 1 0 1 1 2 1 0 0 0 0 0 1 1
 1 1 1 0 0 1 1 1 1 1 1 1]
0.5918299843029218
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># æ‰‹è‚˜æ–¹æ³•: æ‹ç‚¹é™„è¿‘å°±æ˜¯è¾ƒå¥½çš„èšç±»åˆ’åˆ†</span></span><br><span class="line">wcss = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">    kmeans = KMeans(n_clusters=i, init=<span class="string">&#x27;k-means++&#x27;</span>, random_state=<span class="number">42</span>).fit(X)</span><br><span class="line">    wcss.append(kmeans.inertia_)</span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">10</span>, <span class="number">5</span>))</span><br><span class="line">sns.lineplot(<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>), wcss, marker=<span class="string">&#x27;o&#x27;</span>, color=<span class="string">&#x27;red&#x27;</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Elbow&#x27;</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Number of clusters&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;WCSS&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><pre><code>D:\Scoop\apps\anaconda3\current\lib\site-packages\sklearn\cluster\_kmeans.py:1036: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=3.
  warnings.warn(
D:\Scoop\apps\anaconda3\current\lib\site-packages\seaborn\_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_55_1.png" alt="png"></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># åˆå§‹å€¼çš„éšæœºé€‰å–ä¼šå½±å“æ¯æ¬¡çš„ç»“æœ</span></span><br><span class="line">kmeans = KMeans(n_clusters=<span class="number">3</span>).fit(X)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 0 | 1 | 2</span></span><br><span class="line">labels = kmeans.predict(X)</span><br><span class="line">plt.scatter(df[<span class="string">&#x27;popularity&#x27;</span>], df[<span class="string">&#x27;danceability&#x27;</span>], c=labels)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;popularity&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;danceability&#x27;</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># çœŸå®å€¼ ä¸ ä¸é¢„æµ‹å€¼é›†åˆçš„äº¤é›† å…ƒç´ ä¸ªæ•°</span></span><br><span class="line">correct_labels = <span class="built_in">sum</span>(y == kmeans.labels_)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;%d/%d samples were correctly labeled.&quot;</span> %</span><br><span class="line">      (correct_labels, y.size))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Accuracy score: &#123;0:0.2f&#125;&#x27;</span>.<span class="built_in">format</span>(correct_labels / <span class="built_in">float</span>(y.size)))</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_56_0.png" alt="png"></p><pre><code>93/530 samples were correctly labeled.
Accuracy score: 0.18
</code></pre><h5 id="sample-2">sample-2</h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.colors</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> sklearn.datasets <span class="keyword">as</span> ds</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> homogeneity_score, completeness_score, v_measure_score, adjusted_mutual_info_score,\</span><br><span class="line">    adjusted_rand_score, silhouette_score</span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> Axes3D</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">expand</span>(<span class="params">a, b</span>):</span><br><span class="line">    d = (b - a) * <span class="number">0.1</span></span><br><span class="line">    <span class="keyword">return</span> a - d, b + d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N = <span class="number">400</span></span><br><span class="line">centers = <span class="number">4</span></span><br><span class="line">data, y = ds.make_blobs(N, n_features=<span class="number">2</span>, centers=centers, random_state=<span class="number">2</span>)</span><br><span class="line">data2, y2 = ds.make_blobs(N,</span><br><span class="line">                          n_features=<span class="number">2</span>,</span><br><span class="line">                          centers=centers,</span><br><span class="line">                          cluster_std=(<span class="number">1</span>, <span class="number">2.5</span>, <span class="number">0.5</span>, <span class="number">2</span>),</span><br><span class="line">                          random_state=<span class="number">2</span>)</span><br><span class="line">data3 = np.vstack(</span><br><span class="line">    (data[y == <span class="number">0</span>][:], data[y == <span class="number">1</span>][:<span class="number">50</span>], data[y == <span class="number">2</span>][:<span class="number">20</span>], data[y == <span class="number">3</span>][:<span class="number">5</span>]))</span><br><span class="line">y3 = np.array([<span class="number">0</span>] * <span class="number">100</span> + [<span class="number">1</span>] * <span class="number">50</span> + [<span class="number">2</span>] * <span class="number">20</span> + [<span class="number">3</span>] * <span class="number">5</span>)</span><br><span class="line">m = np.array(((<span class="number">1</span>, <span class="number">1</span>), (<span class="number">1</span>, <span class="number">3</span>)))</span><br><span class="line">data_r = data.dot(m)</span><br><span class="line"></span><br><span class="line">matplotlib.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">matplotlib.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line">cm = matplotlib.colors.ListedColormap(<span class="built_in">list</span>(<span class="string">&#x27;rgbm&#x27;</span>))</span><br><span class="line">data_list = data, data, data_r, data_r, data2, data2, data3, data3</span><br><span class="line">y_list = y, y, y, y, y2, y2, y3, y3</span><br><span class="line">titles = <span class="string">&#x27;åŸå§‹æ•°æ®&#x27;</span>, <span class="string">&#x27;KMeans++èšç±»&#x27;</span>, <span class="string">&#x27;æ—‹è½¬åæ•°æ®&#x27;</span>, <span class="string">&#x27;æ—‹è½¬åKMeans++èšç±»&#x27;</span>,\</span><br><span class="line">          <span class="string">&#x27;æ–¹å·®ä¸ç›¸ç­‰æ•°æ®&#x27;</span>, <span class="string">&#x27;æ–¹å·®ä¸ç›¸ç­‰KMeans++èšç±»&#x27;</span>, <span class="string">&#x27;æ•°é‡ä¸ç›¸ç­‰æ•°æ®&#x27;</span>, <span class="string">&#x27;æ•°é‡ä¸ç›¸ç­‰KMeans++èšç±»&#x27;</span></span><br><span class="line"></span><br><span class="line">model = KMeans(n_clusters=<span class="number">4</span>, init=<span class="string">&#x27;k-means++&#x27;</span>, n_init=<span class="number">5</span>)</span><br><span class="line">fig = plt.figure(figsize=(<span class="number">8</span>, <span class="number">9</span>), facecolor=<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> i, (x, y, title) <span class="keyword">in</span> <span class="built_in">enumerate</span>(<span class="built_in">zip</span>(data_list, y_list, titles), start=<span class="number">1</span>):</span><br><span class="line">    <span class="comment"># plt.subplot(4, 2, i)</span></span><br><span class="line">    ax = fig.add_subplot(<span class="number">4</span>, <span class="number">2</span>, i)</span><br><span class="line">    plt.title(title)</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        y_pred = y</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        y_pred = model.fit_predict(x)</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Homogeneity:&#x27;</span>, homogeneity_score(y, y_pred))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;completeness:&#x27;</span>, completeness_score(y, y_pred))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;V measure:&#x27;</span>, v_measure_score(y, y_pred))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;AMI:&#x27;</span>, adjusted_mutual_info_score(y, y_pred))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;ARI:&#x27;</span>, adjusted_rand_score(y, y_pred))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Silhouette:&#x27;</span>, silhouette_score(x, y_pred), <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    ax.scatter(x[:, <span class="number">0</span>], x[:, <span class="number">1</span>], s=<span class="number">10</span>, c=y_pred, cmap=cm, edgecolors=<span class="string">&#x27;none&#x27;</span>)</span><br><span class="line">    ax.grid(b=<span class="literal">True</span>, ls=<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">plt.tight_layout(<span class="number">2</span>, rect=(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.95</span>))</span><br><span class="line">plt.suptitle(<span class="string">&#x27;æ•°æ®åˆ†å¸ƒå¯¹KMeansèšç±»çš„å½±å“&#x27;</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>1
Homogeneity: 1.0
completeness: 1.0
V measure: 1.0
AMI: 1.0
ARI: 1.0
Silhouette: 0.616436816839852

2
Homogeneity: 0.9898828240244267
completeness: 0.9899006758819153
V measure: 0.9898917498726852
AMI: 0.9898081557479033
ARI: 0.9933165272203728
Silhouette: 0.6189656317733315

3
Homogeneity: 1.0
completeness: 1.0
V measure: 1.0
AMI: 1.0
ARI: 1.0
Silhouette: 0.5275987244664399

4
Homogeneity: 0.7296158940840607
completeness: 0.7315285272632114
V measure: 0.7305709588584066
AMI: 0.7283397010755561
ARI: 0.6783811042853299
Silhouette: 0.5366236044449266

5
Homogeneity: 1.0
completeness: 1.0
V measure: 1.0
AMI: 1.0
ARI: 1.0
Silhouette: 0.4790725752982868

6
Homogeneity: 0.7449364376693913
completeness: 0.7755445167472191
V measure: 0.7599323988656883
AMI: 0.757903292819801
ARI: 0.7113213508090338
Silhouette: 0.5737260449304202

7
Homogeneity: 1.0
completeness: 1.0
V measure: 1.0
AMI: 1.0
ARI: 1.0
Silhouette: 0.5975066093204152

8
Homogeneity: 0.9776347312784609
completeness: 0.9728632742060752
V measure: 0.975243166591057
AMI: 0.9745709993295113
ARI: 0.9906840043816505
Silhouette: 0.6013877858619149



C:\Users\utsuk\AppData\Local\Temp\ipykernel_28356\867049078.py:57: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.
  plt.tight_layout(2, rect=(0, 0, 1, 0.95))
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_58_2.png" alt="png"></p><h4 id="å±‚æ¬¡èšç±»">å±‚æ¬¡èšç±»</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> AgglomerativeClustering</span><br><span class="line"><span class="keyword">from</span> sklearn.neighbors <span class="keyword">import</span> kneighbors_graph</span><br><span class="line"><span class="keyword">import</span> sklearn.datasets <span class="keyword">as</span> ds</span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">expand</span>(<span class="params">a, b, r</span>):</span><br><span class="line">    d = (b - a) * r</span><br><span class="line">    <span class="keyword">return</span> a - d, b + d</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    warnings.filterwarnings(action=<span class="string">&#x27;ignore&#x27;</span>, category=UserWarning)</span><br><span class="line">    np.set_printoptions(suppress=<span class="literal">True</span>)</span><br><span class="line">    np.random.seed(<span class="number">0</span>)</span><br><span class="line">    n_clusters = <span class="number">4</span></span><br><span class="line">    N = <span class="number">400</span></span><br><span class="line">    data1, y1 = ds.make_blobs(n_samples=N,</span><br><span class="line">                              n_features=<span class="number">2</span>,</span><br><span class="line">                              centers=((-<span class="number">1</span>, <span class="number">1</span>), (<span class="number">1</span>, <span class="number">1</span>), (<span class="number">1</span>, -<span class="number">1</span>), (-<span class="number">1</span>, -<span class="number">1</span>)),</span><br><span class="line">                              cluster_std=(<span class="number">0.1</span>, <span class="number">0.2</span>, <span class="number">0.3</span>, <span class="number">0.4</span>),</span><br><span class="line">                              random_state=<span class="number">0</span>)</span><br><span class="line">    data1 = np.array(data1)</span><br><span class="line">    n_noise = <span class="built_in">int</span>(<span class="number">0.1</span> * N)</span><br><span class="line">    r = np.random.rand(n_noise, <span class="number">2</span>)</span><br><span class="line">    data_min1, data_min2 = np.<span class="built_in">min</span>(data1, axis=<span class="number">0</span>)</span><br><span class="line">    data_max1, data_max2 = np.<span class="built_in">max</span>(data1, axis=<span class="number">0</span>)</span><br><span class="line">    r[:, <span class="number">0</span>] = r[:, <span class="number">0</span>] * (data_max1 - data_min1) + data_min1</span><br><span class="line">    r[:, <span class="number">1</span>] = r[:, <span class="number">1</span>] * (data_max2 - data_min2) + data_min2</span><br><span class="line">    data1_noise = np.concatenate((data1, r), axis=<span class="number">0</span>)</span><br><span class="line">    y1_noise = np.concatenate((y1, [<span class="number">4</span>] * n_noise))</span><br><span class="line"></span><br><span class="line">    data2, y2 = ds.make_moons(n_samples=N, noise=<span class="number">.05</span>)</span><br><span class="line">    data2 = np.array(data2)</span><br><span class="line">    n_noise = <span class="built_in">int</span>(<span class="number">0.1</span> * N)</span><br><span class="line">    r = np.random.rand(n_noise, <span class="number">2</span>)</span><br><span class="line">    data_min1, data_min2 = np.<span class="built_in">min</span>(data2, axis=<span class="number">0</span>)</span><br><span class="line">    data_max1, data_max2 = np.<span class="built_in">max</span>(data2, axis=<span class="number">0</span>)</span><br><span class="line">    r[:, <span class="number">0</span>] = r[:, <span class="number">0</span>] * (data_max1 - data_min1) + data_min1</span><br><span class="line">    r[:, <span class="number">1</span>] = r[:, <span class="number">1</span>] * (data_max2 - data_min2) + data_min2</span><br><span class="line">    data2_noise = np.concatenate((data2, r), axis=<span class="number">0</span>)</span><br><span class="line">    y2_noise = np.concatenate((y2, [<span class="number">3</span>] * n_noise))</span><br><span class="line"></span><br><span class="line">    mpl.rcParams[<span class="string">&#x27;font.sans-serif&#x27;</span>] = [<span class="string">&#x27;SimHei&#x27;</span>]</span><br><span class="line">    mpl.rcParams[<span class="string">&#x27;axes.unicode_minus&#x27;</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    cm = mpl.colors.ListedColormap([<span class="string">&#x27;r&#x27;</span>, <span class="string">&#x27;g&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;m&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])</span><br><span class="line">    plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>), facecolor=<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">    plt.cla()</span><br><span class="line">    linkages = (<span class="string">&quot;ward&quot;</span>, <span class="string">&quot;complete&quot;</span>, <span class="string">&quot;average&quot;</span>)</span><br><span class="line">    <span class="keyword">for</span> index, (n_clusters, data, y) <span class="keyword">in</span> <span class="built_in">enumerate</span>(</span><br><span class="line">        ((<span class="number">4</span>, data1, y1), (<span class="number">4</span>, data1_noise, y1_noise), (<span class="number">2</span>, data2, y2),</span><br><span class="line">         (<span class="number">2</span>, data2_noise, y2_noise))):</span><br><span class="line">        plt.subplot(<span class="number">4</span>, <span class="number">4</span>, <span class="number">4</span> * index + <span class="number">1</span>)</span><br><span class="line">        plt.scatter(data[:, <span class="number">0</span>], data[:, <span class="number">1</span>], c=y, s=<span class="number">12</span>, edgecolors=<span class="string">&#x27;k&#x27;</span>, cmap=cm)</span><br><span class="line">        plt.title(<span class="string">&#x27;Prime&#x27;</span>, fontsize=<span class="number">12</span>)</span><br><span class="line">        plt.grid(b=<span class="literal">True</span>, ls=<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">        data_min1, data_min2 = np.<span class="built_in">min</span>(data, axis=<span class="number">0</span>)</span><br><span class="line">        data_max1, data_max2 = np.<span class="built_in">max</span>(data, axis=<span class="number">0</span>)</span><br><span class="line">        plt.xlim(expand(data_min1, data_max1, <span class="number">0.05</span>))</span><br><span class="line">        plt.ylim(expand(data_min2, data_max2, <span class="number">0.05</span>))</span><br><span class="line"></span><br><span class="line">        connectivity = kneighbors_graph(data,</span><br><span class="line">                                        n_neighbors=<span class="number">7</span>,</span><br><span class="line">                                        mode=<span class="string">&#x27;distance&#x27;</span>,</span><br><span class="line">                                        metric=<span class="string">&#x27;minkowski&#x27;</span>,</span><br><span class="line">                                        p=<span class="number">2</span>,</span><br><span class="line">                                        include_self=<span class="literal">True</span>)</span><br><span class="line">        connectivity = <span class="number">0.5</span> * (connectivity + connectivity.T)</span><br><span class="line">        <span class="keyword">for</span> i, linkage <span class="keyword">in</span> <span class="built_in">enumerate</span>(linkages):</span><br><span class="line">            ac = AgglomerativeClustering(n_clusters=n_clusters,</span><br><span class="line">                                         affinity=<span class="string">&#x27;euclidean&#x27;</span>,</span><br><span class="line">                                         connectivity=connectivity,</span><br><span class="line">                                         linkage=linkage)</span><br><span class="line">            ac.fit(data)</span><br><span class="line">            y = ac.labels_</span><br><span class="line">            plt.subplot(<span class="number">4</span>, <span class="number">4</span>, i + <span class="number">2</span> + <span class="number">4</span> * index)</span><br><span class="line">            plt.scatter(data[:, <span class="number">0</span>],</span><br><span class="line">                        data[:, <span class="number">1</span>],</span><br><span class="line">                        c=y,</span><br><span class="line">                        s=<span class="number">12</span>,</span><br><span class="line">                        edgecolors=<span class="string">&#x27;k&#x27;</span>,</span><br><span class="line">                        cmap=cm)</span><br><span class="line">            plt.title(linkage, fontsize=<span class="number">12</span>)</span><br><span class="line">            plt.grid(b=<span class="literal">True</span>, ls=<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">            plt.xlim(expand(data_min1, data_max1, <span class="number">0.05</span>))</span><br><span class="line">            plt.ylim(expand(data_min2, data_max2, <span class="number">0.05</span>))</span><br><span class="line">    plt.suptitle(<span class="string">&#x27;å±‚æ¬¡èšç±»çš„ä¸åŒåˆå¹¶ç­–ç•¥&#x27;</span>, fontsize=<span class="number">15</span>)</span><br><span class="line">    plt.tight_layout(<span class="number">0.5</span>, rect=(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0.95</span>))</span><br><span class="line">    plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_60_0.png" alt="png"></p><h3 id="é™ç»´é—®é¢˜">é™ç»´é—®é¢˜</h3><h4 id="ç¼ºå¤±å€¼æ¯”ç‡">ç¼ºå¤±å€¼æ¯”ç‡</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># import required libraries</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># read the data</span></span><br><span class="line">train = pd.read_csv(<span class="string">&quot;./_data_set/é™ç»´é—®é¢˜/train_v9rqX0R.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># checking the percentage of missing values in each variable</span></span><br><span class="line"><span class="comment"># æ•°æ®å®Œæ•´ç‡ = (ç©ºæ•° / æ‰€æœ‰æ•°) * 100</span></span><br><span class="line">a = train.isnull().<span class="built_in">sum</span>() / <span class="built_in">len</span>(train) * <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># saving column names in a variable</span></span><br><span class="line">variable = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">12</span>):</span><br><span class="line">    <span class="keyword">if</span> a[i] &lt;= <span class="number">20</span>:  <span class="comment">#setting the threshold as 20%</span></span><br><span class="line">        variable.append(train.columns[i])</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç¼ºå¤±ç‡å¤§äºé˜ˆå€¼çš„åˆ—</span></span><br><span class="line"><span class="built_in">print</span>(variable)</span><br></pre></td></tr></table></figure><pre><code>['Item_Identifier', 'Item_Weight', 'Item_Fat_Content', 'Item_Visibility', 'Item_Type', 'Item_MRP', 'Outlet_Identifier', 'Outlet_Establishment_Year', 'Outlet_Location_Type', 'Outlet_Type', 'Item_Outlet_Sales']
</code></pre><h4 id="ä½æ–¹å·®è¿‡æ»¤">ä½æ–¹å·®è¿‡æ»¤</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># import required libraries</span></span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># read the data</span></span><br><span class="line">train = pd.read_csv(<span class="string">&quot;./_data_set/é™ç»´é—®é¢˜/train_v9rqX0R.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¡«å……ç©ºé¡¹</span></span><br><span class="line">train[<span class="string">&#x27;Item_Weight&#x27;</span>].fillna(train[<span class="string">&#x27;Item_Weight&#x27;</span>].median(), inplace=<span class="literal">True</span>)</span><br><span class="line">train[<span class="string">&#x27;Outlet_Size&#x27;</span>].fillna(train[<span class="string">&#x27;Outlet_Size&#x27;</span>].mode()[<span class="number">0</span>], inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¡«å……åçš„ç¼ºå¤±ç‡</span></span><br><span class="line"><span class="built_in">print</span>(train.isnull().<span class="built_in">sum</span>() / <span class="built_in">len</span>(train) * <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line">numeric = train[[</span><br><span class="line">    <span class="string">&#x27;Item_Weight&#x27;</span>, <span class="string">&#x27;Item_Visibility&#x27;</span>, <span class="string">&#x27;Item_MRP&#x27;</span>, <span class="string">&#x27;Outlet_Establishment_Year&#x27;</span></span><br><span class="line">]]</span><br><span class="line">var = numeric.var()</span><br><span class="line">numeric = numeric.columns</span><br><span class="line">variable = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(var)):</span><br><span class="line">    <span class="keyword">if</span> var[i] &gt;= <span class="number">10</span>:  <span class="comment">#setting the threshold as 10%</span></span><br><span class="line">        variable.append(numeric[i])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(variable)</span><br><span class="line"></span><br></pre></td></tr></table></figure><pre><code>Item_Identifier              0.0
Item_Weight                  0.0
Item_Fat_Content             0.0
Item_Visibility              0.0
Item_Type                    0.0
Item_MRP                     0.0
Outlet_Identifier            0.0
Outlet_Establishment_Year    0.0
Outlet_Size                  0.0
Outlet_Location_Type         0.0
Outlet_Type                  0.0
Item_Outlet_Sales            0.0
dtype: float64
['Item_Weight', 'Item_MRP', 'Outlet_Establishment_Year']
</code></pre><h2 id="ä»£ç ç›¸å…³">ä»£ç ç›¸å…³</h2><h3 id="å­˜å‚¨-è¯»å–æ¨¡å‹">å­˜å‚¨-è¯»å–æ¨¡å‹</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> sklearn.linear_model <span class="keyword">as</span> lm  <span class="comment"># çº¿æ€§æ¨¡å‹</span></span><br><span class="line"><span class="keyword">import</span> sklearn.metrics <span class="keyword">as</span> sm  <span class="comment"># æ¨¡å‹æ€§èƒ½è¯„ä»·æ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> mp</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">x = np.array([[<span class="number">0.5</span>], [<span class="number">0.6</span>], [<span class="number">0.8</span>], [<span class="number">1.1</span>], [<span class="number">1.4</span>]])  <span class="comment"># è¾“å…¥é›†</span></span><br><span class="line">y = np.array([<span class="number">5.0</span>, <span class="number">5.5</span>, <span class="number">6.0</span>, <span class="number">6.8</span>, <span class="number">7.0</span>])  <span class="comment"># è¾“å‡ºé›†</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ›å»ºçº¿æ€§å›å½’å™¨</span></span><br><span class="line">model = lm.LinearRegression()</span><br><span class="line"><span class="comment"># ç”¨å·²çŸ¥è¾“å…¥ã€è¾“å‡ºæ•°æ®é›†è®­ç»ƒå›å½’å™¨</span></span><br><span class="line">model.fit(x, y)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;è®­ç»ƒå®Œæˆ.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># ä¿å­˜è®­ç»ƒåçš„æ¨¡å‹</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;linear_model.pkl&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    pickle.dump(model, f)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;ä¿å­˜æ¨¡å‹å®Œæˆ.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">######################### åŠ è½½æ¨¡å‹ #########################</span></span><br><span class="line"><span class="comment"># ä¸Šé¢é€šè¿‡è®­ç»ƒæ•°æ®x,y è®­ç»ƒå¥½äº† x -&gt; y çš„çº¿æ€§å›å½’æ¨¡å‹</span></span><br><span class="line"><span class="comment"># ä¸‹é¢åŠ è½½æ¨¡å‹, å†ç»™å‡ºæµ‹è¯•æ•°æ® x, æŸ¥çœ‹æ¨¡å‹é¢„æµ‹ç»“æœç›´çº¿ä¸åŸå§‹æ•°æ® (x,y) çš„æ‹Ÿåˆåº¦</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;linear_model.pkl&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    model = pickle.load(f)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;åŠ è½½æ¨¡å‹å®Œæˆ.&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># æ ¹æ®åŠ è½½çš„æ¨¡å‹é¢„æµ‹è¾“å‡º</span></span><br><span class="line">pred_y = model.predict(x)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¯è§†åŒ–å›å½’æ›²çº¿</span></span><br><span class="line">mp.figure(<span class="string">&#x27;Linear Regression&#x27;</span>, facecolor=<span class="string">&#x27;lightgray&#x27;</span>)</span><br><span class="line">mp.title(<span class="string">&#x27;Linear Regression&#x27;</span>, fontsize=<span class="number">20</span>)</span><br><span class="line">mp.xlabel(<span class="string">&#x27;x&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">mp.ylabel(<span class="string">&#x27;y&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">mp.tick_params(labelsize=<span class="number">10</span>)</span><br><span class="line">mp.grid(linestyle=<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">mp.scatter(x, y, c=<span class="string">&#x27;blue&#x27;</span>, alpha=<span class="number">0.8</span>, s=<span class="number">60</span>, label=<span class="string">&#x27;Sample Points&#x27;</span>)</span><br><span class="line"></span><br><span class="line">mp.plot(x, pred_y, c=<span class="string">&#x27;orangered&#x27;</span>, label=<span class="string">&#x27;Regression&#x27;</span>)</span><br><span class="line"></span><br><span class="line">mp.legend()</span><br><span class="line">mp.show()</span><br></pre></td></tr></table></figure><pre><code>è®­ç»ƒå®Œæˆ.
ä¿å­˜æ¨¡å‹å®Œæˆ.
åŠ è½½æ¨¡å‹å®Œæˆ.
</code></pre><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_66_1.png" alt="png"></p><h3 id="Web-app">Web-app</h3><h4 id="ä¸€">ä¸€</h4><p>train ä¸€ä¸ªé€»è¾‘å›å½’æ¨¡å‹å¹¶ç”¨ pickle æ‰“åŒ…</p><p>ç„¶åload</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> LabelEncoder</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, classification_report</span><br><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"></span><br><span class="line">ufos = pd.read_csv(<span class="string">&#x27;./_data_set/web-app/1/ufos.csv&#x27;</span>)</span><br><span class="line"><span class="comment"># ufos.head()</span></span><br><span class="line"></span><br><span class="line">ufos = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&#x27;Seconds&#x27;</span>: ufos[<span class="string">&#x27;duration (seconds)&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Country&#x27;</span>: ufos[<span class="string">&#x27;country&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Latitude&#x27;</span>: ufos[<span class="string">&#x27;latitude&#x27;</span>],</span><br><span class="line">    <span class="string">&#x27;Longitude&#x27;</span>: ufos[<span class="string">&#x27;longitude&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">ufos.Country.unique()</span><br><span class="line"></span><br><span class="line">ufos.dropna(inplace=<span class="literal">True</span>)</span><br><span class="line">ufos = ufos[(ufos[<span class="string">&#x27;Seconds&#x27;</span>] &gt;= <span class="number">1</span>) &amp; (ufos[<span class="string">&#x27;Seconds&#x27;</span>] &lt;= <span class="number">60</span>)]</span><br><span class="line"></span><br><span class="line"><span class="comment"># ufos.info()</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># [&#x27;us&#x27;, nan, &#x27;gb&#x27;, &#x27;ca&#x27;, &#x27;au&#x27;, &#x27;de&#x27;] -&gt; 0-5</span></span><br><span class="line">ufos[<span class="string">&#x27;Country&#x27;</span>] = LabelEncoder().fit_transform(ufos[<span class="string">&#x27;Country&#x27;</span>])</span><br><span class="line"></span><br><span class="line">ufos.head()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================== å‡†å¤‡å®Œæˆ ==============================</span></span><br><span class="line"></span><br><span class="line">x = ufos[[<span class="string">&#x27;Seconds&#x27;</span>, <span class="string">&#x27;Latitude&#x27;</span>, <span class="string">&#x27;Longitude&#x27;</span>]]</span><br><span class="line">y = ufos[<span class="string">&#x27;Country&#x27;</span>]</span><br><span class="line"><span class="comment"># [&#x27;Seconds&#x27;, &#x27;Latitude&#x27;, &#x27;Longitude&#x27;]  ==&gt;  &#x27;Country&#x27;</span></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(x,</span><br><span class="line">                                                    y,</span><br><span class="line">                                                    test_size=<span class="number">0.2</span>,</span><br><span class="line">                                                    random_state=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># default max_iter=100 ä¼šè¶…é™</span></span><br><span class="line">model = LogisticRegression(max_iter=<span class="number">1000</span>).fit(X_train, y_train)</span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, y_pred))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Predicted labels: &#x27;</span>, y_pred)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Accuracy: &#x27;</span>, accuracy_score(y_test, y_pred))</span><br><span class="line"></span><br><span class="line"><span class="comment"># ======================== æ‰“åŒ… model ==============================</span></span><br><span class="line"></span><br><span class="line">model_name = <span class="string">&#x27;./_data_set/web-app/1/ufo-model.pkl&#x27;</span></span><br><span class="line"></span><br><span class="line">pickle.dump(model, <span class="built_in">open</span>(model_name, <span class="string">&#x27;wb&#x27;</span>))</span><br></pre></td></tr></table></figure><pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00        41
           1       0.85      0.47      0.60       250
           2       1.00      1.00      1.00         8
           3       1.00      1.00      1.00       131
           4       0.97      1.00      0.98      4743

    accuracy                           0.97      5173
   macro avg       0.96      0.89      0.92      5173
weighted avg       0.97      0.97      0.97      5173

Predicted labels:  [4 4 4 ... 3 4 4]
Accuracy:  0.9702300405953992
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">model_load = pickle.load(<span class="built_in">open</span>(model_name, <span class="string">&#x27;rb&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(model_load.predict([[<span class="number">50</span>, <span class="number">44</span>, -<span class="number">12</span>]]))</span><br></pre></td></tr></table></figure><pre><code>[3]


D:\Scoop\apps\anaconda3\current\lib\site-packages\sklearn\base.py:450: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
  warnings.warn(
</code></pre><h4 id="äºŒ">äºŒ</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</span><br><span class="line"><span class="keyword">from</span> sklearn.svm <span class="keyword">import</span> SVC</span><br><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score</span><br><span class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score, precision_score, confusion_matrix, classification_report</span><br><span class="line"></span><br><span class="line">data = pd.read_csv(<span class="string">&#x27;./_data_set/cuisines_classification/cleaned_cuisines.csv&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># åˆ é™¤å‰ä¸¤åˆ—æ— ç”¨çš„åˆ—</span></span><br><span class="line">X = data.iloc[:, <span class="number">2</span>:]</span><br><span class="line">y = data[[<span class="string">&#x27;cuisine&#x27;</span>]]</span><br><span class="line"></span><br><span class="line">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class="number">0.3</span>)</span><br><span class="line"></span><br><span class="line">model = SVC(kernel=<span class="string">&#x27;linear&#x27;</span>, C=<span class="number">10</span>, probability=<span class="literal">True</span>, random_state=<span class="number">0</span>)</span><br><span class="line"><span class="comment"># model.fit(X_train, np.revel(y_train))</span></span><br><span class="line">model.fit(X_train, y_train.values.ravel())</span><br><span class="line">y_pred = model.predict(X_test)</span><br><span class="line"><span class="built_in">print</span>(classification_report(y_test, y_pred))</span><br></pre></td></tr></table></figure><pre><code>              precision    recall  f1-score   support

     chinese       0.73      0.68      0.70       242
      indian       0.89      0.88      0.88       246
    japanese       0.80      0.79      0.79       262
      korean       0.82      0.75      0.78       229
        thai       0.75      0.88      0.81       220

    accuracy                           0.79      1199
   macro avg       0.79      0.80      0.79      1199
weighted avg       0.80      0.79      0.79      1199
</code></pre><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> skl2onnx <span class="keyword">import</span> convert_sklearn</span><br><span class="line"><span class="keyword">from</span> skl2onnx.common.data_types <span class="keyword">import</span> FloatTensorType</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼ é‡ä¸º 380</span></span><br><span class="line">initial_type = [(<span class="string">&#x27;float_input&#x27;</span>, FloatTensorType([<span class="literal">None</span>, <span class="number">380</span>]))]</span><br><span class="line">options = &#123;<span class="built_in">id</span>(model): &#123;<span class="string">&#x27;nocl&#x27;</span>: <span class="literal">True</span>, <span class="string">&#x27;zipmap&#x27;</span>: <span class="literal">False</span>&#125;&#125;</span><br><span class="line"></span><br><span class="line">onx = convert_sklearn(model, initial_types=initial_type, options=options)</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;./_data_set/web-app/2/model.onnx&quot;</span>, <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(onx.SerializeToString())</span><br></pre></td></tr></table></figure><h2 id="ä¿¡æ¯è®º">ä¿¡æ¯è®º</h2><h3 id="ä¸¤ç‚¹åˆ†å¸ƒä¿¡æ¯ç†µ">ä¸¤ç‚¹åˆ†å¸ƒä¿¡æ¯ç†µ</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"><span class="comment"># å› ä¸º ln0 æ— å®šä¹‰, ç”¨æ­¤å€¼æ¨¡æ‹Ÿè¶‹è¿‘ 0</span></span><br><span class="line">eps = <span class="number">1e-5</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># probability</span></span><br><span class="line">p = np.linspace(eps, <span class="number">1</span> - eps, <span class="number">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Information entropy</span></span><br><span class="line">h = -(<span class="number">1</span> - p) * np.log2(<span class="number">1</span> - p) - p * np.log2(p)</span><br><span class="line"></span><br><span class="line">plt.plot(p, h, label=<span class="string">&#x27;Information entropy&#x27;</span>, color=<span class="string">&#x27;red&#x27;</span>, lw=<span class="number">3</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;Probability&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;Entropy&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.legend(loc=<span class="string">&#x27;best&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.grid(<span class="literal">True</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment"># ç»“æœä¸­ä¿¡æ¯ç†µçš„å³°å€¼å–å†³äº log åº•æ•°, eä¸ºåº•æ—¶å³°å€¼ä¸º0.7å·¦å³, 2ä¸ºåº•å³°å€¼ä¸º1</span></span><br></pre></td></tr></table></figure><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_74_0.png" alt="png"></p><h3 id="åŸºå°¼ç³»æ•°ä¸-ln">åŸºå°¼ç³»æ•°ä¸-ln</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line">eps = <span class="number">1e-4</span></span><br><span class="line">p = np.linspace(eps, <span class="number">1</span> - eps, <span class="number">100</span>)</span><br><span class="line">h = -(<span class="number">1</span> - p) * np.log2(<span class="number">1</span> - p) - p * np.log2(p)</span><br><span class="line">gini = <span class="number">2</span> * (<span class="number">1</span> - p) * p</span><br><span class="line"></span><br><span class="line">plt.plot(p, gini, <span class="string">&#x27;r-&#x27;</span>, lw=<span class="number">3</span>)</span><br><span class="line">plt.plot(p, h / <span class="number">2</span>, <span class="string">&#x27;g-&#x27;</span>, lw=<span class="number">3</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;Gini(p) / Ln(p)&#x27;</span>, fontsize=<span class="number">16</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;p&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;H&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.legend([<span class="string">&#x27;Gini&#x27;</span>, <span class="string">&#x27;Ln&#x27;</span>], loc=<span class="string">&#x27;best&#x27;</span>, fontsize=<span class="number">14</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure><p><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="ML_files/ML_76_0.png" alt="png"></p><p><a><img src="https://pan.weidows.tech/d/local/img/loading.svg" data-lazy-src="https://pan.weidows.tech/d/local/img/divider.png" alt="åˆ†å‰²çº¿"></a></p><h2 id="å€Ÿç‰©è¡¨">å€Ÿç‰©è¡¨</h2><p><a name="cite_note-1" href="#cite_ref-1">[1]</a>: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://discover304.top/">https://discover304.top/</a></p><p><a name="cite_note-2" href="#cite_ref-2">[2]</a>: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.bilibili.com/video/BV16L411w7oQ?p=6">ã€ä¸Šæµ·äº¤å¤§ã€‘ã€è…¾è®¯ã€‘å¼ºå¼ºè”åˆ æœºå™¨å­¦ä¹ +æ·±åº¦å­¦ä¹ </a></p><p><a name="cite_note-3" href="#cite_ref-3">[3]</a>: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.analyticsvidhya.com/blog/2018/08/dimensionality-reduction-techniques-python/">The Ultimate Guide to 12 Dimensionality Reduction Techniques (with Python codes)</a></p><p><a name="cite_note-4" href="#cite_ref-4">[4]</a>: <a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/microsoft/ML-For-Beginners">https://github.com/microsoft/ML-For-Beginners</a></p><script type="text&#x2F;javascript" src="https://unpkg.com/kity@2.0.4/dist/kity.min.js"></script><script type="text&#x2F;javascript" src="https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js"></script><script defer type="text&#x2F;javascript" src="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js"></script><link rel="stylesheet" type="text&#x2F;css" href="https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css"></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a target="_blank" rel="noopener" href="https://weidows.github.io/">â›âWeidowsâ â</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="https://blog.weidows.tech/post/lang/python/code/ML/">https://blog.weidows.tech/post/lang/python/code/ML/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow noreferrer" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="https://blog.weidows.tech" target="_blank">â­ï¸é½ä¸‹æ— è´°â­ï¸</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/">äººå·¥æ™ºèƒ½</a><a class="post-meta__tags" href="/tags/%E4%BF%A1%E6%81%AF%E8%AE%BA/">ä¿¡æ¯è®º</a><a class="post-meta__tags" href="/tags/python/">python</a><a class="post-meta__tags" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/">æœºå™¨å­¦ä¹ </a></div><div class="post_share"><div class="social-share" data-image="https://pan.weidows.tech/d/local/blog/RsEzqc.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://unpkg.com/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://unpkg.com/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> æ‰“èµ</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="https://pan.weidows.tech/d/local/blog/ZMQ5xr.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://pan.weidows.tech/d/local/blog/ZMNujq.jpg" alt="å¾®ä¿¡"></a><div class="post-qr-code-desc">å¾®ä¿¡</div></li><li class="reward-item"><a href="https://pan.weidows.tech/d/local/blog/ZMNj0c.jpg" rel="external nofollow noreferrer" target="_blank"><img class="post-qr-code-img" src="https://pan.weidows.tech/d/local/blog/ZMNrb5.jpg" alt="æ”¯ä»˜å®"></a><div class="post-qr-code-desc">æ”¯ä»˜å®</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/post/lang/python/AI/ML/" title="ğŸ¥µç¡¬å•ƒ-Machine-Learning"><img class="cover" src="https://pan.weidows.tech/d/local/blog/RHZuZ1.png" onerror='onerror=null,src="https://pan.weidows.tech/d/local/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">ğŸ¥µç¡¬å•ƒ-Machine-Learning</div></div></a></div><div class="next-post pull-right"><a href="/post/experience/dev/interview/" title="ğŸ”å‡‰ç»-é¢è¯•é¢˜"><img class="cover" src="https://pan.weidows.tech/d/local/blog/Z0I1NC.png" onerror='onerror=null,src="https://pan.weidows.tech/d/local/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">ğŸ”å‡‰ç»-é¢è¯•é¢˜</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/post/lang/python/AI/ML/" title="ğŸ¥µç¡¬å•ƒ-Machine-Learning"><img class="cover" src="https://pan.weidows.tech/d/local/blog/RHZuZ1.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-08-07</div><div class="title">ğŸ¥µç¡¬å•ƒ-Machine-Learning</div></div></a></div><div><a href="/post/lang/python/%E6%9D%82/" title="ğŸ˜‘python-mess-code"><img class="cover" src="https://pan.weidows.tech/d/local/blog/RHDLJD.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-08-07</div><div class="title">ğŸ˜‘python-mess-code</div></div></a></div><div><a href="/post/lang/python/AI/AI/" title="ğŸŠAll-about-AI"><img class="cover" src="https://pan.weidows.tech/d/local/blog/RaxR4K.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-08-07</div><div class="title">ğŸŠAll-about-AI</div></div></a></div><div><a href="/post/lang/python/code/DL/" title="ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨Code-4-Deep-Learning"><img class="cover" src="https://pan.weidows.tech/d/local/blog/RHe8xK.png" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-08-07</div><div class="title">ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨Code-4-Deep-Learning</div></div></a></div><div><a href="/post/experience/basic/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="ğŸŒˆåŸºç¡€çŸ¥è¯†"><img class="cover" src="https://pan.weidows.tech/d/local/blog/GVJOM6.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-08-06</div><div class="title">ğŸŒˆåŸºç¡€çŸ¥è¯†</div></div></a></div><div><a href="/post/experience/research/research/" title="â²ï¸è¯¯å…¥ç§‘ç ”æµ·"><img class="cover" src="https://pan.weidows.tech/d/local/blog/ZW7GFn.gif" alt="cover"><div class="content is-center"><div class="date"><i class="fas fa-history fa-fw"></i> 2024-08-06</div><div class="title">â²ï¸è¯¯å…¥ç§‘ç ”æµ·</div></div></a></div></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://pan.weidows.tech/d/local/img/avatar/avatar.png" onerror='this.onerror=null,this.src="https://pan.weidows.tech/d/local/img/404.jpg"' alt="avatar"></div><div class="author-info__name">â›âWeidowsâ â</div><div class="author-info__description">May all the beauty be bless.âœ¨</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">151</div></a><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">225</div></a><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">49</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Weidows" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:utsuko27@qq.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="https://pan.weidows.tech/d/local/blog/ZMQ1NC.jpg" rel="external nofollow noreferrer" target="_blank" title="QQå·"><i class="fab fa-qq"></i></a><a class="social-icon" href="https://pan.weidows.tech/d/local/blog/ZMQRaK.jpg" rel="external nofollow noreferrer" target="_blank" title="å¾®ä¿¡å·"><i class="fab fa-weixin"></i></a><a class="social-icon" href="https://space.bilibili.com/38283369" rel="external nofollow noreferrer" target="_blank"><i class="fa-brands fa-bilibili"></i></a><a class="social-icon" href="/categories/rss" target="_blank" title="RSS"><i class="fa fa-rss-square"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>å…¬å‘Š</span></div><div class="announcement_content"><center><h2 style="color:#0ff">-> æ¬¢è¿,é”Ÿæ–¤æ‹·! <-</h2><h3 style="color:gray">ä½æƒ…å•†ï¼šä»£ç ä¸€å¨å±<br>é«˜æƒ…å•†ï¼šå…¼å®¹æ€§æå¼º</h3>æ¬¢è¿åŠ æˆ‘QQæˆ–ç¾¤ 942848525 <img src="https://moe.counter.weidows.tech/Weidows?theme=rule34" style="width:100%"></center></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%8F"><span class="toc-text">åº</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95"><span class="toc-text">æ•°æ®é¢„å¤„ç†æ–¹æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E5%8C%96-%E5%9D%87%E5%80%BC%E7%A7%BB%E9%99%A4"><span class="toc-text">æ ‡å‡†åŒ–-å‡å€¼ç§»é™¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8C%83%E5%9B%B4%E7%BC%A9%E6%94%BE"><span class="toc-text">èŒƒå›´ç¼©æ”¾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%92%E4%B8%80%E5%8C%96"><span class="toc-text">å½’ä¸€åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E5%80%BC%E5%8C%96"><span class="toc-text">äºŒå€¼åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8B%AC%E7%83%AD%E7%BC%96%E7%A0%81%E7%A4%BA%E4%BE%8B"><span class="toc-text">ç‹¬çƒ­ç¼–ç ç¤ºä¾‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E7%AD%BE%E7%BC%96%E7%A0%81"><span class="toc-text">æ ‡ç­¾ç¼–ç </span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E9%97%AE%E9%A2%98"><span class="toc-text">åŸºæœ¬é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9E%E5%BD%92%E9%97%AE%E9%A2%98"><span class="toc-text">å›å½’é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92"><span class="toc-text">çº¿æ€§å›å½’</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E5%9B%9E%E5%BD%92"><span class="toc-text">å¤šé¡¹å¼å›å½’</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91-%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97"><span class="toc-text">å†³ç­–æ ‘-éšæœºæ£®æ—</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91%E5%88%86%E7%B1%BB"><span class="toc-text">å†³ç­–æ ‘åˆ†ç±»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97"><span class="toc-text">éšæœºæ£®æ—</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%B3%E7%AD%96%E6%A0%91-%E9%9A%8F%E6%9C%BA%E6%A3%AE%E6%9E%97%E5%9B%9E%E5%BD%92"><span class="toc-text">å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E7%B1%BB%E9%97%AE%E9%A2%98"><span class="toc-text">åˆ†ç±»é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E5%9B%9E%E5%BD%92"><span class="toc-text">é€»è¾‘å›å½’</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8C%E5%88%86%E7%B1%BB"><span class="toc-text">äºŒåˆ†ç±»</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E5%88%86%E7%B1%BB"><span class="toc-text">å¤šåˆ†ç±»</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%AF%E6%8C%81%E5%90%91%E9%87%8F%E6%9C%BA-SVM"><span class="toc-text">æ”¯æŒå‘é‡æœº-SVM</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A0%B8%E5%87%BD%E6%95%B0"><span class="toc-text">æ ¸å‡½æ•°</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF"><span class="toc-text">æœ´ç´ è´å¶æ–¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E5%85%83%E9%97%AE%E9%A2%98-%E8%8F%9C%E8%82%B4%E5%88%86%E7%B1%BB"><span class="toc-text">å¤šå…ƒé—®é¢˜-èœè‚´åˆ†ç±»</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E4%B8%8E%E6%B8%85%E6%B4%97"><span class="toc-text">æ•°æ®åŠ è½½ä¸æ¸…æ´—</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%B1%BB-1"><span class="toc-text">åˆ†ç±»-1</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%86%E7%B1%BB-2"><span class="toc-text">åˆ†ç±»-2</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E7%B1%BB%E9%97%AE%E9%A2%98"><span class="toc-text">èšç±»é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%9A%E7%B1%BB%E5%85%A5%E9%97%A8-%E6%95%B0%E6%8D%AE%E5%88%86%E5%B8%83"><span class="toc-text">èšç±»å…¥é—¨-æ•°æ®åˆ†å¸ƒ</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#K-Means-%E4%B8%8E%E8%A1%A1%E9%87%8F%E6%8C%87%E6%A0%87"><span class="toc-text">K-Means-ä¸è¡¡é‡æŒ‡æ ‡</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%A5%E9%97%A8-%E9%9F%B3%E4%B9%90%E5%88%86%E7%B1%BB"><span class="toc-text">å…¥é—¨-éŸ³ä¹åˆ†ç±»</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#sample-2"><span class="toc-text">sample-2</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%82%E6%AC%A1%E8%81%9A%E7%B1%BB"><span class="toc-text">å±‚æ¬¡èšç±»</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%99%8D%E7%BB%B4%E9%97%AE%E9%A2%98"><span class="toc-text">é™ç»´é—®é¢˜</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%BA%E5%A4%B1%E5%80%BC%E6%AF%94%E7%8E%87"><span class="toc-text">ç¼ºå¤±å€¼æ¯”ç‡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%8E%E6%96%B9%E5%B7%AE%E8%BF%87%E6%BB%A4"><span class="toc-text">ä½æ–¹å·®è¿‡æ»¤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E7%9B%B8%E5%85%B3"><span class="toc-text">ä»£ç ç›¸å…³</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%98%E5%82%A8-%E8%AF%BB%E5%8F%96%E6%A8%A1%E5%9E%8B"><span class="toc-text">å­˜å‚¨-è¯»å–æ¨¡å‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Web-app"><span class="toc-text">Web-app</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80"><span class="toc-text">ä¸€</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%8C"><span class="toc-text">äºŒ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%A1%E6%81%AF%E8%AE%BA"><span class="toc-text">ä¿¡æ¯è®º</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E7%82%B9%E5%88%86%E5%B8%83%E4%BF%A1%E6%81%AF%E7%86%B5"><span class="toc-text">ä¸¤ç‚¹åˆ†å¸ƒä¿¡æ¯ç†µ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E5%B0%BC%E7%B3%BB%E6%95%B0%E4%B8%8E-ln"><span class="toc-text">åŸºå°¼ç³»æ•°ä¸-ln</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%80%9F%E7%89%A9%E8%A1%A8"><span class="toc-text">å€Ÿç‰©è¡¨</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/post/system/Windows-Theme-HighContract-Tokyo-Night/README/" title="ğŸ³ï¸â€ğŸŒˆWindows-Theme-HighContract-Tokyo-Night"><img src="https://pan.weidows.tech/d/local/blog/owlk10.png" onerror='this.onerror=null,this.src="https://pan.weidows.tech/d/local/img/404.jpg"' alt="ğŸ³ï¸â€ğŸŒˆWindows-Theme-HighContract-Tokyo-Night"></a><div class="content"><a class="title" href="/post/system/Windows-Theme-HighContract-Tokyo-Night/README/" title="ğŸ³ï¸â€ğŸŒˆWindows-Theme-HighContract-Tokyo-Night">ğŸ³ï¸â€ğŸŒˆWindows-Theme-HighContract-Tokyo-Night</a><time datetime="2025-12-18T07:11:37.070Z" title="æ›´æ–°äº 2025-12-18 15:11:37">2025-12-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/lang/golang/wutils/README/" title="ğŸ‰Docs-wutils"><img src="https://pan.weidows.tech/d/local/blog/1d36e9d50555af6fca23e5fd36246cf5490809012.jpg" onerror='this.onerror=null,this.src="https://pan.weidows.tech/d/local/img/404.jpg"' alt="ğŸ‰Docs-wutils"></a><div class="content"><a class="title" href="/post/lang/golang/wutils/README/" title="ğŸ‰Docs-wutils">ğŸ‰Docs-wutils</a><time datetime="2025-12-18T07:11:36.763Z" title="æ›´æ–°äº 2025-12-18 15:11:36">2025-12-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/system/server/server/" title="ğŸ¥¸æœåŠ¡å™¨ç›¸å…³å¸¸ç”¨æ“ä½œæ‰‹å†Œ"><img src="https://pan.weidows.tech/d/local/blog/6BF32417EC04FF8F50D8693D144615E4.jpg" onerror='this.onerror=null,this.src="https://pan.weidows.tech/d/local/img/404.jpg"' alt="ğŸ¥¸æœåŠ¡å™¨ç›¸å…³å¸¸ç”¨æ“ä½œæ‰‹å†Œ"></a><div class="content"><a class="title" href="/post/system/server/server/" title="ğŸ¥¸æœåŠ¡å™¨ç›¸å…³å¸¸ç”¨æ“ä½œæ‰‹å†Œ">ğŸ¥¸æœåŠ¡å™¨ç›¸å…³å¸¸ç”¨æ“ä½œæ‰‹å†Œ</a><time datetime="2025-12-18T07:11:10.000Z" title="æ›´æ–°äº 2025-12-18 15:11:10">2025-12-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/system/docker/" title="ğŸŒˆåˆæ¢Docker"><img src="https://pan.weidows.tech/d/local/blog/GVawKY.png" onerror='this.onerror=null,this.src="https://pan.weidows.tech/d/local/img/404.jpg"' alt="ğŸŒˆåˆæ¢Docker"></a><div class="content"><a class="title" href="/post/system/docker/" title="ğŸŒˆåˆæ¢Docker">ğŸŒˆåˆæ¢Docker</a><time datetime="2025-11-22T19:38:05.000Z" title="æ›´æ–°äº 2025-11-23 03:38:05">2025-11-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/experience/startup/%E5%88%9B%E4%B8%9A/" title="ğŸ«€åˆ›ä¸š"><img src="https://pan.weidows.tech/d/local/blog/oDj5Gq.png" onerror='this.onerror=null,this.src="https://pan.weidows.tech/d/local/img/404.jpg"' alt="ğŸ«€åˆ›ä¸š"></a><div class="content"><a class="title" href="/post/experience/startup/%E5%88%9B%E4%B8%9A/" title="ğŸ«€åˆ›ä¸š">ğŸ«€åˆ›ä¸š</a><time datetime="2025-11-22T19:38:05.000Z" title="æ›´æ–°äº 2025-11-23 03:38:05">2025-11-23</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/post/design/placeholder/" title="ğŸ¤¯Idea-å ä½ç¬¦"><img src="https://pan.weidows.tech/d/local/blog/oDhham.gif" onerror='this.onerror=null,this.src="https://pan.weidows.tech/d/local/img/404.jpg"' alt="ğŸ¤¯Idea-å ä½ç¬¦"></a><div class="content"><a class="title" href="/post/design/placeholder/" title="ğŸ¤¯Idea-å ä½ç¬¦">ğŸ¤¯Idea-å ä½ç¬¦</a><time datetime="2025-11-22T19:12:37.000Z" title="æ›´æ–°äº 2025-11-23 03:12:37">2025-11-23</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(https://pan.weidows.tech/d/local/blog/RsEzqc.png)"><div id="footer-wrap"><div class="copyright">&copy;2020 - â›âWeidowsâ â - 2025</div><div class="github-badge"><a style="color:#fff" rel="external nofollow noopener noreferrer" href="https://hexo.io/" target="_blank" title="Power By Hexo" data-pjax-state=""><span class="badge-subject">Framework</span><span class="badge-value bg-blue">Hexo</span></a></div><div class="github-badge"><a style="color:#fff" rel="external nofollow noopener noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" title="ä¸»é¢˜" data-pjax-state=""><span class="badge-subject">Theme</span><span class="badge-value bg-blueviolet">Butterfly</span></a></div><div class="github-badge"><a style="color:#fff" rel="external nofollow noopener noreferrer" href="https://github.com/Weidows/Weidows.github.io" target="_blank" title="é™æ€ç½‘é¡µæ‰˜ç®¡" data-pjax-state=""><span class="badge-subject">Hosted</span><span class="badge-value bg-brightgreen">Vercel + GithubPage</span></a></div><div class="github-badge"><a style="color:#fff;vertical-align:middle" rel="external nofollow noopener noreferrer" href="https://wakatime.com/@bd43b19c-e71d-4edd-a297-cc2989d16939" target="_blank" title="Total time coded since Feb 6 2021"><img src="https://wakatime.com/badge/user/bd43b19c-e71d-4edd-a297-cc2989d16939.svg"></a></div><div class="github-badge"><a style="color:#fff" rel="external nofollow noopener noreferrer" href="https://pan.weidows.tech" target="_blank" title="å›¾åºŠåŠ CDN åŠ é€ŸæœåŠ¡" data-pjax-state=""><span class="badge-subject">CDN</span><span class="badge-value bg-orange">Cloudflare</span></a></div><div class="github-badge"><a style="color:#fff" rel="external nofollow noopener noreferrer" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="æœ¬ç«™ç‚¹é‡‡ç”¨çŸ¥è¯†å…±äº«ç½²å-éå•†ä¸šæ€§ä½¿ç”¨-ç›¸åŒæ–¹å¼å…±äº« 4.0 å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯" data-pjax-state=""><span class="badge-subject"><i class="fa fa-copyright"></i></span><span class="badge-value bg-gradient">BY-NC-SA 4.0</span></a></div><div class="github-badge"><a style="color:#fff" rel="external nofollow noopener noreferrer" href="https://www.foreverblog.cn/blog/6104.html" target="_blank" title="ä¸€ä¸ªäººçš„å¯‚å¯ï¼Œä¸€ç¾¤äººçš„ç‹‚æ¬¢ã€‚" data-pjax-state=""><span class="badge-subject">åå¹´ä¹‹çº¦</span></a><a style="color:#fff" rel="external nofollow noopener noreferrer" href="https://icp.gov.moe/?keyword=20244090" target="_blank" title="å¼‚æ¬¡å…ƒä¹‹æ—…-è·ƒè¿-æˆ‘ä»¬ä¸€èµ·å»èŒç«™æˆå‘˜çš„æ˜Ÿçƒæ—…è¡Œå§ï¼" data-pjax-state=""><span class="badge-value bg-gradient-2">èŒICPå¤‡-20244090å·</span></a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.9.0"></script><script src="/js/main.js?v=4.9.0"></script><script src="https://unpkg.com/@fancyapps/ui@5.0.19/dist/fancybox/fancybox.umd.js"></script><script src="https://unpkg.com/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://unpkg.com/vanilla-lazyload@17.8.3/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>(() => {
  const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
  if ($mermaid.length === 0) return
  const runMermaid = () => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'neutral' : 'default'

    Array.from($mermaid).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const loadMermaid = () => {
    window.loadMermaid ? runMermaid() : getScript('https://unpkg.com/mermaid@10.2.2/dist/mermaid.min.js').then(runMermaid)
  }

  btf.addModeChange('mermaid', runMermaid)

  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script><script>function loadWaline () {
  function initWaline () {
    const waline = Waline.init(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://waline.weidows.tech',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
    }, {"emoji":["https://fastly.jsdelivr.net/gh/zhheo/Sticker-Heo@latest/Sticker-100/","https://fastly.jsdelivr.net/gh/walinejs/emojis@1.0.0/alus","https://fastly.jsdelivr.net/gh/walinejs/emojis@1.0.0/bilibili","https://fastly.jsdelivr.net/gh/walinejs/emojis@1.0.0/qq","https://fastly.jsdelivr.net/gh/walinejs/emojis@1.0.0/tieba"]}))
  }

  if (typeof Waline === 'object') initWaline()
  else {
    getCSS('https://unpkg.com/@waline/client@2.15.5/dist/waline.css').then(() => {
      getScript('https://unpkg.com/@waline/client@2.15.5/dist/waline.js').then(initWaline)
    })
  }
}

if ('Waline' === 'Waline' || !true) {
  if (true) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
  else setTimeout(loadWaline, 0)
} else {
  function loadOtherComment () {
    loadWaline()
  }
}</script></div><canvas class="fireworks" mobile="false"></canvas><script src="https://unpkg.com/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script defer id="ribbon" src="https://unpkg.com/butterfly-extsrc@1.1.3/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="true" data-click="true"></script><script src="https://unpkg.com/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: true,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"

  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

  typeof disqusjs === 'object' && disqusjs.destroy()
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', 'G-BHH5BNEG3S', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
  Weidows.re();
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">æœç´¢</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> æ•°æ®åº“åŠ è½½ä¸­</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div><hr><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.9.0"></script></div></div><script src="/assets/mmedia/mmedia-loader.js"></script></body></html>