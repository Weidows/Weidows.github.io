---
title: ğŸ¶Javaç½‘ç»œç¼–ç¨‹
categories:
  - Java
  - ç½‘ç»œç¼–ç¨‹
tags:
  - Java
date: 2021-02-28 17:06:28
cover: https://cdn.jsdelivr.net/gh/Weidows/Images@master/hpp/20210228170730.png
top_img:
---

<!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @LastEditors: Weidows
 * @LastEditTime: 2021-03-02 12:05:24
 * @FilePath: \Weidowsd:\Game\Github\Blog-private\source\_posts\Java\ç½‘ç»œç¼–ç¨‹\1.md
 * @Description:
 * @!: *********************************************************************
-->

- [å‚è€ƒ](#å‚è€ƒ)
- [ç®€ä»‹](#ç®€ä»‹)
- [IP](#ip)
- [ç«¯å£](#ç«¯å£)
- [é€šä¿¡åè®®](#é€šä¿¡åè®®)
  - [TCP](#tcp)
  - [UDP](#udp)
- [TCP è¿æ¥](#tcp-è¿æ¥)
  - [Server ç«¯](#server-ç«¯)
  - [Client ç«¯](#client-ç«¯)
- [æ–‡ä»¶ä¼ è¾“](#æ–‡ä»¶ä¼ è¾“)
  - [Server](#server)
  - [Client](#client)

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images@master/img/divider.png)

# å‚è€ƒ

> [ã€ç‹‚ç¥è¯´ Javaã€‘ç½‘ç»œç¼–ç¨‹](https://blog.csdn.net/weixin_45717355/article/details/110945343)

---

# ç®€ä»‹

- æ¶æ„åŒºåˆ†

  - ç½‘é¡µç¼–ç¨‹: B/S
  - ç½‘ç»œç¼–ç¨‹: C/S

  ***

- é€šä¿¡è¦ç´ (TCP/IP)

  - IP
  - ç«¯å£

  ***

- åè®®å‚è€ƒ

  <img src="https://cdn.jsdelivr.net/gh/Weidows/Images@master/hpp/20210228232437.png" alt="20210228232437" />

  > æ›´ä¸ºè¯¦ç»†çš„: [ç§‘æ¥ç½‘ç»œé€šè®¯åè®®å›¾ 2020 ç‰ˆ](http://www.colasoft.com.cn/download/protocols_map.php)

  - æ­¤å¤„é’ˆå¯¹ä¼ è¾“å±‚ TCP/UDP å­¦ä¹ .

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images@master/img/divider.png)

# IP

```Java
import java.net.InetAddress;
import java.net.UnknownHostException;

public class Ip {

  public static void main(String[] args) {
    // write your code here
    try {
      // è·å–æœ¬æœºå†…ç½‘IPåœ°å€
      InetAddress inetAddress1 = InetAddress.getByName("127.0.0.1");
      System.out.println(inetAddress1);
      InetAddress inetAddress2 = InetAddress.getByName("localhost");
      System.out.println(inetAddress2);
      InetAddress inetAddress3 = InetAddress.getLocalHost();
      System.out.println(inetAddress3);

      //æŸ¥è¯¢ç½‘ç«™ipåœ°å€
      InetAddress inetAddress4 = InetAddress.getByName("www.bilibili.com");
      System.out.println(inetAddress4);

      //å¸¸ç”¨æ–¹æ³•
      System.out.println(inetAddress4.getAddress());
      System.out.println(inetAddress4.getCanonicalHostName()); //è§„èŒƒçš„åå­—
      System.out.println(inetAddress4.getHostAddress()); //ip
      System.out.println(inetAddress4.getHostName()); //åŸŸåï¼Œæˆ–è€…è‡ªå·±ç”µè„‘çš„åå­—
    } catch (UnknownHostException e) {
      e.printStackTrace();
    }
  }
  /**
    /127.0.0.1
    localhost/127.0.0.1
    DESKTOP-CTDDD3K/192.168.114.1
    www.bilibili.com/121.17.123.130
    [B@2a3046da
    121.17.123.130
    121.17.123.130
    www.bilibili.com
   */
}
```

# ç«¯å£

- TCP ä¸ UDP å„æœ‰ 65535 ä¸ªç«¯å£

  - ä¸¤ä¸ªåè®®é—´ä¸å†²çª

  - ä½†æ˜¯ä¸€ä¸ªåè®®ä¸‹çš„ä¸€ä¸ªç«¯å£åªèƒ½åŒæ—¶è¢«ä¸€ä¸ªè½¯ä»¶å ç”¨.

  ***

- ç«¯å£åˆ†ç±»

  - å…¬æœ‰ç«¯å£ 0 ~ 1023

    - HTTPï¼š80

    - HTTPSï¼š443

    - FTPï¼š21

    - Telentï¼š23

  - ç¨‹åºæ³¨å†Œç«¯å£ï¼š1024 ~ 49151ï¼Œåˆ†é…ç»™ç”¨æˆ·æˆ–è€…ç¨‹åº

    - Tomcatï¼š8080

    - MySQLï¼š3306

    - Oracleï¼š1512

  - åŠ¨æ€ã€ç§æœ‰ï¼š49152 ~ 65535

  ***

- å¸¸ç”¨ shell æŒ‡ä»¤

  ```shell
  netstat -ano #æŸ¥çœ‹æ‰€æœ‰çš„ç«¯å£
  netstat -ano | finstr "5900" #æŸ¥çœ‹æŒ‡å®šçš„ç«¯å£
  tasklist | findstr "8696" #æŸ¥çœ‹æŒ‡å®šç«¯å£çš„è¿›ç¨‹
  ```

- InetSocketAddress

  ```Java
  import java.net.InetSocketAddress;

  public class Port {
    public static void main(String[] args) {
      InetSocketAddress socketAddress = new InetSocketAddress("localhost", 8080);
      System.out.println(socketAddress);

      System.out.println(socketAddress.getAddress());
      System.out.println(socketAddress.getHostName());
      System.out.println(socketAddress.getPort());
    }
    /**
      localhost/127.0.0.1:8080
      localhost/127.0.0.1
      localhost
      8080
    */
  }
  ```

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images@master/img/divider.png)

# é€šä¿¡åè®®

- é€šè¿‡çº¦å®šåè®®æ¥ç®¡æ§é€šä¿¡çš„é€Ÿç‡,ç ç‡ç­‰é—®é¢˜

- å¹¶é€šè¿‡åè®®åˆ†å±‚æ¥ç®€åŒ–å¤æ‚åº¦

  ***

- å‡ ç§åè®®

  - TCP:ç”¨æˆ·ä¼ è¾“åè®®

  - UDP:ç”¨æˆ·æ•°æ®æŠ¥åè®®

  - IP:ç½‘ç»œäº’è¿åè®®

  - TCP/IP åè®®ç°‡:æ˜¯ä¸€ç»„åè®® (å››å±‚æ¦‚å¿µæ¨¡å‹)

---

## TCP

- TCP æ˜¯å®¢æˆ·ç«¯<-->æœåŠ¡ç«¯åŒå‘çš„ä¿¡æ¯æ²Ÿé€š,å¯é•¿æ—¶é—´ç¨³å®šè¿æ¥

- ç¨³å®šè¿æ¥æœ€å°éªŒè¯`ä¸‰æ¬¡æ¡æ‰‹,å››æ¬¡æŒ¥æ‰‹`

  ```
  æœ€å°‘éœ€è¦ä¸‰æ¬¡ï¼Œä¿è¯ç¨³å®šè¿æ¥ï¼
  Aï¼šä½ ç…å•¥ï¼Ÿ
  Bï¼šç…ä½ å’‹åœ°ï¼Ÿ
  Aï¼šå¹²ä¸€åœºï¼

  è‡³å°‘å››æ¬¡,åŒæ–¹æ‰èƒ½éƒ½æ–­å¼€è¿æ¥
  Aï¼šæˆ‘è¦èµ°äº†
  Bï¼šä½ çœŸçš„è¦èµ°äº†å—ï¼Ÿ
  Bï¼šä½ çœŸçš„çœŸçš„è¦èµ°äº†å—ï¼Ÿ
  Aï¼šæˆ‘çœŸçš„è¦èµ°äº†
  ```

---

## UDP

- å•å‘çš„ä¿¡æ¯ä¼ é€’

- æ²¡æœ‰å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ç•Œé™

- æ— è®ºæœ‰æ²¡æœ‰æ¥æ”¶æ–¹,æ— è®ºæ¥æ”¶æ–¹æ˜¯å¦æ¥æ”¶,å‘é€æ–¹åªç®¡å‘é€

- å¸¸è§çš„`DDOSæ”»å‡»`,è®©å¤§é‡åƒåœ¾ä¿¡æ¯æ±¡æŸ“æœåŠ¡å™¨æ¥æ”¶ç«¯å£,ä½¿å…¶ç˜«ç—ª.

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images@master/img/divider.png)

# TCP è¿æ¥

- Server æœåŠ¡ç«¯ä¸ Client å®¢æˆ·ç«¯é€šè¿‡ TCP æ–¹å¼åˆ›å»ºæ•°æ®è¿æ¥.

## Server ç«¯

- å»ºç«‹æœåŠ¡çš„ç«¯å£ ServerScoket

- ç­‰å¾…ç”¨æˆ·çš„è¿æ¥ accept

- æ¥æ”¶ç”¨æˆ·çš„æ¶ˆæ¯

```Java
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.net.ServerSocket;
import java.net.Socket;

public class Server {
  public static void main(String[] args) throws IOException {
    //1ã€æˆ‘å¾—æœ‰ä¸€ä¸ªåœ°å€
    ServerSocket serverSocket = new ServerSocket(9999);

    while (true) { // è¿ç»­æ¥æ”¶æ•°æ®
      //2ã€ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥è¿‡æ¥
      Socket accept = serverSocket.accept();

      //3ã€è¯»å–å®¢æˆ·ç«¯çš„æ¶ˆæ¯
      InputStream inputStream = accept.getInputStream();

      /**
       * é€šå¸¸IOæ–¹å¼,å¦‚æœæ˜¯é•¿æ•°æ®ä¼ è¾“,ä¼šå¯¼è‡´å‡ºé”™
       *
        byte[] buffer = new byte[1024];
        int length;
        while ((length = inputStream.read(buffer)) != -1) {
        String s = new String(buffer, 0, length);
        System.out.println(s);
        }
       */

      //4. ç®¡é“æµæ¥æ”¶æ•°æ®
      ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
      byte[] buffer = new byte[1024];
      int length;
      while ((length = inputStream.read(buffer)) != -1) {
        byteArrayOutputStream.write(buffer, 0, length);
      }
      if (byteArrayOutputStream.toString().matches("quit")) {
        break;
      } else {
        System.out.println(byteArrayOutputStream.toString());
        byteArrayOutputStream.close();
        inputStream.close();
        accept.close();
      }
    }

    //5. æœ€åå…³é—­
    serverSocket.close();
  }
}
```

---

## Client ç«¯

- è¿æ¥æœåŠ¡å™¨ Socket

- å‘é€æ¶ˆæ¯

```Java
import java.io.OutputStream;
import java.net.InetAddress;
import java.net.Socket;

public class Client {
  public static void main(String[] args) throws Exception {
    //1ã€è¦çŸ¥é“æœåŠ¡å™¨çš„åœ°å€ï¼Œç«¯å£å·
    InetAddress address = InetAddress.getLocalHost();

    int port = 9999;

    //2ã€åˆ›å»ºä¸€ä¸ªsocketè¿æ¥
    Socket socket = new Socket(address, port);

    //3ã€å‘é€æ¶ˆæ¯ IOæµ
    OutputStream outputStream = socket.getOutputStream();
    outputStream.write("Weidows connecting here.".getBytes());
    // outputStream.write("quit".getBytes());

    //4.å…³é—­é€šé“
    outputStream.close();
    socket.close();
  }
}
```

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images@master/img/divider.png)

# æ–‡ä»¶ä¼ è¾“

## Server

```Java
import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.ServerSocket;
import java.net.Socket;

public class Server {
  public static void main(String[] args) throws Exception {
    //1ã€åˆ›å»ºæœåŠ¡
    ServerSocket serverSocket = new ServerSocket(9999);

    //2ã€ç›‘å¬å®¢æˆ·ç«¯çš„è¿æ¥
    Socket socket = serverSocket.accept(); //é˜»å¡å¼ç›‘å¬ï¼Œä¼šä¸€ç›´ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥
    System.out.println("Serverå¼€å§‹ç›‘å¬.");

    //3ã€è·å–è¾“å…¥æµ
    InputStream is = socket.getInputStream();

    //4ã€æ–‡ä»¶è¾“å‡º
    FileOutputStream fos = new FileOutputStream(new File("Java/src/main/java/twenty_one/net/file_upload/receive.png"));
    byte[] buffer = new byte[1024];
    int len;
    while ((len = is.read(buffer)) != -1) {
      fos.write(buffer, 0, len);
    }
    System.out.println("Serveræ¥æ”¶å®Œæ¯•.");

    //é€šçŸ¥å®¢æˆ·ç«¯æˆ‘æ¥æ”¶å®Œæ¯•äº†
    OutputStream os = socket.getOutputStream();
    os.write("Serveré€šçŸ¥:æ¥å—å®Œæ¯•ï¼ŒClientå¯ä»¥æ–­å¼€äº†".getBytes());

    //5ã€å…³é—­èµ„æº
    fos.close();
    is.close();
    socket.close();
    serverSocket.close();
    System.out.println("Serverå·²å‘é€éªŒè¯å¹¶æ–­å¼€è¿æ¥.");
  }
  /**
    Serverå¼€å§‹ç›‘å¬.
    Serveræ¥æ”¶å®Œæ¯•.
    Serverå·²å‘é€éªŒè¯å¹¶æ–­å¼€è¿æ¥.
   */
}
```

---

## Client

```Java
import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.InputStream;
import java.io.OutputStream;
import java.net.InetAddress;
import java.net.Socket;

public class Client {
  public static void main(String[] args) throws Exception {
    //1ã€åˆ›å»ºä¸€ä¸ªSocketè¿æ¥
    Socket socket = new Socket(InetAddress.getByName("localhost"), 9999);

    //2ã€åˆ›å»ºä¸€ä¸ªè¾“å‡ºæµ
    OutputStream os = socket.getOutputStream();

    //3ã€è¯»å–æ–‡ä»¶
    FileInputStream fis = new FileInputStream(new File("Java/src/main/java/twenty_one/net/file_upload/upload.png"));

    //4ã€å†™å‡ºæ–‡ä»¶
    byte[] buffer = new byte[1024];
    int len;
    while ((len = fis.read(buffer)) != -1) {
      os.write(buffer, 0, len);
    }
    System.out.println("Clientä¼ è¾“å®Œæ¯•.");

    //é€šçŸ¥æœåŠ¡å™¨ï¼Œæˆ‘å·²ç»ç»“æŸäº†
    socket.shutdownOutput(); //æˆ‘å·²ç»ä¼ è¾“å®Œäº†ï¼

    //ç¡®å®šæœåŠ¡å™¨æ¥æ”¶å®Œæ¯•ï¼Œæ‰èƒ½å¤Ÿæ–­å¼€è¿æ¥
    InputStream inputStream = socket.getInputStream();
    //String byte[]
    ByteArrayOutputStream baos = new ByteArrayOutputStream();
    byte[] buffer2 = new byte[1024];
    int len2;
    while ((len2 = inputStream.read(buffer2)) != -1) {
      baos.write(buffer2, 0, len2);
    }
    System.out.println(baos.toString());

    //5ã€å…³é—­èµ„æº
    baos.close();
    inputStream.close();
    fis.close();
    os.close();
    socket.close();
    System.out.println("Clientå·²æ¥æ”¶åˆ°éªŒè¯å¹¶æ–­å¼€è¿æ¥");
  }
  /**
    Clientä¼ è¾“å®Œæ¯•.
    Serveré€šçŸ¥:æ¥å—å®Œæ¯•ï¼ŒClientå¯ä»¥æ–­å¼€äº†
    Clientå·²æ¥æ”¶åˆ°éªŒè¯å¹¶æ–­å¼€è¿æ¥
   */
}
```

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images@master/img/divider.png)
