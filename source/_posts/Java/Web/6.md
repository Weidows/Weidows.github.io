---
title: ğŸ¥¼JavaWeb~(é™†)
categories:
  - Java
  - Web
tags:
  - JavaWeb
  - Java
  - æœåŠ¡å™¨
  - ç¬”è®°
  - JDBC
date: 2021-04-15 15:28:45
cover: https://cdn.jsdelivr.net/gh/Weidows/Images/hpp/20210322091847.png
top_img:
---

<!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @LastEditors: Weidows
 * @LastEditTime: 2021-05-01 00:07:02
 * @FilePath: \Weidowsd:\Game\Github\Blog-private\source\_posts\Java\Web\6.md
 * @Description:
 * @!: *********************************************************************
-->

- [JDBC(å¤ä¹ )](#jdbcå¤ä¹ )
- [JUnit](#junit)
- [SMBMS](#smbms)
  - [æ­å»º](#æ­å»º)
  - [åç«¯é¡¹ç›®ç»“æ„](#åç«¯é¡¹ç›®ç»“æ„)
  - [è¿æ¥é…ç½®æ–‡ä»¶](#è¿æ¥é…ç½®æ–‡ä»¶)
  - [ORM æ˜ å°„](#orm-æ˜ å°„)
  - [é™æ€åŸºæœ¬ç±»](#é™æ€åŸºæœ¬ç±»)
  - [é¢˜å¤–è¯](#é¢˜å¤–è¯)
  - [å®ç°ç™»å½•](#å®ç°ç™»å½•)
  - [é¡¹ç›®æ€»ç»“æ„](#é¡¹ç›®æ€»ç»“æ„)
- [æ–‡ä»¶ä¼ è¾“](#æ–‡ä»¶ä¼ è¾“)
- [é‚®ä»¶å‘é€](#é‚®ä»¶å‘é€)

# JDBC(å¤ä¹ )

> JDBC è¿æ¥ [ğŸš€ è¿›ä¿® MySQL~(è‚†)](../../MySQL/4#jdbc)

> äº‹åŠ¡ [ğŸš€ è¿›ä¿® MySQL~(ä¼)](../../MySQL/5#ideasql)

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

# JUnit

åœ¨ä¸€ä¸ªæ–¹æ³•ä¸Šæ ‡è®° `@Test` æ³¨è§£å,è¿™ä¸ªæ–¹æ³•å¯ä»¥è„±ç¦» Main ç›´æ¥è¿è¡Œ.

- ä¾èµ– (ä¸€èˆ¬åˆ›å»ºé¡¹ç›®æ—¶è‡ªå¸¦)

  ```xml
  <!--å•å…ƒæµ‹è¯•-->
  <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.12</version>
  </dependency>
  ```

- ä¾‹å­:

  ```Java
  import org.junit.Test;

  public class JDBCTest {
    @Test
    public void test() {
      System.out.println("123");
    }
  }
  ```

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

# SMBMS

> é¡¹ç›®ä»£ç : https://github.com/Weidows/Weidows/tree/master/JavaWeb/SMBMS

- å¯ä»¥æ‹‰å–ä»£ç ç›´æ¥çœ‹,ä¸‹é¢çš„ç¬”è®°ç€é‡è®²`ä»é›¶å¼€å‘çš„æµç¨‹`

- æˆ‘çš„è¿™ä¸ªé¡¹ç›®åº”è¯¥æ˜¯è·‘ä¸èµ·æ¥,åœ¨ web,xml ä¸­ filter é‚£é‡Œæœ‰ä¸ª bug,ä¸è¿‡æ— å¤§ç¢,çŸ¥é“æ€ä¹ˆä¸ªåŸç†å°±å¥½.

---

## æ­å»º

- Maven-webapp é¡¹ç›®,è¡¥å…¨ src/resources,æ·»åŠ ä¾èµ–,è¿æ¥ Tomcat å’Œ MySQL,ä¿®æ”¹ web.xml ç‰ˆæœ¬

  - ä¾èµ–:

    ```xml
      <dependencies>
        <dependency>
          <groupId>junit</groupId>
          <artifactId>junit</artifactId>
          <version>4.13.1</version>
          <scope>compile</scope>
        </dependency>
        <!-- servletä¾èµ– -->
        <dependency>
          <groupId>javax.servlet</groupId>
          <artifactId>javax.servlet-api</artifactId>
          <version>4.0.1</version>
          <scope>provided</scope>
        </dependency>
        <!-- JSPä¾èµ– -->
        <dependency>
          <groupId>javax.servlet.jsp</groupId>
          <artifactId>javax.servlet.jsp-api</artifactId>
          <version>2.3.3</version>
          <scope>provided</scope>
        </dependency>
        <!-- JSTLè¡¨è¾¾å¼ä¾èµ– -->
        <dependency>
          <groupId>javax.servlet</groupId>
          <artifactId>jstl</artifactId>
          <version>1.2</version>
        </dependency>
        <!-- Standardæ ‡ç­¾åº“ -->
        <dependency>
          <groupId>taglibs</groupId>
          <artifactId>standard</artifactId>
          <version>1.1.2</version>
        </dependency>
        <dependency>
          <groupId>org.apache.tomcat</groupId>
          <artifactId>jsp-api</artifactId>
          <version>6.0.13</version>
        </dependency>
        <dependency>
          <groupId>org.junit.jupiter</groupId>
          <artifactId>junit-jupiter-api</artifactId>
          <version>${junit.version}</version>
          <scope>test</scope>
        </dependency>
        <dependency>
          <groupId>org.junit.jupiter</groupId>
          <artifactId>junit-jupiter-engine</artifactId>
          <version>${junit.version}</version>
          <scope>test</scope>
        </dependency>
        <!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java -->
        <dependency>
          <groupId>mysql</groupId>
          <artifactId>mysql-connector-java</artifactId>
          <version>8.0.23</version>
        </dependency>
      </dependencies>
    ```

  - æ›´æ”¹ç‰ˆæœ¬å·:`web.xml`

    ```xml
    <?xml version="1.0" encoding="UTF-8"?>
    <web-app xmlns="http://xmlns.jcp.org/xml/ns/javaee"
            xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
            xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_4_0.xsd"
            version="4.0"
            metadata-complete="true">
      <display-name>Archetype Created Web Application</display-name>

    </web-app>
    ```

---

## åç«¯é¡¹ç›®ç»“æ„

```
|> src/main/java
  |> com
    |> weidows
      |> dao           // data access object (å¯¹åº”pojoçš„CURDç±»)
      |> filter        // è¿‡æ»¤å™¨
      |> pojo          // Plain Ordinary Java Object (å°±æ˜¯ORMæ˜ å°„çš„å®ä½“ç±»,å†…éƒ¨ä¸€èˆ¬åªæœ‰getterå’Œsetter)
      |> service       // ä¸šåŠ¡ç±» (æ“ä½œdao)
      |> servlet       // servletåç«¯
      |> utils         // å·¥å…·ç±»
  |> resources         // èµ„æºæ–‡ä»¶

-------

pojoå¯¹åº”æ•°æ®åº“ä¸­æ¯ä¸ªè®°å½•
-> åœ¨daoä¸­ç¼–å†™æ“ä½œpojoçš„SQL/Javaä»£ç ,å®ç°CURDçš„"æ–¹æ³•"
-> åœ¨serviceä¸­é€šè¿‡Javaç¼–å†™äº‹åŠ¡,å¹¶è°ƒç”¨daoä¸­CURDæ–¹æ³•å®ç°å¢åˆ æ”¹æŸ¥"åŠŸèƒ½"
-> åœ¨servletå°±æ˜¯å¯¹åº”è¯·æ±‚å’Œå“åº”æ¥åšä¸šåŠ¡,è°ƒç”¨serviceä¸­çš„æ–¹æ³•.

-------

pojoä¸ºæœ€åº•å±‚,ä¸æ¶‰åŠå¯¹è±¡å¢åˆ æ“ä½œ
-> daoå±‚
  -> BaseDaoå®ç°åˆ›å»ºconnection/preparedStatementå¯¹è±¡,ä»¥åŠå›æ”¶connection/preparedStatement/resultSetçš„æ–¹æ³•.
  -> è¿›ä¸€æ­¥çš„daoç±»ä¸­è¿›è¡Œåˆ›å»ºresultSetå¯¹è±¡,å¹¶å›æ”¶resultSet/preparedStatementå¯¹è±¡
-> åœ¨serviceå±‚è¿›è¡Œconnectionçš„å…³é—­,æ•è·daoå±‚æŠ›å‡ºçš„å¼‚å¸¸,ä¸”æ­¤å±‚ä¸å†å‘ä¸ŠæŠ›å‡ºå¼‚å¸¸.
```

<img src="https://cdn.jsdelivr.net/gh/Weidows/Images/hpp/20210424112946.png" alt="20210424112946" />

---

## è¿æ¥é…ç½®æ–‡ä»¶

(resources/db.properties)

```properties
driverClassName=com.mysql.cj.jdbc.Driver
url=jdbc:mysql://localhost:3306/smbms?useSSL=false&useUnicode=true&characterEncoding=utf-8
user=root
password=123456
```

---

## ORM æ˜ å°„

(ç¼–å†™ pojo ä¸‹çš„å®ä½“ç±»)

> åˆå§‹åŒ– SQL: https://github.com/Weidows/Weidows/blob/master/JavaWeb/SMBMS/smbms.sql

> pojo: https://github.com/Weidows/Weidows/tree/master/JavaWeb/SMBMS/src/main/java/pojo

---

## é™æ€åŸºæœ¬ç±»

> https://github.com/Weidows/Weidows/blob/master/JavaWeb/SMBMS/src/main/java/dao/BaseDao.java

```Java
package com.weidows.dao;

import java.io.IOException;
import java.io.InputStream;
import java.sql.*;
import java.util.Properties;

/**
 * æ“ä½œæ•°æ®åº“çš„åŸºç±»--é™æ€ç±»
 */
public class BaseDao {

  private static final String driver;
  private static final String url;
  private static final String username;
  private static final String password;

  private static Connection connection = null;
  private static PreparedStatement preparedStatement = null;


  //é™æ€ä»£ç å—,åœ¨ç±»åŠ è½½çš„æ—¶å€™æ‰§è¡Œ
  static {
    String configFile = "db.properties";
    InputStream inputStream = BaseDao.class.getClassLoader().getResourceAsStream(configFile);
    Properties properties = new Properties();
    try {
      properties.load(inputStream);
    } catch (IOException e) {
      e.printStackTrace();
    }
    driver = properties.getProperty("driver");
    url = properties.getProperty("url");
    username = properties.getProperty("username");
    password = properties.getProperty("password");
  }


  /**
   * è·å–æ•°æ®åº“è¿æ¥
   *
   * @return connection
   */
  public static Connection getConnection() {
    if (connection == null) {
      try {
        Class.forName(driver);
        connection = DriverManager.getConnection(url, username, password);
      } catch (Exception e) {
        e.printStackTrace();
      }
    }
    return connection;
  }

  /**
   * æŸ¥è¯¢æ•°æ®åº“çš„å…¬å…±æ“ä½œ
   *
   * @param connection
   * @param rs
   * @param sql
   * @param params
   * @return
   */
  public static ResultSet execute(Connection connection, ResultSet rs, String sql, Object[] params) {
    try {
      preparedStatement = connection.prepareStatement(sql);
      for (int i = 0; i < params.length; i++) {
        preparedStatement.setObject(i + 1, params[i]);
      }
      rs = preparedStatement.executeQuery();
    } catch (SQLException throwables) {
      throwables.printStackTrace();
    }
    return rs;
  }

  /**
   * æ›´æ–°æ•°æ®åº“çš„å…¬å…±æ“ä½œ
   *
   * @param connection
   * @param sql
   * @param params
   * @return
   * @throws Exception
   */
  public static int execute(Connection connection, String sql, Object[] params) {
    int updateRows = 0;
    try {
      preparedStatement = connection.prepareStatement(sql);
      for (int i = 0; i < params.length; i++) {
        preparedStatement.setObject(i + 1, params[i]);
      }
      updateRows = preparedStatement.executeUpdate();
    } catch (SQLException throwables) {
      throwables.printStackTrace();
    }
    return updateRows;
  }

  /**
   * é‡Šæ”¾èµ„æº
   *
   * @param connection
   * @param pstm
   * @param rs
   * @return
   */
  public static boolean closeResource(Connection connection, PreparedStatement pstm, ResultSet rs) {
    boolean flag = true;
    try {
      if (rs != null) {
        rs.close();
        rs = null;//GCå›æ”¶
      }
      if (pstm != null) {
        pstm.close();
        pstm = null;//GCå›æ”¶
      }
      if (connection != null) {
        connection.close();
        connection = null;//GCå›æ”¶
      }
    } catch (SQLException e) {
      e.printStackTrace();
      flag = false;
    }
    return flag;
  }
}
```

---

## é¢˜å¤–è¯

- ä¸€ä¸ªç¼–ç¨‹ä¹¦å†™ä¹ æƒ¯: æ–¹æ³•ä¸­é¦–å…ˆæŠŠéœ€è¦ç”¨åˆ°çš„å˜é‡æå‡º

  å°±åƒè¿™é‡Œçš„ä¸‰ä¸ªå˜é‡,åœ¨ä¸€å¼€å§‹æå‡ºæ¥,å°±åƒæ˜¯ç±»é‡Œé¢çš„ field,ä½¿ç”¨èµ·æ¥æ¯”è¾ƒè§„èŒƒ,å®¹æ˜“æ’æŸ¥

  ```Java
  public User getLoginUser(Connection connection, String userCode) {
    PreparedStatement pstm = null;
    ResultSet resultSet = null;
    User user = null;
    try {
      if (null != connection) {
        String sql = "select * from smbms_user where userCode=?";
        Object[] params = {userCode};
        resultSet = BaseDao.execute(connection, pstm, resultSet, sql, params);
        if (resultSet.next()) {
          user = setData(resultSet);
        }
      }
      BaseDao.closeResource(null, pstm, resultSet);
    } catch (SQLException throwables) {
      throwables.printStackTrace();
    }
    return user;
  }
  ```

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

## å®ç°ç™»å½•

- åœ¨è¿™é‡Œå¤ç°ä¸€ä¸‹"ç™»å½•"ä¸šåŠ¡,å…¶ä»–åŠŸèƒ½ä»¥æ­¤ç±»æ¨.

  è¿™é‡Œç€é‡`è¿‡ç¨‹`(è‡ªä¸Šè€Œä¸‹),å…·ä½“æ€ä¹ˆå®ç°çš„ä¸šåŠ¡å»ºè®®ç»“åˆæºç æ¥å­¦ä¹ .

  > <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/hpp/20210422103020.png" alt="20210422103020" />

  > <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/hpp/20210425232035.png" alt="20210425232035" />

---

- `com/weidows/pojo/User.java`

  > https://github.com/Weidows/Weidows/blob/master/JavaWeb/SMBMS/src/main/java/com/weidows/pojo/User.java

- `com/weidows/dao/user/UserDao.java`

  > https://github.com/Weidows/Weidows/blob/master/JavaWeb/SMBMS/src/main/java/com/weidows/dao/user/UserDao.java

- `com/weidows/dao/user/UserDaoImpl.java`

  > https://github.com/Weidows/Weidows/blob/master/JavaWeb/SMBMS/src/main/java/com/weidows/dao/user/UserDaoImpl.java

- `com/weidows/service/user/UserService.java`

  > https://github.com/Weidows/Weidows/blob/master/JavaWeb/SMBMS/src/main/java/com/weidows/service/user/UserService.java

- `com/weidows/service/user/UserServiceImpl.java`

  > https://github.com/Weidows/Weidows/blob/master/JavaWeb/SMBMS/src/main/java/com/weidows/service/user/UserServiceImpl.java

- å‰ç«¯é¡µé¢

  > https://github.com/Weidows/Weidows/blob/master/JavaWeb/SMBMS/src/main/webapp/login.jsp

- å¯¹åº”å‰ç«¯çš„å¸¸é‡ç±»

  > https://github.com/Weidows/Weidows/blob/master/JavaWeb/SMBMS/src/main/java/com/weidows/util/Constants.java

- å¯¹åº” User çš„ servlet ç±»

  > https://github.com/Weidows/Weidows/blob/master/JavaWeb/SMBMS/src/main/java/com/weidows/servlet/user/UserServlet.java

- ç™»å½• servlet ç±»

  > https://github.com/Weidows/Weidows/blob/master/JavaWeb/SMBMS/src/main/java/com/weidows/servlet/user/LoginServlet.java

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

## é¡¹ç›®æ€»ç»“æ„

> <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/hpp/20210426105422.png" alt="20210426105422" />

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

# æ–‡ä»¶ä¼ è¾“

- åˆ©ç”¨åˆ°äº† Commons-io,é€šè¿‡ http å’Œ servlet ä¼ è¾“æµæ–‡ä»¶.

  ```Java
  import org.apache.commons.fileupload.FileItem;
  import org.apache.commons.fileupload.FileUploadException;
  import org.apache.commons.fileupload.disk.DiskFileItemFactory;
  import org.apache.commons.fileupload.servlet.ServletFileUpload;

  import javax.servlet.ServletException;
  import javax.servlet.http.HttpServlet;
  import javax.servlet.http.HttpServletRequest;
  import javax.servlet.http.HttpServletResponse;
  import java.io.File;
  import java.io.FileOutputStream;
  import java.io.IOException;
  import java.io.InputStream;
  import java.util.List;
  import java.util.UUID;


  /**
  * Servlet implementation class FileServlet
  */
  public class FileServlet extends HttpServlet {
    private static final long serialVersionUID = 1L;

    @Override
    protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
      doPost(req, resp);
    }

    /**
    * @see HttpServlet#doGet(HttpServletRequest request, HttpServletResponse response)
    */
    protected void doPost(HttpServletRequest request, HttpServletResponse response)
        throws ServletException, IOException {

      // åˆ¤æ–­ä¸Šä¼ çš„æ–‡ä»¶æ™®é€šè¡¨å•è¿˜æ˜¯å¸¦æ–‡ä»¶çš„è¡¨å•
      if (!ServletFileUpload.isMultipartContent(request)) {
        return;//ç»ˆæ­¢æ–¹æ³•è¿è¡Œ,è¯´æ˜è¿™æ˜¯ä¸€ä¸ªæ™®é€šçš„è¡¨å•,ç›´æ¥è¿”å›
      }

      // åˆ›å»ºä¸Šä¼ æ–‡ä»¶çš„ä¿å­˜è·¯å¾„ï¼Œå»ºè®®åœ¨WEB-INFè·¯å¾„ä¸‹ï¼Œå®‰å…¨ï¼Œç”¨æˆ·æ— æ³•ç›´æ¥è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶
      String tmpPath = this.getServletContext().getRealPath("/WEB-INF/tmp");
      File tempFile = new File(tmpPath);
      if (!tempFile.exists()) {
        tempFile.mkdir();//åˆ›å»ºä¸´æ—¶ç›®å½•
      }

      //åˆ›å»ºä¸Šä¼ æ–‡ä»¶çš„ä¿å­˜è·¯å¾„,å»ºè®®åœ¨WEB-INFè·¯å¾„ä¸‹,å®‰å…¨,ç”¨æˆ·æ— æ³•ç›´æ¥è®¿é—´ä¸Šä¼ çš„æ–‡ä»¶;
      String uploadPath = this.getServletContext().getRealPath("/WEB-INF/upload");
      File uploadFile = new File(uploadPath);
      if (!uploadFile.exists()) {
        uploadFile.mkdir(); //åˆ›å»ºè¿™ä¸ªæœˆå½•
      }

      /*
        å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶,ä¸€èˆ¬éƒ½éœ€è¦é€šè¿‡æµæ¥è·å–,æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ request.getInputStream(),åŸç”Ÿæ€çš„æ–‡ä»¶ä¸Šä¼ æµè·å–,ååˆ†éº»çƒ¦
        å»ºè®®ä½¿ç”¨ Apacheçš„æ–‡ä»¶ä¸Šä¼ ç»„ä»¶æ¥å®ç°, common-fileUpload,å®ƒéœ€è¦ commons-ioç»„ä»¶
      */
      try {
        // è·å–ServletFileUpload
        ServletFileUpload fileUpload = getServletFileUpload(tempFile);

        // å¤„ç†ä¸Šä¼ æ–‡ä»¶
        // æŠŠå‰ç«¯è¯·æ±‚è§£æï¼Œå°è£…æˆFileItemå¯¹è±¡ï¼Œéœ€è¦ä»ServletFileUploadå¯¹è±¡ä¸­è·å–
        boolean flag = uploadParseRequest(fileUpload, request, uploadPath);

        // Servletè¯·æ±‚è½¬å‘æ¶ˆæ¯
        if (flag) {
          // Servletè¯·æ±‚è½¬å‘æ¶ˆæ¯
          request.setAttribute("flag", true);
        } else {
          request.setAttribute("flag", false);
        }
        request.getRequestDispatcher("info.jsp").forward(request, response);
      } catch (FileUploadException e) {
        e.printStackTrace();
      }
    }


    public static ServletFileUpload getServletFileUpload(File tempFile) {
      // åˆ›å»ºDiskFileItemFactoryå¯¹è±¡ï¼Œå¤„ç†æ–‡ä»¶è·¯å¾„æˆ–è€…å¤§å°é™åˆ¶
      DiskFileItemFactory factory = new DiskFileItemFactory();
      // é€šè¿‡è¿™ä¸ªå·¥å‚è®¾ç½®ä¸€ä¸ªç¼“å†²åŒº,å½“ä¸Šä¼ çš„æ–‡ä»¶å¤§äºè¿™ä¸ªç¼“å†²åŒºçš„æ—¶å€™,å°†ä»–æ”¾åˆ°ä¸´æ—¶æ–‡ä»¶ä¸­;
      factory.setSizeThreshold((int) 2e20);// ç¼“å†²åŒºå¤§å°ä¸º1M
      factory.setRepository(tempFile);// ä¸´æ—¶ç›®å½•çš„ä¿å­˜ç›®å½•,éœ€è¦ä¸€ä¸ªfile

      ServletFileUpload servletFileUpload = new ServletFileUpload(factory);
      // å¤„ç†ä¹±ç é—®é¢˜
      servletFileUpload.setHeaderEncoding("UTF-8");
      // è®¾ç½®æ€»å…±èƒ½å¤Ÿä¸Šä¼ æ–‡ä»¶çš„å¤§å° 10M
      servletFileUpload.setFileSizeMax((long) 2e21);

      /*
        ç›‘å¬é•¿ä¼ è¿›åº¦
          pBytesRead:å·²è¯»å–åˆ°çš„æ–‡ä»¶å¤§å°
          pContextLength:æ–‡ä»¶å¤§å°
      */
      servletFileUpload.setProgressListener((long pBytesRead, long pContentLength, int pItems) -> System.out.println("å·²ä¸Šä¼ ï¼š" + pBytesRead + "\næ€»å¤§å°ï¼š" + pContentLength));
      return servletFileUpload;
    }

    public static boolean uploadParseRequest(ServletFileUpload upload, HttpServletRequest request, String uploadPath)
        throws FileUploadException, IOException {
      boolean flag = false; // æ˜¯å¦æˆåŠŸ

      // æŠŠå‰ç«¯è¯·æ±‚è§£æï¼Œå°è£…æˆFileItemå¯¹è±¡
      List<FileItem> fileItems = upload.parseRequest(request);
      for (FileItem fileItem : fileItems) {
        // åˆ¤æ–­ä¸Šä¼ çš„æ–‡ä»¶æ˜¯æ™®é€šçš„è¡¨å•è¿˜æ˜¯å¸¦æ–‡ä»¶çš„è¡¨å•
        if (fileItem.isFormField()) {
          // getFieldNameæŒ‡çš„æ˜¯å‰ç«¯è¡¨å•æ§ä»¶çš„name;
          String name = fileItem.getFieldName();
          String value = fileItem.getString("UTF-8"); // å¤„ç†ä¹±ç 
          System.out.println(name + ": " + value);
        } else {

          // ============å¤„ç†æ–‡ä»¶==============
          // æ‹¿åˆ°æ–‡ä»¶å
          String uploadFileName = fileItem.getName();
          /*
            .trim() åˆ é™¤å‰åç©ºæ ¼
            ä¸‹é¢çš„å†™æ³•ä¼šå¯¼è‡´"uploadFileName == null" ä¸€ç›´åˆ¤å®šä¸ºfalse :
              uploadFileName.trim().equals("") || uploadFileName == null
              åè¿‡æ¥å°±å¥½äº†,åŸå› æ˜¯å­—ç¬¦ä¸²å¯¹è±¡å¼•ç”¨æ”¹å˜äº†
          */
          if (uploadFileName == null || uploadFileName.trim().equals("")) {
            continue;
          }

          // è·å¾—ä¸Šä¼ çš„æ–‡ä»¶å
          String fileName = uploadFileName.substring(uploadFileName.lastIndexOf("/") + 1);
          // è·å¾—æ–‡ä»¶çš„åç¼€å,å¦‚æœæ–‡ä»¶åç¼€åfileExtNameä¸æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ å°±ç›´æŒ‰return.ä¸å¤„ç†,å‘Šè¯‰ç”¨æˆ·æ–‡ä»¶ç±»å‹ä¸å¯¹ã€‚
          String fileExtName = uploadFileName.substring(uploadFileName.lastIndexOf(".") + 1);

          System.out.println("æ–‡ä»¶å: " + fileName + "\nåç¼€å" + fileExtName);
          // ================å¤„ç†æ–‡ä»¶å®Œæ¯•==============


          /*
            UUID.randomUUID(),éšæœºç”Ÿä¸€ä¸ªå”¯ä¸€è¯†åˆ«çš„é€šç”¨ç ,ä¿è¯æ–‡ä»¶å¤¹åå”¯ä¸€
            æ–‡ä»¶çœŸå®å­˜åœ¨çš„è·¯å¾„ realPath
          */
          String realPath = uploadPath + "/" + UUID.randomUUID();

          // ç»™æ¯ä¸ªæ–‡ä»¶åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„æ–‡ä»¶å¤¹
          File realPathFile = new File(realPath);
          if (!realPathFile.exists()) {
            realPathFile.mkdir();
          }
          // ==============å­˜æ”¾åœ°å€å®Œæ¯•==============


          // è·å¾—æ–‡ä»¶ä¸Šä¼ çš„æµ
          InputStream inputStream = fileItem.getInputStream();
          // åˆ›å»ºä¸€ä¸ªæ–‡ä»¶è¾“å‡ºæµ
          FileOutputStream fileOutputStream = new FileOutputStream(realPath + "/" + fileName);

          // åˆ›å»ºä¸€ä¸ªç¼“å†²åŒº
          byte[] buffer = new byte[(int) 2e20]; // 1M
          int len;
          while ((len = inputStream.read(buffer)) > 0) {
            fileOutputStream.write(buffer, 0, len);
          }

          // å…³é—­æµ
          fileOutputStream.close();
          inputStream.close();

          flag = true;
          // ä¸Šä¼ æˆåŠŸ,æ¸…é™¤ä¸´æ—¶æ–‡ä»¶
          fileItem.delete();
          //=============æ–‡ä»¶ä¼ è¾“å®Œæˆ=============
        }
      }
      return flag;
    }
  }
  ```

- é¡¹ç›®åœ°å€

  åŒ…å«ç”¨åˆ°çš„ JSP é¡µé¢å’Œ xml é…ç½®æ–‡ä»¶

  > https://github.com/Weidows/Weidows/tree/master/JavaWeb/Last

- é—®é¢˜: å¦‚æœ Tomcat æ˜¯ 10 ç‰ˆæœ¬çš„,è¿è¡Œæ—¶ä¼šå‡ºç° 500

  > [servlet é…ç½®ç›¸å…³ï¼šHTTP çŠ¶æ€ 500 - å†…éƒ¨æœåŠ¡å™¨é”™è¯¯é—®é¢˜](https://blog.csdn.net/m0_50905990/article/details/115339679)

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

# é‚®ä»¶å‘é€

- åŸç†å›¾:

  <img src="https://i.loli.net/2021/05/01/uSCWFmtpziQh36O.png" alt="é‚®ä»¶ä¼ è¾“åŸç†.drawio" />
