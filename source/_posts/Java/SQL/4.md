---
title: ğŸš€è¿›ä¿®MySQL~(è‚†)
tags:
  - Java
  - MySQL
  - ç¬”è®°
  - JDBC
date: 2021-03-17 14:41:19
cover: https://cdn.jsdelivr.net/gh/Weidows/Images/post/20210304000514.png
top_img:
---

<!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @LastEditors: Weidows
 * @LastEditTime: 2021-03-20 17:34:17
 * @FilePath: \Weidowsd:\Game\Github\Blog-private\source\_posts\Java\MySQL\4.md
 * @Description:
 * @!: *********************************************************************
-->

- [ç”¨æˆ·/æƒé™ç®¡ç†](#ç”¨æˆ·æƒé™ç®¡ç†)
  - [åŸºæœ¬æ“ä½œ](#åŸºæœ¬æ“ä½œ)
  - [æƒé™è§£é‡Š](#æƒé™è§£é‡Š)
  - [è¡¨ç»´æŠ¤](#è¡¨ç»´æŠ¤)
- [å¯¼å‡º&å¯¼å…¥](#å¯¼å‡ºå¯¼å…¥)
- [è®¾è®¡æ•°æ®åº“](#è®¾è®¡æ•°æ®åº“)
- [ä¸‰å¤§èŒƒå¼](#ä¸‰å¤§èŒƒå¼)
  - [ç¬¬ä¸€èŒƒå¼](#ç¬¬ä¸€èŒƒå¼)
  - [ç¬¬äºŒèŒƒå¼](#ç¬¬äºŒèŒƒå¼)
  - [ç¬¬ä¸‰èŒƒå¼](#ç¬¬ä¸‰èŒƒå¼)
  - [æ€§èƒ½è€ƒé‡](#æ€§èƒ½è€ƒé‡)
- [JDBC](#jdbc)
  - [HelloWorld](#helloworld)
  - [å¯¹è±¡æ“ä½œ](#å¯¹è±¡æ“ä½œ)
  - [è§£è€¦æ¡ˆä¾‹](#è§£è€¦æ¡ˆä¾‹)
    - [Utils](#utils)
    - [CRUD](#curd)

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

## ç”¨æˆ·/æƒé™ç®¡ç†

### åŸºæœ¬æ“ä½œ

```SQL
/*
  ç”¨æˆ·ä¿¡æ¯è¡¨ï¼šmysql.user
*/

-- åˆ·æ–°æƒé™
FLUSH PRIVILEGES;

/*
  å¢åŠ ç”¨æˆ·
  å¿…é¡»æ‹¥æœ‰mysqlæ•°æ®åº“çš„å…¨å±€CREATE USERæƒé™ï¼Œæˆ–æ‹¥æœ‰INSERTæƒé™ã€‚
  ç”¨æˆ·å/å¯†ç æ³¨æ„åŠ å¼•å·ï¼Œå¦‚ 'user_name'@'192.168.1.1'
*/
CREATE USER weidows IDENTIFIED BY '123456';

-- é‡å‘½åç”¨æˆ·
RENAME USER weidows TO weidows2;

-- åˆ é™¤ç”¨æˆ·
DROP USER weidows2;

-- è®¾ç½®å¯†ç 
-- ä¸ºå½“å‰ç”¨æˆ·è®¾ç½®å¯†ç 
SET PASSWORD = PASSWORD ('å¯†ç ');
-- ä¸ºæŒ‡å®šç”¨æˆ·è®¾ç½®å¯†ç 
SET PASSWORD FOR ç”¨æˆ·å = PASSWORD ('å¯†ç ');
-- ä¸Šé¢ä¸¤ç§æŠ¥é”™çš„è¯
ALTER USER root@localhost IDENTIFIED BY 'å¯†ç ';

/*
  æˆäºˆæƒé™
  GRANT æƒé™åˆ—è¡¨ ON è¡¨å TO ç”¨æˆ·å [IDENTIFIED BY [PASSWORD] 'password']
    all privileges è¡¨ç¤ºæ‰€æœ‰æƒé™
    *.* è¡¨ç¤ºæ‰€æœ‰åº“çš„æ‰€æœ‰è¡¨
    åº“å.è¡¨å è¡¨ç¤ºæŸåº“ä¸‹é¢çš„æŸè¡¨
  åªæœ‰rootç”¨æˆ·æ‹¥æœ‰grantæƒé™,å…¶ä»–ç”¨æˆ·æ— æ³•å¼€å¯.
*/
GRANT ALL PRIVILEGES ON *.* TO weidows IDENTIFIED BY '123456';

-- æŸ¥çœ‹æƒé™
SHOW GRANTS FOR root@localhost;
-- æŸ¥çœ‹å½“å‰ç”¨æˆ·æƒé™
SHOW GRANTS;
SHOW GRANTS FOR CURRENT_USER;
SHOW GRANTS FOR CURRENT_USER();

/**
  æ’¤æ¶ˆæƒé™
  REVOKE æƒé™åˆ—è¡¨ ON è¡¨å FROM ç”¨æˆ·å
 */
REVOKE ALL PRIVILEGES ON *.* FROM weidows;
```

---

### æƒé™è§£é‡Š

- (æŸ¥è¯¢ç”¨,ä¸ç”¨ç¡¬è®°)

```
ALL [PRIVILEGES]    -- è®¾ç½®é™¤GRANT OPTIONä¹‹å¤–çš„æ‰€æœ‰ç®€å•æƒé™
ALTER    -- å…è®¸ä½¿ç”¨ALTER TABLE
ALTER ROUTINE    -- æ›´æ”¹æˆ–å–æ¶ˆå·²å­˜å‚¨çš„å­ç¨‹åº
CREATE    -- å…è®¸ä½¿ç”¨CREATE TABLE
CREATE ROUTINE    -- åˆ›å»ºå·²å­˜å‚¨çš„å­ç¨‹åº
CREATE TEMPORARY TABLES        -- å…è®¸ä½¿ç”¨CREATE TEMPORARY TABLE
CREATE USER        -- å…è®¸ä½¿ç”¨CREATE USER, DROP USER, RENAME USERå’ŒREVOKE ALL PRIVILEGESã€‚
CREATE VIEW        -- å…è®¸ä½¿ç”¨CREATE VIEW
DELETE    -- å…è®¸ä½¿ç”¨DELETE
DROP    -- å…è®¸ä½¿ç”¨DROP TABLE
EXECUTE        -- å…è®¸ç”¨æˆ·è¿è¡Œå·²å­˜å‚¨çš„å­ç¨‹åº
FILE    -- å…è®¸ä½¿ç”¨SELECT...INTO OUTFILEå’ŒLOAD DATA INFILE
INDEX     -- å…è®¸ä½¿ç”¨CREATE INDEXå’ŒDROP INDEX
INSERT    -- å…è®¸ä½¿ç”¨INSERT
LOCK TABLES        -- å…è®¸å¯¹æ‚¨æ‹¥æœ‰SELECTæƒé™çš„è¡¨ä½¿ç”¨LOCK TABLES
PROCESS     -- å…è®¸ä½¿ç”¨SHOW FULL PROCESSLIST
REFERENCES    -- æœªè¢«å®æ–½
RELOAD    -- å…è®¸ä½¿ç”¨FLUSH
REPLICATION CLIENT    -- å…è®¸ç”¨æˆ·è¯¢é—®ä»å±æœåŠ¡å™¨æˆ–ä¸»æœåŠ¡å™¨çš„åœ°å€
REPLICATION SLAVE    -- ç”¨äºå¤åˆ¶å‹ä»å±æœåŠ¡å™¨ï¼ˆä»ä¸»æœåŠ¡å™¨ä¸­è¯»å–äºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶ï¼‰
SELECT    -- å…è®¸ä½¿ç”¨SELECT
SHOW DATABASES    -- æ˜¾ç¤ºæ‰€æœ‰æ•°æ®åº“
SHOW VIEW    -- å…è®¸ä½¿ç”¨SHOW CREATE VIEW
SHUTDOWN    -- å…è®¸ä½¿ç”¨mysqladmin shutdown
SUPER    -- å…è®¸ä½¿ç”¨CHANGE MASTER, KILL, PURGE MASTER LOGSå’ŒSET GLOBALè¯­å¥ï¼Œmysqladmin debugå‘½ä»¤ï¼›å…è®¸æ‚¨è¿æ¥ï¼ˆä¸€æ¬¡ï¼‰ï¼Œå³ä½¿å·²è¾¾åˆ°max_connectionsã€‚
UPDATE    -- å…è®¸ä½¿ç”¨UPDATE
USAGE    -- â€œæ— æƒé™â€çš„åŒä¹‰è¯
GRANT OPTION    -- å…è®¸æˆäºˆæƒé™
```

---

### è¡¨ç»´æŠ¤

- `äº†è§£`

```SQL
-- åˆ†æå’Œå­˜å‚¨è¡¨çš„å…³é”®å­—åˆ†å¸ƒ
ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE è¡¨å ...

-- æ£€æŸ¥ä¸€ä¸ªæˆ–å¤šä¸ªè¡¨æ˜¯å¦æœ‰é”™è¯¯
CHECK TABLE tbl_name [, tbl_name] ... [option] ...
option = {QUICK | FAST | MEDIUM | EXTENDED | CHANGED}

-- æ•´ç†æ•°æ®æ–‡ä»¶çš„ç¢ç‰‡
OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...
```

---

## å¯¼å‡º&å¯¼å…¥

- å¯ä»¥ç”¨ SQL GUI ç¨‹åºæ“ä½œ,ä¸‹é¢ä»‹ç»å‘½ä»¤è¡Œæ“ä½œ

- å¯¼å‡º

  - å¯ä»¥åŠ ä¸Š-w æºå¸¦å¤‡ä»½æ¡ä»¶
  - -xxx åé¢ä¸åŠ ç©ºæ ¼,ç›´æ¥å¸¦ä¸Šå‚æ•°

  ***

  1. å¯¼å‡ºä¸€å¼ è¡¨ mysqldump -u ç”¨æˆ·å -p å¯†ç  åº“å è¡¨å > æ–‡ä»¶å(D:/a.sql)

  ```
  mysqldump -uroot -p123456 school student >D:/a.sql
  ```

  2. å¯¼å‡ºå¤šå¼ è¡¨ mysqldump -u ç”¨æˆ·å -p å¯†ç  åº“å è¡¨ 1 è¡¨ 2 è¡¨ 3 > æ–‡ä»¶å(D:/a.sql)

  ```
  mysqldump -uroot -p123456 school student result >D:/a.sql
  ```

  3. å¯¼å‡ºæ‰€æœ‰è¡¨ mysqldump -u ç”¨æˆ·å -p å¯†ç  åº“å > æ–‡ä»¶å(D:/a.sql)

  ```
  mysqldump -uroot -p123456 school >D:/a.sql
  ```

  4. å¯¼å‡ºä¸€ä¸ªåº“ mysqldump -u ç”¨æˆ·å -p å¯†ç  -B åº“å > æ–‡ä»¶å(D:/a.sql)

  ```
  mysqldump -uroot -p123456 -B school >D:/a.sql
  ```

---

- å¯¼å…¥

  1. åœ¨å·²ç»ç™»å½• mysql,åˆ‡æ¢åˆ°æŒ‡å®šæ•°æ®åº“çš„æƒ…å†µä¸‹: source å¤‡ä»½æ–‡ä»¶

  ```
  source D:/a.sql
  ```

  2. åœ¨ä¸ç™»å½•çš„æƒ…å†µä¸‹: mysql -u ç”¨æˆ·å -p å¯†ç  [åº“å] < å¤‡ä»½æ–‡ä»¶ (å¦‚æœå¯¼å…¥ä¸€ä¸ªåº“çš„è¯å°±ä¸åŠ åº“å)

  ```
  mysql -uroot -p123456 school <D:/a.sql
  ```

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

## è®¾è®¡æ•°æ®åº“

- ç›®çš„:

  1. èŠ‚çœæ•°æ®å­˜å‚¨ç©ºé—´
  2. ä¿è¯æ•°æ®çš„å®Œæ•´æ€§
  3. æ–¹ä¾¿è¿›è¡Œæ•°æ®åº“åº”ç”¨ç³»ç»Ÿçš„å¼€å‘

  ***

- é˜¶æ®µè®¾è®¡

  1. éœ€æ±‚åˆ†æ: åˆ†æå®¢æˆ·çš„ä¸šåŠ¡å’Œæ•°æ®å¤„ç†éœ€æ±‚
  2. æ¦‚è¦è®¾è®¡: è®¾è®¡æ•°æ®åº“çš„ E-R æ¨¡å‹å›¾ , ç¡®è®¤éœ€æ±‚ä¿¡æ¯çš„æ­£ç¡®å’Œå®Œæ•´.
  3. æ”¶é›†ä¿¡æ¯: æœé›†ä¸éœ€æ±‚ç›¸å…³çš„ä¿¡æ¯éœ€æ±‚.

     1. é¡µé¢ A
     2. åŠŸèƒ½ B
     3. ç‰¹æ®Šéœ€æ±‚ C
     4. è‡ªå®šä¹‰ D
     5. ...

  4. æ ‡è¯†å®ä½“: æ ‡è¯†æ•°æ®åº“æ‰€è¦ç®¡ç†çš„å¯¹è±¡,è¯¦ç»†ä¿¡æ¯(Attribute)ä»¥åŠå…³ç³»(Relationship)

     1. å†™åšå®¢ user -> blog
     2. åˆ†ç±» blog -> category
     3. è¯„è®º user(ä½œè€…) -> user(è¯„è®ºè€…) -> blog(åšå®¢é¡µé¢)
     4. ...

---

## ä¸‰å¤§èŒƒå¼

> [æ•°æ®åº“è®¾è®¡çš„ä¸‰å¤§èŒƒå¼é€šä¿—è®²è§£](https://blog.csdn.net/scarecrow_fly/article/details/102170042)

- ä¸‰å¤§èŒƒå¼å‡ºç°ä¸ºäº†è§£å†³ä¸€ä¸‹å››ç§é—®é¢˜

  - ä¿¡æ¯é‡å¤

  - æ›´æ–°å¼‚å¸¸

  - æ’å…¥å¼‚å¸¸

  - åˆ é™¤å¼‚å¸¸

---

### ç¬¬ä¸€èŒƒå¼

> ç¡®ä¿æ¯åˆ—çš„`åŸå­æ€§`,æ¯åˆ—éƒ½æ˜¯ä¸å¯å†åˆ†çš„æœ€å°æ•°æ®å•å…ƒ

> <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/post/20210317202650.png" alt="20210317202650" />

- ä¸Šé¢å®¶åº­ä¿¡æ¯å’Œå­¦æ ¡ä¿¡æ¯éƒ½å¯ä»¥å†æ‹†åˆ†ä¸ºä¸¤åˆ—

---

### ç¬¬äºŒèŒƒå¼

> å¿…é¡»åœ¨æ»¡è¶³ç¬¬ä¸€èŒƒå¼çš„æ¡ä»¶ä¸‹: æ¯ä¸ªè¡¨åªåšä¸€ä»¶äº‹(`æ¯è¡Œæœ‰å”¯ä¸€æ ‡è¯†`,å…¶ä»–æ•°æ®åªä¾èµ–äºæ­¤æ ‡è¯†åˆ—)

> <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/post/20210317203230.png" alt="20210317203230" />

- ç®€å•æ¥è®²å°±æ˜¯æ ‡è¯†åˆ—å’Œå…¶ä»–åˆ—æœ‰å…±åŒé‡å¤æ•°æ®è¡Œ,é‚£ä¹ˆ`æ ‡è¯†åˆ—`å’Œ`æœ‰é‡å¤æ•°æ®çš„åˆ—`å¯ä»¥åˆ†åˆ°å¦ä¸€ä¸ªè¡¨

  <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/post/20210317203601.png" alt="20210317203601" />

---

### ç¬¬ä¸‰èŒƒå¼

> åœ¨ç¬¬äºŒèŒƒå¼åŸºç¡€ä¸Š,å…¶ä»–åˆ—æ•°æ®å¿…é¡»ä¸æ ‡è¯†åˆ—æ•°æ®æœ‰ç›´æ¥å…³ç³»

> <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/post/20210317204105.png" alt="20210317204105" />

- ä¹Ÿå°±æ˜¯è¯´ä¸å­˜åœ¨æ ‡è¯†åˆ—ä¸å…¶ä»–åˆ—å…±åŒé‡å¤äº†,ä½†è¿˜æ˜¯å¯èƒ½å­˜åœ¨å¤šä¸ªå…¶ä»–åˆ—æœ‰å…±åŒé‡å¤(ç­ä¸»ä»»çš„é‚£ä¸‰åˆ—æœ‰å…±åŒé‡å¤æ•°æ®)

- æŠŠç­ä¸»ä»»åˆ†å‡ºå»

  <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/post/20210317204341.png" alt="20210317204341" />

---

### æ€§èƒ½è€ƒé‡

> `å…³è”æŸ¥è¯¢ä¸èƒ½è¶…è¿‡ä¸‰å¼ è¡¨`.

- å®é™…åº”ç”¨ä¸­éœ€è¦è€ƒè™‘å¤šè¡¨çš„é¢å¤–å¼€é”€

- å¦‚æœä¸è§„èŒƒç¨‹åº¦ä½,è€Œä¸”æ€§èƒ½éœ€æ±‚é«˜çš„åœºæ™¯,åˆ™éœ€è¦è€ƒè™‘æ˜¯å¦éµå¾ªèŒƒå¼.

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

## JDBC

### HelloWorld

<img src="https://cdn.jsdelivr.net/gh/Weidows/Images/post/20210319102812.png" alt="20210319102812" />

- å·¥å…·ç±» (Java è‡ªå¸¦)

  - java.sql
  - javax.sql

- SQL é©±åŠ¨éœ€è¦å¯¼å…¥(åœ¨ pom.xml ä¸­)

  - mysql-connector-java-ç‰ˆæœ¬å· jar

  ```xml
  <!-- https://mvnrepository.com/artifact/mysql/mysql-connector-java -->
  <dependency>
      <groupId>mysql</groupId>
      <artifactId>mysql-connector-java</artifactId>
      <version>8.0.23</version>
  </dependency>
  ```

---

- åˆ›å»ºæ•°æ®åº“

  ```SQL
  CREATE DATABASE jdbcStudy CHARACTER SET utf8 COLLATE utf8_general_ci;

  USE jdbcStudy;

  CREATE TABLE `users`
  (
    id       INT PRIMARY KEY,
    NAME     VARCHAR(40),
    PASSWORD VARCHAR(40),
    email    VARCHAR(60),
    birthday DATE
  );

  INSERT INTO `users`(id, NAME, PASSWORD, email, birthday)
  VALUES (1, 'zhansan', '123456', 'zs@sina.com', '1980-12-04'),
        (2, 'lisi', '123456', 'lisi@sina.com', '1981-12-04'),
        (3, 'wangwu', '123456', 'wangwu@sina.com', '1979-12-04');
  ```

- è¿æ¥,helloworld

  ```Java
  import java.sql.Connection;
  import java.sql.DriverManager;
  import java.sql.ResultSet;
  import java.sql.SQLException;
  import java.sql.Statement;

  import com.mysql.cj.jdbc.Driver;

  public class JDBCFirstDemo {
    public static void main(String[] args) throws ClassNotFoundException, SQLException {
      /**
       * 1.è®¾ç½®ç”¨æˆ·ä¿¡æ¯
          useUnicode = true æ”¯æŒä¸­æ–‡ç¼–ç 
          characterEncoding = utf8 è®¾å®šå­—ç¬¦é›†
          useSSL = true å®‰å…¨è¿æ¥
      */
      String url = "jdbc:mysql://localhost:3306/jdbcStudy?useUnicode = true & characterEncoding = utf8 & useSSL = true";
      String user = "root";
      String password = "123456";

      //2.åŠ è½½é©±åŠ¨(å›ºå®šå†™æ³•,äºŒé€‰ä¸€)
      // Class.forName("com.mysql.cj.jdbc.Driver");
      DriverManager.registerDriver(new Driver());

      /**
       * 3.è¿æ¥ï¼Œæ•°æ®åº“å¯¹è±¡ Connection ä»£è¡¨æ•°æ®åº“
          //äº‹åŠ¡æäº¤
          connection.commit();
          //äº‹åŠ¡å›æ»š
          connection.rollback();
          //æ•°æ®åº“è®¾ç½®è‡ªåŠ¨æäº¤
          connection.setAutoCommit(true);
      */
      Connection connection = DriverManager.getConnection(url, user, password);

      //4.åˆ›å»ºSQLçš„å¯¹è±¡
      Statement statement = connection.createStatement();
      String sql = "SELECT * FROM users";

      //5.æ‰§è¡ŒSQLçš„å¯¹è±¡,æŸ¥çœ‹è¿”å›ç»“æœ
      ResultSet resultSet = statement.executeQuery(sql); //è¿”å›çš„ç»“æœé›†
      while (resultSet.next()) {
        System.out.println("id = " + resultSet.getObject("id"));
        System.out.println("name = " + resultSet.getObject("NAME"));
        System.out.println("password = " + resultSet.getObject("PASSWORD"));
        System.out.println("email = " + resultSet.getObject("email"));
        System.out.println("birthday = " + resultSet.getObject("birthday"));
        System.out.println("===============================================================");
      }

      //6.é‡Šæ”¾è¿æ¥
      resultSet.close();
      statement.close();
      connection.close();
    }

  }
  ```

  ***

- æ‰§è¡Œç»“æœ

  ```
  id = 1
  name = zhansan
  password = 123456
  email = zs@sina.com
  birthday = 1980-12-04
  ===============================================================
  id = 2
  name = lisi
  password = 123456
  email = lisi@sina.com
  birthday = 1981-12-04
  ===============================================================
  id = 3
  name = wangwu
  password = 123456
  email = wangwu@sina.com
  birthday = 1979-12-04
  ===============================================================
  ```

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

### å¯¹è±¡æ“ä½œ

- connection

  - connection.rollback();
  - connection.commit();
  - connection.setAutoCommit();

---

- statement

  - statement.executeQuery(); æ‰§è¡ŒæŸ¥è¯¢ SQL
  - statement.execute(); å¯ä»¥æ‰§è¡Œä»»ä½• SQL æŒ‡ä»¤
  - statement.executeUpdate(); æ›´æ–°ï¼Œæ’å…¥ï¼Œåˆ é™¤ï¼Œè¿”å›å—å½±å“çš„è¡Œæ•°
  - statement.executeBatch(); æ‰§è¡Œä¸€ç»„ SQL

---

- ResultSet

  - resultSet.getObject(); åœ¨ä¸çŸ¥é“åˆ—ç±»å‹ä¸‹ä½¿ç”¨
  - resultSet.getString(); å¦‚æœçŸ¥é“åˆ™æŒ‡å®šä½¿ç”¨
  - resultSet.getInt();
  - ...

  ***

  - resultSet.next(); ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ª
  - resultSet.previous(); ç§»åŠ¨åˆ°ä¸Šä¸€ä¸ª
  - resultSet.beforeFirst(); ç§»åŠ¨åˆ°æœ€å‰
  - resultSet.afterLast(); ç§»åŠ¨åˆ°æœ€å
  - resultSet.absolute(row); ç§»åŠ¨åˆ°æŒ‡å®šè¡Œ

---

### è§£è€¦æ¡ˆä¾‹

- ä¸Šé¢çš„ JDBC åŒ…æ‹¬åŠ è½½è¿æ¥,ä¸šåŠ¡é€»è¾‘,çŠ¶æ€è½¬åŒ–éƒ½å†™åˆ°ä¸€ä¸ªç±»ä¸­,å¯¼è‡´æ‰©å±•æ—¶å¾ˆä¸æ–¹ä¾¿,éœ€è¦ `è§£è€¦`

- æŠŠåŠ è½½è¿æ¥åˆ†ç¦»åˆ° `db.properties`

  ```properties
  driver=com.mysql.cj.jdbc.Driver
  url=jdbc:mysql://localhost:3306/jdbcStudy?useUnicode = true & characterEncoding = utf8 & useSSL = true
  username=root
  password=123456
  ```

#### Utils

- æŠŠ SQL connect å’Œ release åˆ†ç¦»åˆ° `utils.JDBCUtils`

  ```Java
  import java.io.FileInputStream;
  import java.io.IOException;
  import java.sql.Connection;
  import java.sql.DriverManager;
  import java.sql.ResultSet;
  import java.sql.SQLException;
  import java.sql.Statement;
  import java.util.Properties;

  public class JDBCUtils {
    private static String driver = null;
    private static String url = null;
    private static String username = null;
    private static String password = null;

    static {
      // åŠ è½½è¿æ¥ä¿¡æ¯
      Properties properties = new Properties();
      try {
        properties.load(new FileInputStream("Java/src/main/java/twenty_one/jdbc/demo2/db.properties"));

        driver = properties.getProperty("driver");
        url = properties.getProperty("url");
        username = properties.getProperty("username");
        password = properties.getProperty("password");

        Class.forName(driver);
      } catch (IOException | ClassNotFoundException e) {
        e.printStackTrace();
      }
    }

    // è·å–è¿æ¥
    public static Connection getConnection() throws SQLException {
      return DriverManager.getConnection(url, username, password);
    }

    // é‡Šæ”¾èµ„æº
    public static void releaseConnection(Connection connection,Statement statement,ResultSet resultSet) throws SQLException {
      if (resultSet != null) {
        resultSet.close();
      }
      if (statement != null) {
        statement.close();
      }
      if (connection != null) {
        connection.close();
      }
    }
  }
  ```

#### CRUD

- ä¸šåŠ¡ç±»: æµ‹è¯•å¢åˆ æ”¹æŸ¥(CRUD)

  - å¢åˆ æ”¹ç”¨`.executeUpdate()`, æŸ¥ç”¨`.executeQuery()`

  ```Java
  import java.sql.Connection;
  import java.sql.ResultSet;
  import java.sql.SQLException;
  import java.sql.Statement;

  import twenty_one.jdbc.demo2.utils.JDBCUtils;

  public class Test {
    private static Connection connection = null;
    private static Statement statement = null;
    private static ResultSet resultSet = null;

    public static void main(String[] args) throws SQLException {
      // è¿æ¥
      connection = JDBCUtils.getConnection();
      statement = connection.createStatement();

      // å¢
      String insert = "INSERT INTO jdbcstudy.users(NAME, PASSWORD, email, birthday)  VALUES ('weidows', 123456, 'utsuko27@qq.com', '2020-07-28');";
      if (statement.executeUpdate(insert) > 0) { // è¿”å›int:å—å½±å“çš„è¡Œæ•°
        System.out.println("æ’å…¥æˆåŠŸ. insert -> weidows");
      }

      // æ”¹
      String update = "update jdbcstudy.users set password =654321 where name = 'weidows';";
      if (statement.executeUpdate(update) > 0) {
        System.out.println("ä¿®æ”¹æˆåŠŸ. weidows.password -> 654321");
      }

      // æŸ¥
      String query = "SELECT * From jdbcstudy.users;";
      resultSet = statement.executeQuery(query);
      while (resultSet.next()) {
        System.out.println("id = " + resultSet.getObject("id"));
        System.out.println("name = " + resultSet.getObject("NAME"));
        System.out.println("password = " + resultSet.getObject("PASSWORD"));
        System.out.println("email = " + resultSet.getObject("email"));
        System.out.println("birthday = " + resultSet.getObject("birthday"));
        System.out.println("===============================================================");
      }

      // åˆ 
      String delete = "delete from jdbcstudy.users where name = 'weidows';";
      if (statement.executeUpdate(delete) > 0) {
        System.out.println("åˆ é™¤æˆåŠŸ.");
      }

      // æ–­è¿
      JDBCUtils.releaseConnection(connection, statement, resultSet);
    }
  }
  ```

---

- æ‰§è¡Œç»“æœ

  ```
  æ’å…¥æˆåŠŸ. insert -> weidows
  ä¿®æ”¹æˆåŠŸ. weidows.password -> 654321
  id = 1
  name = zhansan
  password = 123456
  email = zs@sina.com
  birthday = 1980-12-04
  ===============================================================
  id = 2
  name = lisi
  password = 123456
  email = lisi@sina.com
  birthday = 1981-12-04
  ===============================================================
  id = 3
  name = wangwu
  password = 123456
  email = wangwu@sina.com
  birthday = 1979-12-04
  ===============================================================
  id = 9
  name = weidows
  password = 654321
  email = utsuko27@qq.com
  birthday = 2020-07-28
  ===============================================================
  åˆ é™¤æˆåŠŸ.
  ```
