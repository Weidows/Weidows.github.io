---
title: ğŸš€è¿›ä¿®MySQL~(è´°)
tags:
  - Java
  - MySQL
  - ç¬”è®°
date: 2021-03-10 12:14:47
cover: https://47i7-my.sharepoint.com/personal/utsuko27_bilibili_hk_cn/Documents/Pictures/bed/post/20210304000514.png
top_img:
---

<!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @LastEditors: Weidows
 * @LastEditTime: 2021-05-06 00:02:28
 * @FilePath: \Weidowsd:\Game\Github\Blog-private\source\_posts\Java\MySQL\2.md
 * @Description:
 * @!: *********************************************************************
-->

- [DQL-æ•°æ®æŸ¥è¯¢](#dql-æ•°æ®æŸ¥è¯¢)
  - [æ€»è§ˆ](#æ€»è§ˆ)
  - [SELECT](#select)
  - [å»é‡ DISTINCT](#å»é‡-distinct)
  - [å¯¹åˆ—ä½¿ç”¨è¡¨è¾¾å¼](#å¯¹åˆ—ä½¿ç”¨è¡¨è¾¾å¼)
  - [where](#where)
    - [é€»è¾‘æ“ä½œç¬¦](#é€»è¾‘æ“ä½œç¬¦)
    - [æ¨¡ç³ŠæŸ¥è¯¢](#æ¨¡ç³ŠæŸ¥è¯¢)
    - [é€šé…ç¬¦](#é€šé…ç¬¦)
  - [è”è¡¨æŸ¥è¯¢](#è”è¡¨æŸ¥è¯¢)
  - [è‡ªè¿æ¥](#è‡ªè¿æ¥)
  - [æ’åº](#æ’åº)
  - [åˆ†é¡µ](#åˆ†é¡µ)
  - [å­æŸ¥è¯¢](#å­æŸ¥è¯¢)
    ![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

## DQL-æ•°æ®æŸ¥è¯¢

### æ€»è§ˆ

- è¯­å¥é¡ºåºä¸èƒ½å˜

  <img src="https://47i7-my.sharepoint.com/personal/utsuko27_bilibili_hk_cn/Documents/Pictures/bed/post/20210316194554.png" alt="20210316194554" />

```SQL
SELECT [ALL | DISTINCT]
{* | table.* | [table.field1[as alias1][,table.field2[as alias2]][,...]]}
FROM table_name [as table_alias]
  [left | right | inner join table_name2]  -- è”åˆæŸ¥è¯¢
  [WHERE ...]  -- æŒ‡å®šç»“æœéœ€æ»¡è¶³çš„æ¡ä»¶
  [GROUP BY ...]  -- æŒ‡å®šç»“æœæŒ‰ç…§å“ªå‡ ä¸ªå­—æ®µæ¥åˆ†ç»„
  [HAVING]  -- è¿‡æ»¤åˆ†ç»„çš„è®°å½•å¿…é¡»æ»¡è¶³çš„æ¬¡è¦æ¡ä»¶
  [ORDER BY ...]  -- æŒ‡å®šæŸ¥è¯¢è®°å½•æŒ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ¡ä»¶æ’åº
  [LIMIT {[offset,]row_count | row_countOFFSET offset}]; -- æŒ‡å®šæŸ¥è¯¢çš„è®°å½•ä»å“ªæ¡è‡³å“ªæ¡
```

---

### SELECT

> SELECT åˆ—å [AS æ˜¾ç¤ºåˆ—å] FROM è¡¨å [AS æ˜¾ç¤ºè¡¨å];

```SQL
-- æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿä¿¡æ¯
SELECT
  *
FROM
  student;

-- æŸ¥è¯¢æŒ‡å®šåˆ—
SELECT
  studentid,
  studentname
FROM
  student;

-- è¿™é‡Œæ˜¯ä¸ºåˆ—å–åˆ«å(aså…³é”®è¯å¯ä»¥çœç•¥)
SELECT
  studentid AS `å­¦ å·`,
  studentname `å§“ å`
FROM
  student;

-- asä¹Ÿå¯ä»¥ä¸ºè¡¨å–åˆ«å(å¹¶ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥)
SELECT
  studentid AS `å­¦ å·`,
  studentname AS `å§“ å`
FROM
  student AS `è¡¨`;

-- é€šè¿‡CONCAT()å‡½æ•°æ‹¼æ¥å­—ç¬¦ä¸²
SELECT
  CONCAT('å§“å: ', studentname) AS `æ‹¼æ¥åçš„åå­—`
FROM
  student;
```

### å»é‡ DISTINCT

```SQL
SELECT DISTINCT * FROM student
```

---

### å¯¹åˆ—ä½¿ç”¨è¡¨è¾¾å¼

- æ•°æ®åº“ä¸­çš„è¡¨è¾¾å¼ : ä¸€èˆ¬ç”±æ–‡æœ¬å€¼ , åˆ—å€¼ , NULL , å‡½æ•°å’Œæ“ä½œç¬¦ç­‰ç»„æˆ

```SQL
-- æŸ¥è¯¢è‡ªå¢æ­¥é•¿
SELECT
  @@auto_increment_increment;

-- æŸ¥è¯¢ç‰ˆæœ¬å·
SELECT
  VERSION();

-- è¡¨è¾¾å¼
SELECT
  100 * 3 -1 AS `ç»“æœ`;

-- å­¦å‘˜è€ƒè¯•æˆç»©é›†ä½“æåˆ†ä¸€åˆ†æŸ¥çœ‹
SELECT
  studentid,
  gradeid + 1 AS 'å‡çº§å'
FROM
  student;
```

---

### where

> è¡¨è¾¾å¼ç»“æœå¿…é¡»æ˜¯ `å¸ƒå°”å€¼`

#### é€»è¾‘æ“ä½œç¬¦

- AND &&
- OR ||
- NOT !

---

- ä¾‹å­

  ```SQL
  -- æ»¡è¶³æ¡ä»¶çš„æŸ¥è¯¢
  SELECT Studentno,StudentResult FROM result;

  -- æŸ¥è¯¢è€ƒè¯•æˆç»©åœ¨95-100ä¹‹é—´çš„
  SELECT Studentno,StudentResult
  FROM result
  WHERE StudentResult>=95 && StudentResult<=100;

  -- æ¨¡ç³ŠæŸ¥è¯¢
  SELECT Studentno,StudentResult
  FROM result
  WHERE StudentResult BETWEEN 95 AND 100;

  -- é™¤äº†1000å·åŒå­¦,è¦å…¶ä»–åŒå­¦çš„æˆç»©
  SELECT studentno,studentresult
  FROM result
  WHERE studentno!=1000;

  -- ä½¿ç”¨NOT
  SELECT studentno,studentresult
  FROM result
  WHERE ! studentno=1000;
  ```

---

#### æ¨¡ç³ŠæŸ¥è¯¢

  <img src="https://47i7-my.sharepoint.com/personal/utsuko27_bilibili_hk_cn/Documents/Pictures/bed/post/20210312120236.png" alt="20210312120236" />

- ä¾‹å­

  ```SQL
  -- LIKE likeç»“åˆä½¿ç”¨çš„é€šé…ç¬¦:  % (ä»£è¡¨0åˆ°ä»»æ„ä¸ªå­—ç¬¦)   _ (ä¸€ä¸ªå­—ç¬¦)
  -- =============================================
  -- æŸ¥è¯¢å§“åˆ˜çš„åŒå­¦çš„å­¦å·åŠå§“å
  SELECT
    studentno,
    studentname
  FROM
    student
  WHERE
    studentname LIKE 'åˆ˜%';

  -- æŸ¥è¯¢å§“åˆ˜çš„åŒå­¦,åé¢åªæœ‰ä¸€ä¸ªå­—çš„
  SELECT
    studentno,
    studentname
  FROM
    student
  WHERE
    studentname LIKE 'åˆ˜_';

  -- æŸ¥è¯¢å§“åˆ˜çš„åŒå­¦,åé¢åªæœ‰ä¸¤ä¸ªå­—çš„
  SELECT
    studentno,
    studentname
  FROM
    student
  WHERE
    studentname LIKE 'åˆ˜__';

  -- æŸ¥è¯¢å§“åä¸­å«æœ‰ 'å˜‰' å­—çš„
  SELECT
    studentno,
    studentname
  FROM
    student
  WHERE
    studentname LIKE '%å˜‰%';
  -- æŸ¥è¯¢å§“åä¸­å«æœ‰ç‰¹æ®Šå­—ç¬¦çš„éœ€è¦ä½¿ç”¨è½¬ä¹‰ç¬¦å· '\'
    -- è‡ªå®šä¹‰è½¬ä¹‰ç¬¦å…³é”®å­—: ESCAPE ':'

  -- IN
  -- =============================================
  -- æŸ¥è¯¢å­¦å·ä¸º1000,1001,1002çš„å­¦ç”Ÿå§“å
  SELECT
    studentno,
    studentname
  FROM
    student
  WHERE
    studentno IN (1000, 1001, 1002);

  -- æŸ¥è¯¢åœ°å€åœ¨åŒ—äº¬,å—äº¬,æ²³å—æ´›é˜³çš„å­¦ç”Ÿ
  SELECT
    studentno,
    studentname,
    address
  FROM
    student
  WHERE
    address IN ('åŒ—äº¬', 'å—äº¬', 'æ²³å—æ´›é˜³');

  -- å¯¹NULLåˆ¤æ–­ ä¸èƒ½ç›´æ¥å†™=NULL, ç”¨ is null
  -- =============================================
  -- æŸ¥è¯¢å‡ºç”Ÿæ—¥æœŸæ²¡æœ‰å¡«å†™çš„åŒå­¦
  SELECT
    studentname
  FROM
    student
  WHERE
    BornDate IS NULL;

  -- æŸ¥è¯¢å‡ºç”Ÿæ—¥æœŸå¡«å†™çš„åŒå­¦
  SELECT
    studentname
  FROM
    student
  WHERE
    BornDate IS NOT NULL;

  -- æŸ¥è¯¢æ²¡æœ‰å†™å®¶åº­ä½å€çš„åŒå­¦
  SELECT
    studentname
  FROM
    student
  WHERE
    Address = ''
    OR Address IS NULL;
  ```

  ***

#### é€šé…ç¬¦

æ¯”å¦‚æœ‰ä¸ªè¡¨ user,æœ‰ä¸€ä¸ª `name` æ•°æ®ä¸º`å¼ ä¸‰`,éœ€è¦é€šè¿‡'å¼ 'å­—æ¨¡ç³ŠæŸ¥è¯¢å‡ºæ¥

- è¿™æ ·æ˜¯æŸ¥ä¸å‡ºæ¥çš„,è¿™æ˜¯å…¨å­—åŒ¹é…,æ¢ä¸º'å¼ ä¸‰'å¯ä»¥æŸ¥å‡ºæ¥

  ```SQL
  select *
  from user
  where name like 'å¼ '
  ```

- éœ€è¦æ”¹æˆè¿™æ ·: è¿™æ ·æ˜¯ä½œä¸ºé€šé…ç¬¦,name ä¸­å«æœ‰'å¼ 'å­—çš„éƒ½ä¼šè¢«åŒ¹é…å‡ºæ¥.

  ```SQL
  select *
  from user
  where name like '%å¼ %'
  ```

---

### è”è¡¨æŸ¥è¯¢

- ä¸ƒç§ SQL joins

  <img src="https://47i7-my.sharepoint.com/personal/utsuko27_bilibili_hk_cn/Documents/Pictures/bed/post/20210313224946.png" alt="20210313224946" />

  - å…±æœ‰å››ç§æ“ä½œç¬¦ `inner,full outer,left,right`

  - ON åé¢è·Ÿçš„æ˜¯ A è¡¨ä¸ B è¡¨æ•°æ®äº¤å‰åˆ—,æ˜¯ join æˆç«‹çš„æ¡ä»¶.

  ***

- ä¾‹å­

  ```SQL
  -- studentå’Œresultè¡¨ä¸­éƒ½æœ‰studentno,å¦‚ä¸æŒ‡å®šselecté‚£ä¸ªè¡¨ä¸­çš„,ä¼šæŠ¥é”™"ä¸æ˜ç¡®"
  SELECT
    s.studentno,
    studentname,
    subjectno,
    StudentResult
  FROM
    student s
    INNER JOIN result r ON r.studentno = s.studentno

  -- å³è¿æ¥
  SELECT
    s.studentno,
    studentname,
    subjectno,
    StudentResult
  FROM
    student s
    RIGHT JOIN result r ON r.studentno = s.studentno

  -- ç­‰å€¼è¿æ¥
  SELECT
    s.studentno,
    studentname,
    subjectno,
    StudentResult
  FROM
    student s,
    result r
  WHERE
    r.studentno = s.studentno

  -- å·¦è¿æ¥ (æŸ¥è¯¢äº†æ‰€æœ‰åŒå­¦,ä¸è€ƒè¯•çš„ä¹Ÿä¼šæŸ¥å‡ºæ¥)
  SELECT
    s.studentno,
    studentname,
    subjectno,
    StudentResult
  FROM
    student s
    LEFT JOIN result r ON r.studentno = s.studentno

  -- æŸ¥ä¸€ä¸‹ç¼ºè€ƒçš„åŒå­¦(å·¦è¿æ¥åº”ç”¨åœºæ™¯)
  SELECT
    s.studentno,
    studentname,
    subjectno,
    StudentResult
  FROM
    student s
    LEFT JOIN result r ON r.studentno = s.studentno
  WHERE
    StudentResult IS NULL

  -- æŸ¥è¯¢å‚åŠ äº†è€ƒè¯•çš„åŒå­¦ä¿¡æ¯(å­¦å·,å­¦ç”Ÿå§“å,ç§‘ç›®å,åˆ†æ•°)
  SELECT
    s.studentno,
    studentname,
    subjectname,
    StudentResult
  FROM
    `student` s
    INNER JOIN `result` r ON r.studentno = s.studentno
    INNER JOIN `subject` sub ON sub.subjectno = r.subjectno
  ```

---

### è‡ªè¿æ¥

- æŠŠä¸€å¼ è¡¨è§†ä½œä¸¤å¼ è¡¨,ç„¶åæŠŠ`åŒä¸€åˆ—`çš„ä¸åŒæ•°æ®ç­›é€‰å¼€`ä½œä¸ºä¸¤åˆ—`è¾“å‡º

- åˆå§‹åŒ–æ•°æ®

  ```SQL
  -- åˆ›å»ºä¸€ä¸ªè¡¨
  CREATE TABLE `category` (
    `categoryid` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT COMMENT 'ä¸»é¢˜id',
    `pid` INT(10) NOT NULL COMMENT 'çˆ¶id',
    `categoryName` VARCHAR(50) NOT NULL COMMENT 'ä¸»é¢˜åå­—',
    PRIMARY KEY (`categoryid`)
  ) ENGINE = INNODB AUTO_INCREMENT = 9 DEFAULT CHARSET = utf8;

  -- æ’å…¥æ•°æ®
  INSERT INTO
    `category` (`categoryid`, `pid`, `categoryName`)
  VALUES('2', '1', 'ä¿¡æ¯æŠ€æœ¯'),
    ('3', '1', 'è½¯ä»¶å¼€å‘'),
    ('4', '3', 'æ•°æ®åº“'),
    ('5', '1', 'ç¾æœ¯è®¾è®¡'),
    ('6', '3', 'webå¼€å‘'),
    ('7', '5', 'psæŠ€æœ¯'),
    ('8', '2', 'åŠå…¬ä¿¡æ¯');
  ```

- select ä¾‹å­

  - æŠŠåŒä¸€å¼ è¡¨ä¸­ categoryName è¿™ä¸€åˆ— select å‡ºçˆ¶æ ç›®å’Œå­æ ç›®ä¸¤åˆ—æ•°æ®è¾“å‡º

  ```SQL
  SELECT
    a.categoryName AS 'çˆ¶æ ç›®',
    b.categoryName AS 'å­æ ç›®'
  FROM
    category AS a,
    category AS b
  WHERE
    a.`categoryid` = b.`pid`;
  ```

- è¾“å‡º

  <img src="https://47i7-my.sharepoint.com/personal/utsuko27_bilibili_hk_cn/Documents/Pictures/bed/post/20210315112316.png" alt="20210315112316" />

- å…¶ä»–æ ·ä¾‹

  ```SQL
  -- æ€è€ƒé¢˜:æŸ¥è¯¢å‚åŠ äº†è€ƒè¯•çš„åŒå­¦ä¿¡æ¯(å­¦å·,å­¦ç”Ÿå§“å,ç§‘ç›®å,åˆ†æ•°)
  SELECT
    s.studentno,
    studentname,
    subjectname,
    StudentResult
  FROM
    student s
    INNER JOIN result r ON r.studentno = s.studentno
    INNER JOIN `subject` sub ON sub.subjectno = r.subjectno;

  -- æŸ¥è¯¢å­¦å‘˜åŠæ‰€å±çš„å¹´çº§(å­¦å·,å­¦ç”Ÿå§“å,å¹´çº§å)
  SELECT
    studentno AS å­¦ å·,
    studentname AS å­¦ ç”Ÿ å§“ å,
    gradename AS å¹´ çº§ å ç§°
  FROM
    student s
    INNER JOIN grade g ON s.`GradeId` = g.`GradeID`;

  -- æŸ¥è¯¢ç§‘ç›®åŠæ‰€å±çš„å¹´çº§(ç§‘ç›®åç§°,å¹´çº§åç§°)
  SELECT
    subjectname AS ç§‘ ç›® å ç§°,
    gradename AS å¹´ çº§ å ç§°
  FROM
    SUBJECT sub
    INNER JOIN grade g ON sub.gradeid = g.gradeid;

  -- æŸ¥è¯¢ æ•°æ®åº“ç»“æ„-1 çš„æ‰€æœ‰è€ƒè¯•ç»“æœ(å­¦å· å­¦ç”Ÿå§“å ç§‘ç›®åç§° æˆç»©)
  SELECT
    s.studentno,
    studentname,
    subjectname,
    StudentResult
  FROM
    student s
    INNER JOIN result r ON r.studentno = s.studentno
    INNER JOIN `subject` sub ON r.subjectno = sub.subjectno
  WHERE
    subjectname = 'æ•°æ®åº“ç»“æ„-1'
  ```

---

### æ’åº

> ORDER BY åˆ—å ASC/DESC(å‡åº/é™)

- ä¾‹å­

  ```SQL
  -- æŒ‰æˆç»©é™åºæ’åº
  SELECT
    s.studentno,
    studentname,
    subjectname,
    StudentResult
  FROM
    student s
    INNER JOIN result r ON r.studentno = s.studentno
    INNER JOIN `subject` sub ON r.subjectno = sub.subjectno
  WHERE
    subjectname = 'æ•°æ®åº“ç»“æ„-1'
  ORDER BY
    StudentResult DESC;
  ```

---

### åˆ†é¡µ

> LIMIT n,m

- å«ä¹‰

  - ä»ç¬¬ n æ¡å¼€å§‹æ˜¾ç¤º

  - æ¯é¡µæ˜¾ç¤º m æ¡æ•°

  ***

- æ¯”å¦‚éœ€è¦æ¯é¡µæ˜¾ç¤º 10 æ¡æ•°æ®,å½“å‰è¦çœ‹ç¬¬ä¸€é¡µ

  - `LIMIT 0,10`

  - ç¬¬ n é¡µæ•°æ®å°±æ˜¯ `LIMIT 10(n-1),10`

  ***

- ä¾‹å­

  ```SQL
  -- æ¯é¡µæ˜¾ç¤º5æ¡æ•°æ®
  SELECT
    s.studentno,
    studentname,
    subjectname,
    StudentResult
  FROM
    student s
    INNER JOIN result r ON r.studentno = s.studentno
    INNER JOIN `subject` sub ON r.subjectno = sub.subjectno
  WHERE
    subjectname = 'æ•°æ®åº“ç»“æ„-1'
  ORDER BY
    StudentResult DESC,
    studentno
  LIMIT
    0, 5 ;

  -- æŸ¥è¯¢ JAVAç¬¬ä¸€å­¦å¹´ è¯¾ç¨‹æˆç»©å‰10åå¹¶ä¸”åˆ†æ•°å¤§äº80çš„å­¦ç”Ÿä¿¡æ¯(å­¦å·,å§“å,è¯¾ç¨‹å,åˆ†æ•°)
  SELECT
    s.studentno,
    studentname,
    subjectname,
    StudentResult
  FROM
    student s
    INNER JOIN result r ON r.studentno = s.studentno
    INNER JOIN `subject` sub ON r.subjectno = sub.subjectno
  WHERE
    subjectname = 'JAVAç¬¬ä¸€å­¦å¹´'
  ORDER BY
    StudentResult DESC
  LIMIT
    0, 10;
  ```

---

### å­æŸ¥è¯¢

æŸ¥è¯¢è¯­å¥ä¸­ where ä¸­åµŒå¥—æŸ¥è¯¢è¯­å¥

```SQL
-- æŸ¥è¯¢ æ•°æ®åº“ç»“æ„-1 çš„è€ƒè¯•ç»“æœ(å­¦å·,ç§‘ç›®ç¼–å·,æˆç»©),å¹¶ä¸”æˆç»©é™åºæ’åˆ—
-- æ–¹æ³•ä¸€:ä½¿ç”¨è¿æ¥æŸ¥è¯¢
SELECT
  studentno,
  r.subjectno,
  StudentResult
FROM
  result r
  INNER JOIN `subject` sub ON r.`SubjectNo` = sub.`SubjectNo`
WHERE
  subjectname = 'æ•°æ®åº“ç»“æ„-1'
ORDER BY
  studentresult DESC;

-- æ–¹æ³•äºŒ:ä½¿ç”¨å­æŸ¥è¯¢(æ‰§è¡Œé¡ºåº:ç”±é‡ŒåŠå¤–)
SELECT
  studentno,
  subjectno,
  StudentResult
FROM
  result
WHERE
  subjectno =(
    SELECT
      subjectno
    FROM
      `subject`
    WHERE
      subjectname = 'æ•°æ®åº“ç»“æ„-1'
  )
ORDER BY
  studentresult DESC;
```
