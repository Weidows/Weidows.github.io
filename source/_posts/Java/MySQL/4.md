---
title: 🚀进修MySQL~(肆)
categories:
  - Java
  - MySQL
tags:
  - Java
  - MySQL
date: 2021-03-17 14:41:19
cover: https://cdn.jsdelivr.net/gh/Weidows/Images@master/hpp/20210304000514.png
top_img:
---

<!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @LastEditors: Weidows
 * @LastEditTime: 2021-03-17 20:52:28
 * @FilePath: \Weidowsd:\Game\Github\Blog-private\source\_posts\Java\MySQL\4.md
 * @Description:
 * @!: *********************************************************************
-->

- [用户/权限管理](#用户权限管理)
  - [基本操作](#基本操作)
  - [权限解释](#权限解释)
  - [表维护](#表维护)
- [导出&导入](#导出导入)
- [设计数据库](#设计数据库)
- [三大范式](#三大范式)
  - [第一范式](#第一范式)
  - [第二范式](#第二范式)
  - [第三范式](#第三范式)
  - [性能考量](#性能考量)
- [JDBC](#jdbc)

![分割线](https://cdn.jsdelivr.net/gh/Weidows/Images@master/img/divider.png)

# 用户/权限管理

## 基本操作

```SQL
/*
  用户信息表：mysql.user
*/

-- 刷新权限
FLUSH PRIVILEGES;

/*
  增加用户
  必须拥有mysql数据库的全局CREATE USER权限，或拥有INSERT权限。
  用户名/密码注意加引号，如 'user_name'@'192.168.1.1'
*/
CREATE USER weidows IDENTIFIED BY '123456';

-- 重命名用户
RENAME USER weidows TO weidows2;

-- 删除用户
DROP USER weidows2;

-- 设置密码
-- 为当前用户设置密码
SET PASSWORD = PASSWORD ('密码');
-- 为指定用户设置密码
SET PASSWORD FOR 用户名 = PASSWORD ('密码');

/*
  授予权限
  GRANT 权限列表 ON 表名 TO 用户名 [IDENTIFIED BY [PASSWORD] 'password']
    all privileges 表示所有权限
    *.* 表示所有库的所有表
    库名.表名 表示某库下面的某表
  只有root用户拥有grant权限,其他用户无法开启.
*/
GRANT ALL PRIVILEGES ON *.* TO weidows IDENTIFIED BY '123456';

-- 查看权限
SHOW GRANTS FOR root@localhost;
-- 查看当前用户权限
SHOW GRANTS;
SHOW GRANTS FOR CURRENT_USER;
SHOW GRANTS FOR CURRENT_USER();

/**
  撤消权限
  REVOKE 权限列表 ON 表名 FROM 用户名
 */
REVOKE ALL PRIVILEGES ON *.* FROM weidows;
```

---

## 权限解释

- (查询用,不用硬记)

```
ALL [PRIVILEGES]    -- 设置除GRANT OPTION之外的所有简单权限
ALTER    -- 允许使用ALTER TABLE
ALTER ROUTINE    -- 更改或取消已存储的子程序
CREATE    -- 允许使用CREATE TABLE
CREATE ROUTINE    -- 创建已存储的子程序
CREATE TEMPORARY TABLES        -- 允许使用CREATE TEMPORARY TABLE
CREATE USER        -- 允许使用CREATE USER, DROP USER, RENAME USER和REVOKE ALL PRIVILEGES。
CREATE VIEW        -- 允许使用CREATE VIEW
DELETE    -- 允许使用DELETE
DROP    -- 允许使用DROP TABLE
EXECUTE        -- 允许用户运行已存储的子程序
FILE    -- 允许使用SELECT...INTO OUTFILE和LOAD DATA INFILE
INDEX     -- 允许使用CREATE INDEX和DROP INDEX
INSERT    -- 允许使用INSERT
LOCK TABLES        -- 允许对您拥有SELECT权限的表使用LOCK TABLES
PROCESS     -- 允许使用SHOW FULL PROCESSLIST
REFERENCES    -- 未被实施
RELOAD    -- 允许使用FLUSH
REPLICATION CLIENT    -- 允许用户询问从属服务器或主服务器的地址
REPLICATION SLAVE    -- 用于复制型从属服务器（从主服务器中读取二进制日志事件）
SELECT    -- 允许使用SELECT
SHOW DATABASES    -- 显示所有数据库
SHOW VIEW    -- 允许使用SHOW CREATE VIEW
SHUTDOWN    -- 允许使用mysqladmin shutdown
SUPER    -- 允许使用CHANGE MASTER, KILL, PURGE MASTER LOGS和SET GLOBAL语句，mysqladmin debug命令；允许您连接（一次），即使已达到max_connections。
UPDATE    -- 允许使用UPDATE
USAGE    -- “无权限”的同义词
GRANT OPTION    -- 允许授予权限
```

---

## 表维护

- `了解`

```SQL
-- 分析和存储表的关键字分布
ANALYZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE 表名 ...

-- 检查一个或多个表是否有错误
CHECK TABLE tbl_name [, tbl_name] ... [option] ...
option = {QUICK | FAST | MEDIUM | EXTENDED | CHANGED}

-- 整理数据文件的碎片
OPTIMIZE [LOCAL | NO_WRITE_TO_BINLOG] TABLE tbl_name [, tbl_name] ...
```

---

# 导出&导入

- 可以用 SQL GUI 程序操作,下面介绍命令行操作

- 导出

  - 可以加上-w 携带备份条件
  - -xxx 后面不加空格,直接带上参数

  ***

  1. 导出一张表 mysqldump -u 用户名 -p 密码 库名 表名 > 文件名(D:/a.sql)

  ```
  mysqldump -uroot -p123456 school student >D:/a.sql
  ```

  2. 导出多张表 mysqldump -u 用户名 -p 密码 库名 表 1 表 2 表 3 > 文件名(D:/a.sql)

  ```
  mysqldump -uroot -p123456 school student result >D:/a.sql
  ```

  3. 导出所有表 mysqldump -u 用户名 -p 密码 库名 > 文件名(D:/a.sql)

  ```
  mysqldump -uroot -p123456 school >D:/a.sql
  ```

  4. 导出一个库 mysqldump -u 用户名 -p 密码 -B 库名 > 文件名(D:/a.sql)

  ```
  mysqldump -uroot -p123456 -B school >D:/a.sql
  ```

---

- 导入

  1. 在已经登录 mysql,切换到指定数据库的情况下: source 备份文件

  ```
  source D:/a.sql
  ```

  2. 在不登录的情况下: mysql -u 用户名 -p 密码 [库名] < 备份文件 (如果导入一个库的话就不加库名)

  ```
  mysql -uroot -p123456 school <D:/a.sql
  ```

![分割线](https://cdn.jsdelivr.net/gh/Weidows/Images@master/img/divider.png)

# 设计数据库

- 目的:

  1. 节省数据存储空间
  2. 保证数据的完整性
  3. 方便进行数据库应用系统的开发

  ***

- 阶段设计

  1. 需求分析: 分析客户的业务和数据处理需求
  2. 概要设计: 设计数据库的 E-R 模型图 , 确认需求信息的正确和完整.
  3. 收集信息: 搜集与需求相关的信息需求.

     1. 页面 A
     2. 功能 B
     3. 特殊需求 C
     4. 自定义 D
     5. ...

  4. 标识实体: 标识数据库所要管理的对象,详细信息(Attribute)以及关系(Relationship)

     1. 写博客 user -> blog
     2. 分类 blog -> category
     3. 评论 user(作者) -> user(评论者) -> blog(博客页面)
     4. ...

---

# 三大范式

> [数据库设计的三大范式通俗讲解](https://blog.csdn.net/scarecrow_fly/article/details/102170042)

- 三大范式出现为了解决一下四种问题

  - 信息重复

  - 更新异常

  - 插入异常

  - 删除异常

---

## 第一范式

> 确保每列的`原子性`,每列都是不可再分的最小数据单元

> <img src="https://cdn.jsdelivr.net/gh/Weidows/Images@master/hpp/20210317202650.png" alt="20210317202650" />

- 上面家庭信息和学校信息都可以再拆分为两列

---

## 第二范式

> 必须在满足第一范式的条件下: 每个表只做一件事(`每行有唯一标识`,其他数据只依赖于此标识列)

> <img src="https://cdn.jsdelivr.net/gh/Weidows/Images@master/hpp/20210317203230.png" alt="20210317203230" />

- 简单来讲就是标识列和其他列有共同重复数据行,那么`标识列`和`有重复数据的列`可以分到另一个表

  <img src="https://cdn.jsdelivr.net/gh/Weidows/Images@master/hpp/20210317203601.png" alt="20210317203601" />

---

## 第三范式

> 在第二范式基础上,其他列数据必须与标识列数据有直接关系

> <img src="https://cdn.jsdelivr.net/gh/Weidows/Images@master/hpp/20210317204105.png" alt="20210317204105" />

- 也就是说不存在标识列与其他列共同重复了,但还是可能存在多个其他列有共同重复(班主任的那三列有共同重复数据)

- 把班主任分出去

  <img src="https://cdn.jsdelivr.net/gh/Weidows/Images@master/hpp/20210317204341.png" alt="20210317204341" />

---

## 性能考量

> `关联查询不能超过三张表`.

- 实际应用中需要考虑多表的额外开销

- 如果不规范程度低,而且性能需求高的场景,则需要考虑是否遵循范式.

![分割线](https://cdn.jsdelivr.net/gh/Weidows/Images@master/img/divider.png)

# JDBC
