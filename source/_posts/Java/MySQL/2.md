---
title: 🚀进修MySQL~(贰)
categories:
  - Java
  - MySQL
tags:
  - Java
  - MySQL
date: 2021-03-10 12:14:47
cover: https://cdn.jsdelivr.net/gh/Weidows/Images@master/hpp/20210304000514.png
top_img:
---

<!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @LastEditors: Weidows
 * @LastEditTime: 2021-03-14 10:34:48
 * @FilePath: \Weidowsd:\Game\Github\Blog-private\source\_posts\Java\MySQL\2.md
 * @Description:
 * @!: *********************************************************************
-->

- [参照](#参照)

![分割线](https://cdn.jsdelivr.net/gh/Weidows/Images@master/img/divider.png)

# DQL-数据查询

## 总览

```SQL
SELECT [ALL | DISTINCT]
{* | table.* | [table.field1[as alias1][,table.field2[as alias2]][,...]]}
FROM table_name [as table_alias]
  [left | right | inner join table_name2]  -- 联合查询
  [WHERE ...]  -- 指定结果需满足的条件
  [GROUP BY ...]  -- 指定结果按照哪几个字段来分组
  [HAVING]  -- 过滤分组的记录必须满足的次要条件
  [ORDER BY ...]  -- 指定查询记录按一个或多个条件排序
  [LIMIT {[offset,]row_count | row_countOFFSET offset}]; -- 指定查询的记录从哪条至哪条
```

---

## SELECT

> SELECT 列名 [AS 显示列名] FROM 表名 [AS 显示表名];

```SQL
-- 查询所有学生信息
SELECT
  *
FROM
  student;

-- 查询指定列
SELECT
  studentid,
  studentname
FROM
  student;

-- 这里是为列取别名(as关键词可以省略)
SELECT
  studentid AS `学 号`,
  studentname `姓 名`
FROM
  student;

-- as也可以为表取别名(并不会显示出来)
SELECT
  studentid AS `学 号`,
  studentname AS `姓 名`
FROM
  student AS `表`;

-- 通过CONCAT()函数拼接字符串
SELECT
  CONCAT('姓名: ', studentname) AS `拼接后的名字`
FROM
  student;
```

## 去重 DISTINCT

```SQL
SELECT DISTINCT * FROM student
```

---

## 对列使用表达式

- 数据库中的表达式 : 一般由文本值 , 列值 , NULL , 函数和操作符等组成

```SQL
-- 查询自增步长
SELECT
  @@auto_increment_increment;

-- 查询版本号
SELECT
  VERSION();

-- 表达式
SELECT
  100 * 3 -1 AS `结果`;

-- 学员考试成绩集体提分一分查看
SELECT
  studentid,
  gradeid + 1 AS '升级后'
FROM
  student;
```

---

## where

> 表达式结果必须是 `布尔值`

- 逻辑操作符

  - AND &&
  - OR ||
  - NOT !

  ***

  - 例子

    ```SQL
    -- 满足条件的查询
    SELECT Studentno,StudentResult FROM result;

    -- 查询考试成绩在95-100之间的
    SELECT Studentno,StudentResult
    FROM result
    WHERE StudentResult>=95 && StudentResult<=100;

    -- 模糊查询
    SELECT Studentno,StudentResult
    FROM result
    WHERE StudentResult BETWEEN 95 AND 100;

    -- 除了1000号同学,要其他同学的成绩
    SELECT studentno,studentresult
    FROM result
    WHERE studentno!=1000;

    -- 使用NOT
    SELECT studentno,studentresult
    FROM result
    WHERE ! studentno=1000;
    ```

---

- 模糊查询

  <img src="https://cdn.jsdelivr.net/gh/Weidows/Images@master/hpp/20210312120236.png" alt="20210312120236" />

  - 例子

    ```SQL
    -- LIKE like结合使用的通配符:  % (代表0到任意个字符)   _ (一个字符)
    -- =============================================
    -- 查询姓刘的同学的学号及姓名
    SELECT
      studentno,
      studentname
    FROM
      student
    WHERE
      studentname LIKE '刘%';

    -- 查询姓刘的同学,后面只有一个字的
    SELECT
      studentno,
      studentname
    FROM
      student
    WHERE
      studentname LIKE '刘_';

    -- 查询姓刘的同学,后面只有两个字的
    SELECT
      studentno,
      studentname
    FROM
      student
    WHERE
      studentname LIKE '刘__';

    -- 查询姓名中含有 '嘉' 字的
    SELECT
      studentno,
      studentname
    FROM
      student
    WHERE
      studentname LIKE '%嘉%';
    -- 查询姓名中含有特殊字符的需要使用转义符号 '\'
      -- 自定义转义符关键字: ESCAPE ':'

    -- IN
    -- =============================================
    -- 查询学号为1000,1001,1002的学生姓名
    SELECT
      studentno,
      studentname
    FROM
      student
    WHERE
      studentno IN (1000, 1001, 1002);

    -- 查询地址在北京,南京,河南洛阳的学生
    SELECT
      studentno,
      studentname,
      address
    FROM
      student
    WHERE
      address IN ('北京', '南京', '河南洛阳');

    -- 对NULL判断 不能直接写=NULL, 用 is null
    -- =============================================
    -- 查询出生日期没有填写的同学
    SELECT
      studentname
    FROM
      student
    WHERE
      BornDate IS NULL;

    -- 查询出生日期填写的同学
    SELECT
      studentname
    FROM
      student
    WHERE
      BornDate IS NOT NULL;

    -- 查询没有写家庭住址的同学
    SELECT
      studentname
    FROM
      student
    WHERE
      Address = ''
      OR Address IS NULL;
    ```

---

## 联表查询

- 七种 SQL joins

  <img src="https://cdn.jsdelivr.net/gh/Weidows/Images@master/hpp/20210313224946.png" alt="20210313224946" />

  - 共有四种操作符 `inner,full outer,left,right`

  - ON 后面跟的是 A 表与 B 表数据交叉列,是 join 成立的条件.

  ***

- 例子

  ```SQL
  -- student和result表中都有studentno,如不指定select那个表中的,会报错"不明确"
  SELECT
    s.studentno,
    studentname,
    subjectno,
    StudentResult
  FROM
    student s
    INNER JOIN result r ON r.studentno = s.studentno

  -- 右连接
  SELECT
    s.studentno,
    studentname,
    subjectno,
    StudentResult
  FROM
    student s
    RIGHT JOIN result r ON r.studentno = s.studentno

  -- 等值连接
  SELECT
    s.studentno,
    studentname,
    subjectno,
    StudentResult
  FROM
    student s,
    result r
  WHERE
    r.studentno = s.studentno

  -- 左连接 (查询了所有同学,不考试的也会查出来)
  SELECT
    s.studentno,
    studentname,
    subjectno,
    StudentResult
  FROM
    student s
    LEFT JOIN result r ON r.studentno = s.studentno

  -- 查一下缺考的同学(左连接应用场景)
  SELECT
    s.studentno,
    studentname,
    subjectno,
    StudentResult
  FROM
    student s
    LEFT JOIN result r ON r.studentno = s.studentno
  WHERE
    StudentResult IS NULL

  -- 查询参加了考试的同学信息(学号,学生姓名,科目名,分数)
  SELECT
    s.studentno,
    studentname,
    subjectname,
    StudentResult
  FROM
    `student` s
    INNER JOIN `result` r ON r.studentno = s.studentno
    INNER JOIN `subject` sub ON sub.subjectno = r.subjectno
  ```
