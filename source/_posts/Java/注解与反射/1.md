---
title: ğŸ”¥Javaæ³¨è§£ä¸åå°„å¤ä¹ ~(å£¹)
categories:
  - Java
  - æ³¨è§£
tags:
  - Java
  - æ³¨è§£
  - åå°„
  - ç¬”è®°
date: 2021-02-25 11:20:20
cover: https://cdn.jsdelivr.net/gh/Weidows/Images/hpp/è“ç²‰é’æ˜¥å¯çˆ±åŠ±å¿—å¾®ä¿¡å…¬ä¼—å·å°é¢.jpg
top_img:
---

<!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @LastEditors: Weidows
 * @LastEditTime: 2021-03-19 00:14:17
 * @FilePath: \Weidowsd:\Game\Github\Blog-private\source\_posts\Java\æ³¨è§£ä¸åå°„\1.md
 * @Description:
 * @!: *********************************************************************
-->

- [å†…ç½®æ³¨è§£](#å†…ç½®æ³¨è§£)
- [å…ƒæ³¨è§£](#å…ƒæ³¨è§£)
- [è‡ªå®šä¹‰æ³¨è§£](#è‡ªå®šä¹‰æ³¨è§£)
- [åå°„](#åå°„)
  - [Class ç±»](#class-ç±»)
  - [ç±»çš„åŠ è½½è¿‡ç¨‹](#ç±»çš„åŠ è½½è¿‡ç¨‹)
- [å®ä¾‹åŒ–ä¸ static åŠ è½½](#å®ä¾‹åŒ–ä¸-static-åŠ è½½)
  - [ä»€ä¹ˆæ—¶å€™ä¼šå‘ç”Ÿç±»åˆå§‹åŒ–?](#ä»€ä¹ˆæ—¶å€™ä¼šå‘ç”Ÿç±»åˆå§‹åŒ–)
- [ç±»åŠ è½½å™¨](#ç±»åŠ è½½å™¨)

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

## å†…ç½®æ³¨è§£

```Java
public class Anno1 {

  @Override //é‡å†™æ–¹æ³•
  public String toString() {
    return super.toString();
  }

  @Deprecated //è¡¨ç¤ºå¼ƒç”¨æ–¹æ³•,ä½†ä»å¯ä½¿ç”¨
  public static void test() {
  }

  @SuppressWarnings("all") //æŠ‘åˆ¶è­¦å‘Š
  public static void test01() {
    int age;
  }

  public static void main(String[] args) {
    test();
    test01();
  }
}
```

---

## å…ƒæ³¨è§£

- `ä½œç”¨äºå…¶ä»–æ³¨è§£çš„æ³¨è§£`

- åœ¨ java.lang.annotation åŒ…ä¸­å¯ä»¥æ‰¾åˆ°.( @ Target , @Retentionï¼Œ@Documented , @Inherited )
  - @Target :ç”¨äºæè¿°æ³¨è§£çš„ä½¿ç”¨èŒƒå›´(å³:è¢«æè¿°çš„æ³¨è§£å¯ä»¥ç”¨åœ¨ä»€ä¹ˆåœ°æ–¹)
  - @Retention :è¡¨ç¤ºéœ€è¦åœ¨ä»€ä¹ˆçº§åˆ«ä¿å­˜è¯¥æ³¨é‡Šä¿¡æ¯,ç”¨äºæè¿°æ³¨è§£çš„ç”Ÿå‘½å‘¨æœŸ(SOURCE < CLASS < RUNTIME)
  - @Document:è¯´æ˜è¯¥æ³¨è§£å°†è¢«åŒ…å«åœ¨ javadoc ä¸­
  - @Inherited: è¯´æ˜å­ç±»å¯ä»¥ç»§æ‰¿çˆ¶ç±»ä¸­çš„è¯¥æ³¨è§£

```Java
import java.lang.annotation.*;

@MyAnnotation
public class Anno2 {
  @MyAnnotation
  void test() {
  }
}

//Target è¡¨ç¤ºæˆ‘ä»¬çš„æ³¨è§£å¯ä»¥ç”¨åœ¨å“ªäº›åœ°æ–¹.
@Target(value = { ElementType.METHOD, ElementType.TYPE })

//Retentionè¡¨ç¤ºæˆ‘ä»¬çš„æ³¨è§£åœ¨ä»€ä¹ˆåœ°æ–¹è¿˜æœ‰æ•ˆã€‚runtime>class>sources
@Retention(value = RetentionPolicy.RUNTIME)

//Documentedè¡¨ç¤ºæ˜¯å¦å°†æˆ‘ä»¬çš„æ³¨è§£ç”Ÿæˆåœ¨Javadocä¸­
@Documented

//Inheritedå­ç±»å¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„æ³¨è§£
@Inherited

@interface MyAnnotation {
}
```

---

## è‡ªå®šä¹‰æ³¨è§£

- ä½¿ç”¨@interface è‡ªå®šä¹‰æ³¨è§£æ—¶,è‡ªåŠ¨ç»§æ‰¿äº† java.lang .annotation.Annotation æ¥å£
- @interface ç”¨æ¥å£°æ˜ä¸€ä¸ªæ³¨è§£,æ ¼å¼: public @ interface æ³¨è§£å{å®šä¹‰å†…å®¹}
  1. å…¶ä¸­çš„æ¯ä¸€ä¸ªæ–¹æ³•å®é™…ä¸Šæ˜¯å£°æ˜äº†ä¸€ä¸ªé…ç½®å‚æ•°.
  2. æ–¹æ³•çš„åç§°å°±æ˜¯å‚æ•°çš„åç§°.
  3. è¿”å›å€¼ç±»å‹å°±æ˜¯å‚æ•°çš„ç±»å‹(è¿”å›å€¼åªèƒ½æ˜¯åŸºæœ¬ç±»å‹,Class , String , enum ).
  4. å¯ä»¥é€šè¿‡ default æ¥å£°æ˜å‚æ•°çš„é»˜è®¤å€¼
  5. å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°æˆå‘˜, ä¸€èˆ¬å‚æ•°åä¸º value
  6. æ³¨è§£å…ƒç´ å¿…é¡»è¦æœ‰å€¼ï¼Œæˆ‘ä»¬å®šä¹‰æ³¨è§£å…ƒç´ æ—¶,ç»å¸¸ä½¿ç”¨ç©ºå­—ç¬¦ä¸²ï¼Œ0 ä½œä¸ºé»˜è®¤å€¼.

```Java
import java.lang.annotation.*;

public class Anno3 {

  public static void main(String[] args) {

  }

  //æ³¨è§£å¯ä»¥æ˜¾ç¤ºèµ‹å€¼ï¼Œå¦‚æœæ²¡æœ‰é»˜è®¤å€¼ ï¼Œæˆ‘ä»¬å°±å¿…é¡»ç»™æ³¨è§£èµ‹å€¼
  @MyAnnotation2(name = {"Weidows", "é½ä¸‹æ— è´°"}, age = 21)
  public void test() {
  }

  @MyAnnotation3("Weidows") //å‚æ•°åªæœ‰ä¸€ä¸ªï¼Œä¸”å‚æ•°åä¸ºvalue
  public void test1() {
  }
}

@Target({ElementType.METHOD, ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@interface MyAnnotation2 {
  //æ³¨è§£çš„å‚æ•°:å‚æ•°ç±»å‹+å‚æ•°å();
  String[] name() default {""};

  int age() default 0;

  int id() default -1; // å¦‚æœé»˜è®¤å€¼ä¸º-1,ä»£è¡¨ä¸å­˜åœ¨ã€‚

  String schools() default "å®¶é‡Œè¹²å¤§å­¦";
}

/**
 * @Target(value = { ElementType.TYPE, ElementType.METHOD })
 * åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶å¯ä»¥çœç•¥å‚æ•°å,å¤šä¸ªå‚æ•°æ—¶ä¸å¯çœç•¥
 */
@Target({ElementType.TYPE, ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@interface MyAnnotation3 {
  //åªæœ‰ä¸€ä¸ªå‚æ•°æ—¶ï¼Œå‚æ•°åä¸ºvalueæ—¶ï¼Œä½¿ç”¨æ—¶ä¸éœ€å‚æ•°å
  String value();
}
```

> ç°åœ¨,æ³¨è§£å®šä¹‰å’Œä½¿ç”¨ç»“æŸäº†,ä¸‹é¢ç»“åˆåå°„æ¥è¯»å–æ³¨è§£æ•°æ®.

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

## åå°„

- å¯ä»¥åœ¨è¿è¡Œæ—¶å®ç°åŠ¨æ€åˆ›å»ºå¯¹è±¡å’Œç¼–è¯‘,æœ‰å¾ˆå¤§çš„çµæ´»æ€§,ä½†ä¼šå½±å“ä¸€å®šæ€§èƒ½

### Class ç±»

- Class ç±»æ—¶åå°„æœºåˆ¶çš„æ ¹æº,å¸¸ç”¨æ–¹æ³•å¦‚ä¸‹:

  <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/hpp/20210226151038.png" alt="20210226151038" />

- è·å– Class ç±»çš„å¯¹è±¡

  ```Java
  public class Demo1 {
    public static void main(String[] args) throws ClassNotFoundException {
      //æ–¹å¼ä¸€ï¼šé€šè¿‡å¯¹è±¡è·å–
      Class c1 = new Student().getClass();
      System.out.println(c1);

      //æ–¹å¼äºŒï¼šé€šè¿‡fornameè·å–
      Class c2 = Class.forName("twenty_one.reflection.Person");
      System.out.println(c2);

      //é€šè¿‡ç±»å.classè·å¾—(æœ€å¯é ,é«˜æ•ˆ)
      Class c3 = Student.class;
      System.out.println(c3);

      //æ–¹å¼å››ï¼šåŸºæœ¬å†…ç½®ç±»å‹çš„åŒ…è£…ç±»éƒ½æœ‰ä¸€ä¸ªTYPEå±æ€§
      Class c4 = Integer.TYPE;
      System.out.println(c4);
    }
  }

  class Person {
    public String name;

    public Person() {
    }

    public Person(String name) {
      this.name = name;
    }

    @Override
    public String toString() {
      return "Person{" + "name='" + name + '\'' + '}';
    }
  }

  class Student extends Person {
    public Student() {
      this.name = "Student";
    }
  }

  class Teacher extends Person {
    public Teacher() {
      this.name = "Teacher";
    }
  }
  ```

  ***

- Class å¯¹è±¡ç±»å‹

  ```Java
  import java.lang.annotation.ElementType;

  public class Demo2 {
    public static void main(String[] args) {
      Class c1 = Object.class; //ç±»
      Class c2 = Runnable.class; //æ¥å£
      Class c3 = String[].class; //- -ç»´æ•°ç»„
      Class c4 = int[][].class; //äºŒç»´æ•°ç»„
      Class c5 = Override.class; //æ³¨è§£
      Class c6 = ElementType.class; //æšä¸¾
      Class c7 = Integer.class; //åŸºæœ¬æ•°æ®ç±»å‹
      Class c8 = void.class; //void
      Class c9 = Class.class; //Class
      System.out.println(c1);//class java.lang.Object
      System.out.println(c2);//interface java.lang.Comparable
      System.out.println(c3);//class [Ljava.lang.String;
      System.out.println(c4);//class [[I
      System.out.println(c5);//interface java.lang.Override
      System.out.println(c6);//class java.lang.annotation.ElementType
      System.out.println(c7);//class java.lang.Integer
      System.out.println(c8);//void
      System.out.println(c9);//class java.lang.Class
    }
  }
  ```

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

### ç±»çš„åŠ è½½è¿‡ç¨‹

1. åŠ è½½: é¦–å…ˆç±»åŠ è½½å™¨è¯»å–.class å­—èŠ‚ç æ–‡ä»¶åˆ°æ–¹æ³•åŒºå†…å­˜,è½¬æ¢æ•°æ®ç»“æ„ä¸ºè¿è¡Œæ—¶,å¹¶ç”Ÿæˆ java.lang.Class å¯¹è±¡.

   - åœ¨åå°„ä¸­è·å– Class å¯¹è±¡å¹¶ä¸æ˜¯åˆ›å»º,è€Œæ˜¯ä»å†…å­˜ä¸­è·å–.

2. é“¾æ¥:å°† Java ç±»çš„äºŒè¿›åˆ¶ä»£ç åˆå¹¶åˆ° JVM çš„è¿è¡ŒçŠ¶æ€ä¹‹ä¸­çš„è¿‡ç¨‹ã€‚

   - éªŒè¯:ç¡®ä¿åŠ è½½çš„ç±»ä¿¡æ¯ç¬¦åˆ JVM è§„èŒƒï¼Œæ²¡æœ‰å®‰å…¨æ–¹é¢çš„é—®é¢˜
   - å‡†å¤‡:æ­£å¼ä¸ºç±»å˜é‡(static) åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡é»˜è®¤åˆå§‹å€¼çš„é˜¶æ®µ,è¿™äº›å†…å­˜éƒ½å°†åœ¨æ–¹æ³•åŒºä¸­è¿›è¡Œåˆ†é…ã€‚
   - è§£æ:è™šæ‹Ÿæœºå¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨(å¸¸é‡å)æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨(åœ°å€)çš„è¿‡ç¨‹ã€‚

3. åˆå§‹åŒ–:

   - æ‰§è¡Œç±»æ„é€ å™¨< clinit> ()æ–¹æ³•çš„è¿‡ç¨‹ã€‚`ç±»æ„é€ å™¨< clinit> ()æ–¹æ³•æ˜¯ç”±ç¼–è¯‘æœŸè‡ªåŠ¨æ”¶é›†ç±»ä¸­æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€ä»£ç å—ä¸­çš„è¯­å¥åˆå¹¶äº§ç”Ÿçš„ã€‚`(ç±»æ„é€  å™¨æ˜¯æ„é€ ç±»ä¿¡æ¯çš„ï¼Œä¸æ˜¯æ„é€ è¯¥ç±»å¯¹è±¡çš„æ„é€ å™¨)ã€‚
   - å½“åˆå§‹åŒ–ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å…¶çˆ¶ç±»è¿˜æ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚
   - è™šæ‹Ÿæœºä¼šä¿è¯ä¸€ ä¸ªç±»çš„ ()æ–¹æ³•åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­è¢«æ­£ç¡®åŠ é”å’ŒåŒæ­¥ã€‚

   ***

- ä¾‹å­

  ```Java
  public class Demo3 {
    public static void main(String[] args) {
      A a = new A();
      System.out.println(A.m);//300
      /*
        1.åŠ è½½åˆ°å†…å­˜ï¼Œäº§ç”Ÿä¸€ä¸ªç±»å¯¹åº”Classå¯¹è±¡
        2.é“¾æ¥ï¼Œé“¾æ¥ç»“æŸåm=â—
        3.åˆå§‹åŒ–
        <clinit>(){
            m=100;
            System.out.println( "Aç±»é™æ€ä»£ç å—åˆå§‹åŒ–");
            m = 300;
        }
      */
    }
  }

  class A {
    // * 1.1
    static int m = 100;

    // * 1.2
    static {
      System.out.println("Aç±»é™æ€ä»£ç å—åˆå§‹åŒ–");
      m = 300;
    }

    // * 2
    public A() {
      System.out.println("Aç±»çš„æ„é€ åˆå§‹åŒ–");
    }
  }
  ```

  <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/hpp/20210226172346.png" alt="20210226172346" />

---

## å®ä¾‹åŒ–ä¸ static åŠ è½½

- å°è¯•ä¸‹å®ä¾‹åŒ–ä¸å¦å¯¹ static èµ„æºè°ƒç”¨çš„å½±å“

- å®ä¾‹åŒ–+è°ƒç”¨

  ```Java
  public class Demo3 {
    public static void main(String[] args) {
      A a = new A();
      System.out.println(A.m);//300
    }
  }
  ```

  ```
  Aç±»é™æ€ä»£ç å—åˆå§‹åŒ–
  Aç±»çš„æ„é€ åˆå§‹åŒ–
  300
  ```

  ***

- å®ä¾‹åŒ–+ä¸è°ƒç”¨

  ```Java
  public class Demo3 {
    public static void main(String[] args) {
      A a = new A();
      // System.out.println(A.m);//300
    }
  }
  ```

  ```
  Aç±»é™æ€ä»£ç å—åˆå§‹åŒ–
  Aç±»çš„æ„é€ åˆå§‹åŒ–
  ```

  ***

- ä¸å®ä¾‹åŒ–+è°ƒç”¨

  ```Java
  public class Demo3 {
    public static void main(String[] args) {
      // A a = new A();
      System.out.println(A.m);//300
    }
  }
  ```

  ```
  Aç±»é™æ€ä»£ç å—åˆå§‹åŒ–
  300
  ```

- å¯ä»¥å‘ç°åœ¨å®ä¾‹åŒ–å¯¹è±¡ä¹‹åè°ƒç”¨ static èµ„æº,å¹¶ä¸ä¼šå†æ¬¡æ‰§è¡Œé™æ€ä»£ç å—

  - å¦‚æœæ²¡å®ä¾‹åŒ–çš„æƒ…å†µä¸‹è°ƒå– static èµ„æº,ç±»ä¼šåŠ è½½,ä½†ä¸ä¼šæ‰§è¡Œæ„é€ å™¨

---

### ä»€ä¹ˆæ—¶å€™ä¼šå‘ç”Ÿç±»åˆå§‹åŒ–?

<img src="https://cdn.jsdelivr.net/gh/Weidows/Images/hpp/20210226172913.png" alt="20210226172913" />

```Java
public class Demo4 {

  static {
    System.out.println("mainç±»è¢«åŠ è½½");
  }

  public static void main(String[] args) throws ClassNotFoundException {
    //1.ä¸»åŠ¨å¼•ç”¨
    // Son son = new Son();
    /*
    * mainç±»è¢«åŠ è½½
    * çˆ¶ç±»è¢«åŠ è½½
    * å­ç±»è¢«åŠ è½½
    * */

    //åå°„ä¹Ÿä¼šäº§ç”Ÿä¸»åŠ¨å¼•ç”¨
    // Class.forName("twenty_one.reflection.Son");
    /*
     * mainç±»è¢«åŠ è½½
     * çˆ¶ç±»è¢«åŠ è½½
     * å­ç±»è¢«åŠ è½½
     * */

    //ä¸ä¼šäº§ç”Ÿç±»çš„å¼•ç”¨çš„æ–¹æ³•
    // System.out.println(Son.b);
    /*
    * mainç±»è¢«åŠ è½½
    * çˆ¶ç±»è¢«åŠ è½½
    * 2
    * */

    //åªä¼šmainç±»è¢«åŠ è½½
    // System.out.println(Son.M);
    /*
     * mainç±»è¢«åŠ è½½
     * 1
     * */

    //å…¨åŠ è½½
    System.out.println(Son.m);
    /*
     * mainç±»è¢«åŠ è½½
     * çˆ¶ç±»è¢«åŠ è½½
     * å­ç±»è¢«åŠ è½½
     * 100
     */
  }
}

class Father {
  static int b = 2;
  static {
    System.out.println("çˆ¶ç±»è¢«åŠ è½½");
  }
}

class Son extends Father {
  static {
    System.out.println("å­ç±»è¢«åŠ è½½");
  }
  static int m = 100;
  static final int M = 1;
}
```

![åˆ†å‰²çº¿](https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png)

## ç±»åŠ è½½å™¨

- ä½œç”¨

  <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/hpp/20210227171646.png" alt="20210227171646" />

- åˆ†ç±»

  <img src="https://cdn.jsdelivr.net/gh/Weidows/Images/hpp/20210227172006.png" alt="20210227172006" />

  ***

- æ“ä½œç±»åŠ è½½å™¨

  ```Java
  public class Demo5 {
    public static void main(String[] args) throws ClassNotFoundException {
      //è·å–ç³»ç»Ÿçš„ç±»åŠ è½½å™¨
      ClassLoader systemClassLoader = ClassLoader.getSystemClassLoader();
      System.out.println(systemClassLoader);//jdk.internal.loader.ClassLoaders$AppClassLoader@4459eb14

      //è·å–ç³»ç»Ÿç±»åŠ è½½å™¨çš„çˆ¶ç±»åŠ è½½å™¨-->æ‰©å±•ç±»åŠ è½½å™¨
      ClassLoader parent = systemClassLoader.getParent();
      System.out.println(parent);//jdk.internal.loader.ClassLoaders$PlatformClassLoader@7960847b

      //è·å–æ‰©å±•ç±»åŠ è½½å™¨çš„çˆ¶ç±»åŠ è½½å™¨-->æ ¹åŠ è½½å™¨(C/C++)
      ClassLoader grantparent = parent.getParent();
      System.out.println(grantparent);//null

      //æµ‹è¯•å½“å‰ç±»æ˜¯å“ªä¸ªåŠ è½½å™¨åŠ è½½çš„
      ClassLoader classLoader = Demo5.class.getClassLoader();
      System.out.println(classLoader);//jdk.internal.loader.ClassLoaders$AppClassLoader@4459eb14

      //æµ‹è¯•JDKå†…ç½®çš„ç±»æ˜¯è°åŠ è½½çš„
      ClassLoader classLoader1 = Class.forName("java.lang.Object").getClassLoader();
      System.out.println(classLoader1);//null

      //å¦‚ä½•è·å¾—ç³»ç»Ÿç±»åŠ è½½å™¨å¯ä»¥åŠ è½½çš„è·¯å¾„
      System.out.println(System.getProperty("java.class.path"));//D:\Game\Weidows\Java\target\classes;D:\Game\Scoop\persist\maven\mvn-repository\commons-io\commons-io\2.8.0\commons-io-2.8.0.jar
    }
  }
  ```
