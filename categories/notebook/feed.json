{
    "version": "https://jsonfeed.org/version/1",
    "title": "â­ï¸é½ä¸‹æ— è´°â­ï¸ â€¢ All posts by \"notebook\" category",
    "description": "May all the beauty be bless.âœ¨",
    "home_page_url": "https://weidows.github.io",
    "items": [
        {
            "id": "https://weidows.github.io/post/public-post/notebook/ML/",
            "url": "https://weidows.github.io/post/public-post/notebook/ML/",
            "title": "ğŸ‘€Code-4-Machine-Learning",
            "date_published": "2022-04-11T07:07:22.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2022-02-23 02:28:46\n * @FilePath: \\Blog-private\\scaffolds\\post.md\n * @Description:\n * @!: *********************************************************************\n-->\n<h2 id=\"åº\">åº</h2>\n<p>æ­¤æ–‡ä¸ºå…¶ä»–æ–‡ç« çš„ä»£ç éƒ¨åˆ†:</p>\n<blockquote>\n<p><a href=\"../../../AI/AI\">ğŸŠAll-about-AI</a></p>\n</blockquote>\n<p>ä¹Ÿæä¾›äº† notebook å½¢å¼: <a href=\"https://github.com/Weidows-projects/public-post/blob/main/notebook/ML/ML.ipynb\">ä»£ç åœ°å€</a></p>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"åˆ†å‰²çº¿\"></a></p>\n<h2 id=\"æ•°æ®é¢„å¤„ç†æ–¹æ³•\">æ•°æ®é¢„å¤„ç†æ–¹æ³•</h2>\n<h3 id=\"æ ‡å‡†åŒ–-å‡å€¼ç§»é™¤\">æ ‡å‡†åŒ–-å‡å€¼ç§»é™¤</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ•°æ®é¢„å¤„ç†ä¹‹ï¼šå‡å€¼ç§»é™¤ç¤ºä¾‹</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ ·æœ¬æ•°æ®</span></span><br><span class=\"line\">raw_samples = np.array([</span><br><span class=\"line\">    [<span class=\"number\">3.0</span>, -<span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>],\\</span><br><span class=\"line\">    [<span class=\"number\">0.0</span>, <span class=\"number\">4.0</span>, <span class=\"number\">3.0</span>], \\</span><br><span class=\"line\">    [<span class=\"number\">1.0</span>, -<span class=\"number\">4.0</span>, <span class=\"number\">2.0</span>]]\\</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ±‚æ¯åˆ—çš„å¹³å‡å€¼ axis=0ä¸ºåˆ—, =1ä¸ºè¡Œ ä¸å¡«å°±è®¡ç®—æ‰€æœ‰å€¼</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(raw_samples.mean(axis=<span class=\"number\">0</span>))</span><br><span class=\"line\"><span class=\"comment\"># æ±‚æ¯åˆ—æ ‡å‡†å·®</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(raw_samples.std(axis=<span class=\"number\">0</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">std_samples = raw_samples.copy()  <span class=\"comment\"># å¤åˆ¶æ ·æœ¬æ•°æ®</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> col <span class=\"keyword\">in</span> std_samples.T:  <span class=\"comment\"># .Tä¸ºè½¬ç½®,éå†æ¯åˆ—</span></span><br><span class=\"line\">    col_mean = col.mean()  <span class=\"comment\"># è®¡ç®—å¹³å‡æ•°</span></span><br><span class=\"line\">    col_std = col.std()  <span class=\"comment\"># æ±‚æ ‡å‡†å·®</span></span><br><span class=\"line\">    col -= col_mean  <span class=\"comment\"># å‡å¹³å‡å€¼</span></span><br><span class=\"line\">    col /= col_std  <span class=\"comment\"># é™¤æ ‡å‡†å·®</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å‡å€¼æ— é™è¶‹è¿‘0,ä½†å¯èƒ½ä¸æ˜¯0</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(std_samples.mean(axis=<span class=\"number\">0</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(std_samples.std(axis=<span class=\"number\">0</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># scale æ ‡å‡†ç§»é™¤,ä¸ä¸Šé¢åŠŸèƒ½ç›¸åŒ</span></span><br><span class=\"line\">std_samples = sp.scale(raw_samples)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(std_samples.mean(axis=<span class=\"number\">0</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(std_samples.std(axis=<span class=\"number\">0</span>))</span><br></pre></td></tr></table></figure>\n<pre><code>[ 1.33333333 -0.33333333  2.33333333]\n[1.24721913 3.29983165 0.47140452]\n[ 5.55111512e-17  0.00000000e+00 -2.96059473e-16]\n[1. 1. 1.]\n[ 5.55111512e-17  0.00000000e+00 -2.96059473e-16]\n[1. 1. 1.]\n</code></pre>\n<h3 id=\"èŒƒå›´ç¼©æ”¾-2\">èŒƒå›´ç¼©æ”¾</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># æ•°æ®é¢„å¤„ç†ä¹‹ï¼šèŒƒå›´ç¼©æ”¾</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ ·æœ¬æ•°æ®</span></span><br><span class=\"line\">raw_samples = np.array([</span><br><span class=\"line\">    [<span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>, <span class=\"number\">3.0</span>],\\</span><br><span class=\"line\">    [<span class=\"number\">4.0</span>, <span class=\"number\">5.0</span>, <span class=\"number\">6.0</span>],\\</span><br><span class=\"line\">    [<span class=\"number\">7.0</span>, <span class=\"number\">8.0</span>, <span class=\"number\">9.0</span>]]).astype(<span class=\"string\">&quot;float64&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">mms_samples = raw_samples.copy()  <span class=\"comment\"># å¤åˆ¶æ ·æœ¬æ•°æ®</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> col <span class=\"keyword\">in</span> mms_samples.T:</span><br><span class=\"line\">    col_min = col.<span class=\"built_in\">min</span>()</span><br><span class=\"line\">    col_max = col.<span class=\"built_in\">max</span>()</span><br><span class=\"line\">    col -= col_min</span><br><span class=\"line\">    col /= (col_max - col_min)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(mms_samples)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ ¹æ®ç»™å®šèŒƒå›´åˆ›å»ºä¸€ä¸ªèŒƒå›´ç¼©æ”¾å™¨å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\"># ä½¿ç”¨èŒƒå›´ç¼©æ”¾å™¨å®ç°ç‰¹å¾å€¼èŒƒå›´ç¼©æ”¾</span></span><br><span class=\"line\">mms_samples = sp.MinMaxScaler(feature_range=(<span class=\"number\">0</span>, <span class=\"number\">1</span>))\\</span><br><span class=\"line\">  .fit_transform(raw_samples)  <span class=\"comment\"># ç¼©æ”¾</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(mms_samples)</span><br></pre></td></tr></table></figure>\n<pre><code>[[0.  0.  0. ]\n [0.5 0.5 0.5]\n [1.  1.  1. ]]\n[[0.  0.  0. ]\n [0.5 0.5 0.5]\n [1.  1.  1. ]]\n</code></pre>\n<h3 id=\"å½’ä¸€åŒ–-2\">å½’ä¸€åŒ–</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ ·æœ¬æ•°æ®</span></span><br><span class=\"line\">raw_samples = np.array([</span><br><span class=\"line\">    [<span class=\"number\">10.0</span>, <span class=\"number\">20.0</span>, <span class=\"number\">5.0</span>],\\</span><br><span class=\"line\">    [<span class=\"number\">8.0</span>, <span class=\"number\">10.0</span>, <span class=\"number\">1.0</span>]])</span><br><span class=\"line\"></span><br><span class=\"line\">nor_samples = raw_samples.copy()</span><br><span class=\"line\"><span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> nor_samples:</span><br><span class=\"line\">    row /= <span class=\"built_in\">abs</span>(row).<span class=\"built_in\">sum</span>()  <span class=\"comment\"># å…ˆå¯¹è¡Œæ±‚ç»å¯¹å€¼ï¼Œå†æ±‚å’Œï¼Œå†é™¤ä»¥ç»å¯¹å€¼ä¹‹å’Œ</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(nor_samples)  <span class=\"comment\"># æ‰“å°ç»“æœ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># norm=l1  /=ç»å¯¹å€¼ä¹‹å’Œ</span></span><br><span class=\"line\"><span class=\"comment\"># norm=l2  /=å¹³æ–¹ä¹‹å’Œ</span></span><br><span class=\"line\">nor_samples = sp.normalize(raw_samples.copy(), norm=<span class=\"string\">&#x27;l1&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(nor_samples)  <span class=\"comment\"># æ‰“å°ç»“æœ</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>[[0.28571429 0.57142857 0.14285714]\n [0.42105263 0.52631579 0.05263158]]\n[[0.28571429 0.57142857 0.14285714]\n [0.42105263 0.52631579 0.05263158]]\n</code></pre>\n<h3 id=\"äºŒå€¼åŒ–-2\">äºŒå€¼åŒ–</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># äºŒå€¼åŒ–</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\">raw_samples = np.array([[<span class=\"number\">65.5</span>, <span class=\"number\">89.0</span>, <span class=\"number\">73.0</span>],\\</span><br><span class=\"line\">                        [<span class=\"number\">55.0</span>, <span class=\"number\">99.0</span>, <span class=\"number\">98.5</span>],\\</span><br><span class=\"line\">                        [<span class=\"number\">45.0</span>, <span class=\"number\">22.5</span>, <span class=\"number\">60.0</span>]])</span><br><span class=\"line\"></span><br><span class=\"line\">bin_samples = raw_samples.copy()  <span class=\"comment\"># å¤åˆ¶æ•°ç»„</span></span><br><span class=\"line\"><span class=\"comment\"># ç”Ÿæˆæ©ç æ•°ç»„</span></span><br><span class=\"line\">mask1 = bin_samples &lt; <span class=\"number\">60</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(mask1)</span><br><span class=\"line\">mask2 = bin_samples &gt;= <span class=\"number\">60</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é€šè¿‡æ©ç è¿›è¡ŒäºŒå€¼åŒ–å¤„ç† (åªè½¬æ¢Trueçš„ä½ç½®)</span></span><br><span class=\"line\">bin_samples[mask1] = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(bin_samples)</span><br><span class=\"line\">bin_samples[mask2] = <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(bin_samples)  <span class=\"comment\"># æ‰“å°ç»“æœ</span></span><br><span class=\"line\"></span><br><span class=\"line\">bin_transformer = sp.Binarizer(threshold=<span class=\"number\">60</span> - <span class=\"number\">1</span>)  <span class=\"comment\"># åˆ›å»ºäºŒå€¼åŒ–å¯¹è±¡(æ³¨æ„è¾¹ç•Œå€¼)</span></span><br><span class=\"line\">bin_samples = bin_transformer.transform(raw_samples.copy())  <span class=\"comment\"># äºŒå€¼åŒ–é¢„å¤„ç†</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(bin_samples)</span><br></pre></td></tr></table></figure>\n<pre><code>[[False False False]\n [ True False False]\n [ True  True False]]\n[[65.5 89.  73. ]\n [ 0.  99.  98.5]\n [ 0.   0.  60. ]]\n[[1. 1. 1.]\n [0. 1. 1.]\n [0. 0. 1.]]\n[[1. 1. 1.]\n [0. 1. 1.]\n [0. 0. 1.]]\n</code></pre>\n<h3 id=\"ç‹¬çƒ­ç¼–ç ç¤ºä¾‹\">ç‹¬çƒ­ç¼–ç ç¤ºä¾‹</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\">raw_samples = np.array([[<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>],\\</span><br><span class=\"line\">                        [<span class=\"number\">7</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>],\\</span><br><span class=\"line\">                        [<span class=\"number\">1</span>, <span class=\"number\">8</span>, <span class=\"number\">6</span>],\\</span><br><span class=\"line\">                        [<span class=\"number\">7</span>, <span class=\"number\">3</span>, <span class=\"number\">9</span>]])</span><br><span class=\"line\"></span><br><span class=\"line\">one_hot_encoder = sp.OneHotEncoder(</span><br><span class=\"line\">    sparse=<span class=\"literal\">False</span>,  <span class=\"comment\"># æ˜¯å¦é‡‡ç”¨ç¨€ç–æ ¼å¼</span></span><br><span class=\"line\">    dtype=<span class=\"string\">&quot;int32&quot;</span>,</span><br><span class=\"line\">    categories=<span class=\"string\">&quot;auto&quot;</span>)  <span class=\"comment\"># è‡ªåŠ¨ç¼–ç </span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ‰§è¡Œç‹¬çƒ­ç¼–ç </span></span><br><span class=\"line\">oh_samples = one_hot_encoder.fit_transform(raw_samples.copy())</span><br><span class=\"line\"><span class=\"built_in\">print</span>(oh_samples)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(one_hot_encoder.inverse_transform(oh_samples))  <span class=\"comment\"># è§£ç </span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>[[1 0 1 0 0 1 0 0 0]\n [0 1 0 1 0 0 1 0 0]\n [1 0 0 0 1 0 0 1 0]\n [0 1 1 0 0 0 0 0 1]]\n[[1 3 2]\n [7 5 4]\n [1 8 6]\n [7 3 9]]\n</code></pre>\n<h3 id=\"æ ‡ç­¾ç¼–ç -2\">æ ‡ç­¾ç¼–ç </h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\">raw_samples = np.array([<span class=\"string\">&#x27;audi&#x27;</span>, <span class=\"string\">&#x27;ford&#x27;</span>, <span class=\"string\">&#x27;audi&#x27;</span>, <span class=\"string\">&#x27;bmw&#x27;</span>, <span class=\"string\">&#x27;ford&#x27;</span>, <span class=\"string\">&#x27;bmw&#x27;</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">lb_encoder = sp.LabelEncoder()  <span class=\"comment\"># å®šä¹‰æ ‡ç­¾ç¼–ç å¯¹è±¡</span></span><br><span class=\"line\">lb_samples = lb_encoder.fit_transform(raw_samples.copy())  <span class=\"comment\"># æ‰§è¡Œæ ‡ç­¾ç¼–ç </span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(lb_samples)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(lb_encoder.inverse_transform(lb_samples))  <span class=\"comment\"># é€†å‘è½¬æ¢</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>[0 2 0 1 2 1]\n['audi' 'ford' 'audi' 'bmw' 'ford' 'bmw']\n</code></pre>\n<h2 id=\"åŸºæœ¬é—®é¢˜-2\">åŸºæœ¬é—®é¢˜</h2>\n<h3 id=\"å›å½’é—®é¢˜-2\">å›å½’é—®é¢˜</h3>\n<h4 id=\"çº¿æ€§å›å½’-2\">çº¿æ€§å›å½’</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> mp</span><br><span class=\"line\"><span class=\"keyword\">from</span> mpl_toolkits.mplot3d <span class=\"keyword\">import</span> axes3d</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è®­ç»ƒæ•°æ®é›†</span></span><br><span class=\"line\">train_x = np.array([<span class=\"number\">0.5</span>, <span class=\"number\">0.6</span>, <span class=\"number\">0.8</span>, <span class=\"number\">1.1</span>, <span class=\"number\">1.4</span>])  <span class=\"comment\"># è¾“å…¥é›†</span></span><br><span class=\"line\">train_y = np.array([<span class=\"number\">5.0</span>, <span class=\"number\">5.5</span>, <span class=\"number\">6.0</span>, <span class=\"number\">6.8</span>, <span class=\"number\">7.0</span>])  <span class=\"comment\"># è¾“å‡ºé›†</span></span><br><span class=\"line\"></span><br><span class=\"line\">n_epochs = <span class=\"number\">30</span>  <span class=\"comment\"># è¿­ä»£æ¬¡æ•°</span></span><br><span class=\"line\">l_rate = <span class=\"number\">0.01</span>  <span class=\"comment\"># å­¦ä¹ ç‡</span></span><br><span class=\"line\">epochs = []  <span class=\"comment\"># è®°å½•è¿­ä»£æ¬¡æ•°</span></span><br><span class=\"line\">losses = []  <span class=\"comment\"># è®°å½•æŸå¤±å€¼</span></span><br><span class=\"line\"></span><br><span class=\"line\">w0, w1 = [<span class=\"number\">1</span>], [<span class=\"number\">1</span>]  <span class=\"comment\"># æ¨¡å‹åˆå§‹å€¼</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, n_epochs + <span class=\"number\">1</span>):</span><br><span class=\"line\">    epochs.append(i)  <span class=\"comment\"># è®°å½•ç¬¬å‡ æ¬¡è¿­ä»£</span></span><br><span class=\"line\"></span><br><span class=\"line\">    y = w0[-<span class=\"number\">1</span>] + w1[-<span class=\"number\">1</span>] * train_x  <span class=\"comment\"># å–å‡ºæœ€æ–°çš„w0,w1è®¡ç®—çº¿æ€§æ–¹ç¨‹è¾“å‡º</span></span><br><span class=\"line\">    <span class=\"comment\"># æŸå¤±å‡½æ•°(å‡æ–¹å·®)</span></span><br><span class=\"line\">    loss = (((train_y - y)**<span class=\"number\">2</span>).<span class=\"built_in\">sum</span>()) / <span class=\"number\">2</span></span><br><span class=\"line\">    losses.append(loss)  <span class=\"comment\"># è®°å½•æ¯æ¬¡è¿­ä»£çš„æŸå¤±å€¼</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;%d: w0=%f, w1=%f, loss=%f&quot;</span> % (i, w0[-<span class=\"number\">1</span>], w1[-<span class=\"number\">1</span>], loss))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># è®¡ç®—w0,w1çš„åå¯¼æ•°</span></span><br><span class=\"line\">    d0 = -(train_y - y).<span class=\"built_in\">sum</span>()</span><br><span class=\"line\">    d1 = -(train_x * (train_y - y)).<span class=\"built_in\">sum</span>()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># æ›´æ–°w0,w1</span></span><br><span class=\"line\">    w0.append(w0[-<span class=\"number\">1</span>] - (d0 * l_rate))</span><br><span class=\"line\">    w1.append(w1[-<span class=\"number\">1</span>] - (d1 * l_rate))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">###################### è®­ç»ƒè¿‡ç¨‹å¯è§†åŒ– ######################</span></span><br><span class=\"line\"><span class=\"comment\">## æŸå¤±å‡½æ•°æ”¶æ•›è¿‡ç¨‹</span></span><br><span class=\"line\">w0 = np.array(w0[:-<span class=\"number\">1</span>])</span><br><span class=\"line\">w1 = np.array(w1[:-<span class=\"number\">1</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">mp.figure(<span class=\"string\">&quot;Losses&quot;</span>, facecolor=<span class=\"string\">&quot;lightgray&quot;</span>)  <span class=\"comment\"># åˆ›å»ºä¸€ä¸ªçª—ä½“</span></span><br><span class=\"line\">mp.title(<span class=\"string\">&quot;epoch&quot;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&quot;loss&quot;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.grid(linestyle=<span class=\"string\">&quot;:&quot;</span>)  <span class=\"comment\"># ç½‘æ ¼çº¿ï¼šè™šçº¿</span></span><br><span class=\"line\">mp.plot(epochs, losses, c=<span class=\"string\">&quot;blue&quot;</span>, label=<span class=\"string\">&quot;loss&quot;</span>)</span><br><span class=\"line\">mp.legend()  <span class=\"comment\"># å›¾ä¾‹</span></span><br><span class=\"line\">mp.tight_layout()  <span class=\"comment\"># ç´§å‡‘æ ¼å¼</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## æ˜¾ç¤ºæ¨¡å‹ç›´çº¿</span></span><br><span class=\"line\">pred_y = w0[-<span class=\"number\">1</span>] + w1[-<span class=\"number\">1</span>] * train_x  <span class=\"comment\"># æ ¹æ®xé¢„æµ‹y</span></span><br><span class=\"line\">mp.figure(<span class=\"string\">&quot;Linear Regression&quot;</span>, facecolor=<span class=\"string\">&quot;lightgray&quot;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&quot;Linear Regression&quot;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.xlabel(<span class=\"string\">&quot;x&quot;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&quot;y&quot;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.grid(linestyle=<span class=\"string\">&quot;:&quot;</span>)</span><br><span class=\"line\">mp.scatter(train_x, train_y, c=<span class=\"string\">&quot;blue&quot;</span>, label=<span class=\"string\">&quot;Traing&quot;</span>)  <span class=\"comment\"># ç»˜åˆ¶æ ·æœ¬æ•£ç‚¹å›¾</span></span><br><span class=\"line\">mp.plot(train_x, pred_y, c=<span class=\"string\">&quot;red&quot;</span>, label=<span class=\"string\">&quot;Regression&quot;</span>)</span><br><span class=\"line\">mp.legend()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ˜¾ç¤ºæ¢¯åº¦ä¸‹é™è¿‡ç¨‹(å¤åˆ¶ç²˜è´´å³å¯ï¼Œä¸éœ€è¦ç¼–å†™)</span></span><br><span class=\"line\"><span class=\"comment\"># è®¡ç®—æŸå¤±å‡½æ•°æ›²é¢ä¸Šçš„ç‚¹ loss = f(w0, w1)</span></span><br><span class=\"line\">arr1 = np.linspace(<span class=\"number\">0</span>, <span class=\"number\">10</span>, <span class=\"number\">500</span>)  <span class=\"comment\"># 0~9é—´äº§ç”Ÿ500ä¸ªå…ƒç´ çš„å‡åŒ€åˆ—è¡¨</span></span><br><span class=\"line\">arr2 = np.linspace(<span class=\"number\">0</span>, <span class=\"number\">3.5</span>, <span class=\"number\">500</span>)  <span class=\"comment\"># 0~3.5é—´äº§ç”Ÿ500ä¸ªå…ƒç´ çš„å‡åŒ€åˆ—è¡¨</span></span><br><span class=\"line\"></span><br><span class=\"line\">grid_w0, grid_w1 = np.meshgrid(arr1, arr2)  <span class=\"comment\"># äº§ç”ŸäºŒç»´çŸ©é˜µ</span></span><br><span class=\"line\"></span><br><span class=\"line\">flat_w0, flat_w1 = grid_w0.ravel(), grid_w1.ravel()  <span class=\"comment\"># äºŒç»´çŸ©é˜µæ‰å¹³åŒ–</span></span><br><span class=\"line\">loss_metrix = train_y.reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>)  <span class=\"comment\"># ç”Ÿæˆè¯¯å·®çŸ©é˜µï¼ˆ-1,1ï¼‰è¡¨ç¤ºè‡ªåŠ¨è®¡ç®—ç»´åº¦</span></span><br><span class=\"line\">outer = np.outer(train_x, flat_w1)  <span class=\"comment\"># æ±‚å¤–ç§¯ï¼ˆtrain_xå’Œflat_w1å…ƒç´ ä¸¤ä¸¤ç›¸ä¹˜çš„æ–°çŸ©é˜µï¼‰</span></span><br><span class=\"line\"><span class=\"comment\"># è®¡ç®—æŸå¤±ï¼š((w0 + w1*x - y)**2)/2</span></span><br><span class=\"line\">flat_loss = (((flat_w0 + outer - loss_metrix) ** <span class=\"number\">2</span>).<span class=\"built_in\">sum</span>(axis=<span class=\"number\">0</span>)) / <span class=\"number\">2</span></span><br><span class=\"line\">grid_loss = flat_loss.reshape(grid_w0.shape)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.figure(<span class=\"string\">&#x27;Loss Function&#x27;</span>)</span><br><span class=\"line\">ax = mp.axes(projection=<span class=\"string\">&#x27;3d&#x27;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&#x27;Loss Function&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">ax.set_xlabel(<span class=\"string\">&#x27;w0&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">ax.set_ylabel(<span class=\"string\">&#x27;w1&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">ax.set_zlabel(<span class=\"string\">&#x27;loss&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">ax.plot_surface(grid_w0, grid_w1, grid_loss, rstride=<span class=\"number\">10</span>, cstride=<span class=\"number\">10</span>, cmap=<span class=\"string\">&#x27;jet&#x27;</span>)</span><br><span class=\"line\">ax.plot(w0, w1, losses, <span class=\"string\">&#x27;o-&#x27;</span>, c=<span class=\"string\">&#x27;orangered&#x27;</span>, label=<span class=\"string\">&#x27;BGD&#x27;</span>, zorder=<span class=\"number\">5</span>)</span><br><span class=\"line\">mp.legend(loc=<span class=\"string\">&#x27;lower left&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.show()</span><br></pre></td></tr></table></figure>\n<pre><code>1: w0=1.000000, w1=1.000000, loss=44.175000\n2: w0=1.209000, w1=1.190600, loss=36.538828\n3: w0=1.399164, w1=1.363579, loss=30.231687\n4: w0=1.572208, w1=1.520546, loss=25.022227\n5: w0=1.729693, w1=1.662961, loss=20.719373\n6: w0=1.873039, w1=1.792151, loss=17.165309\n7: w0=2.003532, w1=1.909325, loss=14.229691\n8: w0=2.122345, w1=2.015577, loss=11.804865\n9: w0=2.230542, w1=2.111905, loss=9.801916\n10: w0=2.329091, w1=2.199215, loss=8.147408\n11: w0=2.418871, w1=2.278330, loss=6.780688\n12: w0=2.500681, w1=2.349997, loss=5.651660\n13: w0=2.575247, w1=2.414898, loss=4.718950\n14: w0=2.643230, w1=2.473648, loss=3.948384\n15: w0=2.705228, w1=2.526811, loss=3.311740\n16: w0=2.761786, w1=2.574896, loss=2.785706\n17: w0=2.813402, w1=2.618367, loss=2.351029\n18: w0=2.860524, w1=2.657645, loss=1.991807\n19: w0=2.903561, w1=2.693114, loss=1.694907\n20: w0=2.942886, w1=2.725122, loss=1.449482\n21: w0=2.978836, w1=2.753985, loss=1.246572\n22: w0=3.011719, w1=2.779990, loss=1.078777\n23: w0=3.041814, w1=2.803399, loss=0.939987\n24: w0=3.069373, w1=2.824449, loss=0.825153\n25: w0=3.094629, w1=2.843355, loss=0.730107\n26: w0=3.117790, w1=2.860315, loss=0.651405\n27: w0=3.139046, w1=2.875507, loss=0.586204\n28: w0=3.158572, w1=2.889091, loss=0.532154\n29: w0=3.176523, w1=2.901216, loss=0.487315\n30: w0=3.193044, w1=2.912016, loss=0.450086\n</code></pre>\n<p><img src=\"ML_files/ML_13_1.png\" alt=\"png\"></p>\n<p><img src=\"ML_files/ML_13_2.png\" alt=\"png\"></p>\n<p><img src=\"ML_files/ML_13_3.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># åˆ©ç”¨LinearRegressionå®ç°çº¿æ€§å›å½’</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.linear_model <span class=\"keyword\">as</span> lm  <span class=\"comment\"># çº¿æ€§æ¨¡å‹# çº¿æ€§æ¨¡å‹</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.metrics <span class=\"keyword\">as</span> sm  <span class=\"comment\"># æ¨¡å‹æ€§èƒ½è¯„ä»·æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> mp</span><br><span class=\"line\"></span><br><span class=\"line\">train_x = np.array([[<span class=\"number\">0.5</span>], [<span class=\"number\">0.6</span>], [<span class=\"number\">0.8</span>], [<span class=\"number\">1.1</span>], [<span class=\"number\">1.4</span>]])  <span class=\"comment\"># è¾“å…¥é›†</span></span><br><span class=\"line\">train_y = np.array([<span class=\"number\">5.0</span>, <span class=\"number\">5.5</span>, <span class=\"number\">6.0</span>, <span class=\"number\">6.8</span>, <span class=\"number\">7.0</span>])  <span class=\"comment\"># è¾“å‡ºé›†</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºçº¿æ€§å›å½’å™¨</span></span><br><span class=\"line\">line_model = lm.LinearRegression()</span><br><span class=\"line\"><span class=\"comment\"># ç”¨å·²çŸ¥è¾“å…¥ã€è¾“å‡ºæ•°æ®é›†è®­ç»ƒå›å½’å™¨</span></span><br><span class=\"line\">line_model.fit(train_x, train_y)</span><br><span class=\"line\"><span class=\"comment\"># æ ¹æ®è®­ç»ƒæ¨¡å‹é¢„æµ‹è¾“å‡º</span></span><br><span class=\"line\">pred_y = line_model.predict(train_x)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;coef_:&quot;</span>, line_model.coef_)  <span class=\"comment\"># ç³»æ•°</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;intercept_:&quot;</span>, line_model.intercept_)  <span class=\"comment\"># æˆªè·</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¯è§†åŒ–å›å½’æ›²çº¿</span></span><br><span class=\"line\">mp.figure(<span class=\"string\">&#x27;Linear Regression&#x27;</span>, facecolor=<span class=\"string\">&#x27;lightgray&#x27;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&#x27;Linear Regression&#x27;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.xlabel(<span class=\"string\">&#x27;x&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&#x27;y&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.tick_params(labelsize=<span class=\"number\">10</span>)</span><br><span class=\"line\">mp.grid(linestyle=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç»˜åˆ¶æ ·æœ¬ç‚¹</span></span><br><span class=\"line\">mp.scatter(train_x, train_y, c=<span class=\"string\">&#x27;blue&#x27;</span>, alpha=<span class=\"number\">0.8</span>, s=<span class=\"number\">60</span>, label=<span class=\"string\">&#x27;Sample&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç»˜åˆ¶æ‹Ÿåˆç›´çº¿</span></span><br><span class=\"line\">mp.plot(</span><br><span class=\"line\">    train_x,  <span class=\"comment\"># xåæ ‡æ•°æ®</span></span><br><span class=\"line\">    pred_y,  <span class=\"comment\"># yåæ ‡æ•°æ®</span></span><br><span class=\"line\">    c=<span class=\"string\">&#x27;orangered&#x27;</span>,</span><br><span class=\"line\">    label=<span class=\"string\">&#x27;Regression Line&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.legend()  <span class=\"comment\"># å·¦ä¸Šè§’çš„å›¾ä¾‹</span></span><br><span class=\"line\">mp.show()</span><br></pre></td></tr></table></figure>\n<pre><code>coef_: [2.2189781]\nintercept_: 4.107299270072994\n</code></pre>\n<p><img src=\"ML_files/ML_14_1.png\" alt=\"png\"></p>\n<h3 id=\"å†³ç­–æ ‘-éšæœºæ£®æ—-2\">å†³ç­–æ ‘-éšæœºæ£®æ—</h3>\n<h4 id=\"å†³ç­–æ ‘åˆ†ç±»\">å†³ç­–æ ‘åˆ†ç±»</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> DecisionTreeClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.preprocessing <span class=\"keyword\">import</span> LabelEncoder</span><br><span class=\"line\"><span class=\"keyword\">import</span> pydotplus</span><br><span class=\"line\"></span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;simHei&#x27;</span>]</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">iris_feature_E = <span class=\"string\">&#x27;sepal length&#x27;</span>, <span class=\"string\">&#x27;sepal width&#x27;</span>, <span class=\"string\">&#x27;petal length&#x27;</span>, <span class=\"string\">&#x27;petal width&#x27;</span></span><br><span class=\"line\">iris_feature = <span class=\"string\">&#x27;èŠ±è¼é•¿åº¦&#x27;</span>, <span class=\"string\">&#x27;èŠ±è¼å®½åº¦&#x27;</span>, <span class=\"string\">&#x27;èŠ±ç“£é•¿åº¦&#x27;</span>, <span class=\"string\">&#x27;èŠ±ç“£å®½åº¦&#x27;</span></span><br><span class=\"line\">iris_class = <span class=\"string\">&#x27;Iris-setosa&#x27;</span>, <span class=\"string\">&#x27;Iris-versicolor&#x27;</span>, <span class=\"string\">&#x27;Iris-virginica&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">path = <span class=\"string\">&#x27;iris_classification/iris.data&#x27;</span>  <span class=\"comment\"># æ•°æ®æ–‡ä»¶è·¯å¾„</span></span><br><span class=\"line\">data = pd.read_csv(path, header=<span class=\"literal\">None</span>)</span><br><span class=\"line\">x = data[<span class=\"built_in\">list</span>(<span class=\"built_in\">range</span>(<span class=\"number\">4</span>))]</span><br><span class=\"line\"><span class=\"comment\"># y = pd.Categorical(data[4]).codes</span></span><br><span class=\"line\">y = LabelEncoder().fit_transform(data[<span class=\"number\">4</span>])</span><br><span class=\"line\"><span class=\"comment\"># ä¸ºäº†å¯è§†åŒ–ï¼Œä»…ä½¿ç”¨å‰ä¸¤åˆ—ç‰¹å¾</span></span><br><span class=\"line\">x = x[[<span class=\"number\">0</span>, <span class=\"number\">1</span>]]</span><br><span class=\"line\"><span class=\"comment\"># x = x.iloc[:, :2]</span></span><br><span class=\"line\">x_train, x_test, y_train, y_test = train_test_split(x,</span><br><span class=\"line\">                                                    y,</span><br><span class=\"line\">                                                    test_size=<span class=\"number\">0.3</span>,</span><br><span class=\"line\">                                                    random_state=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å†³ç­–æ ‘å‚æ•°ä¼°è®¡</span></span><br><span class=\"line\"><span class=\"comment\"># min_samples_split = 10ï¼šå¦‚æœè¯¥ç»“ç‚¹åŒ…å«çš„æ ·æœ¬æ•°ç›®å¤§äº10ï¼Œåˆ™(æœ‰å¯èƒ½)å¯¹å…¶åˆ†æ”¯</span></span><br><span class=\"line\"><span class=\"comment\"># min_samples_leaf = 10ï¼šè‹¥å°†æŸç»“ç‚¹åˆ†æ”¯åï¼Œå¾—åˆ°çš„æ¯ä¸ªå­ç»“ç‚¹æ ·æœ¬æ•°ç›®éƒ½å¤§äº10ï¼Œåˆ™å®Œæˆåˆ†æ”¯ï¼›å¦åˆ™ï¼Œä¸è¿›è¡Œåˆ†æ”¯</span></span><br><span class=\"line\">model = DecisionTreeClassifier(criterion=<span class=\"string\">&#x27;entropy&#x27;</span>)</span><br><span class=\"line\">model.fit(x_train, y_train)</span><br><span class=\"line\">y_train_pred = model.predict(x_train)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;è®­ç»ƒé›†æ­£ç¡®ç‡ï¼š&#x27;</span>, accuracy_score(y_train, y_train_pred))</span><br><span class=\"line\">y_test_hat = model.predict(x_test)  <span class=\"comment\"># æµ‹è¯•æ•°æ®</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;æµ‹è¯•é›†æ­£ç¡®ç‡ï¼š&#x27;</span>, accuracy_score(y_test, y_test_hat))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ä¿å­˜</span></span><br><span class=\"line\"><span class=\"comment\"># dot -Tpng my.dot -o my.png</span></span><br><span class=\"line\"><span class=\"comment\"># 1ã€è¾“å‡º</span></span><br><span class=\"line\"><span class=\"comment\"># with open(&#x27;iris.dot&#x27;, &#x27;w&#x27;) as f:</span></span><br><span class=\"line\"><span class=\"comment\">#     tree.export_graphviz(model, out_file=f, feature_names=iris_feature_E[0:2], class_names=iris_class,</span></span><br><span class=\"line\"><span class=\"comment\">#                          filled=True, rounded=True, special_characters=True)</span></span><br><span class=\"line\">tree.export_graphviz(model,</span><br><span class=\"line\">                     out_file=<span class=\"string\">&#x27;iris_classification/iris.dot&#x27;</span>,</span><br><span class=\"line\">                     feature_names=iris_feature_E[<span class=\"number\">0</span>:<span class=\"number\">2</span>],</span><br><span class=\"line\">                     class_names=iris_class,</span><br><span class=\"line\">                     filled=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                     rounded=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                     special_characters=<span class=\"literal\">True</span>)</span><br><span class=\"line\"><span class=\"comment\"># 2ã€ç»™å®šæ–‡ä»¶å</span></span><br><span class=\"line\"><span class=\"comment\"># tree.export_graphviz(model, out_file=&#x27;iris.dot&#x27;)</span></span><br><span class=\"line\"><span class=\"comment\"># tree.export_graphviz(model, out_file=&#x27;iris.dot&#x27;)</span></span><br><span class=\"line\"><span class=\"comment\"># 3ã€è¾“å‡ºä¸ºpdfæ ¼å¼</span></span><br><span class=\"line\">dot_data = tree.export_graphviz(model,</span><br><span class=\"line\">                                out_file=<span class=\"literal\">None</span>,</span><br><span class=\"line\">                                feature_names=iris_feature_E[<span class=\"number\">0</span>:<span class=\"number\">2</span>],</span><br><span class=\"line\">                                class_names=iris_class,</span><br><span class=\"line\">                                filled=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                rounded=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                special_characters=<span class=\"literal\">True</span>)</span><br><span class=\"line\">graph = pydotplus.graph_from_dot_data(dot_data)</span><br><span class=\"line\">graph.write_pdf(<span class=\"string\">&#x27;iris_classification/iris.pdf&#x27;</span>)</span><br><span class=\"line\">f = <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;iris_classification/iris.png&#x27;</span>, <span class=\"string\">&#x27;wb&#x27;</span>)</span><br><span class=\"line\">f.write(graph.create_png())</span><br><span class=\"line\">f.close()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å›¾</span></span><br><span class=\"line\">N, M = <span class=\"number\">50</span>, <span class=\"number\">50</span>  <span class=\"comment\"># æ¨ªçºµå„é‡‡æ ·å¤šå°‘ä¸ªå€¼</span></span><br><span class=\"line\">x1_min, x2_min = x.<span class=\"built_in\">min</span>()</span><br><span class=\"line\">x1_max, x2_max = x.<span class=\"built_in\">max</span>()</span><br><span class=\"line\">t1 = np.linspace(x1_min, x1_max, N)</span><br><span class=\"line\">t2 = np.linspace(x2_min, x2_max, M)</span><br><span class=\"line\">x1, x2 = np.meshgrid(t1, t2)  <span class=\"comment\"># ç”Ÿæˆç½‘æ ¼é‡‡æ ·ç‚¹</span></span><br><span class=\"line\">x_show = np.stack((x1.flat, x2.flat), axis=<span class=\"number\">1</span>)  <span class=\"comment\"># æµ‹è¯•ç‚¹</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(x_show.shape)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;x_show = \\n&#x27;</span>, x_show)</span><br><span class=\"line\"></span><br><span class=\"line\">cm_light = mpl.colors.ListedColormap([<span class=\"string\">&#x27;#A0FFA0&#x27;</span>, <span class=\"string\">&#x27;#FFA0A0&#x27;</span>, <span class=\"string\">&#x27;#A0A0FF&#x27;</span>])</span><br><span class=\"line\">cm_dark = mpl.colors.ListedColormap([<span class=\"string\">&#x27;g&#x27;</span>, <span class=\"string\">&#x27;r&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>])</span><br><span class=\"line\">y_show_hat = model.predict(x_show)  <span class=\"comment\"># é¢„æµ‹å€¼</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_show_hat.shape)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_show_hat)</span><br><span class=\"line\">y_show_hat = y_show_hat.reshape(x1.shape)  <span class=\"comment\"># ä½¿ä¹‹ä¸è¾“å…¥çš„å½¢çŠ¶ç›¸åŒ</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_show_hat)</span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.pcolormesh(x1, x2, y_show_hat, cmap=cm_light, shading=<span class=\"string\">&#x27;auto&#x27;</span>)  <span class=\"comment\"># é¢„æµ‹å€¼çš„æ˜¾ç¤º</span></span><br><span class=\"line\">plt.scatter(x_test[<span class=\"number\">0</span>],</span><br><span class=\"line\">            x_test[<span class=\"number\">1</span>],</span><br><span class=\"line\">            c=y_test.ravel(),</span><br><span class=\"line\">            edgecolors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">            s=<span class=\"number\">100</span>,</span><br><span class=\"line\">            zorder=<span class=\"number\">10</span>,</span><br><span class=\"line\">            cmap=cm_dark,</span><br><span class=\"line\">            marker=<span class=\"string\">&#x27;*&#x27;</span>)  <span class=\"comment\"># æµ‹è¯•æ•°æ®</span></span><br><span class=\"line\">plt.scatter(x[<span class=\"number\">0</span>], x[<span class=\"number\">1</span>], c=y.ravel(), edgecolors=<span class=\"string\">&#x27;k&#x27;</span>, s=<span class=\"number\">20</span>,</span><br><span class=\"line\">            cmap=cm_dark)  <span class=\"comment\"># å…¨éƒ¨æ•°æ®</span></span><br><span class=\"line\">plt.xlabel(iris_feature[<span class=\"number\">0</span>], fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.ylabel(iris_feature[<span class=\"number\">1</span>], fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.xlim(x1_min, x1_max)</span><br><span class=\"line\">plt.ylim(x2_min, x2_max)</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>, color=<span class=\"string\">&#x27;#606060&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;é¸¢å°¾èŠ±æ•°æ®çš„å†³ç­–æ ‘åˆ†ç±»&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è®­ç»ƒé›†ä¸Šçš„é¢„æµ‹ç»“æœ</span></span><br><span class=\"line\">y_test = y_test.reshape(-<span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_test_hat)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_test)</span><br><span class=\"line\">result = (y_test_hat == y_test)  <span class=\"comment\"># Trueåˆ™é¢„æµ‹æ­£ç¡®ï¼ŒFalseåˆ™é¢„æµ‹é”™è¯¯</span></span><br><span class=\"line\">acc = np.mean(result)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;å‡†ç¡®åº¦: %.2f%%&#x27;</span> % (<span class=\"number\">100</span> * acc))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¿‡æ‹Ÿåˆï¼šé”™è¯¯ç‡</span></span><br><span class=\"line\">depth = np.arange(<span class=\"number\">1</span>, <span class=\"number\">15</span>)</span><br><span class=\"line\">err_train_list = []</span><br><span class=\"line\">err_test_list = []</span><br><span class=\"line\">clf = DecisionTreeClassifier(criterion=<span class=\"string\">&#x27;entropy&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> d <span class=\"keyword\">in</span> depth:</span><br><span class=\"line\">    clf.set_params(max_depth=d)</span><br><span class=\"line\">    clf.fit(x_train, y_train)</span><br><span class=\"line\">    y_train_pred = clf.predict(x_train)</span><br><span class=\"line\">    err_train = <span class=\"number\">1</span> - accuracy_score(y_train, y_train_pred)</span><br><span class=\"line\">    err_train_list.append(err_train)</span><br><span class=\"line\">    y_test_pred = clf.predict(x_test)</span><br><span class=\"line\">    err_test = <span class=\"number\">1</span> - accuracy_score(y_test, y_test_pred)</span><br><span class=\"line\">    err_test_list.append(err_test)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(d, <span class=\"string\">&#x27; æµ‹è¯•é›†é”™è¯¯ç‡: %.2f%%&#x27;</span> % (<span class=\"number\">100</span> * err_test))</span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.plot(depth,</span><br><span class=\"line\">         err_test_list,</span><br><span class=\"line\">         <span class=\"string\">&#x27;ro-&#x27;</span>,</span><br><span class=\"line\">         markeredgecolor=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">         lw=<span class=\"number\">2</span>,</span><br><span class=\"line\">         label=<span class=\"string\">&#x27;æµ‹è¯•é›†é”™è¯¯ç‡&#x27;</span>)</span><br><span class=\"line\">plt.plot(depth,</span><br><span class=\"line\">         err_train_list,</span><br><span class=\"line\">         <span class=\"string\">&#x27;go-&#x27;</span>,</span><br><span class=\"line\">         markeredgecolor=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">         lw=<span class=\"number\">2</span>,</span><br><span class=\"line\">         label=<span class=\"string\">&#x27;è®­ç»ƒé›†é”™è¯¯ç‡&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;å†³ç­–æ ‘æ·±åº¦&#x27;</span>, fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;é”™è¯¯ç‡&#x27;</span>, fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.legend(loc=<span class=\"string\">&#x27;lower left&#x27;</span>, fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;å†³ç­–æ ‘æ·±åº¦ä¸è¿‡æ‹Ÿåˆ&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>, color=<span class=\"string\">&#x27;#606060&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<pre><code>è®­ç»ƒé›†æ­£ç¡®ç‡ï¼š 0.9523809523809523\næµ‹è¯•é›†æ­£ç¡®ç‡ï¼š 0.6222222222222222\n(2500, 2)\nx_show = \n [[4.3        2.        ]\n [4.37346939 2.        ]\n [4.44693878 2.        ]\n ...\n [7.75306122 4.4       ]\n [7.82653061 4.4       ]\n [7.9        4.4       ]]\n(2500,)\n[0 0 0 ... 2 2 2]\n[[0 0 0 ... 1 1 1]\n [0 0 0 ... 1 1 1]\n [0 0 0 ... 1 1 1]\n ...\n [0 0 0 ... 2 2 2]\n [0 0 0 ... 2 2 2]\n [0 0 0 ... 2 2 2]]\n</code></pre>\n<p><img src=\"ML_files/ML_16_1.png\" alt=\"png\"></p>\n<pre><code>[0 1 2 0 2 2 1 0 0 2 2 0 1 2 1 0 2 1 0 0 1 0 2 0 2 1 0 0 1 1 2 2 2 2 1 0 1\n 0 2 1 2 0 1 1 1]\n[0 1 1 0 2 1 2 0 0 2 1 0 2 1 1 0 1 1 0 0 1 1 1 0 2 1 0 0 1 2 1 2 1 2 2 0 1\n 0 1 2 2 0 2 2 1]\nå‡†ç¡®åº¦: 62.22%\n1  æµ‹è¯•é›†é”™è¯¯ç‡: 44.44%\n2  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%\n3  æµ‹è¯•é›†é”™è¯¯ç‡: 20.00%\n4  æµ‹è¯•é›†é”™è¯¯ç‡: 24.44%\n5  æµ‹è¯•é›†é”™è¯¯ç‡: 24.44%\n6  æµ‹è¯•é›†é”™è¯¯ç‡: 28.89%\n7  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%\n8  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%\n9  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%\n10  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%\n11  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%\n12  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%\n13  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%\n14  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%\n</code></pre>\n<p><img src=\"ML_files/ML_16_3.png\" alt=\"png\"></p>\n<h4 id=\"éšæœºæ£®æ—-3\">éšæœºæ£®æ—</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> DecisionTreeClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"></span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">iris_feature = <span class=\"string\">u&#x27;èŠ±è¼é•¿åº¦&#x27;</span>, <span class=\"string\">u&#x27;èŠ±è¼å®½åº¦&#x27;</span>, <span class=\"string\">u&#x27;èŠ±ç“£é•¿åº¦&#x27;</span>, <span class=\"string\">u&#x27;èŠ±ç“£å®½åº¦&#x27;</span></span><br><span class=\"line\">path = <span class=\"string\">&#x27;iris_classification/iris.data&#x27;</span>  <span class=\"comment\"># æ•°æ®æ–‡ä»¶è·¯å¾„</span></span><br><span class=\"line\">data = pd.read_csv(path, header=<span class=\"literal\">None</span>)</span><br><span class=\"line\">x_prime = data[<span class=\"built_in\">list</span>(<span class=\"built_in\">range</span>(<span class=\"number\">4</span>))]</span><br><span class=\"line\">y = pd.Categorical(data[<span class=\"number\">4</span>]).codes</span><br><span class=\"line\">x_prime_train, x_prime_test, y_train, y_test = train_test_split(</span><br><span class=\"line\">    x_prime, y, train_size=<span class=\"number\">0.7</span>, random_state=<span class=\"number\">0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">feature_pairs = [[<span class=\"number\">0</span>, <span class=\"number\">1</span>], [<span class=\"number\">0</span>, <span class=\"number\">2</span>], [<span class=\"number\">0</span>, <span class=\"number\">3</span>], [<span class=\"number\">1</span>, <span class=\"number\">2</span>], [<span class=\"number\">1</span>, <span class=\"number\">3</span>], [<span class=\"number\">2</span>, <span class=\"number\">3</span>]]</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">8</span>, <span class=\"number\">6</span>), facecolor=<span class=\"string\">&#x27;#FFFFFF&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, pair <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(feature_pairs):</span><br><span class=\"line\">    <span class=\"comment\"># å‡†å¤‡æ•°æ®</span></span><br><span class=\"line\">    x_train = x_prime_train[pair]</span><br><span class=\"line\">    x_test = x_prime_test[pair]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># å†³ç­–æ ‘å­¦ä¹ </span></span><br><span class=\"line\">    model = DecisionTreeClassifier(criterion=<span class=\"string\">&#x27;entropy&#x27;</span>, min_samples_leaf=<span class=\"number\">3</span>)</span><br><span class=\"line\">    model.fit(x_train, y_train)</span><br><span class=\"line\"></span><br><span class=\"line\">    N, M = <span class=\"number\">500</span>, <span class=\"number\">500</span>  <span class=\"comment\"># æ¨ªçºµå„é‡‡æ ·å¤šå°‘ä¸ªå€¼</span></span><br><span class=\"line\">    x1_min, x2_min = x_train.<span class=\"built_in\">min</span>()</span><br><span class=\"line\">    x1_max, x2_max = x_train.<span class=\"built_in\">max</span>()</span><br><span class=\"line\">    t1 = np.linspace(x1_min, x1_max, N)</span><br><span class=\"line\">    t2 = np.linspace(x2_min, x2_max, M)</span><br><span class=\"line\">    x1, x2 = np.meshgrid(t1, t2)  <span class=\"comment\"># ç”Ÿæˆç½‘æ ¼é‡‡æ ·ç‚¹</span></span><br><span class=\"line\">    x_show = np.stack((x1.flat, x2.flat), axis=<span class=\"number\">1</span>)  <span class=\"comment\"># æµ‹è¯•ç‚¹</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># è®­ç»ƒé›†ä¸Šçš„é¢„æµ‹ç»“æœ</span></span><br><span class=\"line\">    y_train_pred = model.predict(x_train)</span><br><span class=\"line\">    acc_train = accuracy_score(y_train, y_train_pred)</span><br><span class=\"line\">    y_test_pred = model.predict(x_test)</span><br><span class=\"line\">    acc_test = accuracy_score(y_test, y_test_pred)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;ç‰¹å¾ï¼š&#x27;</span>, iris_feature[pair[<span class=\"number\">0</span>]], <span class=\"string\">&#x27; + &#x27;</span>, iris_feature[pair[<span class=\"number\">1</span>]])</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\tè®­ç»ƒé›†å‡†ç¡®ç‡: %.4f%%&#x27;</span> % (<span class=\"number\">100</span> * acc_train))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\tæµ‹è¯•é›†å‡†ç¡®ç‡: %.4f%%\\n&#x27;</span> % (<span class=\"number\">100</span> * acc_test))</span><br><span class=\"line\"></span><br><span class=\"line\">    cm_light = mpl.colors.ListedColormap([<span class=\"string\">&#x27;#A0FFA0&#x27;</span>, <span class=\"string\">&#x27;#FFA0A0&#x27;</span>, <span class=\"string\">&#x27;#A0A0FF&#x27;</span>])</span><br><span class=\"line\">    cm_dark = mpl.colors.ListedColormap([<span class=\"string\">&#x27;g&#x27;</span>, <span class=\"string\">&#x27;r&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>])</span><br><span class=\"line\">    y_hat = model.predict(x_show)</span><br><span class=\"line\">    y_hat = y_hat.reshape(x1.shape)</span><br><span class=\"line\">    plt.subplot(<span class=\"number\">2</span>, <span class=\"number\">3</span>, i + <span class=\"number\">1</span>)</span><br><span class=\"line\">    plt.contour(x1,</span><br><span class=\"line\">                x2,</span><br><span class=\"line\">                y_hat,</span><br><span class=\"line\">                colors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">                levels=[<span class=\"number\">0</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">                antialiased=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                linewidths=<span class=\"number\">1</span>)</span><br><span class=\"line\">    plt.pcolormesh(x1, x2, y_hat, cmap=cm_light, shading=<span class=\"string\">&#x27;auto&#x27;</span>)  <span class=\"comment\"># é¢„æµ‹å€¼</span></span><br><span class=\"line\">    plt.scatter(x_train[pair[<span class=\"number\">0</span>]],</span><br><span class=\"line\">                x_train[pair[<span class=\"number\">1</span>]],</span><br><span class=\"line\">                c=y_train,</span><br><span class=\"line\">                s=<span class=\"number\">20</span>,</span><br><span class=\"line\">                edgecolors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">                cmap=cm_dark,</span><br><span class=\"line\">                label=<span class=\"string\">u&#x27;è®­ç»ƒé›†&#x27;</span>)</span><br><span class=\"line\">    plt.scatter(x_test[pair[<span class=\"number\">0</span>]],</span><br><span class=\"line\">                x_test[pair[<span class=\"number\">1</span>]],</span><br><span class=\"line\">                c=y_test,</span><br><span class=\"line\">                s=<span class=\"number\">80</span>,</span><br><span class=\"line\">                marker=<span class=\"string\">&#x27;*&#x27;</span>,</span><br><span class=\"line\">                edgecolors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">                cmap=cm_dark,</span><br><span class=\"line\">                label=<span class=\"string\">u&#x27;æµ‹è¯•é›†&#x27;</span>)</span><br><span class=\"line\">    plt.xlabel(iris_feature[pair[<span class=\"number\">0</span>]], fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">    plt.ylabel(iris_feature[pair[<span class=\"number\">1</span>]], fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">    <span class=\"comment\"># plt.legend(loc=&#x27;upper right&#x27;, fancybox=True, framealpha=0.3)</span></span><br><span class=\"line\">    plt.xlim(x1_min, x1_max)</span><br><span class=\"line\">    plt.ylim(x2_min, x2_max)</span><br><span class=\"line\">    plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>, color=<span class=\"string\">&#x27;#606060&#x27;</span>)</span><br><span class=\"line\">plt.suptitle(<span class=\"string\">u&#x27;å†³ç­–æ ‘å¯¹é¸¢å°¾èŠ±æ•°æ®ä¸¤ç‰¹å¾ç»„åˆçš„åˆ†ç±»ç»“æœ&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">plt.tight_layout(<span class=\"number\">1</span>, rect=(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0.94</span>))  <span class=\"comment\"># (left, bottom, right, top)</span></span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>ç‰¹å¾ï¼š èŠ±è¼é•¿åº¦  +  èŠ±è¼å®½åº¦\n\tè®­ç»ƒé›†å‡†ç¡®ç‡: 85.7143%\n\tæµ‹è¯•é›†å‡†ç¡®ç‡: 71.1111%\n\nç‰¹å¾ï¼š èŠ±è¼é•¿åº¦  +  èŠ±ç“£é•¿åº¦\n\tè®­ç»ƒé›†å‡†ç¡®ç‡: 96.1905%\n\tæµ‹è¯•é›†å‡†ç¡®ç‡: 91.1111%\n\nç‰¹å¾ï¼š èŠ±è¼é•¿åº¦  +  èŠ±ç“£å®½åº¦\n\tè®­ç»ƒé›†å‡†ç¡®ç‡: 96.1905%\n\tæµ‹è¯•é›†å‡†ç¡®ç‡: 86.6667%\n\nç‰¹å¾ï¼š èŠ±è¼å®½åº¦  +  èŠ±ç“£é•¿åº¦\n\tè®­ç»ƒé›†å‡†ç¡®ç‡: 97.1429%\n\tæµ‹è¯•é›†å‡†ç¡®ç‡: 95.5556%\n\nç‰¹å¾ï¼š èŠ±è¼å®½åº¦  +  èŠ±ç“£å®½åº¦\n\tè®­ç»ƒé›†å‡†ç¡®ç‡: 96.1905%\n\tæµ‹è¯•é›†å‡†ç¡®ç‡: 84.4444%\n\nç‰¹å¾ï¼š èŠ±ç“£é•¿åº¦  +  èŠ±ç“£å®½åº¦\n\tè®­ç»ƒé›†å‡†ç¡®ç‡: 98.0952%\n\tæµ‹è¯•é›†å‡†ç¡®ç‡: 97.7778%\n\n\n\nC:\\Users\\utsuk\\AppData\\Local\\Temp\\ipykernel_25000\\2108356862.py:83: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.\n  plt.tight_layout(1, rect=(0, 0, 1, 0.94))  # (left, bottom, right, top)\n</code></pre>\n<p><img src=\"ML_files/ML_18_2.png\" alt=\"png\"></p>\n<h4 id=\"å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’\">å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> RandomForestRegressor</span><br><span class=\"line\"></span><br><span class=\"line\">N = <span class=\"number\">100</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># [-3,3)</span></span><br><span class=\"line\">x = np.random.rand(N) * <span class=\"number\">6</span> - <span class=\"number\">3</span></span><br><span class=\"line\">x.sort()</span><br><span class=\"line\">y = np.sin(x) + np.random.randn(N) * <span class=\"number\">0.05</span></span><br><span class=\"line\">x = x.reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(x)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># model = DecisionTreeRegressor(criterion=&#x27;mse&#x27;, max_depth=10)</span></span><br><span class=\"line\">model = RandomForestRegressor(n_estimators=<span class=\"number\">20</span>, criterion=<span class=\"string\">&#x27;mse&#x27;</span>, max_depth=<span class=\"number\">10</span>)</span><br><span class=\"line\">model.fit(x, y)</span><br><span class=\"line\">x_test = np.linspace(-<span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">50</span>).reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">y_hat = model.predict(x_test)</span><br><span class=\"line\"></span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.plot(x, y, <span class=\"string\">&#x27;r*&#x27;</span>, markersize=<span class=\"number\">10</span>, markeredgecolor=<span class=\"string\">&#x27;k&#x27;</span>, label=<span class=\"string\">&#x27;å®é™…å€¼&#x27;</span>)</span><br><span class=\"line\">plt.plot(x_test, y_hat, <span class=\"string\">&#x27;g-&#x27;</span>, linewidth=<span class=\"number\">2</span>, label=<span class=\"string\">&#x27;é¢„æµ‹å€¼&#x27;</span>)</span><br><span class=\"line\">plt.legend(loc=<span class=\"string\">&#x27;upper left&#x27;</span>, fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;X&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Y&#x27;</span>)</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>, color=<span class=\"string\">&#x27;#606060&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">plt.tight_layout(<span class=\"number\">2</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ¯”è¾ƒå†³ç­–æ ‘çš„æ·±åº¦å½±å“</span></span><br><span class=\"line\">depth = [<span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\">clr = <span class=\"string\">&#x27;rgbmy&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># model = DecisionTreeRegressor(criterion=&#x27;mse&#x27;)</span></span><br><span class=\"line\">model = RandomForestRegressor(n_estimators=<span class=\"number\">20</span>, criterion=<span class=\"string\">&#x27;mse&#x27;</span>)</span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.plot(x, y, <span class=\"string\">&#x27;ro&#x27;</span>, ms=<span class=\"number\">5</span>, mec=<span class=\"string\">&#x27;k&#x27;</span>, label=<span class=\"string\">&#x27;å®é™…å€¼&#x27;</span>)</span><br><span class=\"line\">x_test = np.linspace(-<span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">50</span>).reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> d, c <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(depth, clr):</span><br><span class=\"line\">    model.set_params(max_depth=d)</span><br><span class=\"line\">    model.fit(x, y)</span><br><span class=\"line\">    y_hat = model.predict(x_test)</span><br><span class=\"line\">    plt.plot(x_test,</span><br><span class=\"line\">             y_hat,</span><br><span class=\"line\">             <span class=\"string\">&#x27;-&#x27;</span>,</span><br><span class=\"line\">             color=c,</span><br><span class=\"line\">             linewidth=<span class=\"number\">2</span>,</span><br><span class=\"line\">             markeredgecolor=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">             label=<span class=\"string\">&#x27;Depth=%d&#x27;</span> % d)</span><br><span class=\"line\">plt.legend(loc=<span class=\"string\">&#x27;upper left&#x27;</span>, fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;X&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Y&#x27;</span>)</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>, color=<span class=\"string\">&#x27;#606060&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">plt.tight_layout(<span class=\"number\">2</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<pre><code>[[-2.95013857]\n [-2.91406777]\n [-2.90709403]\n [-2.90375999]\n [-2.87745415]\n [-2.86685497]\n [-2.84070033]\n [-2.81375697]\n [-2.77943784]\n [-2.77745775]\n [-2.66347611]\n [-2.65986762]\n [-2.64217075]\n [-2.63778267]\n [-2.63639243]\n [-2.60165162]\n [-2.48896096]\n [-2.43041085]\n [-2.39941506]\n [-2.38779079]\n [-2.37856289]\n [-2.32809632]\n [-2.29426051]\n [-2.25524085]\n [-2.23914776]\n [-2.16578847]\n [-2.0055294 ]\n [-1.9885004 ]\n [-1.73199798]\n [-1.61893958]\n [-1.58908223]\n [-1.54966302]\n [-1.49074428]\n [-1.46530843]\n [-1.40362808]\n [-1.3935955 ]\n [-1.3928819 ]\n [-1.37684247]\n [-1.3377295 ]\n [-1.33035029]\n [-1.24577529]\n [-1.15561278]\n [-1.12976361]\n [-0.92771942]\n [-0.91536325]\n [-0.83851709]\n [-0.54828961]\n [-0.54587447]\n [-0.54456521]\n [-0.51610774]\n [-0.38078143]\n [-0.27298529]\n [-0.20898971]\n [-0.20866835]\n [ 0.01703485]\n [ 0.03203468]\n [ 0.06107388]\n [ 0.07358949]\n [ 0.07361575]\n [ 0.10676155]\n [ 0.15818226]\n [ 0.20123638]\n [ 0.3410772 ]\n [ 0.45680655]\n [ 0.52384169]\n [ 0.65741898]\n [ 0.68306354]\n [ 0.82845395]\n [ 0.83952908]\n [ 0.99278446]\n [ 1.04865533]\n [ 1.16809926]\n [ 1.21294563]\n [ 1.44659934]\n [ 1.47606149]\n [ 1.48031876]\n [ 1.54476213]\n [ 1.54542061]\n [ 1.60452852]\n [ 1.85706958]\n [ 1.9814776 ]\n [ 2.07801869]\n [ 2.08420295]\n [ 2.08974078]\n [ 2.09458999]\n [ 2.21547939]\n [ 2.2354401 ]\n [ 2.2824592 ]\n [ 2.39313024]\n [ 2.4822308 ]\n [ 2.5275393 ]\n [ 2.56392915]\n [ 2.63696096]\n [ 2.65318554]\n [ 2.66286196]\n [ 2.67531127]\n [ 2.69337798]\n [ 2.78329004]\n [ 2.83409465]\n [ 2.94897411]]\n[-0.16517944 -0.2651016  -0.26383212 -0.2408083  -0.21137157 -0.30729908\n -0.24489794 -0.42738593 -0.39536257 -0.34762803 -0.55252409 -0.40629331\n -0.47658554 -0.47459876 -0.50897455 -0.58933727 -0.57144697 -0.61564276\n -0.76543047 -0.64009055 -0.79612233 -0.77625958 -0.82824783 -0.74228023\n -0.6882561  -0.85479709 -0.9210133  -0.88824326 -0.94228155 -1.04205908\n -1.01456756 -1.0150173  -1.01319155 -0.93942161 -1.0101109  -1.00949492\n -1.00669835 -1.02762794 -0.90526463 -1.04873446 -0.98356087 -0.96345712\n -0.90790305 -0.78617335 -0.8215092  -0.7756252  -0.62805774 -0.61416394\n -0.55438357 -0.54877048 -0.24409899 -0.24654351 -0.22139215 -0.31816396\n -0.00948097  0.03731195  0.07871564  0.06089414  0.091661    0.10130855\n  0.05916354  0.284293    0.32301758  0.47390064  0.43774825  0.59439442\n  0.62285701  0.78479681  0.7888438   0.91498224  0.91654605  0.84583033\n  0.90598404  0.99494553  1.05048367  0.97256267  1.04768316  1.09246729\n  0.92367061  0.97097779  0.98148804  0.86766162  0.87249721  0.81545132\n  0.80772307  0.75639662  0.73792794  0.75909448  0.71239606  0.63892773\n  0.6373865   0.53978973  0.47836416  0.47544309  0.4156747   0.46233128\n  0.43384357  0.32001956  0.2980857   0.16211947]\n\n\nC:\\Users\\utsuk\\AppData\\Local\\Temp\\ipykernel_25000\\2984870596.py:33: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.\n  plt.tight_layout(2)\n</code></pre>\n<p><img src=\"ML_files/ML_20_2.png\" alt=\"png\"></p>\n<pre><code>C:\\Users\\utsuk\\AppData\\Local\\Temp\\ipykernel_25000\\2984870596.py:60: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.\n  plt.tight_layout(2)\n</code></pre>\n<p><img src=\"ML_files/ML_20_4.png\" alt=\"png\"></p>\n<h3 id=\"åˆ†ç±»é—®é¢˜-2\">åˆ†ç±»é—®é¢˜</h3>\n<h4 id=\"é€»è¾‘å›å½’-2\">é€»è¾‘å›å½’</h4>\n<h5 id=\"äºŒåˆ†ç±»\">äºŒåˆ†ç±»</h5>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.linear_model <span class=\"keyword\">as</span> lm</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> mp</span><br><span class=\"line\"></span><br><span class=\"line\">x = np.array([[<span class=\"number\">3</span>, <span class=\"number\">1</span>], [<span class=\"number\">2</span>, <span class=\"number\">5</span>], [<span class=\"number\">1</span>, <span class=\"number\">8</span>], [<span class=\"number\">6</span>, <span class=\"number\">4</span>],\\</span><br><span class=\"line\">              [<span class=\"number\">5</span>, <span class=\"number\">2</span>], [<span class=\"number\">3</span>, <span class=\"number\">5</span>], [<span class=\"number\">4</span>, <span class=\"number\">7</span>], [<span class=\"number\">4</span>, -<span class=\"number\">1</span>]])</span><br><span class=\"line\">y = np.array([<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºé€»è¾‘åˆ†ç±»å™¨å¯¹è±¡</span></span><br><span class=\"line\"><span class=\"comment\"># Cå‚æ•°ï¼šæ­£åˆ™å¼ºåº¦ï¼Œè¶Šå¤§æ‹Ÿåˆæ•ˆæœè¶Šå°ï¼Œé€šè¿‡è°ƒæ•´è¯¥å‚æ•°é˜²æ­¢è¿‡æ‹Ÿåˆ</span></span><br><span class=\"line\"><span class=\"comment\"># solverå‚æ•°ï¼šé€»è¾‘å‡½æ•°ä¸­æŒ‡æ•°çš„å‡½æ•°å…³ç³»ï¼ˆliblinearè¡¨ç¤ºçº¿æ€§å…³ç³»ï¼‰</span></span><br><span class=\"line\">model = lm.LogisticRegression()</span><br><span class=\"line\">model.fit(x, y)  <span class=\"comment\"># è®­ç»ƒ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># é¢„æµ‹</span></span><br><span class=\"line\">test_x = np.array([[<span class=\"number\">3</span>, <span class=\"number\">9</span>], [<span class=\"number\">6</span>, <span class=\"number\">1</span>]])</span><br><span class=\"line\">test_y = model.predict(test_x)  <span class=\"comment\"># é¢„æµ‹</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(test_y)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è®¡ç®—æ˜¾ç¤ºåæ ‡çš„è¾¹ç•Œ</span></span><br><span class=\"line\"><span class=\"comment\"># x[:, 0].min()   x ä¸­æ‰€æœ‰æ•°ç»„çš„ç¬¬ä¸€ä½</span></span><br><span class=\"line\">left = x[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span></span><br><span class=\"line\">right = x[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">buttom = x[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span></span><br><span class=\"line\">top = x[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># äº§ç”Ÿç½‘æ ¼åŒ–çŸ©é˜µ</span></span><br><span class=\"line\">grid_x, grid_y = np.meshgrid(np.arange(left, right, <span class=\"number\">0.01</span>),</span><br><span class=\"line\">                             np.arange(buttom, top, <span class=\"number\">0.01</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;grid_x.shape:&quot;</span>, grid_x.shape)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;grid_y.shape:&quot;</span>, grid_y.shape)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å°†x,yåæ ‡åˆå¹¶æˆä¸¤åˆ—</span></span><br><span class=\"line\">mesh_x = np.column_stack((grid_x.ravel(), grid_y.ravel()))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;mesh_x.shape:&quot;</span>, mesh_x.shape)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ ¹æ®æ¯ä¸ªç‚¹çš„xyåæ ‡è¿›è¡Œé¢„æµ‹ï¼Œå¹¶è¿˜åŸæˆäºŒç»´å½¢çŠ¶</span></span><br><span class=\"line\">mesh_z = model.predict(mesh_x)</span><br><span class=\"line\">mesh_z = mesh_z.reshape(grid_x.shape)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.figure(<span class=\"string\">&#x27;Logistic Regression&#x27;</span>, facecolor=<span class=\"string\">&#x27;lightgray&#x27;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&#x27;Logistic Regression&#x27;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.xlabel(<span class=\"string\">&#x27;x&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&#x27;y&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.tick_params(labelsize=<span class=\"number\">10</span>)</span><br><span class=\"line\">mp.pcolormesh(grid_x, grid_y, mesh_z, cmap=<span class=\"string\">&#x27;gray&#x27;</span>, shading=<span class=\"string\">&#x27;auto&#x27;</span>)</span><br><span class=\"line\">mp.scatter(</span><br><span class=\"line\">    x[:, <span class=\"number\">0</span>],  <span class=\"comment\"># æ ·æœ¬xåæ ‡</span></span><br><span class=\"line\">    x[:, <span class=\"number\">1</span>],  <span class=\"comment\"># æ ·æœ¬yåæ ‡</span></span><br><span class=\"line\">    c=y,</span><br><span class=\"line\">    cmap=<span class=\"string\">&#x27;brg&#x27;</span>,</span><br><span class=\"line\">    s=<span class=\"number\">80</span>)</span><br><span class=\"line\">mp.scatter(test_x[:, <span class=\"number\">0</span>], test_x[:, <span class=\"number\">1</span>], c=<span class=\"string\">&quot;red&quot;</span>, marker=<span class=\"string\">&#x27;s&#x27;</span>, s=<span class=\"number\">80</span>)</span><br><span class=\"line\">mp.show()</span><br></pre></td></tr></table></figure>\n<pre><code>[1 0]\ngrid_x.shape: (1100, 700)\ngrid_y.shape: (1100, 700)\nmesh_x.shape: (770000, 2)\n</code></pre>\n<p><img src=\"ML_files/ML_22_1.png\" alt=\"png\"></p>\n<h5 id=\"å¤šåˆ†ç±»\">å¤šåˆ†ç±»</h5>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.linear_model <span class=\"keyword\">as</span> lm</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> mp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># è¾“å…¥</span></span><br><span class=\"line\">x = np.array([[<span class=\"number\">4</span>, <span class=\"number\">7</span>], [<span class=\"number\">3.5</span>, <span class=\"number\">8</span>], [<span class=\"number\">3.1</span>, <span class=\"number\">6.2</span>], [<span class=\"number\">0.5</span>, <span class=\"number\">1</span>], [<span class=\"number\">1</span>, <span class=\"number\">2</span>], [<span class=\"number\">1.2</span>, <span class=\"number\">1.9</span>],</span><br><span class=\"line\">              [<span class=\"number\">6</span>, <span class=\"number\">2</span>], [<span class=\"number\">5.7</span>, <span class=\"number\">1.5</span>], [<span class=\"number\">5.4</span>, <span class=\"number\">2.2</span>]])</span><br><span class=\"line\"><span class=\"comment\"># è¾“å‡ºï¼ˆå¤šä¸ªç±»åˆ«ï¼‰</span></span><br><span class=\"line\">y = np.array([<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">2</span>, <span class=\"number\">2</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºé€»è¾‘åˆ†ç±»å™¨å¯¹è±¡</span></span><br><span class=\"line\">model = lm.LogisticRegression(C=<span class=\"number\">200</span>)  <span class=\"comment\"># è°ƒæ•´è¯¥å€¼ä¸º1çœ‹æ•ˆæœ</span></span><br><span class=\"line\">model.fit(x, y)  <span class=\"comment\"># è®­ç»ƒ</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åæ ‡è½´èŒƒå›´</span></span><br><span class=\"line\">left = x[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span></span><br><span class=\"line\">right = x[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">h = <span class=\"number\">0.005</span></span><br><span class=\"line\"></span><br><span class=\"line\">buttom = x[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span></span><br><span class=\"line\">top = x[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">v = <span class=\"number\">0.005</span></span><br><span class=\"line\"></span><br><span class=\"line\">grid_x, grid_y = np.meshgrid(np.arange(left, right, h),</span><br><span class=\"line\">                             np.arange(buttom, top, v))</span><br><span class=\"line\"></span><br><span class=\"line\">mesh_x = np.column_stack((grid_x.ravel(), grid_y.ravel()))</span><br><span class=\"line\">mesh_z = model.predict(mesh_x)</span><br><span class=\"line\">mesh_z = mesh_z.reshape(grid_x.shape)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¯è§†åŒ–</span></span><br><span class=\"line\">mp.figure(<span class=\"string\">&#x27;Logistic Classification&#x27;</span>, facecolor=<span class=\"string\">&#x27;lightgray&#x27;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&#x27;Logistic Classification&#x27;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.xlabel(<span class=\"string\">&#x27;x&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&#x27;y&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.tick_params(labelsize=<span class=\"number\">10</span>)</span><br><span class=\"line\">mp.pcolormesh(grid_x, grid_y, mesh_z, cmap=<span class=\"string\">&#x27;gray&#x27;</span>, shading=<span class=\"string\">&#x27;auto&#x27;</span>)</span><br><span class=\"line\">mp.scatter(x[:, <span class=\"number\">0</span>], x[:, <span class=\"number\">1</span>], c=y, cmap=<span class=\"string\">&#x27;brg&#x27;</span>, s=<span class=\"number\">80</span>)</span><br><span class=\"line\">mp.show()</span><br></pre></td></tr></table></figure>\n<p><img src=\"ML_files/ML_24_0.png\" alt=\"png\"></p>\n<h4 id=\"æ”¯æŒå‘é‡æœº-SVM-2\">æ”¯æŒå‘é‡æœº-SVM</h4>\n<h5 id=\"æ ¸å‡½æ•°-2\">æ ¸å‡½æ•°</h5>\n<ol>\n<li>\n<p>çº¿æ€§</p>\n</li>\n<li>\n<p>å¾„å‘åŸº-é«˜æ–¯</p>\n</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> svm</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> GridSearchCV</span><br><span class=\"line\"><span class=\"keyword\">from</span> time <span class=\"keyword\">import</span> time</span><br><span class=\"line\"></span><br><span class=\"line\">iris_feature = <span class=\"string\">&#x27;èŠ±è¼é•¿åº¦&#x27;</span>, <span class=\"string\">&#x27;èŠ±è¼å®½åº¦&#x27;</span>, <span class=\"string\">&#x27;èŠ±ç“£é•¿åº¦&#x27;</span>, <span class=\"string\">&#x27;èŠ±ç“£å®½åº¦&#x27;</span></span><br><span class=\"line\">path = <span class=\"string\">&#x27;iris_classification/iris.data&#x27;</span>  <span class=\"comment\"># æ•°æ®æ–‡ä»¶è·¯å¾„</span></span><br><span class=\"line\">data = pd.read_csv(path, header=<span class=\"literal\">None</span>)</span><br><span class=\"line\">x, y = data[[<span class=\"number\">0</span>, <span class=\"number\">1</span>]], pd.Categorical(data[<span class=\"number\">4</span>]).codes</span><br><span class=\"line\">x_train, x_test, y_train, y_test = train_test_split(x,</span><br><span class=\"line\">                                                    y,</span><br><span class=\"line\">                                                    random_state=<span class=\"number\">1</span>,</span><br><span class=\"line\">                                                    test_size=<span class=\"number\">0.4</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ†ç±»å™¨</span></span><br><span class=\"line\"><span class=\"comment\"># svm_clf = svm.SVC(C=10, gamma=1, kernel=&#x27;rbf&#x27;, decision_function_shape=&#x27;ovo&#x27;)</span></span><br><span class=\"line\"><span class=\"comment\"># svm_clf = svm.SVC(C=3, kernel=&#x27;poly&#x27;, degree=3)</span></span><br><span class=\"line\">svm_clf = svm.SVC(C=<span class=\"number\">3</span>, kernel=<span class=\"string\">&#x27;linear&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;GridSearchCV begin...&#x27;</span>)</span><br><span class=\"line\">t = time()</span><br><span class=\"line\">clf = svm_clf</span><br><span class=\"line\"><span class=\"comment\"># clf = GridSearchCV(svm_clf, param_grid=&#123;&#x27;gamma&#x27;:np.logspace(-2, 2, 10), &#x27;C&#x27;:np.logspace(-2, 2, 10)&#125;, cv=3)</span></span><br><span class=\"line\">clf.fit(x_train, y_train.ravel())</span><br><span class=\"line\">t_end = time()</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;è€—æ—¶ï¼š%dç§’&#x27;</span> % (t_end - t))</span><br><span class=\"line\"><span class=\"comment\"># print(&#x27;æœ€ä¼˜å‚æ•°ï¼š&#x27;, clf.best_params_)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å‡†ç¡®ç‡</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(clf.score(x_train, y_train))  <span class=\"comment\"># ç²¾åº¦</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;è®­ç»ƒé›†å‡†ç¡®ç‡ï¼š&#x27;</span>, accuracy_score(y_train, clf.predict(x_train)))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(clf.score(x_test, y_test))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;æµ‹è¯•é›†å‡†ç¡®ç‡ï¼š&#x27;</span>, accuracy_score(y_test, clf.predict(x_test)))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># decision_function</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(x_train[:<span class=\"number\">5</span>])</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;decision_function:\\n&#x27;</span>, clf.decision_function(x_train))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\npredict:\\n&#x27;</span>, clf.predict(x_train))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç”»å›¾</span></span><br><span class=\"line\">x1_min, x2_min = x.<span class=\"built_in\">min</span>()</span><br><span class=\"line\">x1_max, x2_max = x.<span class=\"built_in\">max</span>()</span><br><span class=\"line\">x1, x2 = np.mgrid[x1_min:x1_max:<span class=\"number\">300j</span>, x2_min:x2_max:<span class=\"number\">300j</span>]  <span class=\"comment\"># ç”Ÿæˆç½‘æ ¼é‡‡æ ·ç‚¹</span></span><br><span class=\"line\">grid_test = np.stack((x1.flat, x2.flat), axis=<span class=\"number\">1</span>)  <span class=\"comment\"># æµ‹è¯•ç‚¹</span></span><br><span class=\"line\">grid_hat = clf.predict(grid_test)  <span class=\"comment\"># é¢„æµ‹åˆ†ç±»å€¼</span></span><br><span class=\"line\">grid_hat = grid_hat.reshape(x1.shape)  <span class=\"comment\"># ä½¿ä¹‹ä¸è¾“å…¥çš„å½¢çŠ¶ç›¸åŒ</span></span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">cm_light = mpl.colors.ListedColormap([<span class=\"string\">&#x27;#A0FFA0&#x27;</span>, <span class=\"string\">&#x27;#FFA0A0&#x27;</span>, <span class=\"string\">&#x27;#A0A0FF&#x27;</span>])</span><br><span class=\"line\">cm_dark = mpl.colors.ListedColormap([<span class=\"string\">&#x27;g&#x27;</span>, <span class=\"string\">&#x27;r&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>])</span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.pcolormesh(x1, x2, grid_hat, cmap=cm_light, shading=<span class=\"string\">&#x27;auto&#x27;</span>)</span><br><span class=\"line\">plt.scatter(x[<span class=\"number\">0</span>], x[<span class=\"number\">1</span>], c=y, edgecolors=<span class=\"string\">&#x27;k&#x27;</span>, s=<span class=\"number\">50</span>, cmap=cm_dark)  <span class=\"comment\"># æ ·æœ¬</span></span><br><span class=\"line\">plt.scatter(x_test[<span class=\"number\">0</span>], x_test[<span class=\"number\">1</span>], s=<span class=\"number\">120</span>, facecolors=<span class=\"string\">&#x27;none&#x27;</span>,</span><br><span class=\"line\">            zorder=<span class=\"number\">10</span>)  <span class=\"comment\"># åœˆä¸­æµ‹è¯•é›†æ ·æœ¬</span></span><br><span class=\"line\">plt.xlabel(iris_feature[<span class=\"number\">0</span>], fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.ylabel(iris_feature[<span class=\"number\">1</span>], fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.xlim(x1_min, x1_max)</span><br><span class=\"line\">plt.ylim(x2_min, x2_max)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;é¸¢å°¾èŠ±SVMäºŒç‰¹å¾åˆ†ç±»&#x27;</span>, fontsize=<span class=\"number\">16</span>)</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\">plt.tight_layout(pad=<span class=\"number\">1.5</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<pre><code>GridSearchCV begin...\nè€—æ—¶ï¼š0ç§’\n0.7888888888888889\nè®­ç»ƒé›†å‡†ç¡®ç‡ï¼š 0.7888888888888889\n0.7833333333333333\næµ‹è¯•é›†å‡†ç¡®ç‡ï¼š 0.7833333333333333\n       0    1\n11   4.8  3.4\n113  5.7  2.5\n123  6.3  2.7\n12   4.8  3.0\n2    4.7  3.2\ndecision_function:\n [[ 2.27077043  0.77466667 -0.23050192]\n [-0.26084184  2.25751125  1.0560141 ]\n [-0.28293421  2.25843306  1.22796515]\n [ 2.24308998  0.92588576 -0.2355186 ]\n [ 2.26643883  0.80879936 -0.24170145]\n [-0.28069428  1.23581332  2.24817619]\n [ 2.28018898  0.76457517 -0.24714914]\n [-0.25832462  1.21350955  2.20811726]\n [-0.27289547  1.20094518  2.249947  ]\n [-0.28479994  1.2318958   2.26058535]\n [-0.23449614  2.22389578  1.08207816]\n [-0.27824598  1.19362022  2.2618816 ]\n [-0.24940836  1.20624284  2.19142888]\n [ 2.2732283  -0.2577432   0.82271427]\n [-0.2872948   2.27977562  1.1680301 ]\n [-0.28016055  1.24346593  2.23969255]\n [-0.28069428  1.23581332  2.24817619]\n [-0.17539161  2.25364746  0.77515212]\n [-0.25325305  1.14281388  2.23566431]\n [-0.2421088   2.25159667  0.90072452]\n [ 2.24374936 -0.23761503  0.93581753]\n [ 2.24150985  0.87804111 -0.2241573 ]\n [ 2.28041834 -0.27382086  0.86293615]\n [-0.27824598  1.19362022  2.2618816 ]\n [ 2.27361996  0.84008337 -0.26180365]\n [-0.26919985  2.24943754  1.18347413]\n [-0.28629221  2.26101768  1.23745359]\n [-0.23808639  1.19803786  2.16960812]\n [ 2.24670891 -0.21840299  0.83780678]\n [ 2.23817757  0.82105098 -0.19112107]\n [-0.2549617   2.24213564  1.1247623 ]\n [ 2.24150985  0.87804111 -0.2241573 ]\n [-0.30409023  1.27536123  2.28319903]\n [-0.27073104  1.23503534  2.2197061 ]\n [-0.30441277  1.26883084  2.28803158]\n [-0.28752494  1.24411663  2.25991942]\n [-0.29292012  2.28000741  1.22212062]\n [-0.23176304  1.04104242  2.22722296]\n [-0.28694643  1.15125962  2.28088265]\n [-0.19956441  2.19653578  1.01742803]\n [ 2.26878977 -0.27918692  1.16597018]\n [-0.2549617   2.24213564  1.1247623 ]\n [ 2.18519501  1.23494087 -0.26146238]\n [-0.2512831   2.2597216   0.89408741]\n [-0.29066599  1.240849    2.26933123]\n [ 2.25729439 -0.2129225   0.79411601]\n [-0.29441953  1.26382422  2.26345809]\n [ 2.26377705 -0.22976306  0.79617407]\n [ 2.27077043  0.77466667 -0.23050192]\n [-0.2445374   1.07681969  2.23683943]\n [-0.21840757  2.21786592  1.00447438]\n [-0.28524498  1.22203776  2.26581127]\n [ 2.24947915  0.81045802 -0.20787766]\n [ 2.2684482  -0.24915018  0.81973595]\n [-0.20907334  1.12013512  2.17603067]\n [ 2.26728139  0.82893904 -0.24984081]\n [-0.2549617   2.24213564  1.1247623 ]\n [ 2.25207771  0.85867453 -0.23431088]\n [-0.28069428  1.23581332  2.24817619]\n [ 1.05055292  2.22662497 -0.23240122]\n [ 2.2722284   0.7997718  -0.24896247]\n [-0.26723747  1.19201787  2.24286157]\n [ 2.27827649  0.82682975 -0.26630655]\n [-0.17333043  2.16553945  1.02939988]\n [ 2.26890439  0.89311197 -0.26243597]\n [-0.2512831   2.2597216   0.89408741]\n [-0.23341849  2.27309387  0.7709214 ]\n [ 2.25617562 -0.22437834  0.81410784]\n [ 2.22986475  0.96247553 -0.22562355]\n [ 0.93771503  2.24006469 -0.23365567]\n [ 2.28631446 -0.25590025  0.75474384]\n [-0.23808639  1.19803786  2.16960812]\n [-0.2646401   1.23019768  2.20613126]\n [ 2.25729439 -0.2129225   0.79411601]\n [-0.28479994  1.2318958   2.26058535]\n [-0.22087216  2.20491832  1.08971052]\n [-0.29260626  2.28238001  1.20719635]\n [-0.29101034  1.23272406  2.27341138]\n [-0.2549617   2.24213564  1.1247623 ]\n [ 2.19974418 -0.17699012  0.91119813]\n [ 2.21209755  1.01040036 -0.21350121]\n [-0.27849238  2.26059076  1.19977637]\n [-0.26997469  2.24280567  1.20408124]\n [-0.29874557  1.25977449  2.27874043]\n [-0.25377271  2.24886239  1.06528288]\n [-0.27961589  2.2500049   1.22933155]\n [-0.27219081  1.21466357  2.24182934]\n [-0.2884762   2.2710352   1.22512174]\n [-0.28479994  1.2318958   2.26058535]\n [ 2.24150985  0.87804111 -0.2241573 ]]\n\npredict:\n [0 1 1 0 0 2 0 2 2 2 1 2 2 0 1 2 2 1 2 1 0 0 0 2 0 1 1 2 0 0 1 0 2 2 2 2 1\n 2 2 1 0 1 0 1 2 0 2 0 0 2 1 2 0 0 2 0 1 0 2 1 0 2 0 1 0 1 1 0 0 1 0 2 2 0\n 2 1 1 2 1 0 0 1 1 2 1 1 2 1 2 0]\n</code></pre>\n<p><img src=\"ML_files/ML_26_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> svm</span><br><span class=\"line\"><span class=\"keyword\">from</span> scipy <span class=\"keyword\">import</span> stats</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">extend</span>(<span class=\"params\">a, b, r=<span class=\"number\">0.01</span></span>):</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> a * (<span class=\"number\">1</span> + r) - b * r, -a * r + b * (<span class=\"number\">1</span> + r)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">np.random.seed(<span class=\"number\">0</span>)</span><br><span class=\"line\">N = <span class=\"number\">200</span></span><br><span class=\"line\">x = np.empty((<span class=\"number\">4</span> * N, <span class=\"number\">2</span>))</span><br><span class=\"line\">means = [(-<span class=\"number\">1</span>, <span class=\"number\">1</span>), (<span class=\"number\">1</span>, <span class=\"number\">1</span>), (<span class=\"number\">1</span>, -<span class=\"number\">1</span>), (-<span class=\"number\">1</span>, -<span class=\"number\">1</span>)]</span><br><span class=\"line\">sigmas = [</span><br><span class=\"line\">    np.eye(<span class=\"number\">2</span>), <span class=\"number\">2</span> * np.eye(<span class=\"number\">2</span>),</span><br><span class=\"line\">    np.diag((<span class=\"number\">1</span>, <span class=\"number\">2</span>)),</span><br><span class=\"line\">    np.array(((<span class=\"number\">3</span>, <span class=\"number\">2</span>), (<span class=\"number\">2</span>, <span class=\"number\">3</span>)))</span><br><span class=\"line\">]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">    mn = stats.multivariate_normal(means[i], sigmas[i] * <span class=\"number\">0.07</span>)</span><br><span class=\"line\">    x[i * N:(i + <span class=\"number\">1</span>) * N, :] = mn.rvs(N)</span><br><span class=\"line\">a = np.array((<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)).reshape((-<span class=\"number\">1</span>, <span class=\"number\">1</span>))</span><br><span class=\"line\">y = np.tile(a, N).flatten()</span><br><span class=\"line\">clf = svm.SVC(C=<span class=\"number\">1</span>, kernel=<span class=\"string\">&#x27;rbf&#x27;</span>, gamma=<span class=\"number\">1</span>, decision_function_shape=<span class=\"string\">&#x27;ovo&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># clf = svm.SVC(C=1, kernel=&#x27;linear&#x27;, decision_function_shape=&#x27;ovr&#x27;)</span></span><br><span class=\"line\">clf.fit(x, y)</span><br><span class=\"line\">y_hat = clf.predict(x)</span><br><span class=\"line\">acc = accuracy_score(y, y_hat)</span><br><span class=\"line\">np.set_printoptions(suppress=<span class=\"literal\">True</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬ä¸ªæ•°ï¼š%dï¼Œæ­£ç¡®ç‡ï¼š%.2f%%&#x27;</span> % (<span class=\"built_in\">round</span>(acc * <span class=\"number\">4</span> * N), <span class=\"number\">100</span> * acc))</span><br><span class=\"line\"><span class=\"comment\"># decision_function</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(clf.decision_function(x))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_hat)</span><br><span class=\"line\"></span><br><span class=\"line\">x1_min, x2_min = np.<span class=\"built_in\">min</span>(x, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">x1_max, x2_max = np.<span class=\"built_in\">max</span>(x, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">x1_min, x1_max = extend(x1_min, x1_max)</span><br><span class=\"line\">x2_min, x2_max = extend(x2_min, x2_max)</span><br><span class=\"line\">x1, x2 = np.mgrid[x1_min:x1_max:<span class=\"number\">500j</span>, x2_min:x2_max:<span class=\"number\">500j</span>]</span><br><span class=\"line\">x_test = np.stack((x1.flat, x2.flat), axis=<span class=\"number\">1</span>)</span><br><span class=\"line\">y_test = clf.predict(x_test)</span><br><span class=\"line\">y_test = y_test.reshape(x1.shape)</span><br><span class=\"line\">cm_light = mpl.colors.ListedColormap(</span><br><span class=\"line\">    [<span class=\"string\">&#x27;#FF8080&#x27;</span>, <span class=\"string\">&#x27;#80FF80&#x27;</span>, <span class=\"string\">&#x27;#8080FF&#x27;</span>, <span class=\"string\">&#x27;#F0F080&#x27;</span>])</span><br><span class=\"line\">cm_dark = mpl.colors.ListedColormap([<span class=\"string\">&#x27;r&#x27;</span>, <span class=\"string\">&#x27;g&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"string\">&#x27;y&#x27;</span>])</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.pcolormesh(x1, x2, y_test, cmap=cm_light, shading=<span class=\"string\">&#x27;auto&#x27;</span>)</span><br><span class=\"line\">plt.contour(x1, x2, y_test, levels=(<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>), colors=<span class=\"string\">&#x27;k&#x27;</span>, linestyles=<span class=\"string\">&#x27;--&#x27;</span>)</span><br><span class=\"line\">plt.scatter(x[:, <span class=\"number\">0</span>],</span><br><span class=\"line\">            x[:, <span class=\"number\">1</span>],</span><br><span class=\"line\">            s=<span class=\"number\">20</span>,</span><br><span class=\"line\">            c=y,</span><br><span class=\"line\">            cmap=cm_dark,</span><br><span class=\"line\">            edgecolors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">            alpha=<span class=\"number\">0.7</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;$X_1$&#x27;</span>, fontsize=<span class=\"number\">11</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;$X_2$&#x27;</span>, fontsize=<span class=\"number\">11</span>)</span><br><span class=\"line\">plt.xlim((x1_min, x1_max))</span><br><span class=\"line\">plt.ylim((x2_min, x2_max))</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>)</span><br><span class=\"line\">plt.tight_layout(pad=<span class=\"number\">2.5</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;SVMå¤šåˆ†ç±»æ–¹æ³•ï¼šOne/One or One/Other&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬ä¸ªæ•°ï¼š793ï¼Œæ­£ç¡®ç‡ï¼š99.12%\n[[ 1.30403817  1.18371967  1.61069453  0.53379555  0.10282667 -0.6639782 ]\n [ 1.20484592  1.00041165  1.13023042  0.32840742  0.16888308 -0.33559223]\n [ 1.28448754  1.15305262  1.24310512  0.59725054 -0.31474389 -0.97622623]\n ...\n [-0.23584035 -0.08224918 -1.09483656  0.1554822  -1.12200744 -1.12840424]\n [ 0.2447751   0.34444513 -1.55255237  0.17064062 -1.24348982 -1.41973039]\n [-0.03070327 -0.15566364 -1.9254549  -0.09600454 -1.23897289 -1.44257329]]\n[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1\n 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2\n 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n 2 2 2 2 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]\n</code></pre>\n<p><img src=\"ML_files/ML_27_1.png\" alt=\"png\"></p>\n<h4 id=\"æœ´ç´ è´å¶æ–¯-2\">æœ´ç´ è´å¶æ–¯</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NBClassify</span>(<span class=\"params\"><span class=\"built_in\">object</span></span>):</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">__init__</span>(<span class=\"params\">self, fillNa=<span class=\"number\">1</span></span>):</span></span><br><span class=\"line\">        self.fillNa = <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">pass</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">train</span>(<span class=\"params\">self, trainSet</span>):</span></span><br><span class=\"line\">        <span class=\"comment\"># è®¡ç®—æ¯ç§ç±»åˆ«çš„æ¦‚ç‡</span></span><br><span class=\"line\">        <span class=\"comment\"># ä¿å­˜æ‰€æœ‰tagçš„æ‰€æœ‰ç§ç±»ï¼ŒåŠå®ƒä»¬å‡ºç°çš„é¢‘æ¬¡</span></span><br><span class=\"line\">        dictTag = &#123;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> subTuple <span class=\"keyword\">in</span> trainSet:</span><br><span class=\"line\">            dictTag[<span class=\"built_in\">str</span>(</span><br><span class=\"line\">                subTuple[<span class=\"number\">1</span>])] = <span class=\"number\">1</span> <span class=\"keyword\">if</span> <span class=\"built_in\">str</span>(subTuple[<span class=\"number\">1</span>]) <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> dictTag.keys(</span><br><span class=\"line\">                ) <span class=\"keyword\">else</span> dictTag[<span class=\"built_in\">str</span>(subTuple[<span class=\"number\">1</span>])] + <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"comment\"># ä¿å­˜æ¯ä¸ªtagæœ¬èº«çš„æ¦‚ç‡</span></span><br><span class=\"line\">        tagProbablity = &#123;&#125;</span><br><span class=\"line\">        totalFreq = <span class=\"built_in\">sum</span>([value <span class=\"keyword\">for</span> value <span class=\"keyword\">in</span> dictTag.values()])</span><br><span class=\"line\">        <span class=\"keyword\">for</span> key, value <span class=\"keyword\">in</span> dictTag.items():</span><br><span class=\"line\">            tagProbablity[key] = value / totalFreq</span><br><span class=\"line\">        <span class=\"comment\"># print(tagProbablity)</span></span><br><span class=\"line\">        self.tagProbablity = tagProbablity</span><br><span class=\"line\">        <span class=\"comment\">##############################################################################</span></span><br><span class=\"line\">        <span class=\"comment\"># è®¡ç®—ç‰¹å¾çš„æ¡ä»¶æ¦‚ç‡</span></span><br><span class=\"line\">        <span class=\"comment\"># ä¿å­˜ç‰¹å¾å±æ€§åŸºæœ¬ä¿¡æ¯&#123;ç‰¹å¾1:&#123;å€¼1:å‡ºç°5æ¬¡, å€¼2:å‡ºç°1æ¬¡&#125;, ç‰¹å¾2:&#123;å€¼1:å‡ºç°1æ¬¡, å€¼2:å‡ºç°5æ¬¡&#125;&#125;</span></span><br><span class=\"line\">        dictFeaturesBase = &#123;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> subTuple <span class=\"keyword\">in</span> trainSet:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> key, value <span class=\"keyword\">in</span> subTuple[<span class=\"number\">0</span>].items():</span><br><span class=\"line\">                <span class=\"keyword\">if</span> key <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> dictFeaturesBase.keys():</span><br><span class=\"line\">                    dictFeaturesBase[key] = &#123;value: <span class=\"number\">1</span>&#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> value <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> dictFeaturesBase[key].keys():</span><br><span class=\"line\">                        dictFeaturesBase[key][value] = <span class=\"number\">1</span></span><br><span class=\"line\">                    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                        dictFeaturesBase[key][value] += <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"comment\"># dictFeaturesBase = &#123;</span></span><br><span class=\"line\">        <span class=\"comment\"># &#x27;èŒä¸š&#x27;: &#123;&#x27;å†œå¤«&#x27;: 1, &#x27;æ•™å¸ˆ&#x27;: 2, &#x27;å»ºç­‘å·¥äºº&#x27;: 2, &#x27;æŠ¤å£«&#x27;: 1&#125;,</span></span><br><span class=\"line\">        <span class=\"comment\"># &#x27;ç—‡çŠ¶&#x27;: &#123;&#x27;æ‰“å–·åš&#x27;: 3, &#x27;å¤´ç—›&#x27;: 3&#125;</span></span><br><span class=\"line\">        <span class=\"comment\"># &#125;</span></span><br><span class=\"line\">        dictFeatures = &#123;&#125;.fromkeys([key <span class=\"keyword\">for</span> key <span class=\"keyword\">in</span> dictTag])</span><br><span class=\"line\">        <span class=\"keyword\">for</span> key <span class=\"keyword\">in</span> dictFeatures.keys():</span><br><span class=\"line\">            dictFeatures[key] = &#123;&#125;.fromkeys([key <span class=\"keyword\">for</span> key <span class=\"keyword\">in</span> dictFeaturesBase])</span><br><span class=\"line\">        <span class=\"keyword\">for</span> key, value <span class=\"keyword\">in</span> dictFeatures.items():</span><br><span class=\"line\">            <span class=\"keyword\">for</span> subkey <span class=\"keyword\">in</span> value.keys():</span><br><span class=\"line\">                value[subkey] = &#123;&#125;.fromkeys(</span><br><span class=\"line\">                    [x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> dictFeaturesBase[subkey].keys()])</span><br><span class=\"line\">        <span class=\"comment\"># dictFeatures = &#123;</span></span><br><span class=\"line\">        <span class=\"comment\">#  &#x27;æ„Ÿå†’ &#x27;: &#123;&#x27;ç—‡çŠ¶&#x27;: &#123;&#x27;æ‰“å–·åš&#x27;: None, &#x27;å¤´ç—›&#x27;: None&#125;, &#x27;èŒä¸š&#x27;: &#123;&#x27;æŠ¤å£«&#x27;: None, &#x27;å†œå¤«&#x27;: None, &#x27;å»ºç­‘å·¥äºº&#x27;: None, &#x27;æ•™å¸ˆ&#x27;: None&#125;&#125;,</span></span><br><span class=\"line\">        <span class=\"comment\">#  &#x27;è„‘éœ‡è¡&#x27;: &#123;&#x27;ç—‡çŠ¶&#x27;: &#123;&#x27;æ‰“å–·åš&#x27;: None, &#x27;å¤´ç—›&#x27;: None&#125;, &#x27;èŒä¸š&#x27;: &#123;&#x27;æŠ¤å£«&#x27;: None, &#x27;å†œå¤«&#x27;: None, &#x27;å»ºç­‘å·¥äºº&#x27;: None, &#x27;æ•™å¸ˆ&#x27;: None&#125;&#125;,</span></span><br><span class=\"line\">        <span class=\"comment\">#  &#x27;è¿‡æ• &#x27;: &#123;&#x27;ç—‡çŠ¶&#x27;: &#123;&#x27;æ‰“å–·åš&#x27;: None, &#x27;å¤´ç—›&#x27;: None&#125;, &#x27;èŒä¸š&#x27;: &#123;&#x27;æŠ¤å£«&#x27;: None, &#x27;å†œå¤«&#x27;: None, &#x27;å»ºç­‘å·¥äºº&#x27;: None, &#x27;æ•™å¸ˆ&#x27;: None&#125;&#125;</span></span><br><span class=\"line\">        <span class=\"comment\">#  &#125;</span></span><br><span class=\"line\">        <span class=\"comment\"># initialise dictFeatures</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> subTuple <span class=\"keyword\">in</span> trainSet:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> key, value <span class=\"keyword\">in</span> subTuple[<span class=\"number\">0</span>].items():</span><br><span class=\"line\">                dictFeatures[subTuple[<span class=\"number\">1</span>]][key][value] = <span class=\"number\">1</span> <span class=\"keyword\">if</span> dictFeatures[</span><br><span class=\"line\">                    subTuple[<span class=\"number\">1</span>]][key][value] == <span class=\"literal\">None</span> <span class=\"keyword\">else</span> dictFeatures[</span><br><span class=\"line\">                        subTuple[<span class=\"number\">1</span>]][key][value] + <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"comment\"># print(dictFeatures)</span></span><br><span class=\"line\">        <span class=\"comment\"># å°†é©¯è‰¯æ ·æœ¬ä¸­æ²¡æœ‰çš„é¡¹ç›®ï¼Œç”±Noneæ”¹ä¸ºä¸€ä¸ªéå¸¸å°çš„æ•°å€¼ï¼Œè¡¨ç¤ºå…¶æ¦‚ç‡æå°è€Œå¹¶éæ˜¯é›¶</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> tag, featuresDict <span class=\"keyword\">in</span> dictFeatures.items():</span><br><span class=\"line\">            <span class=\"keyword\">for</span> featureName, fetureValueDict <span class=\"keyword\">in</span> featuresDict.items():</span><br><span class=\"line\">                <span class=\"keyword\">for</span> featureKey, featureValues <span class=\"keyword\">in</span> fetureValueDict.items():</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> featureValues == <span class=\"literal\">None</span>:</span><br><span class=\"line\">                        fetureValueDict[featureKey] = <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"comment\"># ç”±ç‰¹å¾é¢‘ç‡è®¡ç®—ç‰¹å¾çš„æ¡ä»¶æ¦‚ç‡P(feature|tag)</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> tag, featuresDict <span class=\"keyword\">in</span> dictFeatures.items():</span><br><span class=\"line\">            <span class=\"keyword\">for</span> featureName, fetureValueDict <span class=\"keyword\">in</span> featuresDict.items():</span><br><span class=\"line\">                totalCount = <span class=\"built_in\">sum</span>(</span><br><span class=\"line\">                    [x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> fetureValueDict.values() <span class=\"keyword\">if</span> x != <span class=\"literal\">None</span>])</span><br><span class=\"line\">                <span class=\"keyword\">for</span> featureKey, featureValues <span class=\"keyword\">in</span> fetureValueDict.items():</span><br><span class=\"line\">                    fetureValueDict[</span><br><span class=\"line\">                        featureKey] = featureValues / totalCount <span class=\"keyword\">if</span> featureValues != <span class=\"literal\">None</span> <span class=\"keyword\">else</span> <span class=\"literal\">None</span></span><br><span class=\"line\">        self.featuresProbablity = dictFeatures</span><br><span class=\"line\">        <span class=\"comment\">##############################################################################</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">classify</span>(<span class=\"params\">self, featureDict</span>):</span></span><br><span class=\"line\">        resultDict = &#123;&#125;</span><br><span class=\"line\">        <span class=\"comment\"># è®¡ç®—æ¯ä¸ªtagçš„æ¡ä»¶æ¦‚ç‡</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> key, value <span class=\"keyword\">in</span> self.tagProbablity.items():</span><br><span class=\"line\">            iNumList = []</span><br><span class=\"line\">            <span class=\"keyword\">for</span> f, v <span class=\"keyword\">in</span> featureDict.items():</span><br><span class=\"line\">                <span class=\"keyword\">if</span> self.featuresProbablity[key][f][v]:</span><br><span class=\"line\">                    iNumList.append(self.featuresProbablity[key][f][v])</span><br><span class=\"line\">            conditionPr = <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> iNum <span class=\"keyword\">in</span> iNumList:</span><br><span class=\"line\">                conditionPr *= iNum</span><br><span class=\"line\">            resultDict[key] = value * conditionPr</span><br><span class=\"line\">        <span class=\"comment\"># å¯¹æ¯”æ¯ä¸ªtagçš„æ¡ä»¶æ¦‚ç‡çš„å¤§å°</span></span><br><span class=\"line\">        resultList = <span class=\"built_in\">sorted</span>(resultDict.items(),</span><br><span class=\"line\">                            key=<span class=\"keyword\">lambda</span> x: x[<span class=\"number\">1</span>],</span><br><span class=\"line\">                            reverse=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> resultList[<span class=\"number\">0</span>][<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    trainSet = [</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;ç—‡çŠ¶&quot;</span>: <span class=\"string\">&quot;æ‰“å–·åš&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;èŒä¸š&quot;</span>: <span class=\"string\">&quot;æŠ¤å£«&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;æ„Ÿå†’ &quot;</span>),</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;ç—‡çŠ¶&quot;</span>: <span class=\"string\">&quot;æ‰“å–·åš&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;èŒä¸š&quot;</span>: <span class=\"string\">&quot;å†œå¤«&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;è¿‡æ• &quot;</span>),</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;ç—‡çŠ¶&quot;</span>: <span class=\"string\">&quot;å¤´ç—›&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;èŒä¸š&quot;</span>: <span class=\"string\">&quot;å»ºç­‘å·¥äºº&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;è„‘éœ‡è¡&quot;</span>),</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;ç—‡çŠ¶&quot;</span>: <span class=\"string\">&quot;å¤´ç—›&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;èŒä¸š&quot;</span>: <span class=\"string\">&quot;å»ºç­‘å·¥äºº&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;æ„Ÿå†’ &quot;</span>),</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;ç—‡çŠ¶&quot;</span>: <span class=\"string\">&quot;æ‰“å–·åš&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;èŒä¸š&quot;</span>: <span class=\"string\">&quot;æ•™å¸ˆ&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;æ„Ÿå†’ &quot;</span>),</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;ç—‡çŠ¶&quot;</span>: <span class=\"string\">&quot;å¤´ç—›&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;èŒä¸š&quot;</span>: <span class=\"string\">&quot;æ•™å¸ˆ&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;è„‘éœ‡è¡&quot;</span>),</span><br><span class=\"line\">    ]</span><br><span class=\"line\">    monitor = NBClassify()</span><br><span class=\"line\">    <span class=\"comment\"># trainSet is something like that [(featureDict, tag), ]</span></span><br><span class=\"line\">    monitor.train(trainSet)</span><br><span class=\"line\">    <span class=\"comment\"># æ‰“å–·åšçš„å»ºç­‘å·¥äºº</span></span><br><span class=\"line\">    <span class=\"comment\"># è¯·é—®ä»–æ‚£ä¸Šæ„Ÿå†’çš„æ¦‚ç‡æœ‰å¤šå¤§ï¼Ÿ</span></span><br><span class=\"line\">    result = monitor.classify(&#123;<span class=\"string\">&quot;ç—‡çŠ¶&quot;</span>: <span class=\"string\">&quot;æ‰“å–·åš&quot;</span>, <span class=\"string\">&quot;èŒä¸š&quot;</span>: <span class=\"string\">&quot;å»ºç­‘å·¥äºº&quot;</span>&#125;)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(result)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>æ„Ÿå†’ \n</code></pre>\n<h3 id=\"èšç±»é—®é¢˜\">èšç±»é—®é¢˜</h3>\n<h4 id=\"K-Means-ä¸è¡¡é‡æŒ‡æ ‡\">K-Means-ä¸è¡¡é‡æŒ‡æ ‡</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.colors</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.datasets <span class=\"keyword\">as</span> ds</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> homogeneity_score, completeness_score, v_measure_score, adjusted_mutual_info_score,\\</span><br><span class=\"line\">    adjusted_rand_score, silhouette_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.cluster <span class=\"keyword\">import</span> KMeans</span><br><span class=\"line\"><span class=\"keyword\">from</span> mpl_toolkits.mplot3d <span class=\"keyword\">import</span> Axes3D</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">expand</span>(<span class=\"params\">a, b</span>):</span></span><br><span class=\"line\">    d = (b - a) * <span class=\"number\">0.1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> a - d, b + d</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">N = <span class=\"number\">400</span></span><br><span class=\"line\">centers = <span class=\"number\">4</span></span><br><span class=\"line\">data, y = ds.make_blobs(N, n_features=<span class=\"number\">2</span>, centers=centers, random_state=<span class=\"number\">2</span>)</span><br><span class=\"line\">data2, y2 = ds.make_blobs(N,</span><br><span class=\"line\">                          n_features=<span class=\"number\">2</span>,</span><br><span class=\"line\">                          centers=centers,</span><br><span class=\"line\">                          cluster_std=(<span class=\"number\">1</span>, <span class=\"number\">2.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">2</span>),</span><br><span class=\"line\">                          random_state=<span class=\"number\">2</span>)</span><br><span class=\"line\">data3 = np.vstack(</span><br><span class=\"line\">    (data[y == <span class=\"number\">0</span>][:], data[y == <span class=\"number\">1</span>][:<span class=\"number\">50</span>], data[y == <span class=\"number\">2</span>][:<span class=\"number\">20</span>], data[y == <span class=\"number\">3</span>][:<span class=\"number\">5</span>]))</span><br><span class=\"line\">y3 = np.array([<span class=\"number\">0</span>] * <span class=\"number\">100</span> + [<span class=\"number\">1</span>] * <span class=\"number\">50</span> + [<span class=\"number\">2</span>] * <span class=\"number\">20</span> + [<span class=\"number\">3</span>] * <span class=\"number\">5</span>)</span><br><span class=\"line\">m = np.array(((<span class=\"number\">1</span>, <span class=\"number\">1</span>), (<span class=\"number\">1</span>, <span class=\"number\">3</span>)))</span><br><span class=\"line\">data_r = data.dot(m)</span><br><span class=\"line\"></span><br><span class=\"line\">matplotlib.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">matplotlib.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\">cm = matplotlib.colors.ListedColormap(<span class=\"built_in\">list</span>(<span class=\"string\">&#x27;rgbm&#x27;</span>))</span><br><span class=\"line\">data_list = data, data, data_r, data_r, data2, data2, data3, data3</span><br><span class=\"line\">y_list = y, y, y, y, y2, y2, y3, y3</span><br><span class=\"line\">titles = <span class=\"string\">&#x27;åŸå§‹æ•°æ®&#x27;</span>, <span class=\"string\">&#x27;KMeans++èšç±»&#x27;</span>, <span class=\"string\">&#x27;æ—‹è½¬åæ•°æ®&#x27;</span>, <span class=\"string\">&#x27;æ—‹è½¬åKMeans++èšç±»&#x27;</span>,\\</span><br><span class=\"line\">          <span class=\"string\">&#x27;æ–¹å·®ä¸ç›¸ç­‰æ•°æ®&#x27;</span>, <span class=\"string\">&#x27;æ–¹å·®ä¸ç›¸ç­‰KMeans++èšç±»&#x27;</span>, <span class=\"string\">&#x27;æ•°é‡ä¸ç›¸ç­‰æ•°æ®&#x27;</span>, <span class=\"string\">&#x27;æ•°é‡ä¸ç›¸ç­‰KMeans++èšç±»&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">model = KMeans(n_clusters=<span class=\"number\">4</span>, init=<span class=\"string\">&#x27;k-means++&#x27;</span>, n_init=<span class=\"number\">5</span>)</span><br><span class=\"line\">fig = plt.figure(figsize=(<span class=\"number\">8</span>, <span class=\"number\">9</span>), facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, (x, y, title) <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(<span class=\"built_in\">zip</span>(data_list, y_list, titles), start=<span class=\"number\">1</span>):</span><br><span class=\"line\">    <span class=\"comment\"># plt.subplot(4, 2, i)</span></span><br><span class=\"line\">    ax = fig.add_subplot(<span class=\"number\">4</span>, <span class=\"number\">2</span>, i)</span><br><span class=\"line\">    plt.title(title)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> i % <span class=\"number\">2</span> == <span class=\"number\">1</span>:</span><br><span class=\"line\">        y_pred = y</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        y_pred = model.fit_predict(x)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(i)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Homogeneity:&#x27;</span>, homogeneity_score(y, y_pred))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;completeness:&#x27;</span>, completeness_score(y, y_pred))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;V measure:&#x27;</span>, v_measure_score(y, y_pred))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;AMI:&#x27;</span>, adjusted_mutual_info_score(y, y_pred))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;ARI:&#x27;</span>, adjusted_rand_score(y, y_pred))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Silhouette:&#x27;</span>, silhouette_score(x, y_pred), <span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\">    ax.scatter(x[:, <span class=\"number\">0</span>], x[:, <span class=\"number\">1</span>], s=<span class=\"number\">10</span>, c=y_pred, cmap=cm, edgecolors=<span class=\"string\">&#x27;none&#x27;</span>)</span><br><span class=\"line\">    ax.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\">plt.tight_layout(<span class=\"number\">2</span>, rect=(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0.95</span>))</span><br><span class=\"line\">plt.suptitle(<span class=\"string\">&#x27;æ•°æ®åˆ†å¸ƒå¯¹KMeansèšç±»çš„å½±å“&#x27;</span>, fontsize=<span class=\"number\">18</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>1\nHomogeneity: 1.0\ncompleteness: 1.0\nV measure: 1.0\nAMI: 1.0\nARI: 1.0\nSilhouette: 0.616436816839852 \n\n2\nHomogeneity: 0.9898828240244267\ncompleteness: 0.9899006758819153\nV measure: 0.9898917498726852\nAMI: 0.9898081557479033\nARI: 0.9933165272203728\nSilhouette: 0.6189656317733315 \n\n3\nHomogeneity: 1.0\ncompleteness: 1.0\nV measure: 1.0\nAMI: 1.0\nARI: 1.0\nSilhouette: 0.5275987244664399 \n\n4\nHomogeneity: 0.7296158940840607\ncompleteness: 0.7315285272632114\nV measure: 0.7305709588584066\nAMI: 0.7283397010755561\nARI: 0.6783811042853299\nSilhouette: 0.5366236044449266 \n\n5\nHomogeneity: 1.0\ncompleteness: 1.0\nV measure: 1.0\nAMI: 1.0\nARI: 1.0\nSilhouette: 0.4790725752982868 \n\n6\nHomogeneity: 0.7449364376693913\ncompleteness: 0.7755445167472191\nV measure: 0.7599323988656883\nAMI: 0.757903292819801\nARI: 0.7113213508090338\nSilhouette: 0.5737260449304202 \n\n7\nHomogeneity: 1.0\ncompleteness: 1.0\nV measure: 1.0\nAMI: 1.0\nARI: 1.0\nSilhouette: 0.5975066093204152 \n\n8\nHomogeneity: 0.9776347312784609\ncompleteness: 0.9728632742060752\nV measure: 0.975243166591057\nAMI: 0.9745709993295113\nARI: 0.9906840043816505\nSilhouette: 0.6013877858619149 \n\n\n\nC:\\Users\\utsuk\\AppData\\Local\\Temp\\ipykernel_28356\\867049078.py:57: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.\n  plt.tight_layout(2, rect=(0, 0, 1, 0.95))\n</code></pre>\n<p><img src=\"ML_files/ML_31_2.png\" alt=\"png\"></p>\n<h4 id=\"å±‚æ¬¡èšç±»\">å±‚æ¬¡èšç±»</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.cluster <span class=\"keyword\">import</span> AgglomerativeClustering</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.neighbors <span class=\"keyword\">import</span> kneighbors_graph</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.datasets <span class=\"keyword\">as</span> ds</span><br><span class=\"line\"><span class=\"keyword\">import</span> warnings</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">def</span> <span class=\"title\">expand</span>(<span class=\"params\">a, b, r</span>):</span></span><br><span class=\"line\">    d = (b - a) * r</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a - d, b + d</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    warnings.filterwarnings(action=<span class=\"string\">&#x27;ignore&#x27;</span>, category=UserWarning)</span><br><span class=\"line\">    np.set_printoptions(suppress=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    np.random.seed(<span class=\"number\">0</span>)</span><br><span class=\"line\">    n_clusters = <span class=\"number\">4</span></span><br><span class=\"line\">    N = <span class=\"number\">400</span></span><br><span class=\"line\">    data1, y1 = ds.make_blobs(n_samples=N,</span><br><span class=\"line\">                              n_features=<span class=\"number\">2</span>,</span><br><span class=\"line\">                              centers=((-<span class=\"number\">1</span>, <span class=\"number\">1</span>), (<span class=\"number\">1</span>, <span class=\"number\">1</span>), (<span class=\"number\">1</span>, -<span class=\"number\">1</span>), (-<span class=\"number\">1</span>, -<span class=\"number\">1</span>)),</span><br><span class=\"line\">                              cluster_std=(<span class=\"number\">0.1</span>, <span class=\"number\">0.2</span>, <span class=\"number\">0.3</span>, <span class=\"number\">0.4</span>),</span><br><span class=\"line\">                              random_state=<span class=\"number\">0</span>)</span><br><span class=\"line\">    data1 = np.array(data1)</span><br><span class=\"line\">    n_noise = <span class=\"built_in\">int</span>(<span class=\"number\">0.1</span> * N)</span><br><span class=\"line\">    r = np.random.rand(n_noise, <span class=\"number\">2</span>)</span><br><span class=\"line\">    data_min1, data_min2 = np.<span class=\"built_in\">min</span>(data1, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    data_max1, data_max2 = np.<span class=\"built_in\">max</span>(data1, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    r[:, <span class=\"number\">0</span>] = r[:, <span class=\"number\">0</span>] * (data_max1 - data_min1) + data_min1</span><br><span class=\"line\">    r[:, <span class=\"number\">1</span>] = r[:, <span class=\"number\">1</span>] * (data_max2 - data_min2) + data_min2</span><br><span class=\"line\">    data1_noise = np.concatenate((data1, r), axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    y1_noise = np.concatenate((y1, [<span class=\"number\">4</span>] * n_noise))</span><br><span class=\"line\"></span><br><span class=\"line\">    data2, y2 = ds.make_moons(n_samples=N, noise=<span class=\"number\">.05</span>)</span><br><span class=\"line\">    data2 = np.array(data2)</span><br><span class=\"line\">    n_noise = <span class=\"built_in\">int</span>(<span class=\"number\">0.1</span> * N)</span><br><span class=\"line\">    r = np.random.rand(n_noise, <span class=\"number\">2</span>)</span><br><span class=\"line\">    data_min1, data_min2 = np.<span class=\"built_in\">min</span>(data2, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    data_max1, data_max2 = np.<span class=\"built_in\">max</span>(data2, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    r[:, <span class=\"number\">0</span>] = r[:, <span class=\"number\">0</span>] * (data_max1 - data_min1) + data_min1</span><br><span class=\"line\">    r[:, <span class=\"number\">1</span>] = r[:, <span class=\"number\">1</span>] * (data_max2 - data_min2) + data_min2</span><br><span class=\"line\">    data2_noise = np.concatenate((data2, r), axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    y2_noise = np.concatenate((y2, [<span class=\"number\">3</span>] * n_noise))</span><br><span class=\"line\"></span><br><span class=\"line\">    mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">    mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">    cm = mpl.colors.ListedColormap([<span class=\"string\">&#x27;r&#x27;</span>, <span class=\"string\">&#x27;g&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"string\">&#x27;m&#x27;</span>, <span class=\"string\">&#x27;c&#x27;</span>])</span><br><span class=\"line\">    plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">8</span>), facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">    plt.cla()</span><br><span class=\"line\">    linkages = (<span class=\"string\">&quot;ward&quot;</span>, <span class=\"string\">&quot;complete&quot;</span>, <span class=\"string\">&quot;average&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> index, (n_clusters, data, y) <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(</span><br><span class=\"line\">        ((<span class=\"number\">4</span>, data1, y1), (<span class=\"number\">4</span>, data1_noise, y1_noise), (<span class=\"number\">2</span>, data2, y2),</span><br><span class=\"line\">         (<span class=\"number\">2</span>, data2_noise, y2_noise))):</span><br><span class=\"line\">        plt.subplot(<span class=\"number\">4</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span> * index + <span class=\"number\">1</span>)</span><br><span class=\"line\">        plt.scatter(data[:, <span class=\"number\">0</span>], data[:, <span class=\"number\">1</span>], c=y, s=<span class=\"number\">12</span>, edgecolors=<span class=\"string\">&#x27;k&#x27;</span>, cmap=cm)</span><br><span class=\"line\">        plt.title(<span class=\"string\">&#x27;Prime&#x27;</span>, fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">        plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\">        data_min1, data_min2 = np.<span class=\"built_in\">min</span>(data, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        data_max1, data_max2 = np.<span class=\"built_in\">max</span>(data, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        plt.xlim(expand(data_min1, data_max1, <span class=\"number\">0.05</span>))</span><br><span class=\"line\">        plt.ylim(expand(data_min2, data_max2, <span class=\"number\">0.05</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        connectivity = kneighbors_graph(data,</span><br><span class=\"line\">                                        n_neighbors=<span class=\"number\">7</span>,</span><br><span class=\"line\">                                        mode=<span class=\"string\">&#x27;distance&#x27;</span>,</span><br><span class=\"line\">                                        metric=<span class=\"string\">&#x27;minkowski&#x27;</span>,</span><br><span class=\"line\">                                        p=<span class=\"number\">2</span>,</span><br><span class=\"line\">                                        include_self=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        connectivity = <span class=\"number\">0.5</span> * (connectivity + connectivity.T)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i, linkage <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(linkages):</span><br><span class=\"line\">            ac = AgglomerativeClustering(n_clusters=n_clusters,</span><br><span class=\"line\">                                         affinity=<span class=\"string\">&#x27;euclidean&#x27;</span>,</span><br><span class=\"line\">                                         connectivity=connectivity,</span><br><span class=\"line\">                                         linkage=linkage)</span><br><span class=\"line\">            ac.fit(data)</span><br><span class=\"line\">            y = ac.labels_</span><br><span class=\"line\">            plt.subplot(<span class=\"number\">4</span>, <span class=\"number\">4</span>, i + <span class=\"number\">2</span> + <span class=\"number\">4</span> * index)</span><br><span class=\"line\">            plt.scatter(data[:, <span class=\"number\">0</span>],</span><br><span class=\"line\">                        data[:, <span class=\"number\">1</span>],</span><br><span class=\"line\">                        c=y,</span><br><span class=\"line\">                        s=<span class=\"number\">12</span>,</span><br><span class=\"line\">                        edgecolors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">                        cmap=cm)</span><br><span class=\"line\">            plt.title(linkage, fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">            plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\">            plt.xlim(expand(data_min1, data_max1, <span class=\"number\">0.05</span>))</span><br><span class=\"line\">            plt.ylim(expand(data_min2, data_max2, <span class=\"number\">0.05</span>))</span><br><span class=\"line\">    plt.suptitle(<span class=\"string\">&#x27;å±‚æ¬¡èšç±»çš„ä¸åŒåˆå¹¶ç­–ç•¥&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">    plt.tight_layout(<span class=\"number\">0.5</span>, rect=(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0.95</span>))</span><br><span class=\"line\">    plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src=\"ML_files/ML_33_0.png\" alt=\"png\"></p>\n<h3 id=\"é™ç»´é—®é¢˜-2\">é™ç»´é—®é¢˜</h3>\n<h4 id=\"ç¼ºå¤±å€¼æ¯”ç‡-2\">ç¼ºå¤±å€¼æ¯”ç‡</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># import required libraries</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># read the data</span></span><br><span class=\"line\">train = pd.read_csv(<span class=\"string\">&quot;./é™ç»´é—®é¢˜/train_v9rqX0R.csv&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># checking the percentage of missing values in each variable</span></span><br><span class=\"line\"><span class=\"comment\"># æ•°æ®å®Œæ•´ç‡ = (ç©ºæ•° / æ‰€æœ‰æ•°) * 100</span></span><br><span class=\"line\">a = train.isnull().<span class=\"built_in\">sum</span>() / <span class=\"built_in\">len</span>(train) * <span class=\"number\">100</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># saving column names in a variable</span></span><br><span class=\"line\">variable = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"number\">12</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> a[i] &lt;= <span class=\"number\">20</span>:  <span class=\"comment\">#setting the threshold as 20%</span></span><br><span class=\"line\">        variable.append(train.columns[i])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç¼ºå¤±ç‡å¤§äºé˜ˆå€¼çš„åˆ—</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(variable)</span><br></pre></td></tr></table></figure>\n<pre><code>['Item_Identifier', 'Item_Weight', 'Item_Fat_Content', 'Item_Visibility', 'Item_Type', 'Item_MRP', 'Outlet_Identifier', 'Outlet_Establishment_Year', 'Outlet_Location_Type', 'Outlet_Type', 'Item_Outlet_Sales']\n</code></pre>\n<h4 id=\"ä½æ–¹å·®è¿‡æ»¤-2\">ä½æ–¹å·®è¿‡æ»¤</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># import required libraries</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># read the data</span></span><br><span class=\"line\">train = pd.read_csv(<span class=\"string\">&quot;./é™ç»´é—®é¢˜/train_v9rqX0R.csv&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¡«å……ç©ºé¡¹</span></span><br><span class=\"line\">train[<span class=\"string\">&#x27;Item_Weight&#x27;</span>].fillna(train[<span class=\"string\">&#x27;Item_Weight&#x27;</span>].median(), inplace=<span class=\"literal\">True</span>)</span><br><span class=\"line\">train[<span class=\"string\">&#x27;Outlet_Size&#x27;</span>].fillna(train[<span class=\"string\">&#x27;Outlet_Size&#x27;</span>].mode()[<span class=\"number\">0</span>], inplace=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¡«å……åçš„ç¼ºå¤±ç‡</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(train.isnull().<span class=\"built_in\">sum</span>() / <span class=\"built_in\">len</span>(train) * <span class=\"number\">100</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">numeric = train[[</span><br><span class=\"line\">    <span class=\"string\">&#x27;Item_Weight&#x27;</span>, <span class=\"string\">&#x27;Item_Visibility&#x27;</span>, <span class=\"string\">&#x27;Item_MRP&#x27;</span>, <span class=\"string\">&#x27;Outlet_Establishment_Year&#x27;</span></span><br><span class=\"line\">]]</span><br><span class=\"line\">var = numeric.var()</span><br><span class=\"line\">numeric = numeric.columns</span><br><span class=\"line\">variable = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(var)):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> var[i] &gt;= <span class=\"number\">10</span>:  <span class=\"comment\">#setting the threshold as 10%</span></span><br><span class=\"line\">        variable.append(numeric[i])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(variable)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>Item_Identifier              0.0\nItem_Weight                  0.0\nItem_Fat_Content             0.0\nItem_Visibility              0.0\nItem_Type                    0.0\nItem_MRP                     0.0\nOutlet_Identifier            0.0\nOutlet_Establishment_Year    0.0\nOutlet_Size                  0.0\nOutlet_Location_Type         0.0\nOutlet_Type                  0.0\nItem_Outlet_Sales            0.0\ndtype: float64\n['Item_Weight', 'Item_MRP', 'Outlet_Establishment_Year']\n</code></pre>\n<h2 id=\"ä»£ç ç›¸å…³\">ä»£ç ç›¸å…³</h2>\n<h3 id=\"å­˜å‚¨-è¯»å–æ¨¡å‹\">å­˜å‚¨-è¯»å–æ¨¡å‹</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.linear_model <span class=\"keyword\">as</span> lm  <span class=\"comment\"># çº¿æ€§æ¨¡å‹</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.metrics <span class=\"keyword\">as</span> sm  <span class=\"comment\"># æ¨¡å‹æ€§èƒ½è¯„ä»·æ¨¡å—</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> mp</span><br><span class=\"line\"><span class=\"keyword\">import</span> pickle</span><br><span class=\"line\"></span><br><span class=\"line\">x = np.array([[<span class=\"number\">0.5</span>], [<span class=\"number\">0.6</span>], [<span class=\"number\">0.8</span>], [<span class=\"number\">1.1</span>], [<span class=\"number\">1.4</span>]])  <span class=\"comment\"># è¾“å…¥é›†</span></span><br><span class=\"line\">y = np.array([<span class=\"number\">5.0</span>, <span class=\"number\">5.5</span>, <span class=\"number\">6.0</span>, <span class=\"number\">6.8</span>, <span class=\"number\">7.0</span>])  <span class=\"comment\"># è¾“å‡ºé›†</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># åˆ›å»ºçº¿æ€§å›å½’å™¨</span></span><br><span class=\"line\">model = lm.LinearRegression()</span><br><span class=\"line\"><span class=\"comment\"># ç”¨å·²çŸ¥è¾“å…¥ã€è¾“å‡ºæ•°æ®é›†è®­ç»ƒå›å½’å™¨</span></span><br><span class=\"line\">model.fit(x, y)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;è®­ç»ƒå®Œæˆ.&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ä¿å­˜è®­ç»ƒåçš„æ¨¡å‹</span></span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;linear_model.pkl&#x27;</span>, <span class=\"string\">&#x27;wb&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    pickle.dump(model, f)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;ä¿å­˜æ¨¡å‹å®Œæˆ.&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">######################### åŠ è½½æ¨¡å‹ #########################</span></span><br><span class=\"line\"><span class=\"comment\"># ä¸Šé¢é€šè¿‡è®­ç»ƒæ•°æ®x,y è®­ç»ƒå¥½äº† x -&gt; y çš„çº¿æ€§å›å½’æ¨¡å‹</span></span><br><span class=\"line\"><span class=\"comment\"># ä¸‹é¢åŠ è½½æ¨¡å‹, å†ç»™å‡ºæµ‹è¯•æ•°æ® x, æŸ¥çœ‹æ¨¡å‹é¢„æµ‹ç»“æœç›´çº¿ä¸åŸå§‹æ•°æ® (x,y) çš„æ‹Ÿåˆåº¦</span></span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;linear_model.pkl&#x27;</span>, <span class=\"string\">&#x27;rb&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    model = pickle.load(f)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;åŠ è½½æ¨¡å‹å®Œæˆ.&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># æ ¹æ®åŠ è½½çš„æ¨¡å‹é¢„æµ‹è¾“å‡º</span></span><br><span class=\"line\">pred_y = model.predict(x)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å¯è§†åŒ–å›å½’æ›²çº¿</span></span><br><span class=\"line\">mp.figure(<span class=\"string\">&#x27;Linear Regression&#x27;</span>, facecolor=<span class=\"string\">&#x27;lightgray&#x27;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&#x27;Linear Regression&#x27;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.xlabel(<span class=\"string\">&#x27;x&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&#x27;y&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.tick_params(labelsize=<span class=\"number\">10</span>)</span><br><span class=\"line\">mp.grid(linestyle=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\">mp.scatter(x, y, c=<span class=\"string\">&#x27;blue&#x27;</span>, alpha=<span class=\"number\">0.8</span>, s=<span class=\"number\">60</span>, label=<span class=\"string\">&#x27;Sample Points&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.plot(x, pred_y, c=<span class=\"string\">&#x27;orangered&#x27;</span>, label=<span class=\"string\">&#x27;Regression&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.legend()</span><br><span class=\"line\">mp.show()</span><br></pre></td></tr></table></figure>\n<pre><code>è®­ç»ƒå®Œæˆ.\nä¿å­˜æ¨¡å‹å®Œæˆ.\nåŠ è½½æ¨¡å‹å®Œæˆ.\n</code></pre>\n<p><img src=\"ML_files/ML_39_1.png\" alt=\"png\"></p>\n<h2 id=\"ä¿¡æ¯è®º\">ä¿¡æ¯è®º</h2>\n<h3 id=\"ä¸¤ç‚¹åˆ†å¸ƒä¿¡æ¯ç†µ\">ä¸¤ç‚¹åˆ†å¸ƒä¿¡æ¯ç†µ</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># å› ä¸º ln0 æ— å®šä¹‰, ç”¨æ­¤å€¼æ¨¡æ‹Ÿè¶‹è¿‘ 0</span></span><br><span class=\"line\">eps = <span class=\"number\">1e-5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># probability</span></span><br><span class=\"line\">p = np.linspace(eps, <span class=\"number\">1</span> - eps, <span class=\"number\">100</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Information entropy</span></span><br><span class=\"line\">h = -(<span class=\"number\">1</span> - p) * np.log2(<span class=\"number\">1</span> - p) - p * np.log2(p)</span><br><span class=\"line\"></span><br><span class=\"line\">plt.plot(p, h, label=<span class=\"string\">&#x27;Information entropy&#x27;</span>, color=<span class=\"string\">&#x27;red&#x27;</span>, lw=<span class=\"number\">3</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Probability&#x27;</span>, fontsize=<span class=\"number\">16</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Entropy&#x27;</span>, fontsize=<span class=\"number\">16</span>)</span><br><span class=\"line\">plt.legend(loc=<span class=\"string\">&#x27;best&#x27;</span>, fontsize=<span class=\"number\">16</span>)</span><br><span class=\"line\">plt.grid(<span class=\"literal\">True</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ç»“æœä¸­ä¿¡æ¯ç†µçš„å³°å€¼å–å†³äº log åº•æ•°, eä¸ºåº•æ—¶å³°å€¼ä¸º0.7å·¦å³, 2ä¸ºåº•å³°å€¼ä¸º1</span></span><br></pre></td></tr></table></figure>\n<p><img src=\"ML_files/ML_41_0.png\" alt=\"png\"></p>\n<h3 id=\"åŸºå°¼ç³»æ•°ä¸-ln\">åŸºå°¼ç³»æ•°ä¸-ln</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\">eps = <span class=\"number\">1e-4</span></span><br><span class=\"line\">p = np.linspace(eps, <span class=\"number\">1</span> - eps, <span class=\"number\">100</span>)</span><br><span class=\"line\">h = -(<span class=\"number\">1</span> - p) * np.log2(<span class=\"number\">1</span> - p) - p * np.log2(p)</span><br><span class=\"line\">gini = <span class=\"number\">2</span> * (<span class=\"number\">1</span> - p) * p</span><br><span class=\"line\"></span><br><span class=\"line\">plt.plot(p, gini, <span class=\"string\">&#x27;r-&#x27;</span>, lw=<span class=\"number\">3</span>)</span><br><span class=\"line\">plt.plot(p, h / <span class=\"number\">2</span>, <span class=\"string\">&#x27;g-&#x27;</span>, lw=<span class=\"number\">3</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Gini(p) / Ln(p)&#x27;</span>, fontsize=<span class=\"number\">16</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;p&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;H&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">plt.legend([<span class=\"string\">&#x27;Gini&#x27;</span>, <span class=\"string\">&#x27;Ln&#x27;</span>], loc=<span class=\"string\">&#x27;best&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<p><img src=\"ML_files/ML_43_0.png\" alt=\"png\"></p>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"åˆ†å‰²çº¿\"></a></p>\n<h2 id=\"å€Ÿç‰©è¡¨-32\">å€Ÿç‰©è¡¨</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://discover304.top/\">https://discover304.top/</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://www.bilibili.com/video/BV16L411w7oQ?p=6\">ã€ä¸Šæµ·äº¤å¤§ã€‘ã€è…¾è®¯ã€‘å¼ºå¼ºè”åˆ æœºå™¨å­¦ä¹ +æ·±åº¦å­¦ä¹ </a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://www.analyticsvidhya.com/blog/2018/08/dimensionality-reduction-techniques-python/\">The Ultimate Guide to 12 Dimensionality Reduction Techniques (with Python codes)</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "äººå·¥æ™ºèƒ½",
                "æœºå™¨å­¦ä¹ ",
                "ä¿¡æ¯è®º"
            ]
        }
    ]
}