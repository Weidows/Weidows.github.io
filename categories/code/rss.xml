<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>â­ï¸é½ä¸‹æ— è´°â­ï¸ â€¢ Posts by &#34;code&#34; category</title>
        <link>https://weidows.github.io</link>
        <description>May all the beauty be bless.âœ¨</description>
        <language>zh-CN</language>
        <pubDate>Thu, 30 Jun 2022 16:59:59 +0000</pubDate>
        <lastBuildDate>Thu, 30 Jun 2022 16:59:59 +0000</lastBuildDate>
        <category>å¤‡å¿˜å½•</category>
        <category>API</category>
        <category>Twitter</category>
        <category>cloudflare</category>
        <category>æ¨è</category>
        <category>æµè§ˆå™¨</category>
        <category>æ‰©å±•</category>
        <category>FFmpeg</category>
        <category>ç®—æ³•</category>
        <category>hexdump</category>
        <category>HLS</category>
        <category>openssl</category>
        <category>shell</category>
        <category>å¯†ç å­¦</category>
        <category>QQ</category>
        <category>PS</category>
        <category>è®¾è®¡</category>
        <category>é…è‰²</category>
        <category>æ¶æ„</category>
        <category>å…¬å¸</category>
        <category>ç®¡ç†</category>
        <category>doing</category>
        <category>ideas</category>
        <category>design</category>
        <category>æ‘„å½±</category>
        <category>SSH</category>
        <category>Linux</category>
        <category>Regex</category>
        <category>yaml</category>
        <category>ç”Ÿæ´»</category>
        <category>æ¸¸æˆ</category>
        <category>å“²å­¦</category>
        <category>Dev</category>
        <category>åŒ»å­¦</category>
        <category>å¥èº«</category>
        <category>çŒ«</category>
        <category>ç¬”è®°</category>
        <category>å·¥ä½œ</category>
        <category>é—²é±¼</category>
        <category>è´­ç‰©</category>
        <category>English</category>
        <category>VScode</category>
        <category>IDEA</category>
        <category>HTML</category>
        <category>CSS</category>
        <category>JavaScript</category>
        <category>æˆé•¿è·¯çº¿</category>
        <category>åŸºç¡€çŸ¥è¯†</category>
        <category>Java</category>
        <category>cpp</category>
        <category>Python</category>
        <category>å·¥å…·</category>
        <category>å¤§å‰ç«¯</category>
        <category>Font</category>
        <category>VR</category>
        <category>ç½‘è¯¾</category>
        <category>Manjaro</category>
        <category>æ“ä½œç³»ç»Ÿ</category>
        <category>æœåŠ¡å™¨</category>
        <category>è™šæ‹Ÿæœº</category>
        <category>æ ‘è“æ´¾</category>
        <category>Windows</category>
        <category>office</category>
        <category>Docker</category>
        <category>å¤šçº¿ç¨‹</category>
        <category>è¿›ç¨‹</category>
        <category>CPU</category>
        <category>Scoop</category>
        <category>Maven</category>
        <category>Git</category>
        <category>nodejs</category>
        <category>wsl2</category>
        <category>Aria2</category>
        <category>PyCharm</category>
        <category>Goland</category>
        <category>å›¾åºŠ</category>
        <category>çˆ¬è™«</category>
        <category>SM.MS</category>
        <category>package</category>
        <category>homebrew</category>
        <category>Tomcat</category>
        <category>Website</category>
        <category>AI</category>
        <category>GPT</category>
        <category>æ‰‹æœº</category>
        <category>è€³æœº</category>
        <category>ç”µè„‘</category>
        <category>npm</category>
        <category>yarn</category>
        <category>LeetCode</category>
        <category>æ•°æ®ç»“æ„</category>
        <category>é¢è¯•</category>
        <category>OpenGL</category>
        <category>C</category>
        <category>conan</category>
        <category>è®¡ç½‘</category>
        <category>ç¡¬ä»¶</category>
        <category>OneNote</category>
        <category>å¤å˜å‡½æ•°</category>
        <category>äººå·¥æ™ºèƒ½</category>
        <category>é€šä¿¡</category>
        <category>éŸ³é¢‘</category>
        <category>å‚…é‡Œå¶å˜æ¢</category>
        <category>æåŒ–ç </category>
        <category>ä¿¡æ¯è®º</category>
        <category>SQL</category>
        <category>å‰ç«¯</category>
        <category>JSON</category>
        <category>Mariadb</category>
        <category>åç«¯</category>
        <category>k8s</category>
        <category>å¤©æ–‡å­¦</category>
        <category>ç‰©ç†</category>
        <category>LaTeX</category>
        <category>Butterfly</category>
        <category>KaTeX</category>
        <category>Math</category>
        <category>research</category>
        <category>math</category>
        <category>dataset</category>
        <category>æ·±åº¦å­¦ä¹ </category>
        <category>ç‚¹äº‘</category>
        <category>è‡ªåŠ¨é©¾é©¶</category>
        <category>Color</category>
        <category>åˆ›ä¸š</category>
        <category>Javadoc</category>
        <category>ç¼–ç </category>
        <category>è®¾è®¡æ¨¡å¼</category>
        <category>JVM</category>
        <category>Lambda</category>
        <category>CORS</category>
        <category>JQuery</category>
        <category>Vue</category>
        <category>Cmake</category>
        <category>åŒºå—é“¾</category>
        <category>Golang</category>
        <category>tools</category>
        <category>doc</category>
        <category>Markdown</category>
        <category>markdown</category>
        <category>slidev</category>
        <category>PHP</category>
        <category>Processing</category>
        <category>Anaconda</category>
        <category>python</category>
        <category>opengl</category>
        <category>PowerShell</category>
        <category>zsh</category>
        <category>å®å¡”é¢æ¿</category>
        <category>guitar</category>
        <category>music</category>
        <category>éŸ³ä¹</category>
        <category>å¿ƒç†å­¦</category>
        <category>æç¬‘</category>
        <category>é«˜èƒ½</category>
        <category>å¾®ä¿¡</category>
        <category>relationship</category>
        <category>å¿«æ·é”®</category>
        <category>theme</category>
        <category>AWS</category>
        <category>Server</category>
        <category>Ubuntu</category>
        <category>alist</category>
        <category>system</category>
        <category>è“æ˜“äº‘</category>
        <category>Hexo</category>
        <category>Github</category>
        <category>Gitee</category>
        <category>Action</category>
        <category>branch</category>
        <category>release</category>
        <category>Copilot</category>
        <category>æ’ä»¶</category>
        <category>Emmet</category>
        <category>ç¾åŒ–</category>
        <category>snippet</category>
        <category>SEO</category>
        <category>Pjax</category>
        <category>butterfly</category>
        <category>pug</category>
        <category>styl</category>
        <category>ä¼˜åŒ–</category>
        <category>é­”æ”¹</category>
        <category>MyBatis</category>
        <category>Map</category>
        <category>CRUD</category>
        <category>æ—¥å¿—</category>
        <category>åˆ†é¡µ</category>
        <category>æ•°æ®åº“</category>
        <category>æ³¨è§£</category>
        <category>MySQL</category>
        <category>JDBC</category>
        <category>JavaWeb</category>
        <category>Servlet</category>
        <category>Cookie</category>
        <category>Session</category>
        <category>JSP</category>
        <category>Filter</category>
        <category>å¯¹è±¡</category>
        <category>åå°„</category>
        <category>æœºå™¨å­¦ä¹ </category>
        <category>MMDetection</category>
        <category>Colab</category>
        <category>æ¦‚ç‡è®º</category>
        <item>
            <guid isPermalink="true">https://weidows.github.io/post/lang/python/code/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%8F%91%E7%94%9F%E5%99%A8/</guid>
            <title>â™¾ï¸ä¼ªéšæœºæ•°å‘ç”Ÿå™¨</title>
            <link>https://weidows.github.io/post/lang/python/code/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%8F%91%E7%94%9F%E5%99%A8/</link>
            <category>å¯†ç å­¦</category>
            <category>æ¦‚ç‡è®º</category>
            <pubDate>Thu, 30 Jun 2022 16:59:59 +0000</pubDate>
            <description><![CDATA[ &lt;!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @LastEditors: Weidows
 * @LastEditTime: 2023-04-20 18:30:39
 * @FilePath: \Blog-private\source\_posts\python\code\ä¼ªéšæœºæ•°å‘ç”Ÿå™¨.md
 * @Description:
 * @!: *********************************************************************
--&gt;
&lt;h2 id=&#34;åº&#34;&gt;åº&lt;/h2&gt;
&lt;p&gt;æ­¤å‘ç”Ÿå™¨åŸºäºç©ºé—´æ•°ç»„, éšæœºç§å­æ¥è‡ªäº time æ—¶é—´æˆ³æœ«å°¾ä½&lt;/p&gt;
&lt;p&gt;éšç€ random æ¬¡æ•°å¢åŠ , array ä¸ç¡®å®šåº¦æŒç»­&lt;code&gt;å åŠ &lt;/code&gt;, æ¯ä½æ¦‚ç‡ä¼šæœ‰ä¸€å®šæ³¢åŠ¨ä½†ä¸ä¼šå‡ºç°åå€šæˆ–é»‘æ´&lt;/p&gt;
&lt;p&gt;ç†µæ¥è‡ªäºæ¯æ¬¡ update çš„ä½ç½®å’Œæ¬¡åº, æ·¡åŒ–äº†æŸæ—¶åˆ» timestamp å’Œç®—åŠ›çš„å½±å“&lt;/p&gt;
&lt;p&gt;æ€æƒ³ç±»ä¼¼å·ç§¯, æŠŠè¿‡å»ä¸å½“å‰çŠ¶æ€æŒç»­å åŠ åˆ°å¯¹æœªæ¥çš„å½±å“ä¸­&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;ç°æœ‰ç¼ºé™·&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ— æ³•ä¿è¯ &lt;code&gt;æ’å®šçš„æ¦‚ç‡&lt;/code&gt; æˆ–è€…è¯´ &lt;code&gt;ç­‰æ¦‚ç‡éšæœº&lt;/code&gt;, ä½†å¯ä»¥è¿‘ä¼¼åšåˆ° &lt;code&gt;è‡ªç„¶éšæœº&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;array éœ€è¦é¢„çƒ­, é¢„çƒ­æ•ˆæœä¹Ÿä¼šå½±å“ä¸€å®šèŒƒå›´å†…çš„éšæœºæ•°è´¨é‡&lt;/li&gt;
&lt;li&gt;å°æ‰¹é‡éšæœºæ•ˆæœè´¼å·®&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;ä»£ç &#34;&gt;ä»£ç &lt;/h2&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; datetime &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; datetime&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;array = [i &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;random&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    time_str = &lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;(datetime.now().timestamp())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(time_str) == &lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;: index = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        index = &lt;span class=&#34;built_in&#34;&gt;int&lt;/span&gt;(time_str[-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# core: æ¯æ¬¡ random, ä½¿ index ä½åŠ ä¸Šä¸‹ä¸€ä½çš„æ•°å­—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    array[index] = (array[index] + array[(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; + index) % &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(array)]) % &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; array[index]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;measure&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;random_times&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    times = [&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; _ &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(random_times):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        num = random()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        times[num] += &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        random_times_div_10 = random_times // &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; i % random_times_div_10 == &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                times[i] = times[i] / random_times_div_10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(times)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            times = [&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; _ &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; __name__ == &lt;span class=&#34;string&#34;&gt;&amp;#x27;__main__&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# print(random())&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# æ•°é‡å¤ªå°, ç®—åŠ›å¤ªå¤§æŠŠéšæœºåº¦ç»™æ·¹äº†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;1K ä¸ªéšæœºæ•° 0-9 å¹³å‡æ¦‚ç‡:&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    measure(&lt;span class=&#34;number&#34;&gt;1_000&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;1M ä¸ªéšæœºæ•° 0-9 å¹³å‡æ¦‚ç‡:&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    measure(&lt;span class=&#34;number&#34;&gt;1_000_000&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;1K ä¸ªéšæœºæ•° 0-9 å¹³å‡æ¦‚ç‡:
[0.0, 0.0, 0.0, 0.01, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]
[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]

1M ä¸ªéšæœºæ•° 0-9 å¹³å‡æ¦‚ç‡:
[0.0, 0.0, 0.0, 1e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
[0.08707, 0.09659, 0.07117, 0.09658, 0.08152, 0.11249, 0.08783, 0.15348, 0.07114, 0.14213]
[0.07329, 0.09794, 0.08054, 0.11958, 0.08392, 0.09796, 0.07334, 0.10519, 0.08776, 0.18048]
[0.11594, 0.10057, 0.09201, 0.12211, 0.05934, 0.10781, 0.05929, 0.10423, 0.08083, 0.15787]
[0.11348, 0.09361, 0.09942, 0.09361, 0.08974, 0.11739, 0.1132, 0.09622, 0.08972, 0.09361]
[0.09697, 0.08811, 0.07557, 0.13141, 0.0873, 0.10951, 0.07558, 0.08811, 0.09013, 0.15731]
[0.09858, 0.07631, 0.11606, 0.07633, 0.13287, 0.07633, 0.09857, 0.09382, 0.1125, 0.11863]
[0.07433, 0.12053, 0.07844, 0.11426, 0.07381, 0.11784, 0.09136, 0.12198, 0.09004, 0.11741]
[0.07852, 0.09592, 0.11335, 0.12832, 0.0749, 0.09957, 0.07491, 0.12733, 0.07851, 0.12867]
[0.07114, 0.11785, 0.08166, 0.15484, 0.06758, 0.11358, 0.06757, 0.12409, 0.09167, 0.11002]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;ä½è¿ç®—æ•°å€¼åˆ†å¸ƒ&#34;&gt;ä½è¿ç®—æ•°å€¼åˆ†å¸ƒ&lt;/h2&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;XOR:&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    arr = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; j &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        arr.append(j ^ i)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(arr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;OR:&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    arr = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; j &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        arr.append(j | i)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(arr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# äº§ç”Ÿ &amp;#x27;7&amp;#x27; é»‘æ´ (array å†…éƒ½æ˜¯ 7)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 10M ä¸ªéšæœºæ•° 0-9 å¹³å‡æ¦‚ç‡:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.0, 0.0, 0.0, 0.0, 0.0, 1e-06, 0.0, 0.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.0, 1.6e-05, 0.0, 0.035234, 0.0, 6e-06, 0.0, 0.933694, 0.0, 0.03105]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;AND:&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    arr = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; j &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        arr.append(j &amp;amp; i)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(arr)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# äº§ç”Ÿ &amp;#x27;0&amp;#x27; é»‘æ´ (array å†…éƒ½æ˜¯ 0)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 10M ä¸ªéšæœºæ•° 0-9 å¹³å‡æ¦‚ç‡:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1e-06, 0.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [0.992248, 0.0, 0.002597, 0.0, 0.000949, 0.0, 0.001722, 0.0, 0.002484, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;XOR:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[1, 0, 3, 2, 5, 4, 7, 6, 9, 8]
[2, 3, 0, 1, 6, 7, 4, 5, 10, 11]
[3, 2, 1, 0, 7, 6, 5, 4, 11, 10]
[4, 5, 6, 7, 0, 1, 2, 3, 12, 13]
[5, 4, 7, 6, 1, 0, 3, 2, 13, 12]
[6, 7, 4, 5, 2, 3, 0, 1, 14, 15]
[7, 6, 5, 4, 3, 2, 1, 0, 15, 14]
[8, 9, 10, 11, 12, 13, 14, 15, 0, 1]
[9, 8, 11, 10, 13, 12, 15, 14, 1, 0]
OR:
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
[1, 1, 3, 3, 5, 5, 7, 7, 9, 9]
[2, 3, 2, 3, 6, 7, 6, 7, 10, 11]
[3, 3, 3, 3, 7, 7, 7, 7, 11, 11]
[4, 5, 6, 7, 4, 5, 6, 7, 12, 13]
[5, 5, 7, 7, 5, 5, 7, 7, 13, 13]
[6, 7, 6, 7, 6, 7, 6, 7, 14, 15]
[7, 7, 7, 7, 7, 7, 7, 7, 15, 15]
[8, 9, 10, 11, 12, 13, 14, 15, 8, 9]
[9, 9, 11, 11, 13, 13, 15, 15, 9, 9]
AND:
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
[0, 1, 0, 1, 0, 1, 0, 1, 0, 1]
[0, 0, 2, 2, 0, 0, 2, 2, 0, 0]
[0, 1, 2, 3, 0, 1, 2, 3, 0, 1]
[0, 0, 0, 0, 4, 4, 4, 4, 0, 0]
[0, 1, 0, 1, 4, 5, 4, 5, 0, 1]
[0, 0, 2, 2, 4, 4, 6, 6, 0, 0]
[0, 1, 2, 3, 4, 5, 6, 7, 0, 1]
[0, 0, 0, 0, 0, 0, 0, 0, 8, 8]
[0, 1, 0, 1, 0, 1, 0, 1, 8, 9]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;golang-éªŒè¯ç -éšæœºæ•°ç”Ÿæˆ&#34;&gt;golang-éªŒè¯ç -éšæœºæ•°ç”Ÿæˆ&lt;/h2&gt;
&lt;p&gt;æœ€å¥½ä¸è¦ç”¨ rand.intn(), ä½æ•°å¤ªå¤§æ—¶ä¼šæº¢å‡º, å¯ä»¥ç”¨é€’å½’æ¥ç”Ÿæˆæ— é™é•¿çš„éšæœºæ•° &lt;sup id=&#39;cite_ref-1&#39;&gt;&lt;a href=&#34;#cite_note-1&#34;&gt;[1]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight go&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;GetRandNum&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;(digit &lt;span class=&#34;type&#34;&gt;int&lt;/span&gt;)&lt;/span&gt;&lt;/span&gt; (res &lt;span class=&#34;type&#34;&gt;string&lt;/span&gt;) &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; digit &amp;lt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; digit &amp;lt; &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		&lt;span class=&#34;comment&#34;&gt;// int32 å°é¡¶ 2^9, 2^10 ä¼šæº¢å‡º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		num := rand.New(rand.NewSource(time.Now().UnixNano())).Int31n(&lt;span class=&#34;type&#34;&gt;int32&lt;/span&gt;(Pow10(digit)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		res = fmt.Sprintf(&lt;span class=&#34;string&#34;&gt;&amp;quot;%0&amp;quot;&lt;/span&gt;+strconv.Itoa(digit)+&lt;span class=&#34;string&#34;&gt;&amp;quot;v&amp;quot;&lt;/span&gt;, num)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		num := rand.New(rand.NewSource(time.Now().UnixNano())).Int31n(&lt;span class=&#34;type&#34;&gt;int32&lt;/span&gt;(Pow10(&lt;span class=&#34;number&#34;&gt;9&lt;/span&gt;)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;		res = fmt.Sprintf(&lt;span class=&#34;string&#34;&gt;&amp;quot;%09v&amp;quot;&lt;/span&gt;, num) + GetRandNum(digit&lt;span class=&#34;number&#34;&gt;-9&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;function&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;func&lt;/span&gt; &lt;span class=&#34;title&#34;&gt;GetVerifyCode&lt;/span&gt;&lt;span class=&#34;params&#34;&gt;()&lt;/span&gt;&lt;/span&gt; &lt;span class=&#34;type&#34;&gt;string&lt;/span&gt; &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;	&lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; GetRandNum(&lt;span class=&#34;number&#34;&gt;6&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;å€Ÿç‰©è¡¨&#34;&gt;å€Ÿç‰©è¡¨&lt;/h2&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-1&#39; href=&#39;#cite_ref-1&#39;&gt;[1]&lt;/a&gt;: &lt;a href=&#34;https://github.com/Weidows/Golang/blob/master/utils/rand.go&#34;&gt;Golang/rand.go at master Â· Weidows/Golang&lt;/a&gt;&lt;/p&gt;
&lt;script type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/kity@2.0.4/dist/kity.min.js&#34;&gt;&lt;/script&gt;&lt;script type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js&#34;&gt;&lt;/script&gt;&lt;script defer=&#34;true&#34; type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js&#34;&gt;&lt;/script&gt;&lt;link rel=&#34;stylesheet&#34; type=&#34;text&amp;#x2F;css&#34; href=&#34;https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css&#34;&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://weidows.github.io/post/lang/python/code/MM-Detection/</guid>
            <title>ğŸ³MM-Detection-Colab</title>
            <link>https://weidows.github.io/post/lang/python/code/MM-Detection/</link>
            <category>æ·±åº¦å­¦ä¹ </category>
            <category>MMDetection</category>
            <category>Colab</category>
            <pubDate>Tue, 07 Jun 2022 09:06:50 +0000</pubDate>
            <description><![CDATA[ &lt;!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @LastEditors: Weidows
 * @LastEditTime: 2023-04-20 18:34:42
 * @FilePath: \Blog-private\source\_posts\python\code\MM-Detection.md
 * @Description:
 * @!: *********************************************************************
--&gt;
&lt;h2 id=&#34;åº&#34;&gt;åº&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Colab å¹³å°å¯¹äº &lt;code&gt;è½»é‡çº§/è¾¹ç¼˜è®¡ç®—&lt;/code&gt; æ¯”è¾ƒæ–¹ä¾¿, å°¤å…¶æ˜¯å¯¹è¿™ç§æ•™ç¨‹æ€§è´¨çš„ notebook, åˆ†äº«å’Œè¿è¡Œéƒ½å¼€ç®±å³ç”¨&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ä½†å¦ä¸€æ–¹é¢:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;å› &lt;/code&gt;: å…è´¹ç‰ˆçš„ Colab æ‰€ç»™çš„ç¡¬ä»¶èµ„æºä¸æ˜¯å¾ˆç¨³å®š, ç”¨å¤ªä¹…çš„è¯ä¼šåˆ†ä¸åˆ° GPU, è™½ç„¶ç»™çš„ GPU è‚¯å®šæ˜¯æ¯”è‡ªå·±çš„å¼€å‘æœºå¼ºå¾ˆå¤š, ä½†æ˜¯è·‘å¤§å‹é¡¹ç›®è‚¯å®šå¸¦ä¸åŠ¨ (è€Œä¸” Colab å•æ¬¡è¿è¡Œæœ€å¤šæŒç»­ 6h, ä¸€æ®µæ—¶é—´æ²¡åŠ¨ä½œçš„è¯ä¼šæ–­è¿, æ–­å¼€åå†è¿‡ä¸€é˜µ runtime ä¼šè¢«é‡ç½®)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;æœ&lt;/code&gt;: å¯ä»¥ç”¨å®ƒæ¥å­¦ä¹ ä¸‹æ€ä¹ˆæ­ç¯å¢ƒä»¥åŠä¸€äº›å°æµ‹è¯•&lt;/p&gt;
&lt;p&gt;æ¯•ç«Ÿç”Ÿäº§æœåŠ¡å™¨ç”³è¯·ä¸æ˜“ / ç¯å¢ƒä¹Ÿä¸èƒ½ä¹±åŠ¨&lt;/p&gt;
&lt;p&gt;å—ç³»ç»Ÿå’Œç½‘ç»œé™åˆ¶, åœ¨å¼€å‘æœºæ­ç¯å¢ƒå¹¶ä¸ç†æƒ³&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;è£…ç¯å¢ƒ&#34;&gt;è£…ç¯å¢ƒ&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;ä»å®‰è£…åˆ°æ”¾å¼ƒåˆ°çˆ¬å‡ºå‘ :( &lt;br&gt;
è·Ÿç€è¿™å‡ ç¯‡è£…çš„ç¯å¢ƒ:&lt;sup id=&#39;cite_ref-2&#39;&gt;&lt;a href=&#34;#cite_note-2&#34;&gt;[2]&lt;/a&gt;&lt;/sup&gt;&lt;sup id=&#39;cite_ref-3&#39;&gt;&lt;a href=&#34;#cite_note-3&#34;&gt;[3]&lt;/a&gt;&lt;/sup&gt;, æœ‰å€Ÿé‰´æ„ä¹‰ä½†æ˜¯æŒ‡å¯¼ä¸æ˜ç¡® &lt;br&gt;
ä¸ªäººå…ˆè·Ÿç€å®˜æ–¹å‡ºçš„è§†é¢‘æ•™ç¨‹å’Œ openbayes ä¸Šçš„ notebook è¯•äº†è¯•æ°´, å¾ˆæ·± &lt;sup id=&#39;cite_ref-1&#39;&gt;&lt;a href=&#34;#cite_note-1&#34;&gt;[1]&lt;/a&gt;&lt;/sup&gt;; æœ€åæ‰¾åˆ°ä¸€ä¸ªæºåº“ tutorial-fork çš„ colab-notebook &lt;sup id=&#39;cite_ref-4&#39;&gt;&lt;a href=&#34;#cite_note-4&#34;&gt;[4]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;é¢„å…ˆè£…ä¸Š cuda, cudnn (colabè‡ªå¸¦)&lt;/p&gt;
&lt;p&gt;ä¾èµ–é“¾: &lt;code&gt;cuda &amp;lt;- pytorch &amp;lt;- mmcv-full &amp;lt;- mmdet&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;æ¯ä¸€æ­¥ä¾èµ–å‰é¢ç¯å¢ƒçš„ç‰ˆæœ¬, å³ä½¿åé¢èƒ½è£…ä¸Šä¹Ÿå¯èƒ½ä¸é€‚é…, ä»»ä½•ä¸€æ­¥æœ‰é—®é¢˜éƒ½ &lt;code&gt;can&#39;t run&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/blog/ZtZpOm.png&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ====================å¯é€‰, colabå¹¶ä¸è‡ªå¸¦conda=====================&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!conda create -n openmmlab -y&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!conda activate openmmlab&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!conda init&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;/bin/bash: conda: command not found
/bin/bash: conda: command not found
/bin/bash: conda: command not found
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ================== ä¸€é”®è£…å¥½ç¯å¢ƒ =======================&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å¦‚æœè¿™é‡Œæœ‰é—®é¢˜å¯ä»¥é‡å¯ä¸€ä¸‹å†…æ ¸: ä»£ç æ‰§è¡Œç¨‹åº -&amp;gt; é‡æ–°å¯åŠ¨ä»£ç æ‰§è¡Œç¨‹åº&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!python -m pip install --upgrade pip&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ³¨æ„å¯¹åº”æœºå­é…ç½®: https://pytorch.org/&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# install dependencies: (use cu111 because colab has CUDA 11.1)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%pip install torch==&lt;span class=&#34;number&#34;&gt;1.9&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;+cu111 torchvision==&lt;span class=&#34;number&#34;&gt;0.10&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;+cu111 -f https://download.pytorch.org/whl/torch_stable.html&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# windows å¹³å°ä¸ç”¨è£…äº†, ä¸€å®šä¼šå¡åœ¨è¿™&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# https://github.com/open-mmlab/mmcv/blob/master/README_zh-CN.md&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%pip install mmcv-full -f https://download.openmmlab.com/mmcv/dist/cu111/torch1&lt;span class=&#34;number&#34;&gt;.9&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;/index.html&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ä¸pip/condaåŒçº§çš„ä¸“é—¨ç»™mm-labç”¨çš„åŒ…ç®¡ç†å™¨, æŠ¥é”™ç‡å¾ˆé«˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%pip install openmim&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ä¾èµ– mmcv, å¦‚æœç”¨mimè£…çš„è¯å¤§æ¦‚ç‡æœ‰é—®é¢˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åé¢è¦ç”¨åˆ°æºç åº“çš„ config, å¯é€‰ç”¨æºåº“å®‰è£…&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%pip install mmdet mmsegmentation&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Requirement already satisfied: pip in /usr/local/lib/python3.7/dist-packages (21.1.3)
Collecting pip
  Downloading pip-22.1.2-py3-none-any.whl (2.1 MB)
[K     |â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 2.1 MB 37.1 MB/s
[?25hInstalling collected packages: pip
  Attempting uninstall: pip
    Found existing installation: pip 21.1.3
    Uninstalling pip-21.1.3:
      Successfully uninstalled pip-21.1.3
Successfully installed pip-22.1.2
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Looking in links: https://download.pytorch.org/whl/torch_stable.html
Collecting torch==1.9.0+cu111
  Downloading https://download.pytorch.org/whl/cu111/torch-1.9.0%2Bcu111-cp37-cp37m-linux_x86_64.whl (2041.3 MB)
[2K     [91mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[91mâ•¸[0m [32m2.0/2.0 GB[0m [31m83.9 MB/s[0m eta [36m0:00:01[0mtcmalloc: large alloc 2041348096 bytes == 0x25c6000 @  0x7fb296fd21e7 0x4a3940 0x4a39cc 0x592b76 0x4df71e 0x59afff 0x515655 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x593dd7 0x511e2c 0x549576 0x593fce 0x548ae9 0x5127f1 0x549576 0x593fce 0x511e2c
[2K     [91mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m[91mâ•¸[0m [32m2.0/2.0 GB[0m [31m82.2 MB/s[0m eta [36m0:00:01[0mtcmalloc: large alloc 2551685120 bytes == 0x7c08e000 @  0x7fb296fd3615 0x592b76 0x4df71e 0x59afff 0x515655 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x593dd7 0x511e2c 0x549576 0x593fce 0x548ae9 0x5127f1 0x549576 0x593fce 0x511e2c 0x549576 0x593fce
tcmalloc: large alloc 2041348096 bytes == 0x25c6000 @  0x7fb296fd21e7 0x4a3940 0x5b438c 0x5b46f7 0x59afff 0x515655 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x4bcb19 0x59c019 0x595ef6 0x5fbece 0x594b72 0x548cc1 0x51566f 0x593dd7 0x548ae9 0x51566f 0x549576 0x593fce 0x548ae9 0x51566f 0x549576 0x593fce 0x548ae9 0x5127f1
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m2.0/2.0 GB[0m [31m836.7 kB/s[0m eta [36m0:00:00[0m
[?25hCollecting torchvision==0.10.0+cu111
  Downloading https://download.pytorch.org/whl/cu111/torchvision-0.10.0%2Bcu111-cp37-cp37m-linux_x86_64.whl (23.2 MB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m23.2/23.2 MB[0m [31m19.8 MB/s[0m eta [36m0:00:00[0m
[?25hRequirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch==1.9.0+cu111) (4.1.1)
Requirement already satisfied: pillow&amp;gt;=5.3.0 in /usr/local/lib/python3.7/dist-packages (from torchvision==0.10.0+cu111) (7.1.2)
Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from torchvision==0.10.0+cu111) (1.21.6)
Installing collected packages: torch, torchvision
  Attempting uninstall: torch
    Found existing installation: torch 1.11.0+cu113
    Uninstalling torch-1.11.0+cu113:
      Successfully uninstalled torch-1.11.0+cu113
  Attempting uninstall: torchvision
    Found existing installation: torchvision 0.12.0+cu113
    Uninstalling torchvision-0.12.0+cu113:
      Successfully uninstalled torchvision-0.12.0+cu113
[31mERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
torchtext 0.12.0 requires torch==1.11.0, but you have torch 1.9.0+cu111 which is incompatible.
torchaudio 0.11.0+cu113 requires torch==1.11.0, but you have torch 1.9.0+cu111 which is incompatible.[0m[31m
[0mSuccessfully installed torch-1.9.0+cu111 torchvision-0.10.0+cu111
[33mWARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m[33m
[0mLooking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Looking in links: https://download.openmmlab.com/mmcv/dist/cu111/torch1.9.0/index.html
Collecting mmcv-full
  Downloading https://download.openmmlab.com/mmcv/dist/cu111/torch1.9.0/mmcv_full-1.5.3-cp37-cp37m-manylinux1_x86_64.whl (46.3 MB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m46.3/46.3 MB[0m [31m8.1 MB/s[0m eta [36m0:00:00[0m
[?25hCollecting addict
  Downloading addict-2.4.0-py3-none-any.whl (3.8 kB)
Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (1.21.6)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (3.13)
Requirement already satisfied: opencv-python&amp;gt;=3 in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (4.1.2.30)
Collecting yapf
  Downloading yapf-0.32.0-py2.py3-none-any.whl (190 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m190.2/190.2 kB[0m [31m20.0 MB/s[0m eta [36m0:00:00[0m
[?25hRequirement already satisfied: Pillow in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (7.1.2)
Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (21.3)
Requirement already satisfied: pyparsing!=3.0.5,&amp;gt;=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging-&amp;gt;mmcv-full) (3.0.9)
Installing collected packages: yapf, addict, mmcv-full
Successfully installed addict-2.4.0 mmcv-full-1.5.3 yapf-0.32.0
[33mWARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m[33m
[0mLooking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting openmim
  Downloading openmim-0.1.6.tar.gz (37 kB)
  Preparing metadata (setup.py) ... [?25l[?25hdone
Requirement already satisfied: Click==7.1.2 in /usr/local/lib/python3.7/dist-packages (from openmim) (7.1.2)
Collecting colorama
  Downloading colorama-0.4.5-py2.py3-none-any.whl (16 kB)
Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from openmim) (2.23.0)
Collecting model-index
  Downloading model_index-0.1.11-py3-none-any.whl (34 kB)
Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from openmim) (1.3.5)
Requirement already satisfied: tabulate in /usr/local/lib/python3.7/dist-packages (from openmim) (0.8.9)
Requirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from model-index-&amp;gt;openmim) (3.13)
Requirement already satisfied: markdown in /usr/local/lib/python3.7/dist-packages (from model-index-&amp;gt;openmim) (3.3.7)
Collecting ordered-set
  Downloading ordered_set-4.1.0-py3-none-any.whl (7.6 kB)
Requirement already satisfied: numpy&amp;gt;=1.17.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&amp;gt;openmim) (1.21.6)
Requirement already satisfied: python-dateutil&amp;gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&amp;gt;openmim) (2.8.2)
Requirement already satisfied: pytz&amp;gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&amp;gt;openmim) (2022.1)
Requirement already satisfied: certifi&amp;gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests-&amp;gt;openmim) (2022.6.15)
Requirement already satisfied: chardet&amp;lt;4,&amp;gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests-&amp;gt;openmim) (3.0.4)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&amp;lt;1.26,&amp;gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests-&amp;gt;openmim) (1.24.3)
Requirement already satisfied: idna&amp;lt;3,&amp;gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests-&amp;gt;openmim) (2.10)
Requirement already satisfied: six&amp;gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&amp;gt;=2.7.3-&amp;gt;pandas-&amp;gt;openmim) (1.15.0)
Requirement already satisfied: importlib-metadata&amp;gt;=4.4 in /usr/local/lib/python3.7/dist-packages (from markdown-&amp;gt;model-index-&amp;gt;openmim) (4.11.4)
Requirement already satisfied: typing-extensions&amp;gt;=3.6.4 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata&amp;gt;=4.4-&amp;gt;markdown-&amp;gt;model-index-&amp;gt;openmim) (4.1.1)
Requirement already satisfied: zipp&amp;gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata&amp;gt;=4.4-&amp;gt;markdown-&amp;gt;model-index-&amp;gt;openmim) (3.8.0)
Building wheels for collected packages: openmim
  Building wheel for openmim (setup.py) ... [?25l[?25hdone
  Created wheel for openmim: filename=openmim-0.1.6-py2.py3-none-any.whl size=43919 sha256=4da5d601b4527ed104f9f6821d3c8d898197648313abcbb891328d3a1a7d1baf
  Stored in directory: /root/.cache/pip/wheels/a8/33/de/415150be8f048d1bcfd72c6a452978e71e229ee0769f1752f8
Successfully built openmim
Installing collected packages: ordered-set, colorama, model-index, openmim
Successfully installed colorama-0.4.5 model-index-0.1.11 openmim-0.1.6 ordered-set-4.1.0
[33mWARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m[33m
[0mLooking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Collecting mmdet
  Downloading mmdet-2.25.0-py3-none-any.whl (1.4 MB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m1.4/1.4 MB[0m [31m60.2 MB/s[0m eta [36m0:00:00[0m
[?25hCollecting mmsegmentation
  Downloading mmsegmentation-0.25.0-py3-none-any.whl (804 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m805.0/805.0 kB[0m [31m62.9 MB/s[0m eta [36m0:00:00[0m
[?25hRequirement already satisfied: pycocotools in /usr/local/lib/python3.7/dist-packages (from mmdet) (2.0.4)
Collecting terminaltables
  Downloading terminaltables-3.1.10-py2.py3-none-any.whl (15 kB)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from mmdet) (3.2.2)
Requirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from mmdet) (1.21.6)
Requirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from mmdet) (1.15.0)
Collecting mmcls&amp;gt;=0.20.1
  Downloading mmcls-0.23.1-py2.py3-none-any.whl (577 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m577.3/577.3 kB[0m [31m54.3 MB/s[0m eta [36m0:00:00[0m
[?25hRequirement already satisfied: prettytable in /usr/local/lib/python3.7/dist-packages (from mmsegmentation) (3.3.0)
Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from mmsegmentation) (21.3)
Requirement already satisfied: cycler&amp;gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&amp;gt;mmdet) (0.11.0)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&amp;gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&amp;gt;mmdet) (3.0.9)
Requirement already satisfied: python-dateutil&amp;gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&amp;gt;mmdet) (2.8.2)
Requirement already satisfied: kiwisolver&amp;gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&amp;gt;mmdet) (1.4.3)
Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from prettytable-&amp;gt;mmsegmentation) (4.11.4)
Requirement already satisfied: wcwidth in /usr/local/lib/python3.7/dist-packages (from prettytable-&amp;gt;mmsegmentation) (0.2.5)
Requirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver&amp;gt;=1.0.1-&amp;gt;matplotlib-&amp;gt;mmdet) (4.1.1)
Requirement already satisfied: zipp&amp;gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata-&amp;gt;prettytable-&amp;gt;mmsegmentation) (3.8.0)
Installing collected packages: terminaltables, mmcls, mmsegmentation, mmdet
Successfully installed mmcls-0.23.1 mmdet-2.25.0 mmsegmentation-0.25.0 terminaltables-3.1.10
[33mWARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m[33m
[0m
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# éªŒè¯å®‰è£…&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!nvcc -V&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!pip &lt;span class=&#34;built_in&#34;&gt;list&lt;/span&gt; | grep mm&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmcv &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; collect_env&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;collect_env()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2020 NVIDIA Corporation
Built on Mon_Oct_12_20:09:46_PDT_2020
Cuda compilation tools, release 11.1, V11.1.105
Build cuda_11.1.TC455_06.29190527_0
community                     1.0.0b1
googleapis-common-protos      1.56.2
mmcls                         0.23.1
mmcv-full                     1.5.2
mmdet                         2.25.0
mmsegmentation                0.25.0
pyviz-comms                   2.2.0
snowballstemmer               2.2.0
torchsummary                  1.5.1





&amp;#123;&#39;CUDA available&#39;: True,
 &#39;CUDA_HOME&#39;: &#39;/usr/local/cuda&#39;,
 &#39;GCC&#39;: &#39;x86_64-linux-gnu-gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0&#39;,
 &#39;GPU 0&#39;: &#39;Tesla T4&#39;,
 &#39;MMCV&#39;: &#39;1.5.2&#39;,
 &#39;MMCV CUDA Compiler&#39;: &#39;11.1&#39;,
 &#39;MMCV Compiler&#39;: &#39;GCC 7.3&#39;,
 &#39;NVCC&#39;: &#39;Cuda compilation tools, release 11.1, V11.1.105&#39;,
 &#39;OpenCV&#39;: &#39;4.1.2&#39;,
 &#39;PyTorch&#39;: &#39;1.9.0+cu111&#39;,
 &#39;PyTorch compiling details&#39;: &#39;PyTorch built with:\n  - GCC 7.3\n  - C++ Version: 201402\n  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications\n  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)\n  - OpenMP 201511 (a.k.a. OpenMP 4.5)\n  - NNPACK is enabled\n  - CPU capability usage: AVX2\n  - CUDA Runtime 11.1\n  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86\n  - CuDNN 8.0.5\n  - Magma 2.5.2\n  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, \n&#39;,
 &#39;Python&#39;: &#39;3.7.13 (default, Apr 24 2022, 01:04:09) [GCC 7.5.0]&#39;,
 &#39;TorchVision&#39;: &#39;0.10.0+cu111&#39;,
 &#39;sys.platform&#39;: &#39;linux&#39;&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;Clone-repo&#34;&gt;Clone-repo&lt;/h3&gt;
&lt;p&gt;clone é¡¹ç›®æºç åº“ä¸‹æ¥, åé¢çš„ &lt;code&gt;éªŒè¯/è®­ç»ƒ&lt;/code&gt; è¦ç”¨åˆ°æºç åº“çš„é…ç½®å’Œå·¥å…·ç­‰ (ç”¨åˆ°å“ªä¸ªåº“ Clone å“ªä¸ªå°±è¡Œ, å½“ç„¶å…¨ clone ä¹Ÿæ²¡é—®é¢˜)&lt;/p&gt;
&lt;p&gt;æ³¨æ„åé¢è¿è¡Œå‰åˆ‡ä¸€ä¸‹è·¯å¾„&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# !rm -rf /content/mmdetection&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%cd /content&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!git clone https://github.com/&lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;-mmlab/mmdetection.git&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%cd mmdetection&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# %pip install -e .&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åç»­ pwd = /content/mmdetection&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;/content
Cloning into &#39;mmdetection&#39;...
remote: Enumerating objects: 24969, done.[K
remote: Counting objects: 100% (10/10), done.[K
remote: Compressing objects: 100% (9/9), done.[K
remote: Total 24969 (delta 3), reused 6 (delta 1), pack-reused 24959[K
Receiving objects: 100% (24969/24969), 37.76 MiB | 11.27 MiB/s, done.
Resolving deltas: 100% (17495/17495), done.
/content/mmdetection
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# !rm -rf /content/mmdetection3d&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%cd /content&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!git clone https://github.com/&lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;-mmlab/mmdetection3d.git&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%cd mmdetection3d&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# mmdetection3d æœ‰ä¸€äº›é¢å¤–çš„ä¾èµ–éœ€è¦å®‰è£…&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%pip install -e .&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# --show ç”¨åˆ°open3Dæ¥å±•ç¤º, ä½†åªèƒ½åœ¨æœ¬æœºcreateçª—å£, colab ä¸Šä¼šæŠ¥é”™&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# %pip install open3d&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åç»­ pwd = /content/mmdetection3d&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;/content
Cloning into &#39;mmdetection3d&#39;...
remote: Enumerating objects: 13252, done.[K
remote: Counting objects: 100% (148/148), done.[K
remote: Compressing objects: 100% (116/116), done.[K
remote: Total 13252 (delta 44), reused 102 (delta 32), pack-reused 13104[K
Receiving objects: 100% (13252/13252), 15.96 MiB | 14.34 MiB/s, done.
Resolving deltas: 100% (9134/9134), done.
/content/mmdetection3d
Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/
Obtaining file:///content/mmdetection3d
  Preparing metadata (setup.py) ... [?25l[?25hdone
Collecting lyft_dataset_sdk
  Downloading lyft_dataset_sdk-0.0.8-py2.py3-none-any.whl (32 kB)
Collecting networkx&amp;lt;2.3,&amp;gt;=2.2
  Downloading networkx-2.2.zip (1.7 MB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m1.7/1.7 MB[0m [31m68.0 MB/s[0m eta [36m0:00:00[0m
[?25h  Preparing metadata (setup.py) ... [?25l[?25hdone
Collecting numba==0.53.0
  Downloading numba-0.53.0-cp37-cp37m-manylinux2014_x86_64.whl (3.4 MB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m3.4/3.4 MB[0m [31m83.6 MB/s[0m eta [36m0:00:00[0m
[?25hRequirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from mmdet3d==1.0.0rc3) (1.21.6)
Collecting nuscenes-devkit
  Downloading nuscenes_devkit-1.1.9-py3-none-any.whl (312 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m312.6/312.6 kB[0m [31m35.9 MB/s[0m eta [36m0:00:00[0m
[?25hCollecting plyfile
  Downloading plyfile-0.7.4-py3-none-any.whl (39 kB)
Requirement already satisfied: scikit-image in /usr/local/lib/python3.7/dist-packages (from mmdet3d==1.0.0rc3) (0.18.3)
Requirement already satisfied: tensorboard in /usr/local/lib/python3.7/dist-packages (from mmdet3d==1.0.0rc3) (2.8.0)
Collecting trimesh&amp;lt;2.35.40,&amp;gt;=2.35.39
  Downloading trimesh-2.35.39.tar.gz (281 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m282.0/282.0 kB[0m [31m35.0 MB/s[0m eta [36m0:00:00[0m
[?25h  Preparing metadata (setup.py) ... [?25l[?25hdone
Collecting llvmlite&amp;lt;0.37,&amp;gt;=0.36.0rc1
  Downloading llvmlite-0.36.0-cp37-cp37m-manylinux2010_x86_64.whl (25.3 MB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m25.3/25.3 MB[0m [31m60.6 MB/s[0m eta [36m0:00:00[0m
[?25hRequirement already satisfied: setuptools in /usr/local/lib/python3.7/dist-packages (from numba==0.53.0-&amp;gt;mmdet3d==1.0.0rc3) (57.4.0)
Requirement already satisfied: decorator&amp;gt;=4.3.0 in /usr/local/lib/python3.7/dist-packages (from networkx&amp;lt;2.3,&amp;gt;=2.2-&amp;gt;mmdet3d==1.0.0rc3) (4.4.2)
Requirement already satisfied: scipy in /usr/local/lib/python3.7/dist-packages (from trimesh&amp;lt;2.35.40,&amp;gt;=2.35.39-&amp;gt;mmdet3d==1.0.0rc3) (1.4.1)
Requirement already satisfied: scikit-learn&amp;gt;=0.19.2 in /usr/local/lib/python3.7/dist-packages (from lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (1.0.2)
Collecting pyquaternion&amp;gt;=0.9.5
  Downloading pyquaternion-0.9.9-py3-none-any.whl (14 kB)
Requirement already satisfied: opencv-python&amp;gt;=3.4.2.17 in /usr/local/lib/python3.7/dist-packages (from lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (4.1.2.30)
Requirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (1.3.5)
Collecting flake8
  Downloading flake8-4.0.1-py2.py3-none-any.whl (64 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m64.1/64.1 kB[0m [31m9.5 MB/s[0m eta [36m0:00:00[0m
[?25hRequirement already satisfied: tqdm&amp;gt;=4.25.0 in /usr/local/lib/python3.7/dist-packages (from lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (4.64.0)
Requirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (3.2.2)
Requirement already satisfied: Pillow&amp;gt;=5.2.0 in /usr/local/lib/python3.7/dist-packages (from lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (7.1.2)
Collecting black
  Downloading black-22.3.0-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.4 MB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m1.4/1.4 MB[0m [31m71.8 MB/s[0m eta [36m0:00:00[0m
[?25hCollecting fire
  Downloading fire-0.4.0.tar.gz (87 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m87.7/87.7 kB[0m [31m10.6 MB/s[0m eta [36m0:00:00[0m
[?25h  Preparing metadata (setup.py) ... [?25l[?25hdone
Requirement already satisfied: Shapely&amp;gt;=1.6.4.post2 in /usr/local/lib/python3.7/dist-packages (from lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (1.8.2)
Requirement already satisfied: plotly in /usr/local/lib/python3.7/dist-packages (from lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (5.5.0)
Requirement already satisfied: pytest in /usr/local/lib/python3.7/dist-packages (from lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (3.6.4)
Requirement already satisfied: cachetools&amp;gt;=3.1.0 in /usr/local/lib/python3.7/dist-packages (from lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (4.2.4)
Requirement already satisfied: pycocotools&amp;gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (2.0.4)
Requirement already satisfied: jupyter in /usr/local/lib/python3.7/dist-packages (from nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (1.0.0)
Requirement already satisfied: descartes in /usr/local/lib/python3.7/dist-packages (from nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (1.1.0)
Requirement already satisfied: imageio&amp;gt;=2.3.0 in /usr/local/lib/python3.7/dist-packages (from scikit-image-&amp;gt;mmdet3d==1.0.0rc3) (2.4.1)
Requirement already satisfied: tifffile&amp;gt;=2019.7.26 in /usr/local/lib/python3.7/dist-packages (from scikit-image-&amp;gt;mmdet3d==1.0.0rc3) (2021.11.2)
Requirement already satisfied: PyWavelets&amp;gt;=1.1.1 in /usr/local/lib/python3.7/dist-packages (from scikit-image-&amp;gt;mmdet3d==1.0.0rc3) (1.3.0)
Requirement already satisfied: google-auth-oauthlib&amp;lt;0.5,&amp;gt;=0.4.1 in /usr/local/lib/python3.7/dist-packages (from tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (0.4.6)
Requirement already satisfied: grpcio&amp;gt;=1.24.3 in /usr/local/lib/python3.7/dist-packages (from tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (1.46.3)
Requirement already satisfied: wheel&amp;gt;=0.26 in /usr/local/lib/python3.7/dist-packages (from tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (0.37.1)
Requirement already satisfied: tensorboard-data-server&amp;lt;0.7.0,&amp;gt;=0.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (0.6.1)
Requirement already satisfied: absl-py&amp;gt;=0.4 in /usr/local/lib/python3.7/dist-packages (from tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (1.1.0)
Requirement already satisfied: markdown&amp;gt;=2.6.8 in /usr/local/lib/python3.7/dist-packages (from tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (3.3.7)
Requirement already satisfied: protobuf&amp;gt;=3.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (3.17.3)
Requirement already satisfied: tensorboard-plugin-wit&amp;gt;=1.6.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (1.8.1)
Requirement already satisfied: werkzeug&amp;gt;=0.11.15 in /usr/local/lib/python3.7/dist-packages (from tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (1.0.1)
Requirement already satisfied: requests&amp;lt;3,&amp;gt;=2.21.0 in /usr/local/lib/python3.7/dist-packages (from tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (2.23.0)
Requirement already satisfied: google-auth&amp;lt;3,&amp;gt;=1.6.3 in /usr/local/lib/python3.7/dist-packages (from tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (1.35.0)
Requirement already satisfied: six&amp;gt;=1.9.0 in /usr/local/lib/python3.7/dist-packages (from google-auth&amp;lt;3,&amp;gt;=1.6.3-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (1.15.0)
Requirement already satisfied: pyasn1-modules&amp;gt;=0.2.1 in /usr/local/lib/python3.7/dist-packages (from google-auth&amp;lt;3,&amp;gt;=1.6.3-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (0.2.8)
Requirement already satisfied: rsa&amp;lt;5,&amp;gt;=3.1.4 in /usr/local/lib/python3.7/dist-packages (from google-auth&amp;lt;3,&amp;gt;=1.6.3-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (4.8)
Requirement already satisfied: requests-oauthlib&amp;gt;=0.7.0 in /usr/local/lib/python3.7/dist-packages (from google-auth-oauthlib&amp;lt;0.5,&amp;gt;=0.4.1-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (1.3.1)
Requirement already satisfied: importlib-metadata&amp;gt;=4.4 in /usr/local/lib/python3.7/dist-packages (from markdown&amp;gt;=2.6.8-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (4.11.4)
Requirement already satisfied: python-dateutil&amp;gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (2.8.2)
Requirement already satisfied: kiwisolver&amp;gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (1.4.3)
Requirement already satisfied: cycler&amp;gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (0.11.0)
Requirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&amp;gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (3.0.9)
Requirement already satisfied: certifi&amp;gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests&amp;lt;3,&amp;gt;=2.21.0-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (2022.6.15)
Requirement already satisfied: idna&amp;lt;3,&amp;gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests&amp;lt;3,&amp;gt;=2.21.0-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (2.10)
Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,&amp;lt;1.26,&amp;gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests&amp;lt;3,&amp;gt;=2.21.0-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (1.24.3)
Requirement already satisfied: chardet&amp;lt;4,&amp;gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests&amp;lt;3,&amp;gt;=2.21.0-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (3.0.4)
Requirement already satisfied: threadpoolctl&amp;gt;=2.0.0 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&amp;gt;=0.19.2-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (3.1.0)
Requirement already satisfied: joblib&amp;gt;=0.11 in /usr/local/lib/python3.7/dist-packages (from scikit-learn&amp;gt;=0.19.2-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (1.1.0)
Collecting click&amp;gt;=8.0.0
  Downloading click-8.1.3-py3-none-any.whl (96 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m96.6/96.6 kB[0m [31m14.1 MB/s[0m eta [36m0:00:00[0m
[?25hCollecting mypy-extensions&amp;gt;=0.4.3
  Downloading mypy_extensions-0.4.3-py2.py3-none-any.whl (4.5 kB)
Requirement already satisfied: typing-extensions&amp;gt;=3.10.0.0 in /usr/local/lib/python3.7/dist-packages (from black-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (4.1.1)
Collecting pathspec&amp;gt;=0.9.0
  Downloading pathspec-0.9.0-py2.py3-none-any.whl (31 kB)
Collecting platformdirs&amp;gt;=2
  Downloading platformdirs-2.5.2-py3-none-any.whl (14 kB)
Collecting typed-ast&amp;gt;=1.4.2
  Downloading typed_ast-1.5.4-cp37-cp37m-manylinux_2_5_x86_64.manylinux1_x86_64.manylinux_2_12_x86_64.manylinux2010_x86_64.whl (843 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m843.7/843.7 kB[0m [31m59.7 MB/s[0m eta [36m0:00:00[0m
[?25hRequirement already satisfied: tomli&amp;gt;=1.1.0 in /usr/local/lib/python3.7/dist-packages (from black-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (2.0.1)
Requirement already satisfied: termcolor in /usr/local/lib/python3.7/dist-packages (from fire-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (1.1.0)
Collecting pyflakes&amp;lt;2.5.0,&amp;gt;=2.4.0
  Downloading pyflakes-2.4.0-py2.py3-none-any.whl (69 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m69.7/69.7 kB[0m [31m10.2 MB/s[0m eta [36m0:00:00[0m
[?25hCollecting pycodestyle&amp;lt;2.9.0,&amp;gt;=2.8.0
  Downloading pycodestyle-2.8.0-py2.py3-none-any.whl (42 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m42.1/42.1 kB[0m [31m5.2 MB/s[0m eta [36m0:00:00[0m
[?25hCollecting flake8
  Downloading flake8-4.0.0-py2.py3-none-any.whl (64 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m64.1/64.1 kB[0m [31m8.3 MB/s[0m eta [36m0:00:00[0m
[?25h  Downloading flake8-3.9.2-py2.py3-none-any.whl (73 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m73.1/73.1 kB[0m [31m10.1 MB/s[0m eta [36m0:00:00[0m
[?25hCollecting pyflakes&amp;lt;2.4.0,&amp;gt;=2.3.0
  Downloading pyflakes-2.3.1-py2.py3-none-any.whl (68 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m68.8/68.8 kB[0m [31m10.1 MB/s[0m eta [36m0:00:00[0m
[?25hCollecting pycodestyle&amp;lt;2.8.0,&amp;gt;=2.7.0
  Downloading pycodestyle-2.7.0-py2.py3-none-any.whl (41 kB)
[2K     [90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”[0m [32m41.7/41.7 kB[0m [31m5.9 MB/s[0m eta [36m0:00:00[0m
[?25hCollecting mccabe&amp;lt;0.7.0,&amp;gt;=0.6.0
  Downloading mccabe-0.6.1-py2.py3-none-any.whl (8.6 kB)
Requirement already satisfied: nbconvert in /usr/local/lib/python3.7/dist-packages (from jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (5.6.1)
Requirement already satisfied: qtconsole in /usr/local/lib/python3.7/dist-packages (from jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (5.3.1)
Requirement already satisfied: jupyter-console in /usr/local/lib/python3.7/dist-packages (from jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (5.2.0)
Requirement already satisfied: ipywidgets in /usr/local/lib/python3.7/dist-packages (from jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (7.7.0)
Requirement already satisfied: ipykernel in /usr/local/lib/python3.7/dist-packages (from jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (4.10.1)
Requirement already satisfied: notebook in /usr/local/lib/python3.7/dist-packages (from jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (5.3.1)
Requirement already satisfied: pytz&amp;gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (2022.1)
Requirement already satisfied: tenacity&amp;gt;=6.2.0 in /usr/local/lib/python3.7/dist-packages (from plotly-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (8.0.1)
Requirement already satisfied: attrs&amp;gt;=17.4.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (21.4.0)
Requirement already satisfied: more-itertools&amp;gt;=4.0.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (8.13.0)
Requirement already satisfied: py&amp;gt;=1.5.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (1.11.0)
Requirement already satisfied: atomicwrites&amp;gt;=1.0 in /usr/local/lib/python3.7/dist-packages (from pytest-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (1.4.0)
Requirement already satisfied: pluggy&amp;lt;0.8,&amp;gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from pytest-&amp;gt;lyft_dataset_sdk-&amp;gt;mmdet3d==1.0.0rc3) (0.7.1)
Requirement already satisfied: zipp&amp;gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata&amp;gt;=4.4-&amp;gt;markdown&amp;gt;=2.6.8-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (3.8.0)
Requirement already satisfied: pyasn1&amp;lt;0.5.0,&amp;gt;=0.4.6 in /usr/local/lib/python3.7/dist-packages (from pyasn1-modules&amp;gt;=0.2.1-&amp;gt;google-auth&amp;lt;3,&amp;gt;=1.6.3-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (0.4.8)
Requirement already satisfied: oauthlib&amp;gt;=3.0.0 in /usr/local/lib/python3.7/dist-packages (from requests-oauthlib&amp;gt;=0.7.0-&amp;gt;google-auth-oauthlib&amp;lt;0.5,&amp;gt;=0.4.1-&amp;gt;tensorboard-&amp;gt;mmdet3d==1.0.0rc3) (3.2.0)
Requirement already satisfied: jupyter-client in /usr/local/lib/python3.7/dist-packages (from ipykernel-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (5.3.5)
Requirement already satisfied: traitlets&amp;gt;=4.1.0 in /usr/local/lib/python3.7/dist-packages (from ipykernel-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (5.1.1)
Requirement already satisfied: tornado&amp;gt;=4.0 in /usr/local/lib/python3.7/dist-packages (from ipykernel-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (5.1.1)
Requirement already satisfied: ipython&amp;gt;=4.0.0 in /usr/local/lib/python3.7/dist-packages (from ipykernel-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (5.5.0)
Requirement already satisfied: jupyterlab-widgets&amp;gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (1.1.0)
Requirement already satisfied: nbformat&amp;gt;=4.2.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (5.4.0)
Requirement already satisfied: ipython-genutils~=0.2.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.2.0)
Requirement already satisfied: widgetsnbextension~=3.6.0 in /usr/local/lib/python3.7/dist-packages (from ipywidgets-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (3.6.0)
Requirement already satisfied: pygments in /usr/local/lib/python3.7/dist-packages (from jupyter-console-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (2.6.1)
Requirement already satisfied: prompt-toolkit&amp;lt;2.0.0,&amp;gt;=1.0.0 in /usr/local/lib/python3.7/dist-packages (from jupyter-console-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (1.0.18)
Requirement already satisfied: pandocfilters&amp;gt;=1.4.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (1.5.0)
Requirement already satisfied: jupyter-core in /usr/local/lib/python3.7/dist-packages (from nbconvert-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (4.10.0)
Requirement already satisfied: mistune&amp;lt;2,&amp;gt;=0.8.1 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.8.4)
Requirement already satisfied: testpath in /usr/local/lib/python3.7/dist-packages (from nbconvert-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.6.0)
Requirement already satisfied: entrypoints&amp;gt;=0.2.2 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.4)
Requirement already satisfied: bleach in /usr/local/lib/python3.7/dist-packages (from nbconvert-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (5.0.0)
Requirement already satisfied: defusedxml in /usr/local/lib/python3.7/dist-packages (from nbconvert-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.7.1)
Requirement already satisfied: jinja2&amp;gt;=2.4 in /usr/local/lib/python3.7/dist-packages (from nbconvert-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (2.11.3)
Requirement already satisfied: Send2Trash in /usr/local/lib/python3.7/dist-packages (from notebook-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (1.8.0)
Requirement already satisfied: terminado&amp;gt;=0.8.1 in /usr/local/lib/python3.7/dist-packages (from notebook-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.13.3)
Requirement already satisfied: qtpy&amp;gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from qtconsole-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (2.1.0)
Requirement already satisfied: pyzmq&amp;gt;=17.1 in /usr/local/lib/python3.7/dist-packages (from qtconsole-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (23.1.0)
Requirement already satisfied: simplegeneric&amp;gt;0.8 in /usr/local/lib/python3.7/dist-packages (from ipython&amp;gt;=4.0.0-&amp;gt;ipykernel-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.8.1)
Requirement already satisfied: pexpect in /usr/local/lib/python3.7/dist-packages (from ipython&amp;gt;=4.0.0-&amp;gt;ipykernel-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (4.8.0)
Requirement already satisfied: pickleshare in /usr/local/lib/python3.7/dist-packages (from ipython&amp;gt;=4.0.0-&amp;gt;ipykernel-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.7.5)
Requirement already satisfied: MarkupSafe&amp;gt;=0.23 in /usr/local/lib/python3.7/dist-packages (from jinja2&amp;gt;=2.4-&amp;gt;nbconvert-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (2.0.1)
Requirement already satisfied: jsonschema&amp;gt;=2.6 in /usr/local/lib/python3.7/dist-packages (from nbformat&amp;gt;=4.2.0-&amp;gt;ipywidgets-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (4.3.3)
Requirement already satisfied: fastjsonschema in /usr/local/lib/python3.7/dist-packages (from nbformat&amp;gt;=4.2.0-&amp;gt;ipywidgets-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (2.15.3)
Requirement already satisfied: wcwidth in /usr/local/lib/python3.7/dist-packages (from prompt-toolkit&amp;lt;2.0.0,&amp;gt;=1.0.0-&amp;gt;jupyter-console-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.2.5)
Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from qtpy&amp;gt;=2.0.1-&amp;gt;qtconsole-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (21.3)
Requirement already satisfied: ptyprocess in /usr/local/lib/python3.7/dist-packages (from terminado&amp;gt;=0.8.1-&amp;gt;notebook-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.7.0)
Requirement already satisfied: webencodings in /usr/local/lib/python3.7/dist-packages (from bleach-&amp;gt;nbconvert-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.5.1)
Requirement already satisfied: pyrsistent!=0.17.0,!=0.17.1,!=0.17.2,&amp;gt;=0.14.0 in /usr/local/lib/python3.7/dist-packages (from jsonschema&amp;gt;=2.6-&amp;gt;nbformat&amp;gt;=4.2.0-&amp;gt;ipywidgets-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (0.18.1)
Requirement already satisfied: importlib-resources&amp;gt;=1.4.0 in /usr/local/lib/python3.7/dist-packages (from jsonschema&amp;gt;=2.6-&amp;gt;nbformat&amp;gt;=4.2.0-&amp;gt;ipywidgets-&amp;gt;jupyter-&amp;gt;nuscenes-devkit-&amp;gt;mmdet3d==1.0.0rc3) (5.7.1)
Building wheels for collected packages: networkx, trimesh, fire
  Building wheel for networkx (setup.py) ... [?25l[?25hdone
  Created wheel for networkx: filename=networkx-2.2-py2.py3-none-any.whl size=1526923 sha256=78db1be6fc20922f3580e77e808eafa1d3e65a486412acdb9563916946595371
  Stored in directory: /root/.cache/pip/wheels/49/fb/7f/02c31ca537b34e1073844b733832e4c3a94071d8edda2c0faa
  Building wheel for trimesh (setup.py) ... [?25l[?25hdone
  Created wheel for trimesh: filename=trimesh-2.35.39-py3-none-any.whl size=324073 sha256=29142163d4899e9eba3c700ea4c47bbdd7b954992e87d68c3003f8a352422bd8
  Stored in directory: /root/.cache/pip/wheels/cb/8d/ba/483fb1c41aa97d67177547c5b380232851007c950f615b1277
  Building wheel for fire (setup.py) ... [?25l[?25hdone
  Created wheel for fire: filename=fire-0.4.0-py2.py3-none-any.whl size=115942 sha256=bf7fdd9c4beb982c2668c3bb8cbcba7f9b8df5fbccc067e369e5553869e63b5b
  Stored in directory: /root/.cache/pip/wheels/8a/67/fb/2e8a12fa16661b9d5af1f654bd199366799740a85c64981226
Successfully built networkx trimesh fire
Installing collected packages: mypy-extensions, mccabe, typed-ast, pyquaternion, pyflakes, pycodestyle, plyfile, platformdirs, pathspec, networkx, llvmlite, fire, trimesh, numba, flake8, click, black, lyft_dataset_sdk, nuscenes-devkit, mmdet3d
  Attempting uninstall: networkx
    Found existing installation: networkx 2.6.3
    Uninstalling networkx-2.6.3:
      Successfully uninstalled networkx-2.6.3
  Attempting uninstall: llvmlite
    Found existing installation: llvmlite 0.34.0
    Uninstalling llvmlite-0.34.0:
      Successfully uninstalled llvmlite-0.34.0
  Attempting uninstall: numba
    Found existing installation: numba 0.51.2
    Uninstalling numba-0.51.2:
      Successfully uninstalled numba-0.51.2
  Attempting uninstall: click
    Found existing installation: click 7.1.2
    Uninstalling click-7.1.2:
      Successfully uninstalled click-7.1.2
  Running setup.py develop for mmdet3d
[31mERROR: pip&#39;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
openmim 0.1.6 requires Click==7.1.2, but you have click 8.1.3 which is incompatible.
flask 1.1.4 requires click&amp;lt;8.0,&amp;gt;=5.1, but you have click 8.1.3 which is incompatible.
albumentations 0.1.12 requires imgaug&amp;lt;0.2.7,&amp;gt;=0.2.5, but you have imgaug 0.2.9 which is incompatible.[0m[31m
[0mSuccessfully installed black-22.3.0 click-8.1.3 fire-0.4.0 flake8-3.9.2 llvmlite-0.36.0 lyft_dataset_sdk-0.0.8 mccabe-0.6.1 mmdet3d-1.0.0rc3 mypy-extensions-0.4.3 networkx-2.2 numba-0.53.0 nuscenes-devkit-1.1.9 pathspec-0.9.0 platformdirs-2.5.2 plyfile-0.7.4 pycodestyle-2.7.0 pyflakes-2.3.1 pyquaternion-0.9.9 trimesh-2.35.39 typed-ast-1.5.4
[33mWARNING: Running pip as the &#39;root&#39; user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv[0m[33m
[0m
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;éªŒè¯&#34;&gt;éªŒè¯&lt;/h2&gt;
&lt;h3 id=&#34;Detection&#34;&gt;Detection&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# mim ä¹Ÿå¯ä»¥ç”¨æ¥search/download,ä¸è¿‡ doc åœ¨æ‰è¿·è—..ä¸çŸ¥é“æ€ä¹ˆç”¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# https://github.com/open-mmlab/mmdetection/tree/master/configs/mask_rcnn&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è·Ÿæ•™ç¨‹ä¸€æ ·çš„å‘½ä»¤...å¤±æ•ˆäº†?&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# !mim search mmdet --model &amp;#x27;mask r-cnn&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# !mim download mmdet --config mask_rcnn_r50_fpn_2x_coco --dest ./_model&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%cd /content/mmdetection&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ä¸‹è½½å¹¶åˆ†åˆ«æµ‹è¯•ä¸‹é¢ä¸¤ä¸ª pre-trained model-checkpoints&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!mkdir checkpoints&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!wget -c https://download.openmmlab.com/mmdetection/v2&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;/mask_rcnn/mask_rcnn_r50_fpn_2x_coco/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-&lt;span class=&#34;number&#34;&gt;0.392&lt;/span&gt;__segm_mAP-&lt;span class=&#34;number&#34;&gt;0.354_20200505_003907&lt;/span&gt;-3e542a40.pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      -O checkpoints/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-&lt;span class=&#34;number&#34;&gt;0.392&lt;/span&gt;__segm_mAP-&lt;span class=&#34;number&#34;&gt;0.354_20200505_003907&lt;/span&gt;-3e542a40.pth&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!wget -c https://download.openmmlab.com/mmdetection/v2&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;/faster_rcnn/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      -O checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;--2022-06-10 12:13:06--  https://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r50_fpn_2x_coco/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-0.392__segm_mAP-0.354_20200505_003907-3e542a40.pth
Resolving download.openmmlab.com (download.openmmlab.com)... 47.74.197.77
Connecting to download.openmmlab.com (download.openmmlab.com)|47.74.197.77|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 177866862 (170M) [application/octet-stream]
Saving to: â€˜checkpoints/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-0.392__segm_mAP-0.354_20200505_003907-3e542a40.pthâ€™

checkpoints/mask_rc 100%[===================&amp;gt;] 169.63M  9.84MB/s    in 18s

2022-06-10 12:13:25 (9.20 MB/s) - â€˜checkpoints/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-0.392__segm_mAP-0.354_20200505_003907-3e542a40.pthâ€™ saved [177866862/177866862]

--2022-06-10 12:13:25--  https://download.openmmlab.com/mmdetection/v2.0/faster_rcnn/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth
Resolving download.openmmlab.com (download.openmmlab.com)... 47.74.197.77
Connecting to download.openmmlab.com (download.openmmlab.com)|47.74.197.77|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 167291982 (160M) [application/octet-stream]
Saving to: â€˜checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pthâ€™

checkpoints/faster_ 100%[===================&amp;gt;] 159.54M  10.9MB/s    in 14s

2022-06-10 12:13:39 (11.5 MB/s) - â€˜checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pthâ€™ saved [167291982/167291982]
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmdet.apis &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; init_detector, inference_detector, show_result_pyplot&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;config = &lt;span class=&#34;string&#34;&gt;&amp;#x27;configs/mask_rcnn/mask_rcnn_r50_fpn_2x_coco.py&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;checkpoint = &lt;span class=&#34;string&#34;&gt;&amp;#x27;checkpoints/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-0.392__segm_mAP-0.354_20200505_003907-3e542a40.pth&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åœ¨ CPU ä¸Šéœ€è¦è®¾ç½® device=&amp;#x27;cpu&amp;#x27; ; GPU ä¸Šè®¾ç½® device=&amp;#x27;cuda:0&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ä½¿ç”¨ mmdetection æºåº“è‡ªå¸¦çš„ demo/demo.jpg&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = init_detector(config, checkpoint, device=&lt;span class=&#34;string&#34;&gt;&amp;#x27;cuda:0&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;result = inference_detector(model, &lt;span class=&#34;string&#34;&gt;&amp;#x27;demo/demo.jpg&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show_result_pyplot(model, &lt;span class=&#34;string&#34;&gt;&amp;#x27;demo/demo.jpg&amp;#x27;&lt;/span&gt;, result)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;load checkpoint from local path: checkpoints/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-0.392__segm_mAP-0.354_20200505_003907-3e542a40.pth


/content/mmdetection/mmdet/datasets/utils.py:70: UserWarning: &amp;quot;ImageToTensor&amp;quot; pipeline is replaced by &amp;quot;DefaultFormatBundle&amp;quot; for batch inference. It is recommended to manually replace it in the test data pipeline in your config file.
  &#39;data pipeline in your config file.&#39;, UserWarning)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;MM-Detection_files/MM-Detection_11_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; mmcv&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmcv.runner &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; load_checkpoint&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmdet.apis &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; inference_detector, show_result_pyplot&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmdet.models &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; build_detector&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Choose to use a config and initialize the detector&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;config = &lt;span class=&#34;string&#34;&gt;&amp;#x27;configs/faster_rcnn/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco.py&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Setup a checkpoint file to load&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;checkpoint = &lt;span class=&#34;string&#34;&gt;&amp;#x27;checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Set the device to be used for evaluation&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;device=&lt;span class=&#34;string&#34;&gt;&amp;#x27;cuda:0&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Load the config&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;config = mmcv.Config.fromfile(config)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Set pretrained to be None since we do not need pretrained model here&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;config.model.pretrained = &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Initialize the detector&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = build_detector(config.model)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Load checkpoint&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;checkpoint = load_checkpoint(model, checkpoint, map_location=device)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Set the classes of models for inference&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.CLASSES = checkpoint[&lt;span class=&#34;string&#34;&gt;&amp;#x27;meta&amp;#x27;&lt;/span&gt;][&lt;span class=&#34;string&#34;&gt;&amp;#x27;CLASSES&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# We need to set the model&amp;#x27;s cfg for inference&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.cfg = config&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Convert the model to GPU&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.to(device)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Convert the model into evaluation mode&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.&lt;span class=&#34;built_in&#34;&gt;eval&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Use the detector to do inference&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;img = &lt;span class=&#34;string&#34;&gt;&amp;#x27;demo/demo.jpg&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;result = inference_detector(model, img)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Let&amp;#x27;s plot the result&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show_result_pyplot(model, img, result, score_thr=&lt;span class=&#34;number&#34;&gt;0.3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;load checkpoint from local path: checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth


/content/mmdetection/mmdet/datasets/utils.py:70: UserWarning: &amp;quot;ImageToTensor&amp;quot; pipeline is replaced by &amp;quot;DefaultFormatBundle&amp;quot; for batch inference. It is recommended to manually replace it in the test data pipeline in your config file.
  &#39;data pipeline in your config file.&#39;, UserWarning)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;MM-Detection_files/MM-Detection_12_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;Detection3D&#34;&gt;Detection3D&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;%cd /content/mmdetection3d&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!mkdir checkpoints&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!wget -c https://download.openmmlab.com/mmdetection3d/v1&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;_models/votenet/votenet_8x8_scannet-3d-&lt;span class=&#34;number&#34;&gt;18&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt;/votenet_8x8_scannet-3d-&lt;span class=&#34;number&#34;&gt;18&lt;/span&gt;class_20210823_234503-cf8134fa.pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      -O checkpoints/votenet_8x8_scannet-3d-&lt;span class=&#34;number&#34;&gt;18&lt;/span&gt;class_20210823_234503-cf8134fa.pth&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;/content/mmdetection3d
--2022-06-23 16:57:39--  https://download.openmmlab.com/mmdetection3d/v1.0.0_models/votenet/votenet_8x8_scannet-3d-18class/votenet_8x8_scannet-3d-18class_20210823_234503-cf8134fa.pth
Resolving download.openmmlab.com (download.openmmlab.com)... 47.74.197.77
Connecting to download.openmmlab.com (download.openmmlab.com)|47.74.197.77|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 3890927 (3.7M) [application/octet-stream]
Saving to: â€˜checkpoints/votenet_8x8_scannet-3d-18class_20210823_234503-cf8134fa.pthâ€™

checkpoints/votenet 100%[===================&amp;gt;]   3.71M  22.2MB/s    in 0.2s

2022-06-23 16:57:39 (22.2 MB/s) - â€˜checkpoints/votenet_8x8_scannet-3d-18class_20210823_234503-cf8134fa.pthâ€™ saved [3890927/3890927]
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# https://mmdetection3d.readthedocs.io/zh_CN/latest/getting_started.html#id10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmdet3d.apis &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; init_model, inference_detector&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;config_file = &lt;span class=&#34;string&#34;&gt;&amp;#x27;configs/votenet/votenet_8x8_scannet-3d-18class.py&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;checkpoint_file = &lt;span class=&#34;string&#34;&gt;&amp;#x27;checkpoints/votenet_8x8_scannet-3d-18class_20210823_234503-cf8134fa.pth&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ä»é…ç½®æ–‡ä»¶å’Œé¢„è®­ç»ƒçš„æ¨¡å‹æ–‡ä»¶ä¸­æ„å»ºæ¨¡å‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = init_model(config_file, checkpoint_file, device=&lt;span class=&#34;string&#34;&gt;&amp;#x27;cuda:0&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æµ‹è¯•å•ä¸ªæ–‡ä»¶å¹¶å¯è§†åŒ–ç»“æœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;point_cloud = &lt;span class=&#34;string&#34;&gt;&amp;#x27;demo/data/scannet/scene0000_00.bin&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;result, data = inference_detector(model, point_cloud)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å¯è§†åŒ–ç»“æœå¹¶ä¸”å°†ç»“æœä¿å­˜åˆ° &amp;#x27;results&amp;#x27; æ–‡ä»¶å¤¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.show_results(data, result, out_dir=&lt;span class=&#34;string&#34;&gt;&amp;#x27;results&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;/content/mmdetection3d/mmdet3d/models/backbones/mink_resnet.py:10: UserWarning: Please follow `getting_started.md` to install MinkowskiEngine.`
  &#39;Please follow `getting_started.md` to install MinkowskiEngine.`&#39;)
/usr/local/lib/python3.7/dist-packages/mmcv/cnn/bricks/conv_module.py:151: UserWarning: Unnecessary conv bias before batch/instance norm
  &#39;Unnecessary conv bias before batch/instance norm&#39;)


load checkpoint from local path: checkpoints/votenet_8x8_scannet-3d-18class_20210823_234503-cf8134fa.pth


/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;Custom-training&#34;&gt;Custom-training&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;é€‰æ‹©+ä¸‹è½½é¢„è®­ç»ƒæ¨¡å‹å’Œæ•°æ®é›†&lt;/p&gt;
&lt;p&gt;å‚æ•°è§£é‡Š: &lt;code&gt;mask_rcnn_r50_fpn_2x_coco&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;mask_rcnn ä¸­ä¸åŒçš„ backbone (ä¸»å¹²ç½‘ç»œ)&lt;/p&gt;
&lt;p&gt;r50: 50å±‚ResNet&lt;/p&gt;
&lt;p&gt;fpn: ç‰¹å¾é‡‘å­—å¡”&lt;/p&gt;
&lt;p&gt;2x: learning rate schedule&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å®šä¹‰æ•°æ®é›†ç±» + config&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;è°ƒç”¨ API è®­ç»ƒ + è¯„ä¼°&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”¨è®­ç»ƒå¥½çš„æ¨¡å‹æ¨ç†æµ‹è¯•&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;hr&gt;
&lt;h3 id=&#34;Detection-2&#34;&gt;Detection&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# pre-trained model åœ¨ä¸Šé¢ä¸‹è½½å¥½äº†, è¿™é‡Œåªä¸‹è½½æ•°æ®é›†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!wget https://download.openmmlab.com/mmdetection/data/kitti_tiny.&lt;span class=&#34;built_in&#34;&gt;zip&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!unzip kitti_tiny.&lt;span class=&#34;built_in&#34;&gt;zip&lt;/span&gt; &amp;gt; /dev/null&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Let&amp;#x27;s take a look at the dataset image&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; mmcv&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;img = mmcv.imread(&lt;span class=&#34;string&#34;&gt;&amp;#x27;kitti_tiny/training/image_2/000073.jpeg&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;25&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.imshow(mmcv.bgr2rgb(img))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;--2022-06-23 18:02:38--  https://download.openmmlab.com/mmdetection/data/kitti_tiny.zip
Resolving download.openmmlab.com (download.openmmlab.com)... 47.74.197.77
Connecting to download.openmmlab.com (download.openmmlab.com)|47.74.197.77|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 6918271 (6.6M) [application/zip]
Saving to: â€˜kitti_tiny.zipâ€™

kitti_tiny.zip      100%[===================&amp;gt;]   6.60M  15.2MB/s    in 0.4s

2022-06-23 18:02:39 (15.2 MB/s) - â€˜kitti_tiny.zipâ€™ saved [6918271/6918271]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;MM-Detection_files/MM-Detection_18_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è‡ªå®šä¹‰æ•°æ®é›†æ ¼å¼ &amp;#x27;KittiTinyDataset&amp;#x27; å¹¶æ³¨å†Œåˆ° mmdet&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; copy&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; os.path &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; osp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; mmcv&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmdet.datasets.builder &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; DATASETS&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmdet.datasets.custom &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; CustomDataset&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;meta&#34;&gt;@DATASETS.register_module()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;KittiTinyDataset&lt;/span&gt;(&lt;span class=&#34;title class_ inherited__&#34;&gt;CustomDataset&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    CLASSES = (&lt;span class=&#34;string&#34;&gt;&amp;#x27;Car&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Pedestrian&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Cyclist&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;load_annotations&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self, ann_file&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        cat2label = &amp;#123;k: i &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i, k &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;enumerate&lt;/span&gt;(&lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.CLASSES)&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# load image list from file&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        image_list = mmcv.list_from_file(&lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.ann_file)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        data_infos = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# convert annotations to middle format&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; image_id &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; image_list:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            filename = &lt;span class=&#34;string&#34;&gt;f&amp;#x27;&lt;span class=&#34;subst&#34;&gt;&amp;#123;self.img_prefix&amp;#125;&lt;/span&gt;/&lt;span class=&#34;subst&#34;&gt;&amp;#123;image_id&amp;#125;&lt;/span&gt;.jpeg&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            image = mmcv.imread(filename)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            height, width = image.shape[:&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            data_info = &lt;span class=&#34;built_in&#34;&gt;dict&lt;/span&gt;(filename=&lt;span class=&#34;string&#34;&gt;f&amp;#x27;&lt;span class=&#34;subst&#34;&gt;&amp;#123;image_id&amp;#125;&lt;/span&gt;.jpeg&amp;#x27;&lt;/span&gt;, width=width, height=height)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;# load annotations&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            label_prefix = &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.img_prefix.replace(&lt;span class=&#34;string&#34;&gt;&amp;#x27;image_2&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;label_2&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            lines = mmcv.list_from_file(osp.join(label_prefix, &lt;span class=&#34;string&#34;&gt;f&amp;#x27;&lt;span class=&#34;subst&#34;&gt;&amp;#123;image_id&amp;#125;&lt;/span&gt;.txt&amp;#x27;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            content = [line.strip().split(&lt;span class=&#34;string&#34;&gt;&amp;#x27; &amp;#x27;&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; line &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; lines]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            bbox_names = [x[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;] &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; x &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; content]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            bboxes = [[&lt;span class=&#34;built_in&#34;&gt;float&lt;/span&gt;(info) &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; info &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; x[&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;:&lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;]] &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; x &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; content]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            gt_bboxes = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            gt_labels = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            gt_bboxes_ignore = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            gt_labels_ignore = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;comment&#34;&gt;# filter &amp;#x27;DontCare&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; bbox_name, bbox &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;zip&lt;/span&gt;(bbox_names, bboxes):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; bbox_name &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; cat2label:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    gt_labels.append(cat2label[bbox_name])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    gt_bboxes.append(bbox)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    gt_labels_ignore.append(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    gt_bboxes_ignore.append(bbox)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            data_anno = &lt;span class=&#34;built_in&#34;&gt;dict&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                bboxes=np.array(gt_bboxes, dtype=np.float32).reshape(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                labels=np.array(gt_labels, dtype=np.long),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                bboxes_ignore=np.array(gt_bboxes_ignore,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                       dtype=np.float32).reshape(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                labels_ignore=np.array(gt_labels_ignore, dtype=np.long))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            data_info.update(ann=data_anno)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            data_infos.append(data_info)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; data_infos&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# mmdet é…ç½®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmcv &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; Config&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmdet.apis &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; set_random_seed&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg = Config.fromfile(&lt;span class=&#34;string&#34;&gt;&amp;#x27;configs/faster_rcnn/faster_rcnn_r50_caffe_fpn_mstrain_1x_coco.py&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# If we need to finetune a model based on a pre-trained detector, we need to use load_from to set the path of checkpoints.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.load_from = &lt;span class=&#34;string&#34;&gt;&amp;#x27;checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Modify dataset type and path&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.dataset_type = &lt;span class=&#34;string&#34;&gt;&amp;#x27;KittiTinyDataset&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data_root = &lt;span class=&#34;string&#34;&gt;&amp;#x27;kitti_tiny/&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.test.&lt;span class=&#34;built_in&#34;&gt;type&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;KittiTinyDataset&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.test.data_root = &lt;span class=&#34;string&#34;&gt;&amp;#x27;kitti_tiny/&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.test.ann_file = &lt;span class=&#34;string&#34;&gt;&amp;#x27;train.txt&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.test.img_prefix = &lt;span class=&#34;string&#34;&gt;&amp;#x27;training/image_2&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.train.&lt;span class=&#34;built_in&#34;&gt;type&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;KittiTinyDataset&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.train.data_root = &lt;span class=&#34;string&#34;&gt;&amp;#x27;kitti_tiny/&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.train.ann_file = &lt;span class=&#34;string&#34;&gt;&amp;#x27;train.txt&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.train.img_prefix = &lt;span class=&#34;string&#34;&gt;&amp;#x27;training/image_2&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.val.&lt;span class=&#34;built_in&#34;&gt;type&lt;/span&gt; = &lt;span class=&#34;string&#34;&gt;&amp;#x27;KittiTinyDataset&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.val.data_root = &lt;span class=&#34;string&#34;&gt;&amp;#x27;kitti_tiny/&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.val.ann_file = &lt;span class=&#34;string&#34;&gt;&amp;#x27;val.txt&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.data.val.img_prefix = &lt;span class=&#34;string&#34;&gt;&amp;#x27;training/image_2&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# modify num classes of the model in box head&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.model.roi_head.bbox_head.num_classes = &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Set up working dir to save files and logs.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.work_dir = &lt;span class=&#34;string&#34;&gt;&amp;#x27;./tutorial_exps&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# The original learning rate (LR) is set for 8-GPU training.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# We divide it by 8 since we only use one GPU.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.optimizer.lr = &lt;span class=&#34;number&#34;&gt;0.02&lt;/span&gt; / &lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.lr_config.warmup = &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.log_config.interval = &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Change the evaluation metric since we use customized dataset.&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.evaluation.metric = &lt;span class=&#34;string&#34;&gt;&amp;#x27;mAP&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# We can set the evaluation interval to reduce the evaluation times&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.evaluation.interval = &lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# We can set the checkpoint saving interval to reduce the storage cost&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.checkpoint_config.interval = &lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Set seed thus the results are more reproducible&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.seed = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;set_random_seed(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, deterministic=&lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.device=&lt;span class=&#34;string&#34;&gt;&amp;#x27;cuda&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.gpu_ids = &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# We can also use tensorboard to log the training process&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cfg.log_config.hooks = [&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;dict&lt;/span&gt;(&lt;span class=&#34;built_in&#34;&gt;type&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;#x27;TextLoggerHook&amp;#x27;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;dict&lt;/span&gt;(&lt;span class=&#34;built_in&#34;&gt;type&lt;/span&gt;=&lt;span class=&#34;string&#34;&gt;&amp;#x27;TensorboardLoggerHook&amp;#x27;&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# We can initialize the logger for training and have a look at the final config used for training&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# print(f&amp;#x27;Config:\n&amp;#123;cfg.pretty_text&amp;#125;&amp;#x27;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Train a new detector&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmdet.datasets &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; build_dataset&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmdet.models &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; build_detector&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mmdet.apis &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; train_detector&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Build dataset&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;datasets = [build_dataset(cfg.data.train)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Build the detector&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = build_detector(cfg.model)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#  build_detector( cfg.model, train_cfg=cfg.get(&amp;#x27;train_cfg&amp;#x27;), test_cfg=cfg.get(&amp;#x27;test_cfg&amp;#x27;))&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Add an attribute for visualization convenience&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.CLASSES = datasets[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].CLASSES&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Create work_dir&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mmcv.mkdir_or_exist(osp.abspath(cfg.work_dir))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æŠ¥é”™:AttributeError: &amp;#x27;ConfigDict&amp;#x27; object has no attribute &amp;#x27;device&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# https://github.com/open-mmlab/mmdetection/issues/7901&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åœ¨ä¸Šé¢ cfg æ·»åŠ äº† cfg.device=&amp;#x27;cuda&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train_detector(model, datasets, cfg, distributed=&lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;, validate=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:54: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:57: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.
Deprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
/content/mmdetection/mmdet/datasets/custom.py:180: UserWarning: CustomDataset does not support filtering empty gt images.
  &#39;CustomDataset does not support filtering empty gt images.&#39;)
2022-06-07 16:41:00,736 - mmdet - INFO - Automatic scaling of learning rate (LR) has been disabled.
2022-06-07 16:41:00,899 - mmdet - INFO - load checkpoint from local path: checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth
2022-06-07 16:41:01,026 - mmdet - WARNING - The model and loaded state dict do not match exactly

size mismatch for roi_head.bbox_head.fc_cls.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([4, 1024]).
size mismatch for roi_head.bbox_head.fc_cls.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([4]).
size mismatch for roi_head.bbox_head.fc_reg.weight: copying a param with shape torch.Size([320, 1024]) from checkpoint, the shape in current model is torch.Size([12, 1024]).
size mismatch for roi_head.bbox_head.fc_reg.bias: copying a param with shape torch.Size([320]) from checkpoint, the shape in current model is torch.Size([12]).
2022-06-07 16:41:01,035 - mmdet - INFO - Start running, host: root@7a73f7b358c4, work_dir: /content/mmdetection/tutorial_exps
2022-06-07 16:41:01,037 - mmdet - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) StepLrUpdaterHook
(NORMAL      ) CheckpointHook
(LOW         ) EvalHook
(VERY_LOW    ) TextLoggerHook
(VERY_LOW    ) TensorboardLoggerHook
 --------------------
before_train_epoch:
(VERY_HIGH   ) StepLrUpdaterHook
(NORMAL      ) NumClassCheckHook
(LOW         ) IterTimerHook
(LOW         ) EvalHook
(VERY_LOW    ) TextLoggerHook
(VERY_LOW    ) TensorboardLoggerHook
 --------------------
before_train_iter:
(VERY_HIGH   ) StepLrUpdaterHook
(LOW         ) IterTimerHook
(LOW         ) EvalHook
 --------------------
after_train_iter:
(ABOVE_NORMAL) OptimizerHook
(NORMAL      ) CheckpointHook
(LOW         ) IterTimerHook
(LOW         ) EvalHook
(VERY_LOW    ) TextLoggerHook
(VERY_LOW    ) TensorboardLoggerHook
 --------------------
after_train_epoch:
(NORMAL      ) CheckpointHook
(LOW         ) EvalHook
(VERY_LOW    ) TextLoggerHook
(VERY_LOW    ) TensorboardLoggerHook
 --------------------
before_val_epoch:
(NORMAL      ) NumClassCheckHook
(LOW         ) IterTimerHook
(VERY_LOW    ) TextLoggerHook
(VERY_LOW    ) TensorboardLoggerHook
 --------------------
before_val_iter:
(LOW         ) IterTimerHook
 --------------------
after_val_iter:
(LOW         ) IterTimerHook
 --------------------
after_val_epoch:
(VERY_LOW    ) TextLoggerHook
(VERY_LOW    ) TensorboardLoggerHook
 --------------------
after_run:
(VERY_LOW    ) TextLoggerHook
(VERY_LOW    ) TensorboardLoggerHook
 --------------------
2022-06-07 16:41:01,038 - mmdet - INFO - workflow: [(&#39;train&#39;, 1)], max: 12 epochs
2022-06-07 16:41:01,040 - mmdet - INFO - Checkpoints will be saved to /content/mmdetection/tutorial_exps by HardDiskBackend.
2022-06-07 16:41:17,697 - mmdet - INFO - Epoch [1][10/25]	lr: 2.500e-03, eta: 0:04:25, time: 0.914, data_time: 0.236, memory: 2790, loss_rpn_cls: 0.0267, loss_rpn_bbox: 0.0173, loss_cls: 0.5377, acc: 81.6211, loss_bbox: 0.3947, loss: 0.9764
2022-06-07 16:41:21,039 - mmdet - INFO - Epoch [1][20/25]	lr: 2.500e-03, eta: 0:02:54, time: 0.334, data_time: 0.023, memory: 2790, loss_rpn_cls: 0.0149, loss_rpn_bbox: 0.0119, loss_cls: 0.1753, acc: 93.4570, loss_bbox: 0.3254, loss: 0.5275
2022-06-07 16:41:28,575 - mmdet - INFO - Epoch [2][10/25]	lr: 2.500e-03, eta: 0:02:16, time: 0.558, data_time: 0.232, memory: 2790, loss_rpn_cls: 0.0167, loss_rpn_bbox: 0.0138, loss_cls: 0.1519, acc: 94.7656, loss_bbox: 0.2673, loss: 0.4497
2022-06-07 16:41:31,944 - mmdet - INFO - Epoch [2][20/25]	lr: 2.500e-03, eta: 0:02:01, time: 0.337, data_time: 0.023, memory: 2790, loss_rpn_cls: 0.0128, loss_rpn_bbox: 0.0127, loss_cls: 0.1325, acc: 94.9316, loss_bbox: 0.2084, loss: 0.3664
2022-06-07 16:41:39,445 - mmdet - INFO - Epoch [3][10/25]	lr: 2.500e-03, eta: 0:01:48, time: 0.569, data_time: 0.236, memory: 2790, loss_rpn_cls: 0.0059, loss_rpn_bbox: 0.0102, loss_cls: 0.0972, acc: 96.2500, loss_bbox: 0.1600, loss: 0.2733
2022-06-07 16:41:42,958 - mmdet - INFO - Epoch [3][20/25]	lr: 2.500e-03, eta: 0:01:40, time: 0.349, data_time: 0.024, memory: 2790, loss_rpn_cls: 0.0088, loss_rpn_bbox: 0.0133, loss_cls: 0.1474, acc: 94.4336, loss_bbox: 0.2652, loss: 0.4346
2022-06-07 16:41:50,449 - mmdet - INFO - Epoch [4][10/25]	lr: 2.500e-03, eta: 0:01:31, time: 0.562, data_time: 0.231, memory: 2790, loss_rpn_cls: 0.0064, loss_rpn_bbox: 0.0134, loss_cls: 0.1168, acc: 95.5566, loss_bbox: 0.2201, loss: 0.3567
2022-06-07 16:41:53,973 - mmdet - INFO - Epoch [4][20/25]	lr: 2.500e-03, eta: 0:01:25, time: 0.353, data_time: 0.027, memory: 2790, loss_rpn_cls: 0.0035, loss_rpn_bbox: 0.0117, loss_cls: 0.1179, acc: 95.5566, loss_bbox: 0.2133, loss: 0.3464
2022-06-07 16:42:01,892 - mmdet - INFO - Epoch [5][10/25]	lr: 2.500e-03, eta: 0:01:18, time: 0.595, data_time: 0.237, memory: 2790, loss_rpn_cls: 0.0040, loss_rpn_bbox: 0.0092, loss_cls: 0.1003, acc: 96.2695, loss_bbox: 0.2087, loss: 0.3223
2022-06-07 16:42:05,430 - mmdet - INFO - Epoch [5][20/25]	lr: 2.500e-03, eta: 0:01:13, time: 0.352, data_time: 0.024, memory: 2790, loss_rpn_cls: 0.0037, loss_rpn_bbox: 0.0107, loss_cls: 0.0903, acc: 96.7090, loss_bbox: 0.1845, loss: 0.2892
2022-06-07 16:42:12,992 - mmdet - INFO - Epoch [6][10/25]	lr: 2.500e-03, eta: 0:01:07, time: 0.567, data_time: 0.232, memory: 2790, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0082, loss_cls: 0.0786, acc: 97.1777, loss_bbox: 0.1799, loss: 0.2685
2022-06-07 16:42:16,595 - mmdet - INFO - Epoch [6][20/25]	lr: 2.500e-03, eta: 0:01:02, time: 0.363, data_time: 0.027, memory: 2790, loss_rpn_cls: 0.0029, loss_rpn_bbox: 0.0100, loss_cls: 0.0891, acc: 96.5332, loss_bbox: 0.1856, loss: 0.2876
2022-06-07 16:42:24,486 - mmdet - INFO - Epoch [7][10/25]	lr: 2.500e-03, eta: 0:00:56, time: 0.591, data_time: 0.238, memory: 2790, loss_rpn_cls: 0.0043, loss_rpn_bbox: 0.0096, loss_cls: 0.0904, acc: 96.6113, loss_bbox: 0.1740, loss: 0.2783
2022-06-07 16:42:28,147 - mmdet - INFO - Epoch [7][20/25]	lr: 2.500e-03, eta: 0:00:52, time: 0.364, data_time: 0.023, memory: 2790, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0116, loss_cls: 0.0926, acc: 96.1816, loss_bbox: 0.1774, loss: 0.2835
2022-06-07 16:42:35,802 - mmdet - INFO - Epoch [8][10/25]	lr: 2.500e-03, eta: 0:00:45, time: 0.572, data_time: 0.232, memory: 2790, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0091, loss_cls: 0.0777, acc: 96.8262, loss_bbox: 0.1420, loss: 0.2314
2022-06-07 16:42:39,346 - mmdet - INFO - Epoch [8][20/25]	lr: 2.500e-03, eta: 0:00:41, time: 0.354, data_time: 0.025, memory: 2790, loss_rpn_cls: 0.0036, loss_rpn_bbox: 0.0082, loss_cls: 0.0777, acc: 97.2168, loss_bbox: 0.1590, loss: 0.2485
2022-06-07 16:42:46,922 - mmdet - INFO - Epoch [9][10/25]	lr: 2.500e-04, eta: 0:00:35, time: 0.565, data_time: 0.232, memory: 2790, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0082, loss_cls: 0.0658, acc: 97.4902, loss_bbox: 0.1351, loss: 0.2116
2022-06-07 16:42:50,443 - mmdet - INFO - Epoch [9][20/25]	lr: 2.500e-04, eta: 0:00:31, time: 0.352, data_time: 0.024, memory: 2790, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0066, loss_cls: 0.0571, acc: 97.8418, loss_bbox: 0.1133, loss: 0.1783
2022-06-07 16:42:58,001 - mmdet - INFO - Epoch [10][10/25]	lr: 2.500e-04, eta: 0:00:25, time: 0.567, data_time: 0.233, memory: 2790, loss_rpn_cls: 0.0034, loss_rpn_bbox: 0.0081, loss_cls: 0.0678, acc: 97.3926, loss_bbox: 0.1332, loss: 0.2125
2022-06-07 16:43:01,493 - mmdet - INFO - Epoch [10][20/25]	lr: 2.500e-04, eta: 0:00:21, time: 0.350, data_time: 0.023, memory: 2790, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0059, loss_cls: 0.0594, acc: 97.6758, loss_bbox: 0.1294, loss: 0.1955
2022-06-07 16:43:09,042 - mmdet - INFO - Epoch [11][10/25]	lr: 2.500e-04, eta: 0:00:15, time: 0.567, data_time: 0.234, memory: 2790, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0069, loss_cls: 0.0638, acc: 97.6270, loss_bbox: 0.1217, loss: 0.1932
2022-06-07 16:43:12,554 - mmdet - INFO - Epoch [11][20/25]	lr: 2.500e-04, eta: 0:00:11, time: 0.351, data_time: 0.023, memory: 2790, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0073, loss_cls: 0.0571, acc: 97.8711, loss_bbox: 0.1212, loss: 0.1869
2022-06-07 16:43:20,107 - mmdet - INFO - Epoch [12][10/25]	lr: 2.500e-05, eta: 0:00:05, time: 0.567, data_time: 0.232, memory: 2790, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0061, loss_cls: 0.0563, acc: 97.9199, loss_bbox: 0.1246, loss: 0.1887
2022-06-07 16:43:23,598 - mmdet - INFO - Epoch [12][20/25]	lr: 2.500e-05, eta: 0:00:01, time: 0.349, data_time: 0.024, memory: 2790, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0048, loss_cls: 0.0511, acc: 97.9297, loss_bbox: 0.0946, loss: 0.1520
2022-06-07 16:43:25,323 - mmdet - INFO - Saving checkpoint at 12 epochs


[&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;&amp;gt;] 25/25, 9.8 task/s, elapsed: 3s, ETA:     0s
---------------iou_thr: 0.5---------------


2022-06-07 16:43:30,260 - mmdet - INFO -
+------------+-----+------+--------+-------+
| class      | gts | dets | recall | ap    |
+------------+-----+------+--------+-------+
| Car        | 62  | 133  | 0.984  | 0.888 |
| Pedestrian | 13  | 40   | 0.846  | 0.768 |
| Cyclist    | 7   | 50   | 0.571  | 0.114 |
+------------+-----+------+--------+-------+
| mAP        |     |      |        | 0.590 |
+------------+-----+------+--------+-------+
2022-06-07 16:43:30,268 - mmdet - INFO - Epoch(val) [12][25]	AP50: 0.5900, mAP: 0.5899
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# load tensorboard in colab&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%load_ext tensorboard&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# see curves in tensorboard&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;%tensorboard --logdir ./tutorial_exps&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;IPython.core.display.Javascript object&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;img = mmcv.imread(&lt;span class=&#34;string&#34;&gt;&amp;#x27;kitti_tiny/training/image_2/000068.jpeg&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.cfg = cfg&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;result = inference_detector(model, img)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;show_result_pyplot(model, img, result)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;MM-Detection_files/MM-Detection_23_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;Detection3D-2&#34;&gt;Detection3D&lt;/h3&gt;
&lt;h4 id=&#34;å•æ¨¡æ€ç‚¹äº‘-3DDetect&#34;&gt;å•æ¨¡æ€ç‚¹äº‘-3DDetect&lt;/h4&gt;
&lt;p&gt;å¯ä»¥ç®€å•çš„æŠŠæµç¨‹çœ‹åš: &lt;code&gt;æŠŠ. binç‚¹äº‘æ•°æ® è½¬æ¢ä¸º .objç‚¹äº‘å’Œé¢„æµ‹ 3D æ¡†çš„å¯è§†åŒ–ç»“æœ&lt;/code&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;%cd /content/mmdetection3d&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!mkdir checkpoints&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!wget -c https://download.openmmlab.com/mmdetection3d/v0&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;_models/second/hv_second_secfpn_6x8_80e_kitti-3d-car/hv_second_secfpn_6x8_80e_kitti-3d-car_20200620_230238-393f000c.pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      -O checkpoints/hv_second_secfpn_6x8_80e_kitti-3d-car_20200620_230238-393f000c.pth&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!wget -c https://download.openmmlab.com/mmdetection3d/v1&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;_models/votenet/votenet_16x8_sunrgbd-3d-&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt;/votenet_16x8_sunrgbd-3d-&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;class_20210820_162823-bf11f014.pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      -O checkpoints/votenet_16x8_sunrgbd-3d-&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;class_20210820_162823-bf11f014.pth&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!python \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/pcd_demo.py \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/data/kitti/kitti_000008.&lt;span class=&#34;built_in&#34;&gt;bin&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  configs/second/hv_second_secfpn_6x8_80e_kitti-3d-car.py \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  checkpoints/hv_second_secfpn_6x8_80e_kitti-3d-car_20200620_230238-393f000c.pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  --out-&lt;span class=&#34;built_in&#34;&gt;dir&lt;/span&gt; /content/mmdetection3d/result/&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!python \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/pcd_demo.py \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/data/sunrgbd/sunrgbd_000017.&lt;span class=&#34;built_in&#34;&gt;bin&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  configs/votenet/votenet_16x8_sunrgbd-3d-&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt;.py \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  checkpoints/votenet_16x8_sunrgbd-3d-&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;class_20210820_162823-bf11f014.pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  --out-&lt;span class=&#34;built_in&#34;&gt;dir&lt;/span&gt; /content/mmdetection3d/result/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;/content/mmdetection3d
mkdir: cannot create directory â€˜checkpointsâ€™: File exists
--2022-06-20 16:05:19--  https://download.openmmlab.com/mmdetection3d/v0.1.0_models/second/hv_second_secfpn_6x8_80e_kitti-3d-car/hv_second_secfpn_6x8_80e_kitti-3d-car_20200620_230238-393f000c.pth
Resolving download.openmmlab.com (download.openmmlab.com)... 47.88.36.72
Connecting to download.openmmlab.com (download.openmmlab.com)|47.88.36.72|:443... connected.
HTTP request sent, awaiting response... 200 OK

    The file is already fully retrieved; nothing to do.

--2022-06-20 16:05:20--  https://download.openmmlab.com/mmdetection3d/v1.0.0_models/votenet/votenet_16x8_sunrgbd-3d-10class/votenet_16x8_sunrgbd-3d-10class_20210820_162823-bf11f014.pth
Resolving download.openmmlab.com (download.openmmlab.com)... 47.88.36.72
Connecting to download.openmmlab.com (download.openmmlab.com)|47.88.36.72|:443... connected.
HTTP request sent, awaiting response... 200 OK

    The file is already fully retrieved; nothing to do.

/content/mmdetection3d/mmdet3d/models/backbones/mink_resnet.py:10: UserWarning: Please follow `getting_started.md` to install MinkowskiEngine.`
  &#39;Please follow `getting_started.md` to install MinkowskiEngine.`&#39;)
/content/mmdetection3d/mmdet3d/models/dense_heads/anchor3d_head.py:85: UserWarning: dir_offset and dir_limit_offset will be depressed and be incorporated into box coder in the future
  &#39;dir_offset and dir_limit_offset will be depressed and be &#39;
load checkpoint from local path: checkpoints/hv_second_secfpn_6x8_80e_kitti-3d-car_20200620_230238-393f000c.pth
[0m/content/mmdetection3d/mmdet3d/models/backbones/mink_resnet.py:10: UserWarning: Please follow `getting_started.md` to install MinkowskiEngine.`
  &#39;Please follow `getting_started.md` to install MinkowskiEngine.`&#39;)
/usr/local/lib/python3.7/dist-packages/mmcv/cnn/bricks/conv_module.py:151: UserWarning: Unnecessary conv bias before batch/instance norm
  &#39;Unnecessary conv bias before batch/instance norm&#39;)
load checkpoint from local path: checkpoints/votenet_16x8_sunrgbd-3d-10class_20210820_162823-bf11f014.pth
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
[0m
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;å¤šæ¨¡æ€ç‚¹äº‘åŠ å›¾åƒ-3DDetect&#34;&gt;å¤šæ¨¡æ€ç‚¹äº‘åŠ å›¾åƒ-3DDetect&lt;/h4&gt;
&lt;p&gt;é€šå¸¸æ˜¯ ç‚¹äº‘+å›¾åƒ, æ•°æ®é›†éœ€è¦é¢å¤–çš„ annotation æä¾› 3D åˆ° 2D çš„ä»¿å°„çŸ©é˜µ&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;!wget -c https://download.openmmlab.com/mmdetection3d/v1&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;_models/mvxnet/dv_mvx-fpn_second_secfpn_adamw_2x8_80e_kitti-3d-&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt;/dv_mvx-fpn_second_secfpn_adamw_2x8_80e_kitti-3d-&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;class_20210831_060805-&lt;span class=&#34;number&#34;&gt;83442923.&lt;/span&gt;pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      -O checkpoints/dv_mvx-fpn_second_secfpn_adamw_2x8_80e_kitti-3d-&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;class_20210831_060805-&lt;span class=&#34;number&#34;&gt;83442923.&lt;/span&gt;pth&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!rm -rf result/kitti_000008&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!python \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/multi_modality_demo.py \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/data/kitti/kitti_000008.&lt;span class=&#34;built_in&#34;&gt;bin&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/data/kitti/kitti_000008.png \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/data/kitti/kitti_000008_infos.pkl \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  configs/mvxnet/dv_mvx-fpn_second_secfpn_adamw_2x8_80e_kitti-3d-&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt;.py \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  checkpoints/dv_mvx-fpn_second_secfpn_adamw_2x8_80e_kitti-3d-&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;class_20210831_060805-&lt;span class=&#34;number&#34;&gt;83442923.&lt;/span&gt;pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  --out-&lt;span class=&#34;built_in&#34;&gt;dir&lt;/span&gt; /content/mmdetection3d/result/&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;25&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.imshow(plt.imread(&lt;span class=&#34;string&#34;&gt;&amp;#x27;result/kitti_000008/kitti_000008_pred.png&amp;#x27;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;--2022-06-23 18:07:17--  https://download.openmmlab.com/mmdetection3d/v1.0.0_models/mvxnet/dv_mvx-fpn_second_secfpn_adamw_2x8_80e_kitti-3d-3class/dv_mvx-fpn_second_secfpn_adamw_2x8_80e_kitti-3d-3class_20210831_060805-83442923.pth
Resolving download.openmmlab.com (download.openmmlab.com)... 47.252.96.28
Connecting to download.openmmlab.com (download.openmmlab.com)|47.252.96.28|:443... connected.
HTTP request sent, awaiting response... 200 OK

    The file is already fully retrieved; nothing to do.

/content/mmdetection3d/mmdet3d/models/backbones/mink_resnet.py:10: UserWarning: Please follow `getting_started.md` to install MinkowskiEngine.`
  &#39;Please follow `getting_started.md` to install MinkowskiEngine.`&#39;)
/content/mmdetection3d/mmdet3d/models/dense_heads/anchor3d_head.py:85: UserWarning: dir_offset and dir_limit_offset will be depressed and be incorporated into box coder in the future
  &#39;dir_offset and dir_limit_offset will be depressed and be &#39;
load checkpoint from local path: checkpoints/dv_mvx-fpn_second_secfpn_adamw_2x8_80e_kitti-3d-3class_20210831_060805-83442923.pth
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
/content/mmdetection3d/mmdet3d/models/fusion_layers/coord_transform.py:35: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  if &#39;pcd_rotation&#39; in img_meta else torch.eye(
[0m




&amp;lt;matplotlib.image.AxesImage at 0x7f7100889490&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;MM-Detection_files/MM-Detection_28_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;å•ç›®å›¾åƒ-3DDetect&#34;&gt;å•ç›®å›¾åƒ-3DDetect&lt;/h4&gt;
&lt;p&gt;å¯ä»¥ç†è§£ä¸ºåœ¨å¤šæ¨¡æ€ä¸Šå»æ‰ç‚¹äº‘æ•°æ® (å½“ç„¶æ•°æ®é›†ä¼šæœ‰æ‰€å˜åŠ¨), æ•ˆæœä¸å¦‚å¤šæ¨¡æ€&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;!wget -c https://download.openmmlab.com/mmdetection3d/v0&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;_models/fcos3d/fcos3d_r101_caffe_fpn_gn-head_dcn_2x8_1x_nus-mono3d/fcos3d_r101_caffe_fpn_gn-head_dcn_2x8_1x_nus-mono3d_20210715_235813-4bed5239.pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      -O checkpoints/fcos3d_r101_caffe_fpn_gn-head_dcn_2x8_1x_nus-mono3d_20210715_235813-4bed5239.pth&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!python \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/mono_det_demo.py \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/data/nuscenes/n015-&lt;span class=&#34;number&#34;&gt;2018&lt;/span&gt;-07-&lt;span class=&#34;number&#34;&gt;24&lt;/span&gt;-&lt;span class=&#34;number&#34;&gt;11&lt;/span&gt;-&lt;span class=&#34;number&#34;&gt;22&lt;/span&gt;-&lt;span class=&#34;number&#34;&gt;45&lt;/span&gt;+0800__CAM_BACK__1532402927637525.jpg \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/data/nuscenes/n015-&lt;span class=&#34;number&#34;&gt;2018&lt;/span&gt;-07-&lt;span class=&#34;number&#34;&gt;24&lt;/span&gt;-&lt;span class=&#34;number&#34;&gt;11&lt;/span&gt;-&lt;span class=&#34;number&#34;&gt;22&lt;/span&gt;-&lt;span class=&#34;number&#34;&gt;45&lt;/span&gt;+0800__CAM_BACK__1532402927637525_mono3d.coco.json \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  configs/fcos3d/fcos3d_r101_caffe_fpn_gn-head_dcn_2x8_1x_nus-mono3d_finetune.py \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  checkpoints/fcos3d_r101_caffe_fpn_gn-head_dcn_2x8_1x_nus-mono3d_20210715_235813-4bed5239.pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  --out-&lt;span class=&#34;built_in&#34;&gt;dir&lt;/span&gt; /content/mmdetection3d/result/&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;25&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.imshow(plt.imread(&lt;span class=&#34;string&#34;&gt;&amp;#x27;result/n015-2018-07-24-11-22-45+0800__CAM_BACK__1532402927637525/n015-2018-07-24-11-22-45+0800__CAM_BACK__1532402927637525_pred.png&amp;#x27;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;--2022-06-23 18:06:22--  https://download.openmmlab.com/mmdetection3d/v0.1.0_models/fcos3d/fcos3d_r101_caffe_fpn_gn-head_dcn_2x8_1x_nus-mono3d/fcos3d_r101_caffe_fpn_gn-head_dcn_2x8_1x_nus-mono3d_20210715_235813-4bed5239.pth
Resolving download.openmmlab.com (download.openmmlab.com)... 47.74.197.77
Connecting to download.openmmlab.com (download.openmmlab.com)|47.74.197.77|:443... connected.
HTTP request sent, awaiting response... 200 OK

    The file is already fully retrieved; nothing to do.

/content/mmdetection3d/mmdet3d/models/backbones/mink_resnet.py:10: UserWarning: Please follow `getting_started.md` to install MinkowskiEngine.`
  &#39;Please follow `getting_started.md` to install MinkowskiEngine.`&#39;)
load checkpoint from local path: checkpoints/fcos3d_r101_caffe_fpn_gn-head_dcn_2x8_1x_nus-mono3d_20210715_235813-4bed5239.pth
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
[0m




&amp;lt;matplotlib.image.AxesImage at 0x7f7100999a50&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;MM-Detection_files/MM-Detection_30_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;ç‚¹äº‘-Segment&#34;&gt;ç‚¹äº‘-Segment&lt;/h4&gt;
&lt;p&gt;ç”±äºå›¾åƒ/è§†é¢‘å¾ˆéš¾åšåˆ°å®šä½ä»¥åŠæµ‹è·çš„ç›®æ ‡, ç›®å‰åš segmentation åªèƒ½ç”¨ç‚¹äº‘, è€Œä¸”ç›®å‰çš„æ¨¡å‹ä»…æ”¯æŒå®¤å†…&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;!wget -c https://download.openmmlab.com/mmdetection3d/v0&lt;span class=&#34;number&#34;&gt;.1&lt;/span&gt;&lt;span class=&#34;number&#34;&gt;.0&lt;/span&gt;_models/pointnet2/pointnet2_ssg_16x2_cosine_200e_scannet_seg-3d-&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt;/pointnet2_ssg_16x2_cosine_200e_scannet_seg-3d-&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;class_20210514_143644-ee73704a.pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      -O checkpoints/pointnet2_ssg_16x2_cosine_200e_scannet_seg-3d-&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;class_20210514_143644-ee73704a.pth&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!python \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/pc_seg_demo.py \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  demo/data/scannet/scene0000_00.&lt;span class=&#34;built_in&#34;&gt;bin&lt;/span&gt; \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  configs/pointnet2/pointnet2_ssg_16x2_cosine_200e_scannet_seg-3d-&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt;.py \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  checkpoints/pointnet2_ssg_16x2_cosine_200e_scannet_seg-3d-&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;class_20210514_143644-ee73704a.pth \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  --out-&lt;span class=&#34;built_in&#34;&gt;dir&lt;/span&gt; /content/mmdetection3d/result/&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;--2022-06-20 17:28:15--  https://download.openmmlab.com/mmdetection3d/v0.1.0_models/pointnet2/pointnet2_ssg_16x2_cosine_200e_scannet_seg-3d-20class/pointnet2_ssg_16x2_cosine_200e_scannet_seg-3d-20class_20210514_143644-ee73704a.pth
Resolving download.openmmlab.com (download.openmmlab.com)... 47.88.36.72
Connecting to download.openmmlab.com (download.openmmlab.com)|47.88.36.72|:443... connected.
HTTP request sent, awaiting response... 200 OK

    The file is already fully retrieved; nothing to do.

/content/mmdetection3d/mmdet3d/models/backbones/mink_resnet.py:10: UserWarning: Please follow `getting_started.md` to install MinkowskiEngine.`
  &#39;Please follow `getting_started.md` to install MinkowskiEngine.`&#39;)
/usr/local/lib/python3.7/dist-packages/mmseg/models/losses/cross_entropy_loss.py:236: UserWarning: Default ``avg_non_ignore`` is False, if you would like to ignore the certain label and average loss over non-ignore labels, which is the same with PyTorch official cross_entropy, set ``avg_non_ignore=True``.
  &#39;Default ``avg_non_ignore`` is False, if you would like to &#39;
/usr/local/lib/python3.7/dist-packages/mmcv/cnn/bricks/conv_module.py:151: UserWarning: Unnecessary conv bias before batch/instance norm
  &#39;Unnecessary conv bias before batch/instance norm&#39;)
load checkpoint from local path: checkpoints/pointnet2_ssg_16x2_cosine_200e_scannet_seg-3d-20class_20210514_143644-ee73704a.pth
/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)
[0m
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;å€Ÿç‰©è¡¨&#34;&gt;å€Ÿç‰©è¡¨&lt;/h2&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-1&#39; href=&#39;#cite_ref-1&#39;&gt;[1]&lt;/a&gt;: &lt;a href=&#34;https://openbayes.com/console/wrh/containers/t93t3LTXlgU&#34;&gt;https://openbayes.com/console/wrh/containers/t93t3LTXlgU&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-2&#39; href=&#39;#cite_ref-2&#39;&gt;[2]&lt;/a&gt;: &lt;a href=&#34;https://zhuanlan.zhihu.com/p/163645165&#34;&gt;MMDetection 2.3 å®‰è£…æ•™ç¨‹&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-3&#39; href=&#39;#cite_ref-3&#39;&gt;[3]&lt;/a&gt;: &lt;a href=&#34;https://mmdetection.readthedocs.io/zh_CN/latest/get_started.html#mmdetection&#34;&gt;https://mmdetection.readthedocs.io/zh_CN/latest/get_started.html#mmdetection&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-4&#39; href=&#39;#cite_ref-4&#39;&gt;[4]&lt;/a&gt;: &lt;a href=&#34;https://colab.research.google.com/github/ZwwWayne/mmdetection/blob/update-colab/demo/MMDet_Tutorial.ipynb#scrollTo=8M5KUnX7Np3h&#34;&gt;https://colab.research.google.com/github/ZwwWayne/mmdetection/blob/update-colab/demo/MMDet_Tutorial.ipynb#scrollTo=8M5KUnX7Np3h&lt;/a&gt;&lt;/p&gt;
&lt;script type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/kity@2.0.4/dist/kity.min.js&#34;&gt;&lt;/script&gt;&lt;script type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js&#34;&gt;&lt;/script&gt;&lt;script defer=&#34;true&#34; type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js&#34;&gt;&lt;/script&gt;&lt;link rel=&#34;stylesheet&#34; type=&#34;text&amp;#x2F;css&#34; href=&#34;https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css&#34;&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://weidows.github.io/post/lang/python/code/DL/</guid>
            <title>ğŸ‘©â€â¤ï¸â€ğŸ’‹â€ğŸ‘¨Code-4-Deep-Learning</title>
            <link>https://weidows.github.io/post/lang/python/code/DL/</link>
            <category>äººå·¥æ™ºèƒ½</category>
            <category>æ·±åº¦å­¦ä¹ </category>
            <category>python</category>
            <pubDate>Wed, 20 Apr 2022 16:26:11 +0000</pubDate>
            <description><![CDATA[ &lt;!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @LastEditors: Weidows
 * @LastEditTime: 2024-08-07 12:54:47
 * @FilePath: \Blog-private\source\_posts\python\code\DL.md
 * @Description:
 * @!: *********************************************************************
--&gt;
&lt;h2 id=&#34;åº&#34;&gt;åº&lt;/h2&gt;
&lt;p&gt;æ­¤æ–‡ä¸ºå…¶ä»–æ–‡ç« çš„ä»£ç éƒ¨åˆ†:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;../../AI/DL&#34;&gt;âš¡å†å•ƒ-Deep-Learning&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¹Ÿæä¾›äº† notebook å½¢å¼: &lt;a href=&#34;https://github.com/Weidows-projects/public-post/blob/main/notebook/DL/DL.ipynb&#34;&gt;ä»£ç åœ°å€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;ç¥ç»ç½‘ç»œ&#34;&gt;ç¥ç»ç½‘ç»œ&lt;/h2&gt;
&lt;h3 id=&#34;æ„ŸçŸ¥å™¨&#34;&gt;æ„ŸçŸ¥å™¨&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;AND&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;x1, x2&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    w1, w2, theta = &lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.7&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    tmp = x1 * w1 + x2 * w2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; tmp &amp;lt;= theta:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;OR&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;x1, x2&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    w1, w2, theta = &lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    tmp = x1 * w1 + x2 * w2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; tmp &amp;lt;= theta:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# éé—¨åªå–ä¸€ä¸ªè¾“å…¥,å¦ä¸€ä¸ªä¸ç®¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;NOT&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;x1, x2&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    w1, w2, theta = -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    tmp = x1 * w1 + x2 * w2 + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; tmp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å¼‚æˆ–é—¨æ˜¯éçº¿æ€§è¿ç®—, éœ€è¦å¤šå±‚æ„ŸçŸ¥å™¨ç»„åˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;XOR&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;x1, x2&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# å¼‚æˆ–é—¨ = (ä¸éé—¨ ä¸ æˆ–é—¨)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; AND(OR(x1, x2), &lt;span class=&#34;keyword&#34;&gt;not&lt;/span&gt; AND(x1, x2))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(AND(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), AND(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), OR(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), OR(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(NOT(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), NOT(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), NOT(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;), NOT(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(XOR(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), XOR(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), XOR(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;), XOR(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;0 1 1 0
1 0 1 0
1 0 0 1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;Pytorch&#34;&gt;Pytorch&lt;/h2&gt;
&lt;h3 id=&#34;MNIST-æ‰‹å†™æ•°å­—è¯†åˆ«&#34;&gt;MNIST-æ‰‹å†™æ•°å­—è¯†åˆ«&lt;/h3&gt;
&lt;p&gt;å…¥é—¨å…¸ä¸­å…¸ &lt;sup id=&#39;cite_ref-1&#39;&gt;&lt;a href=&#34;#cite_note-1&#34;&gt;[1]&lt;/a&gt;&lt;/sup&gt;, å…·ä½“æ•™ç¨‹æ¨è &lt;sup id=&#39;cite_ref-2&#39;&gt;&lt;a href=&#34;#cite_note-2&#34;&gt;[2]&lt;/a&gt;&lt;/sup&gt; &lt;sup id=&#39;cite_ref-3&#39;&gt;&lt;a href=&#34;#cite_note-3&#34;&gt;[3]&lt;/a&gt;&lt;/sup&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; torch&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; torchvision&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; torch.utils.data &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; DataLoader&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è¶…å‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;n_epochs = &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;batch_size_train = &lt;span class=&#34;number&#34;&gt;64&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;batch_size_test = &lt;span class=&#34;number&#34;&gt;1000&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;learning_rate = &lt;span class=&#34;number&#34;&gt;0.01&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;momentum = &lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;log_interval = &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;random_seed = &lt;span class=&#34;number&#34;&gt;42&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;torch.manual_seed(random_seed)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;MINST_mean = &lt;span class=&#34;number&#34;&gt;0.1307&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;MINST_std = &lt;span class=&#34;number&#34;&gt;0.3081&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train_loader = torch.utils.data.DataLoader(torchvision.datasets.MNIST(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    train=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    download=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    transform=torchvision.transforms.Compose([&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        torchvision.transforms.ToTensor(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        torchvision.transforms.Normalize((MINST_mean, ), (MINST_std, ))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ])),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                           batch_size=batch_size_train,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                           shuffle=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;test_loader = torch.utils.data.DataLoader(torchvision.datasets.MNIST(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    train=&lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    download=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    transform=torchvision.transforms.Compose([&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        torchvision.transforms.ToTensor(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        torchvision.transforms.Normalize((MINST_mean, ), (MINST_std, ))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ])),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                          batch_size=batch_size_test,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                          shuffle=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;batch_idx, (example_data, example_targets) = &lt;span class=&#34;built_in&#34;&gt;next&lt;/span&gt;(&lt;span class=&#34;built_in&#34;&gt;enumerate&lt;/span&gt;(train_loader))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ¯æ‰¹æ¬¡æœ‰ 64 å¼ å•é€šé“ 28x28 å¤§å°çš„å›¾ç‰‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(example_data.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ¯ä¸ªå›¾ç‰‡å®é™…çš„æ•°å­—æ ‡ç­¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(example_targets)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fig = plt.figure()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;9&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.subplot(&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, i + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.tight_layout()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.imshow(example_data[i][&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], cmap=&lt;span class=&#34;string&#34;&gt;&amp;#x27;gray&amp;#x27;&lt;/span&gt;, interpolation=&lt;span class=&#34;string&#34;&gt;&amp;#x27;none&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# plt.title(&amp;quot;æ•°å­—: &amp;#123;&amp;#125;&amp;quot;.format(example_targets[i]))&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.title(&lt;span class=&#34;string&#34;&gt;f&amp;#x27;number: &lt;span class=&#34;subst&#34;&gt;&amp;#123;example_targets[i]&amp;#125;&lt;/span&gt;&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.xticks([])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.yticks([])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;torch.Size([64, 1, 28, 28])
tensor([1, 2, 8, 5, 2, 6, 9, 9, 9, 4, 0, 3, 9, 9, 5, 6, 7, 8, 8, 9, 2, 6, 9, 3,
        0, 5, 0, 7, 6, 1, 2, 0, 7, 4, 6, 0, 6, 9, 7, 0, 7, 3, 2, 5, 9, 0, 4, 8,
        3, 6, 4, 0, 3, 2, 6, 6, 3, 2, 2, 3, 6, 7, 8, 4])
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;DL_files/DL_4_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; torch.nn &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; nn&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; torch.nn.functional &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; F&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; torch.optim &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; optim&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;Net&lt;/span&gt;(nn.Module):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;__init__&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;built_in&#34;&gt;super&lt;/span&gt;(Net, &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;).__init__()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# å·ç§¯å±‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.conv1 = nn.Conv2d(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, kernel_size=&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.conv2 = nn.Conv2d(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;, kernel_size=&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# åŠ ä¸€å±‚ dropout (åˆ é™¤ç¥ç»å…ƒ), é˜²æ­¢è¿‡æ‹Ÿåˆ; ä¸è¦ç›´æ¥ç”¨ F.dropout2d&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.conv2_drop = nn.Dropout2d()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# å…¨è¿æ¥å±‚&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.fc1 = nn.Linear(&lt;span class=&#34;number&#34;&gt;320&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.fc2 = nn.Linear(&lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;forward&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self, x&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# åŸ28x28x1 -&amp;gt; å·ç§¯24x24x10 -&amp;gt; æ± åŒ–12x12x10 -&amp;gt; æ¿€æ´»12x12x10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        x = F.relu(F.max_pool2d(&lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.conv1(x), &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# åŸ12x12x10 -&amp;gt; å·ç§¯8x8x20 -&amp;gt; æ± åŒ–4x4x20 -&amp;gt; æ¿€æ´»4x4x20&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        x = F.relu(F.max_pool2d(&lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.conv2_drop(&lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.conv2(x)), &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# 320 = 4x4x20 å°†å¼ é‡xå˜å½¢æˆä¸€ç»´å‘é‡å½¢å¼ï¼Œæ€»ç‰¹å¾æ•°ä¸å˜ï¼Œä¸ºå…¨è¿æ¥å±‚åšå‡†å¤‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        x = x.view(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;320&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        x = F.relu(&lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.fc1(x))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        x = F.dropout(x, training=&lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.training)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        x = &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.fc2(x)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; F.log_softmax(x)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;network = Net()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;optimizer = optim.SGD(network.parameters(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                      lr=learning_rate,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                      momentum=momentum)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train_losses = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train_counter = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;test_losses = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;test_counter = [i * &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(train_loader.dataset) &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(n_epochs + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;train&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;epoch&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    network.train()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; batch_idx, (data, target) &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;enumerate&lt;/span&gt;(train_loader):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        optimizer.zero_grad()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        output = network(data)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        loss = F.nll_loss(output, target)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        loss.backward()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        optimizer.step()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; batch_idx % log_interval == &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Train Epoch: &amp;#123;&amp;#125; [&amp;#123;&amp;#125;/&amp;#123;&amp;#125; (&amp;#123;:.0f&amp;#125;%)]\tLoss: &amp;#123;:.6f&amp;#125;&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;built_in&#34;&gt;format&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                epoch + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, batch_idx * &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(data), &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(train_loader.dataset),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;number&#34;&gt;100.&lt;/span&gt; * batch_idx / &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(train_loader), loss.item()))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            train_losses.append(loss.item())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            train_counter.append((batch_idx * &lt;span class=&#34;number&#34;&gt;64&lt;/span&gt;) +&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                 (epoch * &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(train_loader.dataset)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            torch.save(network.state_dict(), &lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/MNIST/model.pth&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            torch.save(optimizer.state_dict(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                       &lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/MNIST/optimizer.pth&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;test&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    network.&lt;span class=&#34;built_in&#34;&gt;eval&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    test_loss = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    correct = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# æµ‹è¯•é›†ä¸éœ€è¦åå‘ä¼ æ’­ï¼Œæ‰€ä»¥ä½¿ç”¨ torch.no_grad() æ–¹æ³•å…³é—­è®¡ç®—å›¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;with&lt;/span&gt; torch.no_grad():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; data, target &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; test_loader:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            output = network(data)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            test_loss += F.nll_loss(output, target, reduction=&lt;span class=&#34;string&#34;&gt;&amp;#x27;sum&amp;#x27;&lt;/span&gt;).item()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            pred = output.data.&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, keepdim=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            correct += pred.eq(target.data.view_as(pred)).&lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    test_loss /= &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(test_loader.dataset)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    test_losses.append(test_loss)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;\nTest set: Avg. loss: &amp;#123;:.4f&amp;#125;, Accuracy: &amp;#123;&amp;#125;/&amp;#123;&amp;#125; (&amp;#123;:.0f&amp;#125;%)\n&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;built_in&#34;&gt;format&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        test_loss, correct, &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(test_loader.dataset),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;number&#34;&gt;100.&lt;/span&gt; * correct / &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(test_loader.dataset)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; __name__ == &lt;span class=&#34;string&#34;&gt;&amp;#x27;__main__&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# train(0)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# ä¸åŠ è¿™ä¸ªï¼Œåé¢ç”»å›¾å°±ä¼šæŠ¥é”™ï¼šx and y must be the same size&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    test()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; epoch &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(n_epochs):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        train(epoch)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        test()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;C:\Users\Administrator\AppData\Local\Temp\ipykernel_18752\2337744027.py:29: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  return F.log_softmax(x)


Train Epoch: 1 [0/60000 (0%)]	Loss: 2.306355
Train Epoch: 1 [640/60000 (1%)]	Loss: 2.309732
Train Epoch: 1 [1280/60000 (2%)]	Loss: 2.263060
Train Epoch: 1 [1920/60000 (3%)]	Loss: 2.253021
Train Epoch: 1 [2560/60000 (4%)]	Loss: 2.239486
Train Epoch: 1 [3200/60000 (5%)]	Loss: 2.232780
Train Epoch: 1 [3840/60000 (6%)]	Loss: 2.223558
Train Epoch: 1 [4480/60000 (7%)]	Loss: 2.174626
Train Epoch: 1 [5120/60000 (9%)]	Loss: 2.122881
Train Epoch: 1 [5760/60000 (10%)]	Loss: 2.025848
Train Epoch: 1 [6400/60000 (11%)]	Loss: 1.923471
Train Epoch: 1 [7040/60000 (12%)]	Loss: 1.832063
Train Epoch: 1 [7680/60000 (13%)]	Loss: 1.906025
Train Epoch: 1 [8320/60000 (14%)]	Loss: 1.673950
Train Epoch: 1 [8960/60000 (15%)]	Loss: 1.537203
Train Epoch: 1 [9600/60000 (16%)]	Loss: 1.439621
Train Epoch: 1 [10240/60000 (17%)]	Loss: 1.275429
Train Epoch: 1 [10880/60000 (18%)]	Loss: 1.183242
Train Epoch: 1 [11520/60000 (19%)]	Loss: 1.182200
Train Epoch: 1 [12160/60000 (20%)]	Loss: 1.154036
Train Epoch: 1 [12800/60000 (21%)]	Loss: 0.921464
Train Epoch: 1 [13440/60000 (22%)]	Loss: 0.877538
Train Epoch: 1 [14080/60000 (23%)]	Loss: 0.917646
Train Epoch: 1 [14720/60000 (25%)]	Loss: 0.928683
Train Epoch: 1 [15360/60000 (26%)]	Loss: 0.883320
Train Epoch: 1 [16000/60000 (27%)]	Loss: 0.829271
Train Epoch: 1 [16640/60000 (28%)]	Loss: 0.843372
Train Epoch: 1 [17280/60000 (29%)]	Loss: 0.962177
Train Epoch: 1 [17920/60000 (30%)]	Loss: 0.816695
Train Epoch: 1 [18560/60000 (31%)]	Loss: 0.803838
Train Epoch: 1 [19200/60000 (32%)]	Loss: 0.706732
Train Epoch: 1 [19840/60000 (33%)]	Loss: 0.697531
Train Epoch: 1 [20480/60000 (34%)]	Loss: 0.748919
Train Epoch: 1 [21120/60000 (35%)]	Loss: 0.599384
Train Epoch: 1 [21760/60000 (36%)]	Loss: 0.873525
Train Epoch: 1 [22400/60000 (37%)]	Loss: 0.730187
Train Epoch: 1 [23040/60000 (38%)]	Loss: 0.780188
Train Epoch: 1 [23680/60000 (39%)]	Loss: 0.688149
Train Epoch: 1 [24320/60000 (41%)]	Loss: 0.578381
Train Epoch: 1 [24960/60000 (42%)]	Loss: 0.679022
Train Epoch: 1 [25600/60000 (43%)]	Loss: 0.597318
Train Epoch: 1 [26240/60000 (44%)]	Loss: 0.885319
Train Epoch: 1 [26880/60000 (45%)]	Loss: 0.586243
Train Epoch: 1 [27520/60000 (46%)]	Loss: 0.832649
Train Epoch: 1 [28160/60000 (47%)]	Loss: 0.541850
Train Epoch: 1 [28800/60000 (48%)]	Loss: 0.997807
Train Epoch: 1 [29440/60000 (49%)]	Loss: 0.680030
Train Epoch: 1 [30080/60000 (50%)]	Loss: 0.546325
Train Epoch: 1 [30720/60000 (51%)]	Loss: 0.812084
Train Epoch: 1 [31360/60000 (52%)]	Loss: 0.659495
Train Epoch: 1 [32000/60000 (53%)]	Loss: 0.880883
Train Epoch: 1 [32640/60000 (54%)]	Loss: 0.788217
Train Epoch: 1 [33280/60000 (55%)]	Loss: 0.810931
Train Epoch: 1 [33920/60000 (57%)]	Loss: 0.572216
Train Epoch: 1 [34560/60000 (58%)]	Loss: 0.481873
Train Epoch: 1 [35200/60000 (59%)]	Loss: 0.502513
Train Epoch: 1 [35840/60000 (60%)]	Loss: 0.410055
Train Epoch: 1 [36480/60000 (61%)]	Loss: 0.489813
Train Epoch: 1 [37120/60000 (62%)]	Loss: 0.507667
Train Epoch: 1 [37760/60000 (63%)]	Loss: 0.497175
Train Epoch: 1 [38400/60000 (64%)]	Loss: 0.433524
Train Epoch: 1 [39040/60000 (65%)]	Loss: 0.448550
Train Epoch: 1 [39680/60000 (66%)]	Loss: 0.451818
Train Epoch: 1 [40320/60000 (67%)]	Loss: 0.501129
Train Epoch: 1 [40960/60000 (68%)]	Loss: 0.605211
Train Epoch: 1 [41600/60000 (69%)]	Loss: 0.332027
Train Epoch: 1 [42240/60000 (70%)]	Loss: 0.483988
Train Epoch: 1 [42880/60000 (71%)]	Loss: 0.887791
Train Epoch: 1 [43520/60000 (72%)]	Loss: 0.273152
Train Epoch: 1 [44160/60000 (74%)]	Loss: 0.590317
Train Epoch: 1 [44800/60000 (75%)]	Loss: 0.459316
Train Epoch: 1 [45440/60000 (76%)]	Loss: 0.492083
Train Epoch: 1 [46080/60000 (77%)]	Loss: 0.477218
Train Epoch: 1 [46720/60000 (78%)]	Loss: 0.421333
Train Epoch: 1 [47360/60000 (79%)]	Loss: 0.576612
Train Epoch: 1 [48000/60000 (80%)]	Loss: 0.359032
Train Epoch: 1 [48640/60000 (81%)]	Loss: 0.434221
Train Epoch: 1 [49280/60000 (82%)]	Loss: 0.506898
Train Epoch: 1 [49920/60000 (83%)]	Loss: 0.342816
Train Epoch: 1 [50560/60000 (84%)]	Loss: 0.287471
Train Epoch: 1 [51200/60000 (85%)]	Loss: 0.250604
Train Epoch: 1 [51840/60000 (86%)]	Loss: 0.386828
Train Epoch: 1 [52480/60000 (87%)]	Loss: 0.331759
Train Epoch: 1 [53120/60000 (88%)]	Loss: 0.388772
Train Epoch: 1 [53760/60000 (90%)]	Loss: 0.509017
Train Epoch: 1 [54400/60000 (91%)]	Loss: 0.517717
Train Epoch: 1 [55040/60000 (92%)]	Loss: 0.393285
Train Epoch: 1 [55680/60000 (93%)]	Loss: 0.341990
Train Epoch: 1 [56320/60000 (94%)]	Loss: 0.434098
Train Epoch: 1 [56960/60000 (95%)]	Loss: 0.342924
Train Epoch: 1 [57600/60000 (96%)]	Loss: 0.617892
Train Epoch: 1 [58240/60000 (97%)]	Loss: 0.488426
Train Epoch: 1 [58880/60000 (98%)]	Loss: 0.356584
Train Epoch: 1 [59520/60000 (99%)]	Loss: 0.548745

Test set: Avg. loss: 0.1674, Accuracy: 9512/10000 (95%)

Train Epoch: 2 [0/60000 (0%)]	Loss: 0.315766
Train Epoch: 2 [640/60000 (1%)]	Loss: 0.468051
Train Epoch: 2 [1280/60000 (2%)]	Loss: 0.464737
Train Epoch: 2 [1920/60000 (3%)]	Loss: 0.357223
Train Epoch: 2 [2560/60000 (4%)]	Loss: 0.317739
Train Epoch: 2 [3200/60000 (5%)]	Loss: 0.684018
Train Epoch: 2 [3840/60000 (6%)]	Loss: 0.464855
Train Epoch: 2 [4480/60000 (7%)]	Loss: 0.420857
Train Epoch: 2 [5120/60000 (9%)]	Loss: 0.508732
Train Epoch: 2 [5760/60000 (10%)]	Loss: 0.318191
Train Epoch: 2 [6400/60000 (11%)]	Loss: 0.346217
Train Epoch: 2 [7040/60000 (12%)]	Loss: 0.559674
Train Epoch: 2 [7680/60000 (13%)]	Loss: 0.409686
Train Epoch: 2 [8320/60000 (14%)]	Loss: 0.535685
Train Epoch: 2 [8960/60000 (15%)]	Loss: 0.480220
Train Epoch: 2 [9600/60000 (16%)]	Loss: 0.519283
Train Epoch: 2 [10240/60000 (17%)]	Loss: 0.329807
Train Epoch: 2 [10880/60000 (18%)]	Loss: 0.393071
Train Epoch: 2 [11520/60000 (19%)]	Loss: 0.444064
Train Epoch: 2 [12160/60000 (20%)]	Loss: 0.533698
Train Epoch: 2 [12800/60000 (21%)]	Loss: 0.511128
Train Epoch: 2 [13440/60000 (22%)]	Loss: 0.346371
Train Epoch: 2 [14080/60000 (23%)]	Loss: 0.307755
Train Epoch: 2 [14720/60000 (25%)]	Loss: 0.536841
Train Epoch: 2 [15360/60000 (26%)]	Loss: 0.310219
Train Epoch: 2 [16000/60000 (27%)]	Loss: 0.493684
Train Epoch: 2 [16640/60000 (28%)]	Loss: 0.395575
Train Epoch: 2 [17280/60000 (29%)]	Loss: 0.252499
Train Epoch: 2 [17920/60000 (30%)]	Loss: 0.238181
Train Epoch: 2 [18560/60000 (31%)]	Loss: 0.323044
Train Epoch: 2 [19200/60000 (32%)]	Loss: 0.421634
Train Epoch: 2 [19840/60000 (33%)]	Loss: 0.409919
Train Epoch: 2 [20480/60000 (34%)]	Loss: 0.325331
Train Epoch: 2 [21120/60000 (35%)]	Loss: 0.396984
Train Epoch: 2 [21760/60000 (36%)]	Loss: 0.395612
Train Epoch: 2 [22400/60000 (37%)]	Loss: 0.378807
Train Epoch: 2 [23040/60000 (38%)]	Loss: 0.368943
Train Epoch: 2 [23680/60000 (39%)]	Loss: 0.525262
Train Epoch: 2 [24320/60000 (41%)]	Loss: 0.227805
Train Epoch: 2 [24960/60000 (42%)]	Loss: 0.278575
Train Epoch: 2 [25600/60000 (43%)]	Loss: 0.404145
Train Epoch: 2 [26240/60000 (44%)]	Loss: 0.467817
Train Epoch: 2 [26880/60000 (45%)]	Loss: 0.279880
Train Epoch: 2 [27520/60000 (46%)]	Loss: 0.539638
Train Epoch: 2 [28160/60000 (47%)]	Loss: 0.257472
Train Epoch: 2 [28800/60000 (48%)]	Loss: 0.220950
Train Epoch: 2 [29440/60000 (49%)]	Loss: 0.448459
Train Epoch: 2 [30080/60000 (50%)]	Loss: 0.280728
Train Epoch: 2 [30720/60000 (51%)]	Loss: 0.321694
Train Epoch: 2 [31360/60000 (52%)]	Loss: 0.234594
Train Epoch: 2 [32000/60000 (53%)]	Loss: 0.249877
Train Epoch: 2 [32640/60000 (54%)]	Loss: 0.443569
Train Epoch: 2 [33280/60000 (55%)]	Loss: 0.358985
Train Epoch: 2 [33920/60000 (57%)]	Loss: 0.350358
Train Epoch: 2 [34560/60000 (58%)]	Loss: 0.240932
Train Epoch: 2 [35200/60000 (59%)]	Loss: 0.400578
Train Epoch: 2 [35840/60000 (60%)]	Loss: 0.451478
Train Epoch: 2 [36480/60000 (61%)]	Loss: 0.366277
Train Epoch: 2 [37120/60000 (62%)]	Loss: 0.464619
Train Epoch: 2 [37760/60000 (63%)]	Loss: 0.219236
Train Epoch: 2 [38400/60000 (64%)]	Loss: 0.310383
Train Epoch: 2 [39040/60000 (65%)]	Loss: 0.318048
Train Epoch: 2 [39680/60000 (66%)]	Loss: 0.598020
Train Epoch: 2 [40320/60000 (67%)]	Loss: 0.248990
Train Epoch: 2 [40960/60000 (68%)]	Loss: 0.153452
Train Epoch: 2 [41600/60000 (69%)]	Loss: 0.155354
Train Epoch: 2 [42240/60000 (70%)]	Loss: 0.249885
Train Epoch: 2 [42880/60000 (71%)]	Loss: 0.198647
Train Epoch: 2 [43520/60000 (72%)]	Loss: 0.394697
Train Epoch: 2 [44160/60000 (74%)]	Loss: 0.450222
Train Epoch: 2 [44800/60000 (75%)]	Loss: 0.202541
Train Epoch: 2 [45440/60000 (76%)]	Loss: 0.268529
Train Epoch: 2 [46080/60000 (77%)]	Loss: 0.348173
Train Epoch: 2 [46720/60000 (78%)]	Loss: 0.359101
Train Epoch: 2 [47360/60000 (79%)]	Loss: 0.522160
Train Epoch: 2 [48000/60000 (80%)]	Loss: 0.488034
Train Epoch: 2 [48640/60000 (81%)]	Loss: 0.350620
Train Epoch: 2 [49280/60000 (82%)]	Loss: 0.523037
Train Epoch: 2 [49920/60000 (83%)]	Loss: 0.124925
Train Epoch: 2 [50560/60000 (84%)]	Loss: 0.299917
Train Epoch: 2 [51200/60000 (85%)]	Loss: 0.302186
Train Epoch: 2 [51840/60000 (86%)]	Loss: 0.323338
Train Epoch: 2 [52480/60000 (87%)]	Loss: 0.256383
Train Epoch: 2 [53120/60000 (88%)]	Loss: 0.313699
Train Epoch: 2 [53760/60000 (90%)]	Loss: 0.442143
Train Epoch: 2 [54400/60000 (91%)]	Loss: 0.234823
Train Epoch: 2 [55040/60000 (92%)]	Loss: 0.356765
Train Epoch: 2 [55680/60000 (93%)]	Loss: 0.425722
Train Epoch: 2 [56320/60000 (94%)]	Loss: 0.260159
Train Epoch: 2 [56960/60000 (95%)]	Loss: 0.307709
Train Epoch: 2 [57600/60000 (96%)]	Loss: 0.368729
Train Epoch: 2 [58240/60000 (97%)]	Loss: 0.554495
Train Epoch: 2 [58880/60000 (98%)]	Loss: 0.151344
Train Epoch: 2 [59520/60000 (99%)]	Loss: 0.332558

Test set: Avg. loss: 0.1095, Accuracy: 9664/10000 (97%)

Train Epoch: 3 [0/60000 (0%)]	Loss: 0.606901
Train Epoch: 3 [640/60000 (1%)]	Loss: 0.217843
Train Epoch: 3 [1280/60000 (2%)]	Loss: 0.225650
Train Epoch: 3 [1920/60000 (3%)]	Loss: 0.359506
Train Epoch: 3 [2560/60000 (4%)]	Loss: 0.380754
Train Epoch: 3 [3200/60000 (5%)]	Loss: 0.283387
Train Epoch: 3 [3840/60000 (6%)]	Loss: 0.318688
Train Epoch: 3 [4480/60000 (7%)]	Loss: 0.335678
Train Epoch: 3 [5120/60000 (9%)]	Loss: 0.157370
Train Epoch: 3 [5760/60000 (10%)]	Loss: 0.220007
Train Epoch: 3 [6400/60000 (11%)]	Loss: 0.291860
Train Epoch: 3 [7040/60000 (12%)]	Loss: 0.464692
Train Epoch: 3 [7680/60000 (13%)]	Loss: 0.229839
Train Epoch: 3 [8320/60000 (14%)]	Loss: 0.342332
Train Epoch: 3 [8960/60000 (15%)]	Loss: 0.313431
Train Epoch: 3 [9600/60000 (16%)]	Loss: 0.341073
Train Epoch: 3 [10240/60000 (17%)]	Loss: 0.208354
Train Epoch: 3 [10880/60000 (18%)]	Loss: 0.188568
Train Epoch: 3 [11520/60000 (19%)]	Loss: 0.213437
Train Epoch: 3 [12160/60000 (20%)]	Loss: 0.327615
Train Epoch: 3 [12800/60000 (21%)]	Loss: 0.240687
Train Epoch: 3 [13440/60000 (22%)]	Loss: 0.347590
Train Epoch: 3 [14080/60000 (23%)]	Loss: 0.367349
Train Epoch: 3 [14720/60000 (25%)]	Loss: 0.270027
Train Epoch: 3 [15360/60000 (26%)]	Loss: 0.549701
Train Epoch: 3 [16000/60000 (27%)]	Loss: 0.265491
Train Epoch: 3 [16640/60000 (28%)]	Loss: 0.264681
Train Epoch: 3 [17280/60000 (29%)]	Loss: 0.259617
Train Epoch: 3 [17920/60000 (30%)]	Loss: 0.193016
Train Epoch: 3 [18560/60000 (31%)]	Loss: 0.405925
Train Epoch: 3 [19200/60000 (32%)]	Loss: 0.230640
Train Epoch: 3 [19840/60000 (33%)]	Loss: 0.298929
Train Epoch: 3 [20480/60000 (34%)]	Loss: 0.508493
Train Epoch: 3 [21120/60000 (35%)]	Loss: 0.253897
Train Epoch: 3 [21760/60000 (36%)]	Loss: 0.201565
Train Epoch: 3 [22400/60000 (37%)]	Loss: 0.276484
Train Epoch: 3 [23040/60000 (38%)]	Loss: 0.447977
Train Epoch: 3 [23680/60000 (39%)]	Loss: 0.542686
Train Epoch: 3 [24320/60000 (41%)]	Loss: 0.340117
Train Epoch: 3 [24960/60000 (42%)]	Loss: 0.238209
Train Epoch: 3 [25600/60000 (43%)]	Loss: 0.151151
Train Epoch: 3 [26240/60000 (44%)]	Loss: 0.365213
Train Epoch: 3 [26880/60000 (45%)]	Loss: 0.362948
Train Epoch: 3 [27520/60000 (46%)]	Loss: 0.237704
Train Epoch: 3 [28160/60000 (47%)]	Loss: 0.398583
Train Epoch: 3 [28800/60000 (48%)]	Loss: 0.397255
Train Epoch: 3 [29440/60000 (49%)]	Loss: 0.262200
Train Epoch: 3 [30080/60000 (50%)]	Loss: 0.152108
Train Epoch: 3 [30720/60000 (51%)]	Loss: 0.372339
Train Epoch: 3 [31360/60000 (52%)]	Loss: 0.372472
Train Epoch: 3 [32000/60000 (53%)]	Loss: 0.259656
Train Epoch: 3 [32640/60000 (54%)]	Loss: 0.435441
Train Epoch: 3 [33280/60000 (55%)]	Loss: 0.378388
Train Epoch: 3 [33920/60000 (57%)]	Loss: 0.177515
Train Epoch: 3 [34560/60000 (58%)]	Loss: 0.283689
Train Epoch: 3 [35200/60000 (59%)]	Loss: 0.131174
Train Epoch: 3 [35840/60000 (60%)]	Loss: 0.171783
Train Epoch: 3 [36480/60000 (61%)]	Loss: 0.104585
Train Epoch: 3 [37120/60000 (62%)]	Loss: 0.389055
Train Epoch: 3 [37760/60000 (63%)]	Loss: 0.360526
Train Epoch: 3 [38400/60000 (64%)]	Loss: 0.259271
Train Epoch: 3 [39040/60000 (65%)]	Loss: 0.525336
Train Epoch: 3 [39680/60000 (66%)]	Loss: 0.196208
Train Epoch: 3 [40320/60000 (67%)]	Loss: 0.374461
Train Epoch: 3 [40960/60000 (68%)]	Loss: 0.216166
Train Epoch: 3 [41600/60000 (69%)]	Loss: 0.221857
Train Epoch: 3 [42240/60000 (70%)]	Loss: 0.223318
Train Epoch: 3 [42880/60000 (71%)]	Loss: 0.185287
Train Epoch: 3 [43520/60000 (72%)]	Loss: 0.382659
Train Epoch: 3 [44160/60000 (74%)]	Loss: 0.262684
Train Epoch: 3 [44800/60000 (75%)]	Loss: 0.388742
Train Epoch: 3 [45440/60000 (76%)]	Loss: 0.286496
Train Epoch: 3 [46080/60000 (77%)]	Loss: 0.301708
Train Epoch: 3 [46720/60000 (78%)]	Loss: 0.451360
Train Epoch: 3 [47360/60000 (79%)]	Loss: 0.279125
Train Epoch: 3 [48000/60000 (80%)]	Loss: 0.197034
Train Epoch: 3 [48640/60000 (81%)]	Loss: 0.240700
Train Epoch: 3 [49280/60000 (82%)]	Loss: 0.594597
Train Epoch: 3 [49920/60000 (83%)]	Loss: 0.108885
Train Epoch: 3 [50560/60000 (84%)]	Loss: 0.199601
Train Epoch: 3 [51200/60000 (85%)]	Loss: 0.184297
Train Epoch: 3 [51840/60000 (86%)]	Loss: 0.175885
Train Epoch: 3 [52480/60000 (87%)]	Loss: 0.365624
Train Epoch: 3 [53120/60000 (88%)]	Loss: 0.236363
Train Epoch: 3 [53760/60000 (90%)]	Loss: 0.508030
Train Epoch: 3 [54400/60000 (91%)]	Loss: 0.379145
Train Epoch: 3 [55040/60000 (92%)]	Loss: 0.304528
Train Epoch: 3 [55680/60000 (93%)]	Loss: 0.184158
Train Epoch: 3 [56320/60000 (94%)]	Loss: 0.323510
Train Epoch: 3 [56960/60000 (95%)]	Loss: 0.192909
Train Epoch: 3 [57600/60000 (96%)]	Loss: 0.275473
Train Epoch: 3 [58240/60000 (97%)]	Loss: 0.397780
Train Epoch: 3 [58880/60000 (98%)]	Loss: 0.159153
Train Epoch: 3 [59520/60000 (99%)]	Loss: 0.231473

Test set: Avg. loss: 0.0909, Accuracy: 9709/10000 (97%)
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;15&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(train_counter, train_losses, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;blue&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.scatter(test_counter, test_losses, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;red&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.legend([&lt;span class=&#34;string&#34;&gt;&amp;#x27;Train Loss&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Test Loss&amp;#x27;&lt;/span&gt;], loc=&lt;span class=&#34;string&#34;&gt;&amp;#x27;upper right&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;number of training examples seen&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;negative log likelihood loss&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;DL_files/DL_6_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;continued_network = Net()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;continued_optimizer = optim.SGD(network.parameters(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                lr=learning_rate,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                momentum=momentum)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;network_state_dict = torch.load(&lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/MNIST/model.pth&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;continued_network.load_state_dict(network_state_dict)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;optimizer_state_dict = torch.load(&lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/MNIST/optimizer.pth&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;continued_optimizer.load_state_dict(optimizer_state_dict)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;9&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    train(i)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    test()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    test_counter.append(i * &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(train_loader.dataset))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;C:\Users\Administrator\AppData\Local\Temp\ipykernel_18752\2337744027.py:29: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  return F.log_softmax(x)


Train Epoch: 4 [0/60000 (0%)]	Loss: 0.180916
Train Epoch: 4 [640/60000 (1%)]	Loss: 0.188782
Train Epoch: 4 [1280/60000 (2%)]	Loss: 0.250786
Train Epoch: 4 [1920/60000 (3%)]	Loss: 0.185484
Train Epoch: 4 [2560/60000 (4%)]	Loss: 0.295455
Train Epoch: 4 [3200/60000 (5%)]	Loss: 0.172000
Train Epoch: 4 [3840/60000 (6%)]	Loss: 0.117650
Train Epoch: 4 [4480/60000 (7%)]	Loss: 0.423349
Train Epoch: 4 [5120/60000 (9%)]	Loss: 0.285250
Train Epoch: 4 [5760/60000 (10%)]	Loss: 0.360192
Train Epoch: 4 [6400/60000 (11%)]	Loss: 0.362748
Train Epoch: 4 [7040/60000 (12%)]	Loss: 0.292238
Train Epoch: 4 [7680/60000 (13%)]	Loss: 0.238687
Train Epoch: 4 [8320/60000 (14%)]	Loss: 0.150868
Train Epoch: 4 [8960/60000 (15%)]	Loss: 0.427452
Train Epoch: 4 [9600/60000 (16%)]	Loss: 0.230040
Train Epoch: 4 [10240/60000 (17%)]	Loss: 0.275437
Train Epoch: 4 [10880/60000 (18%)]	Loss: 0.158874
Train Epoch: 4 [11520/60000 (19%)]	Loss: 0.162058
Train Epoch: 4 [12160/60000 (20%)]	Loss: 0.177609
Train Epoch: 4 [12800/60000 (21%)]	Loss: 0.416331
Train Epoch: 4 [13440/60000 (22%)]	Loss: 0.255415
Train Epoch: 4 [14080/60000 (23%)]	Loss: 0.150464
Train Epoch: 4 [14720/60000 (25%)]	Loss: 0.285846
Train Epoch: 4 [15360/60000 (26%)]	Loss: 0.175966
Train Epoch: 4 [16000/60000 (27%)]	Loss: 0.385556
Train Epoch: 4 [16640/60000 (28%)]	Loss: 0.217486
Train Epoch: 4 [17280/60000 (29%)]	Loss: 0.243101
Train Epoch: 4 [17920/60000 (30%)]	Loss: 0.182876
Train Epoch: 4 [18560/60000 (31%)]	Loss: 0.094987
Train Epoch: 4 [19200/60000 (32%)]	Loss: 0.225338
Train Epoch: 4 [19840/60000 (33%)]	Loss: 0.145325
Train Epoch: 4 [20480/60000 (34%)]	Loss: 0.165757
Train Epoch: 4 [21120/60000 (35%)]	Loss: 0.218088
Train Epoch: 4 [21760/60000 (36%)]	Loss: 0.085633
Train Epoch: 4 [22400/60000 (37%)]	Loss: 0.122317
Train Epoch: 4 [23040/60000 (38%)]	Loss: 0.272857
Train Epoch: 4 [23680/60000 (39%)]	Loss: 0.155769
Train Epoch: 4 [24320/60000 (41%)]	Loss: 0.212894
Train Epoch: 4 [24960/60000 (42%)]	Loss: 0.117393
Train Epoch: 4 [25600/60000 (43%)]	Loss: 0.211204
Train Epoch: 4 [26240/60000 (44%)]	Loss: 0.071398
Train Epoch: 4 [26880/60000 (45%)]	Loss: 0.091613
Train Epoch: 4 [27520/60000 (46%)]	Loss: 0.267689
Train Epoch: 4 [28160/60000 (47%)]	Loss: 0.194783
Train Epoch: 4 [28800/60000 (48%)]	Loss: 0.207981
Train Epoch: 4 [29440/60000 (49%)]	Loss: 0.367123
Train Epoch: 4 [30080/60000 (50%)]	Loss: 0.179464
Train Epoch: 4 [30720/60000 (51%)]	Loss: 0.204890
Train Epoch: 4 [31360/60000 (52%)]	Loss: 0.219245
Train Epoch: 4 [32000/60000 (53%)]	Loss: 0.229217
Train Epoch: 4 [32640/60000 (54%)]	Loss: 0.139216
Train Epoch: 4 [33280/60000 (55%)]	Loss: 0.300938
Train Epoch: 4 [33920/60000 (57%)]	Loss: 0.133212
Train Epoch: 4 [34560/60000 (58%)]	Loss: 0.352936
Train Epoch: 4 [35200/60000 (59%)]	Loss: 0.153349
Train Epoch: 4 [35840/60000 (60%)]	Loss: 0.208317
Train Epoch: 4 [36480/60000 (61%)]	Loss: 0.164447
Train Epoch: 4 [37120/60000 (62%)]	Loss: 0.227367
Train Epoch: 4 [37760/60000 (63%)]	Loss: 0.241028
Train Epoch: 4 [38400/60000 (64%)]	Loss: 0.307894
Train Epoch: 4 [39040/60000 (65%)]	Loss: 0.461609
Train Epoch: 4 [39680/60000 (66%)]	Loss: 0.381326
Train Epoch: 4 [40320/60000 (67%)]	Loss: 0.135251
Train Epoch: 4 [40960/60000 (68%)]	Loss: 0.518683
Train Epoch: 4 [41600/60000 (69%)]	Loss: 0.210409
Train Epoch: 4 [42240/60000 (70%)]	Loss: 0.187576
Train Epoch: 4 [42880/60000 (71%)]	Loss: 0.115259
Train Epoch: 4 [43520/60000 (72%)]	Loss: 0.259883
Train Epoch: 4 [44160/60000 (74%)]	Loss: 0.177242
Train Epoch: 4 [44800/60000 (75%)]	Loss: 0.345635
Train Epoch: 4 [45440/60000 (76%)]	Loss: 0.213670
Train Epoch: 4 [46080/60000 (77%)]	Loss: 0.193606
Train Epoch: 4 [46720/60000 (78%)]	Loss: 0.173757
Train Epoch: 4 [47360/60000 (79%)]	Loss: 0.215879
Train Epoch: 4 [48000/60000 (80%)]	Loss: 0.171952
Train Epoch: 4 [48640/60000 (81%)]	Loss: 0.119270
Train Epoch: 4 [49280/60000 (82%)]	Loss: 0.324480
Train Epoch: 4 [49920/60000 (83%)]	Loss: 0.104771
Train Epoch: 4 [50560/60000 (84%)]	Loss: 0.163072
Train Epoch: 4 [51200/60000 (85%)]	Loss: 0.160245
Train Epoch: 4 [51840/60000 (86%)]	Loss: 0.249122
Train Epoch: 4 [52480/60000 (87%)]	Loss: 0.282949
Train Epoch: 4 [53120/60000 (88%)]	Loss: 0.152365
Train Epoch: 4 [53760/60000 (90%)]	Loss: 0.102036
Train Epoch: 4 [54400/60000 (91%)]	Loss: 0.162332
Train Epoch: 4 [55040/60000 (92%)]	Loss: 0.182912
Train Epoch: 4 [55680/60000 (93%)]	Loss: 0.468722
Train Epoch: 4 [56320/60000 (94%)]	Loss: 0.421446
Train Epoch: 4 [56960/60000 (95%)]	Loss: 0.254925
Train Epoch: 4 [57600/60000 (96%)]	Loss: 0.345340
Train Epoch: 4 [58240/60000 (97%)]	Loss: 0.293855
Train Epoch: 4 [58880/60000 (98%)]	Loss: 0.200609
Train Epoch: 4 [59520/60000 (99%)]	Loss: 0.045524

Test set: Avg. loss: 0.0696, Accuracy: 9772/10000 (98%)

Train Epoch: 5 [0/60000 (0%)]	Loss: 0.270343
Train Epoch: 5 [640/60000 (1%)]	Loss: 0.275511
Train Epoch: 5 [1280/60000 (2%)]	Loss: 0.209185
Train Epoch: 5 [1920/60000 (3%)]	Loss: 0.172124
Train Epoch: 5 [2560/60000 (4%)]	Loss: 0.176122
Train Epoch: 5 [3200/60000 (5%)]	Loss: 0.469673
Train Epoch: 5 [3840/60000 (6%)]	Loss: 0.113855
Train Epoch: 5 [4480/60000 (7%)]	Loss: 0.241289
Train Epoch: 5 [5120/60000 (9%)]	Loss: 0.123443
Train Epoch: 5 [5760/60000 (10%)]	Loss: 0.153661
Train Epoch: 5 [6400/60000 (11%)]	Loss: 0.069777
Train Epoch: 5 [7040/60000 (12%)]	Loss: 0.372212
Train Epoch: 5 [7680/60000 (13%)]	Loss: 0.158761
Train Epoch: 5 [8320/60000 (14%)]	Loss: 0.231457
Train Epoch: 5 [8960/60000 (15%)]	Loss: 0.235761
Train Epoch: 5 [9600/60000 (16%)]	Loss: 0.208866
Train Epoch: 5 [10240/60000 (17%)]	Loss: 0.511828
Train Epoch: 5 [10880/60000 (18%)]	Loss: 0.333603
Train Epoch: 5 [11520/60000 (19%)]	Loss: 0.254337
Train Epoch: 5 [12160/60000 (20%)]	Loss: 0.260536
Train Epoch: 5 [12800/60000 (21%)]	Loss: 0.263866
Train Epoch: 5 [13440/60000 (22%)]	Loss: 0.483610
Train Epoch: 5 [14080/60000 (23%)]	Loss: 0.178215
Train Epoch: 5 [14720/60000 (25%)]	Loss: 0.137731
Train Epoch: 5 [15360/60000 (26%)]	Loss: 0.177714
Train Epoch: 5 [16000/60000 (27%)]	Loss: 0.132543
Train Epoch: 5 [16640/60000 (28%)]	Loss: 0.146177
Train Epoch: 5 [17280/60000 (29%)]	Loss: 0.398970
Train Epoch: 5 [17920/60000 (30%)]	Loss: 0.120811
Train Epoch: 5 [18560/60000 (31%)]	Loss: 0.147756
Train Epoch: 5 [19200/60000 (32%)]	Loss: 0.317457
Train Epoch: 5 [19840/60000 (33%)]	Loss: 0.310727
Train Epoch: 5 [20480/60000 (34%)]	Loss: 0.144468
Train Epoch: 5 [21120/60000 (35%)]	Loss: 0.515887
Train Epoch: 5 [21760/60000 (36%)]	Loss: 0.113731
Train Epoch: 5 [22400/60000 (37%)]	Loss: 0.326223
Train Epoch: 5 [23040/60000 (38%)]	Loss: 0.275539
Train Epoch: 5 [23680/60000 (39%)]	Loss: 0.261113
Train Epoch: 5 [24320/60000 (41%)]	Loss: 0.198070
Train Epoch: 5 [24960/60000 (42%)]	Loss: 0.380463
Train Epoch: 5 [25600/60000 (43%)]	Loss: 0.130256
Train Epoch: 5 [26240/60000 (44%)]	Loss: 0.234225
Train Epoch: 5 [26880/60000 (45%)]	Loss: 0.284392
Train Epoch: 5 [27520/60000 (46%)]	Loss: 0.168175
Train Epoch: 5 [28160/60000 (47%)]	Loss: 0.346845
Train Epoch: 5 [28800/60000 (48%)]	Loss: 0.206521
Train Epoch: 5 [29440/60000 (49%)]	Loss: 0.149305
Train Epoch: 5 [30080/60000 (50%)]	Loss: 0.248684
Train Epoch: 5 [30720/60000 (51%)]	Loss: 0.245173
Train Epoch: 5 [31360/60000 (52%)]	Loss: 0.201854
Train Epoch: 5 [32000/60000 (53%)]	Loss: 0.182244
Train Epoch: 5 [32640/60000 (54%)]	Loss: 0.160925
Train Epoch: 5 [33280/60000 (55%)]	Loss: 0.251155
Train Epoch: 5 [33920/60000 (57%)]	Loss: 0.137573
Train Epoch: 5 [34560/60000 (58%)]	Loss: 0.305431
Train Epoch: 5 [35200/60000 (59%)]	Loss: 0.260936
Train Epoch: 5 [35840/60000 (60%)]	Loss: 0.298855
Train Epoch: 5 [36480/60000 (61%)]	Loss: 0.209435
Train Epoch: 5 [37120/60000 (62%)]	Loss: 0.152100
Train Epoch: 5 [37760/60000 (63%)]	Loss: 0.322987
Train Epoch: 5 [38400/60000 (64%)]	Loss: 0.245070
Train Epoch: 5 [39040/60000 (65%)]	Loss: 0.079185
Train Epoch: 5 [39680/60000 (66%)]	Loss: 0.286104
Train Epoch: 5 [40320/60000 (67%)]	Loss: 0.134519
Train Epoch: 5 [40960/60000 (68%)]	Loss: 0.256614
Train Epoch: 5 [41600/60000 (69%)]	Loss: 0.230492
Train Epoch: 5 [42240/60000 (70%)]	Loss: 0.081532
Train Epoch: 5 [42880/60000 (71%)]	Loss: 0.174270
Train Epoch: 5 [43520/60000 (72%)]	Loss: 0.123896
Train Epoch: 5 [44160/60000 (74%)]	Loss: 0.126517
Train Epoch: 5 [44800/60000 (75%)]	Loss: 0.333949
Train Epoch: 5 [45440/60000 (76%)]	Loss: 0.369903
Train Epoch: 5 [46080/60000 (77%)]	Loss: 0.207948
Train Epoch: 5 [46720/60000 (78%)]	Loss: 0.080965
Train Epoch: 5 [47360/60000 (79%)]	Loss: 0.117344
Train Epoch: 5 [48000/60000 (80%)]	Loss: 0.419863
Train Epoch: 5 [48640/60000 (81%)]	Loss: 0.265613
Train Epoch: 5 [49280/60000 (82%)]	Loss: 0.256468
Train Epoch: 5 [49920/60000 (83%)]	Loss: 0.509733
Train Epoch: 5 [50560/60000 (84%)]	Loss: 0.144000
Train Epoch: 5 [51200/60000 (85%)]	Loss: 0.174094
Train Epoch: 5 [51840/60000 (86%)]	Loss: 0.335760
Train Epoch: 5 [52480/60000 (87%)]	Loss: 0.363208
Train Epoch: 5 [53120/60000 (88%)]	Loss: 0.199396
Train Epoch: 5 [53760/60000 (90%)]	Loss: 0.276358
Train Epoch: 5 [54400/60000 (91%)]	Loss: 0.063482
Train Epoch: 5 [55040/60000 (92%)]	Loss: 0.107777
Train Epoch: 5 [55680/60000 (93%)]	Loss: 0.273694
Train Epoch: 5 [56320/60000 (94%)]	Loss: 0.111036
Train Epoch: 5 [56960/60000 (95%)]	Loss: 0.242194
Train Epoch: 5 [57600/60000 (96%)]	Loss: 0.192879
Train Epoch: 5 [58240/60000 (97%)]	Loss: 0.140068
Train Epoch: 5 [58880/60000 (98%)]	Loss: 0.053538
Train Epoch: 5 [59520/60000 (99%)]	Loss: 0.282342

Test set: Avg. loss: 0.0648, Accuracy: 9794/10000 (98%)

Train Epoch: 6 [0/60000 (0%)]	Loss: 0.157271
Train Epoch: 6 [640/60000 (1%)]	Loss: 0.125083
Train Epoch: 6 [1280/60000 (2%)]	Loss: 0.324760
Train Epoch: 6 [1920/60000 (3%)]	Loss: 0.233483
Train Epoch: 6 [2560/60000 (4%)]	Loss: 0.305379
Train Epoch: 6 [3200/60000 (5%)]	Loss: 0.133055
Train Epoch: 6 [3840/60000 (6%)]	Loss: 0.308374
Train Epoch: 6 [4480/60000 (7%)]	Loss: 0.361411
Train Epoch: 6 [5120/60000 (9%)]	Loss: 0.263687
Train Epoch: 6 [5760/60000 (10%)]	Loss: 0.136558
Train Epoch: 6 [6400/60000 (11%)]	Loss: 0.187681
Train Epoch: 6 [7040/60000 (12%)]	Loss: 0.249220
Train Epoch: 6 [7680/60000 (13%)]	Loss: 0.206636
Train Epoch: 6 [8320/60000 (14%)]	Loss: 0.151353
Train Epoch: 6 [8960/60000 (15%)]	Loss: 0.195330
Train Epoch: 6 [9600/60000 (16%)]	Loss: 0.361656
Train Epoch: 6 [10240/60000 (17%)]	Loss: 0.366321
Train Epoch: 6 [10880/60000 (18%)]	Loss: 0.166131
Train Epoch: 6 [11520/60000 (19%)]	Loss: 0.075402
Train Epoch: 6 [12160/60000 (20%)]	Loss: 0.151120
Train Epoch: 6 [12800/60000 (21%)]	Loss: 0.115874
Train Epoch: 6 [13440/60000 (22%)]	Loss: 0.144778
Train Epoch: 6 [14080/60000 (23%)]	Loss: 0.063986
Train Epoch: 6 [14720/60000 (25%)]	Loss: 0.174532
Train Epoch: 6 [15360/60000 (26%)]	Loss: 0.261803
Train Epoch: 6 [16000/60000 (27%)]	Loss: 0.251123
Train Epoch: 6 [16640/60000 (28%)]	Loss: 0.145080
Train Epoch: 6 [17280/60000 (29%)]	Loss: 0.354523
Train Epoch: 6 [17920/60000 (30%)]	Loss: 0.187603
Train Epoch: 6 [18560/60000 (31%)]	Loss: 0.082521
Train Epoch: 6 [19200/60000 (32%)]	Loss: 0.154904
Train Epoch: 6 [19840/60000 (33%)]	Loss: 0.165881
Train Epoch: 6 [20480/60000 (34%)]	Loss: 0.115822
Train Epoch: 6 [21120/60000 (35%)]	Loss: 0.603689
Train Epoch: 6 [21760/60000 (36%)]	Loss: 0.164415
Train Epoch: 6 [22400/60000 (37%)]	Loss: 0.107442
Train Epoch: 6 [23040/60000 (38%)]	Loss: 0.196783
Train Epoch: 6 [23680/60000 (39%)]	Loss: 0.220013
Train Epoch: 6 [24320/60000 (41%)]	Loss: 0.207349
Train Epoch: 6 [24960/60000 (42%)]	Loss: 0.178466
Train Epoch: 6 [25600/60000 (43%)]	Loss: 0.149325
Train Epoch: 6 [26240/60000 (44%)]	Loss: 0.169802
Train Epoch: 6 [26880/60000 (45%)]	Loss: 0.205438
Train Epoch: 6 [27520/60000 (46%)]	Loss: 0.121831
Train Epoch: 6 [28160/60000 (47%)]	Loss: 0.169774
Train Epoch: 6 [28800/60000 (48%)]	Loss: 0.138925
Train Epoch: 6 [29440/60000 (49%)]	Loss: 0.183873
Train Epoch: 6 [30080/60000 (50%)]	Loss: 0.108401
Train Epoch: 6 [30720/60000 (51%)]	Loss: 0.087508
Train Epoch: 6 [31360/60000 (52%)]	Loss: 0.114378
Train Epoch: 6 [32000/60000 (53%)]	Loss: 0.124145
Train Epoch: 6 [32640/60000 (54%)]	Loss: 0.368228
Train Epoch: 6 [33280/60000 (55%)]	Loss: 0.353432
Train Epoch: 6 [33920/60000 (57%)]	Loss: 0.239896
Train Epoch: 6 [34560/60000 (58%)]	Loss: 0.341117
Train Epoch: 6 [35200/60000 (59%)]	Loss: 0.280842
Train Epoch: 6 [35840/60000 (60%)]	Loss: 0.303140
Train Epoch: 6 [36480/60000 (61%)]	Loss: 0.340119
Train Epoch: 6 [37120/60000 (62%)]	Loss: 0.165236
Train Epoch: 6 [37760/60000 (63%)]	Loss: 0.113621
Train Epoch: 6 [38400/60000 (64%)]	Loss: 0.313772
Train Epoch: 6 [39040/60000 (65%)]	Loss: 0.258854
Train Epoch: 6 [39680/60000 (66%)]	Loss: 0.158878
Train Epoch: 6 [40320/60000 (67%)]	Loss: 0.160731
Train Epoch: 6 [40960/60000 (68%)]	Loss: 0.166837
Train Epoch: 6 [41600/60000 (69%)]	Loss: 0.226772
Train Epoch: 6 [42240/60000 (70%)]	Loss: 0.160613
Train Epoch: 6 [42880/60000 (71%)]	Loss: 0.157473
Train Epoch: 6 [43520/60000 (72%)]	Loss: 0.279009
Train Epoch: 6 [44160/60000 (74%)]	Loss: 0.157638
Train Epoch: 6 [44800/60000 (75%)]	Loss: 0.202747
Train Epoch: 6 [45440/60000 (76%)]	Loss: 0.123593
Train Epoch: 6 [46080/60000 (77%)]	Loss: 0.164986
Train Epoch: 6 [46720/60000 (78%)]	Loss: 0.285264
Train Epoch: 6 [47360/60000 (79%)]	Loss: 0.211086
Train Epoch: 6 [48000/60000 (80%)]	Loss: 0.125422
Train Epoch: 6 [48640/60000 (81%)]	Loss: 0.076380
Train Epoch: 6 [49280/60000 (82%)]	Loss: 0.274299
Train Epoch: 6 [49920/60000 (83%)]	Loss: 0.128968
Train Epoch: 6 [50560/60000 (84%)]	Loss: 0.100312
Train Epoch: 6 [51200/60000 (85%)]	Loss: 0.173260
Train Epoch: 6 [51840/60000 (86%)]	Loss: 0.375576
Train Epoch: 6 [52480/60000 (87%)]	Loss: 0.359121
Train Epoch: 6 [53120/60000 (88%)]	Loss: 0.137199
Train Epoch: 6 [53760/60000 (90%)]	Loss: 0.280192
Train Epoch: 6 [54400/60000 (91%)]	Loss: 0.345643
Train Epoch: 6 [55040/60000 (92%)]	Loss: 0.213638
Train Epoch: 6 [55680/60000 (93%)]	Loss: 0.142949
Train Epoch: 6 [56320/60000 (94%)]	Loss: 0.188716
Train Epoch: 6 [56960/60000 (95%)]	Loss: 0.067698
Train Epoch: 6 [57600/60000 (96%)]	Loss: 0.227284
Train Epoch: 6 [58240/60000 (97%)]	Loss: 0.141719
Train Epoch: 6 [58880/60000 (98%)]	Loss: 0.166098
Train Epoch: 6 [59520/60000 (99%)]	Loss: 0.251494

Test set: Avg. loss: 0.0615, Accuracy: 9814/10000 (98%)

Train Epoch: 7 [0/60000 (0%)]	Loss: 0.091176
Train Epoch: 7 [640/60000 (1%)]	Loss: 0.269873
Train Epoch: 7 [1280/60000 (2%)]	Loss: 0.132484
Train Epoch: 7 [1920/60000 (3%)]	Loss: 0.181744
Train Epoch: 7 [2560/60000 (4%)]	Loss: 0.119089
Train Epoch: 7 [3200/60000 (5%)]	Loss: 0.172001
Train Epoch: 7 [3840/60000 (6%)]	Loss: 0.288416
Train Epoch: 7 [4480/60000 (7%)]	Loss: 0.282734
Train Epoch: 7 [5120/60000 (9%)]	Loss: 0.274102
Train Epoch: 7 [5760/60000 (10%)]	Loss: 0.224655
Train Epoch: 7 [6400/60000 (11%)]	Loss: 0.227839
Train Epoch: 7 [7040/60000 (12%)]	Loss: 0.202125
Train Epoch: 7 [7680/60000 (13%)]	Loss: 0.176258
Train Epoch: 7 [8320/60000 (14%)]	Loss: 0.198535
Train Epoch: 7 [8960/60000 (15%)]	Loss: 0.119568
Train Epoch: 7 [9600/60000 (16%)]	Loss: 0.204526
Train Epoch: 7 [10240/60000 (17%)]	Loss: 0.259647
Train Epoch: 7 [10880/60000 (18%)]	Loss: 0.216371
Train Epoch: 7 [11520/60000 (19%)]	Loss: 0.098282
Train Epoch: 7 [12160/60000 (20%)]	Loss: 0.156163
Train Epoch: 7 [12800/60000 (21%)]	Loss: 0.194898
Train Epoch: 7 [13440/60000 (22%)]	Loss: 0.172166
Train Epoch: 7 [14080/60000 (23%)]	Loss: 0.231052
Train Epoch: 7 [14720/60000 (25%)]	Loss: 0.135253
Train Epoch: 7 [15360/60000 (26%)]	Loss: 0.144452
Train Epoch: 7 [16000/60000 (27%)]	Loss: 0.162540
Train Epoch: 7 [16640/60000 (28%)]	Loss: 0.136042
Train Epoch: 7 [17280/60000 (29%)]	Loss: 0.236265
Train Epoch: 7 [17920/60000 (30%)]	Loss: 0.208569
Train Epoch: 7 [18560/60000 (31%)]	Loss: 0.158493
Train Epoch: 7 [19200/60000 (32%)]	Loss: 0.161767
Train Epoch: 7 [19840/60000 (33%)]	Loss: 0.066611
Train Epoch: 7 [20480/60000 (34%)]	Loss: 0.322254
Train Epoch: 7 [21120/60000 (35%)]	Loss: 0.233296
Train Epoch: 7 [21760/60000 (36%)]	Loss: 0.086176
Train Epoch: 7 [22400/60000 (37%)]	Loss: 0.125919
Train Epoch: 7 [23040/60000 (38%)]	Loss: 0.148241
Train Epoch: 7 [23680/60000 (39%)]	Loss: 0.108953
Train Epoch: 7 [24320/60000 (41%)]	Loss: 0.223288
Train Epoch: 7 [24960/60000 (42%)]	Loss: 0.243924
Train Epoch: 7 [25600/60000 (43%)]	Loss: 0.224430
Train Epoch: 7 [26240/60000 (44%)]	Loss: 0.230509
Train Epoch: 7 [26880/60000 (45%)]	Loss: 0.326988
Train Epoch: 7 [27520/60000 (46%)]	Loss: 0.229315
Train Epoch: 7 [28160/60000 (47%)]	Loss: 0.315817
Train Epoch: 7 [28800/60000 (48%)]	Loss: 0.137005
Train Epoch: 7 [29440/60000 (49%)]	Loss: 0.116640
Train Epoch: 7 [30080/60000 (50%)]	Loss: 0.167090
Train Epoch: 7 [30720/60000 (51%)]	Loss: 0.173242
Train Epoch: 7 [31360/60000 (52%)]	Loss: 0.191092
Train Epoch: 7 [32000/60000 (53%)]	Loss: 0.134305
Train Epoch: 7 [32640/60000 (54%)]	Loss: 0.138862
Train Epoch: 7 [33280/60000 (55%)]	Loss: 0.125831
Train Epoch: 7 [33920/60000 (57%)]	Loss: 0.129372
Train Epoch: 7 [34560/60000 (58%)]	Loss: 0.120971
Train Epoch: 7 [35200/60000 (59%)]	Loss: 0.268926
Train Epoch: 7 [35840/60000 (60%)]	Loss: 0.170120
Train Epoch: 7 [36480/60000 (61%)]	Loss: 0.455412
Train Epoch: 7 [37120/60000 (62%)]	Loss: 0.182606
Train Epoch: 7 [37760/60000 (63%)]	Loss: 0.085986
Train Epoch: 7 [38400/60000 (64%)]	Loss: 0.229982
Train Epoch: 7 [39040/60000 (65%)]	Loss: 0.165970
Train Epoch: 7 [39680/60000 (66%)]	Loss: 0.125090
Train Epoch: 7 [40320/60000 (67%)]	Loss: 0.149905
Train Epoch: 7 [40960/60000 (68%)]	Loss: 0.382724
Train Epoch: 7 [41600/60000 (69%)]	Loss: 0.155642
Train Epoch: 7 [42240/60000 (70%)]	Loss: 0.059763
Train Epoch: 7 [42880/60000 (71%)]	Loss: 0.305220
Train Epoch: 7 [43520/60000 (72%)]	Loss: 0.209007
Train Epoch: 7 [44160/60000 (74%)]	Loss: 0.309034
Train Epoch: 7 [44800/60000 (75%)]	Loss: 0.049236
Train Epoch: 7 [45440/60000 (76%)]	Loss: 0.305584
Train Epoch: 7 [46080/60000 (77%)]	Loss: 0.187595
Train Epoch: 7 [46720/60000 (78%)]	Loss: 0.117563
Train Epoch: 7 [47360/60000 (79%)]	Loss: 0.147911
Train Epoch: 7 [48000/60000 (80%)]	Loss: 0.233994
Train Epoch: 7 [48640/60000 (81%)]	Loss: 0.198659
Train Epoch: 7 [49280/60000 (82%)]	Loss: 0.302784
Train Epoch: 7 [49920/60000 (83%)]	Loss: 0.204405
Train Epoch: 7 [50560/60000 (84%)]	Loss: 0.053611
Train Epoch: 7 [51200/60000 (85%)]	Loss: 0.635807
Train Epoch: 7 [51840/60000 (86%)]	Loss: 0.101712
Train Epoch: 7 [52480/60000 (87%)]	Loss: 0.097702
Train Epoch: 7 [53120/60000 (88%)]	Loss: 0.257620
Train Epoch: 7 [53760/60000 (90%)]	Loss: 0.121270
Train Epoch: 7 [54400/60000 (91%)]	Loss: 0.191442
Train Epoch: 7 [55040/60000 (92%)]	Loss: 0.127309
Train Epoch: 7 [55680/60000 (93%)]	Loss: 0.148693
Train Epoch: 7 [56320/60000 (94%)]	Loss: 0.073504
Train Epoch: 7 [56960/60000 (95%)]	Loss: 0.184949
Train Epoch: 7 [57600/60000 (96%)]	Loss: 0.072307
Train Epoch: 7 [58240/60000 (97%)]	Loss: 0.296258
Train Epoch: 7 [58880/60000 (98%)]	Loss: 0.415298
Train Epoch: 7 [59520/60000 (99%)]	Loss: 0.309931

Test set: Avg. loss: 0.0576, Accuracy: 9823/10000 (98%)

Train Epoch: 8 [0/60000 (0%)]	Loss: 0.411129
Train Epoch: 8 [640/60000 (1%)]	Loss: 0.082472
Train Epoch: 8 [1280/60000 (2%)]	Loss: 0.232263
Train Epoch: 8 [1920/60000 (3%)]	Loss: 0.184606
Train Epoch: 8 [2560/60000 (4%)]	Loss: 0.082728
Train Epoch: 8 [3200/60000 (5%)]	Loss: 0.173117
Train Epoch: 8 [3840/60000 (6%)]	Loss: 0.111649
Train Epoch: 8 [4480/60000 (7%)]	Loss: 0.442360
Train Epoch: 8 [5120/60000 (9%)]	Loss: 0.227383
Train Epoch: 8 [5760/60000 (10%)]	Loss: 0.288936
Train Epoch: 8 [6400/60000 (11%)]	Loss: 0.227669
Train Epoch: 8 [7040/60000 (12%)]	Loss: 0.238741
Train Epoch: 8 [7680/60000 (13%)]	Loss: 0.276109
Train Epoch: 8 [8320/60000 (14%)]	Loss: 0.173926
Train Epoch: 8 [8960/60000 (15%)]	Loss: 0.167442
Train Epoch: 8 [9600/60000 (16%)]	Loss: 0.178728
Train Epoch: 8 [10240/60000 (17%)]	Loss: 0.181267
Train Epoch: 8 [10880/60000 (18%)]	Loss: 0.213851
Train Epoch: 8 [11520/60000 (19%)]	Loss: 0.130871
Train Epoch: 8 [12160/60000 (20%)]	Loss: 0.074143
Train Epoch: 8 [12800/60000 (21%)]	Loss: 0.090848
Train Epoch: 8 [13440/60000 (22%)]	Loss: 0.262355
Train Epoch: 8 [14080/60000 (23%)]	Loss: 0.112236
Train Epoch: 8 [14720/60000 (25%)]	Loss: 0.237863
Train Epoch: 8 [15360/60000 (26%)]	Loss: 0.128822
Train Epoch: 8 [16000/60000 (27%)]	Loss: 0.325940
Train Epoch: 8 [16640/60000 (28%)]	Loss: 0.059681
Train Epoch: 8 [17280/60000 (29%)]	Loss: 0.297807
Train Epoch: 8 [17920/60000 (30%)]	Loss: 0.193296
Train Epoch: 8 [18560/60000 (31%)]	Loss: 0.101481
Train Epoch: 8 [19200/60000 (32%)]	Loss: 0.319415
Train Epoch: 8 [19840/60000 (33%)]	Loss: 0.221697
Train Epoch: 8 [20480/60000 (34%)]	Loss: 0.128780
Train Epoch: 8 [21120/60000 (35%)]	Loss: 0.365089
Train Epoch: 8 [21760/60000 (36%)]	Loss: 0.114066
Train Epoch: 8 [22400/60000 (37%)]	Loss: 0.178602
Train Epoch: 8 [23040/60000 (38%)]	Loss: 0.198497
Train Epoch: 8 [23680/60000 (39%)]	Loss: 0.113458
Train Epoch: 8 [24320/60000 (41%)]	Loss: 0.084631
Train Epoch: 8 [24960/60000 (42%)]	Loss: 0.220370
Train Epoch: 8 [25600/60000 (43%)]	Loss: 0.112375
Train Epoch: 8 [26240/60000 (44%)]	Loss: 0.180620
Train Epoch: 8 [26880/60000 (45%)]	Loss: 0.174218
Train Epoch: 8 [27520/60000 (46%)]	Loss: 0.220530
Train Epoch: 8 [28160/60000 (47%)]	Loss: 0.322495
Train Epoch: 8 [28800/60000 (48%)]	Loss: 0.108935
Train Epoch: 8 [29440/60000 (49%)]	Loss: 0.302106
Train Epoch: 8 [30080/60000 (50%)]	Loss: 0.143926
Train Epoch: 8 [30720/60000 (51%)]	Loss: 0.132183
Train Epoch: 8 [31360/60000 (52%)]	Loss: 0.295584
Train Epoch: 8 [32000/60000 (53%)]	Loss: 0.153446
Train Epoch: 8 [32640/60000 (54%)]	Loss: 0.356207
Train Epoch: 8 [33280/60000 (55%)]	Loss: 0.049660
Train Epoch: 8 [33920/60000 (57%)]	Loss: 0.134523
Train Epoch: 8 [34560/60000 (58%)]	Loss: 0.107794
Train Epoch: 8 [35200/60000 (59%)]	Loss: 0.152601
Train Epoch: 8 [35840/60000 (60%)]	Loss: 0.183556
Train Epoch: 8 [36480/60000 (61%)]	Loss: 0.139419
Train Epoch: 8 [37120/60000 (62%)]	Loss: 0.217243
Train Epoch: 8 [37760/60000 (63%)]	Loss: 0.067120
Train Epoch: 8 [38400/60000 (64%)]	Loss: 0.140370
Train Epoch: 8 [39040/60000 (65%)]	Loss: 0.118206
Train Epoch: 8 [39680/60000 (66%)]	Loss: 0.068067
Train Epoch: 8 [40320/60000 (67%)]	Loss: 0.390102
Train Epoch: 8 [40960/60000 (68%)]	Loss: 0.362602
Train Epoch: 8 [41600/60000 (69%)]	Loss: 0.151053
Train Epoch: 8 [42240/60000 (70%)]	Loss: 0.329660
Train Epoch: 8 [42880/60000 (71%)]	Loss: 0.030132
Train Epoch: 8 [43520/60000 (72%)]	Loss: 0.214005
Train Epoch: 8 [44160/60000 (74%)]	Loss: 0.177053
Train Epoch: 8 [44800/60000 (75%)]	Loss: 0.270380
Train Epoch: 8 [45440/60000 (76%)]	Loss: 0.160427
Train Epoch: 8 [46080/60000 (77%)]	Loss: 0.152326
Train Epoch: 8 [46720/60000 (78%)]	Loss: 0.173051
Train Epoch: 8 [47360/60000 (79%)]	Loss: 0.213168
Train Epoch: 8 [48000/60000 (80%)]	Loss: 0.148429
Train Epoch: 8 [48640/60000 (81%)]	Loss: 0.179701
Train Epoch: 8 [49280/60000 (82%)]	Loss: 0.115524
Train Epoch: 8 [49920/60000 (83%)]	Loss: 0.203157
Train Epoch: 8 [50560/60000 (84%)]	Loss: 0.092355
Train Epoch: 8 [51200/60000 (85%)]	Loss: 0.241119
Train Epoch: 8 [51840/60000 (86%)]	Loss: 0.214614
Train Epoch: 8 [52480/60000 (87%)]	Loss: 0.133498
Train Epoch: 8 [53120/60000 (88%)]	Loss: 0.139286
Train Epoch: 8 [53760/60000 (90%)]	Loss: 0.271059
Train Epoch: 8 [54400/60000 (91%)]	Loss: 0.126945
Train Epoch: 8 [55040/60000 (92%)]	Loss: 0.098850
Train Epoch: 8 [55680/60000 (93%)]	Loss: 0.224279
Train Epoch: 8 [56320/60000 (94%)]	Loss: 0.166734
Train Epoch: 8 [56960/60000 (95%)]	Loss: 0.143847
Train Epoch: 8 [57600/60000 (96%)]	Loss: 0.146182
Train Epoch: 8 [58240/60000 (97%)]	Loss: 0.226856
Train Epoch: 8 [58880/60000 (98%)]	Loss: 0.049229
Train Epoch: 8 [59520/60000 (99%)]	Loss: 0.534476

Test set: Avg. loss: 0.0554, Accuracy: 9817/10000 (98%)

Train Epoch: 9 [0/60000 (0%)]	Loss: 0.054686
Train Epoch: 9 [640/60000 (1%)]	Loss: 0.235064
Train Epoch: 9 [1280/60000 (2%)]	Loss: 0.106654
Train Epoch: 9 [1920/60000 (3%)]	Loss: 0.234180
Train Epoch: 9 [2560/60000 (4%)]	Loss: 0.198757
Train Epoch: 9 [3200/60000 (5%)]	Loss: 0.162267
Train Epoch: 9 [3840/60000 (6%)]	Loss: 0.271285
Train Epoch: 9 [4480/60000 (7%)]	Loss: 0.080265
Train Epoch: 9 [5120/60000 (9%)]	Loss: 0.122332
Train Epoch: 9 [5760/60000 (10%)]	Loss: 0.217631
Train Epoch: 9 [6400/60000 (11%)]	Loss: 0.185639
Train Epoch: 9 [7040/60000 (12%)]	Loss: 0.168876
Train Epoch: 9 [7680/60000 (13%)]	Loss: 0.112571
Train Epoch: 9 [8320/60000 (14%)]	Loss: 0.125877
Train Epoch: 9 [8960/60000 (15%)]	Loss: 0.188810
Train Epoch: 9 [9600/60000 (16%)]	Loss: 0.105145
Train Epoch: 9 [10240/60000 (17%)]	Loss: 0.188370
Train Epoch: 9 [10880/60000 (18%)]	Loss: 0.117349
Train Epoch: 9 [11520/60000 (19%)]	Loss: 0.069228
Train Epoch: 9 [12160/60000 (20%)]	Loss: 0.162447
Train Epoch: 9 [12800/60000 (21%)]	Loss: 0.108819
Train Epoch: 9 [13440/60000 (22%)]	Loss: 0.263229
Train Epoch: 9 [14080/60000 (23%)]	Loss: 0.292624
Train Epoch: 9 [14720/60000 (25%)]	Loss: 0.248468
Train Epoch: 9 [15360/60000 (26%)]	Loss: 0.119649
Train Epoch: 9 [16000/60000 (27%)]	Loss: 0.109907
Train Epoch: 9 [16640/60000 (28%)]	Loss: 0.580101
Train Epoch: 9 [17280/60000 (29%)]	Loss: 0.177047
Train Epoch: 9 [17920/60000 (30%)]	Loss: 0.178420
Train Epoch: 9 [18560/60000 (31%)]	Loss: 0.221444
Train Epoch: 9 [19200/60000 (32%)]	Loss: 0.133854
Train Epoch: 9 [19840/60000 (33%)]	Loss: 0.282360
Train Epoch: 9 [20480/60000 (34%)]	Loss: 0.136910
Train Epoch: 9 [21120/60000 (35%)]	Loss: 0.280332
Train Epoch: 9 [21760/60000 (36%)]	Loss: 0.174279
Train Epoch: 9 [22400/60000 (37%)]	Loss: 0.083278
Train Epoch: 9 [23040/60000 (38%)]	Loss: 0.188579
Train Epoch: 9 [23680/60000 (39%)]	Loss: 0.102640
Train Epoch: 9 [24320/60000 (41%)]	Loss: 0.163085
Train Epoch: 9 [24960/60000 (42%)]	Loss: 0.158967
Train Epoch: 9 [25600/60000 (43%)]	Loss: 0.192901
Train Epoch: 9 [26240/60000 (44%)]	Loss: 0.163242
Train Epoch: 9 [26880/60000 (45%)]	Loss: 0.157237
Train Epoch: 9 [27520/60000 (46%)]	Loss: 0.088420
Train Epoch: 9 [28160/60000 (47%)]	Loss: 0.094397
Train Epoch: 9 [28800/60000 (48%)]	Loss: 0.156636
Train Epoch: 9 [29440/60000 (49%)]	Loss: 0.150083
Train Epoch: 9 [30080/60000 (50%)]	Loss: 0.077640
Train Epoch: 9 [30720/60000 (51%)]	Loss: 0.172498
Train Epoch: 9 [31360/60000 (52%)]	Loss: 0.228058
Train Epoch: 9 [32000/60000 (53%)]	Loss: 0.162368
Train Epoch: 9 [32640/60000 (54%)]	Loss: 0.278008
Train Epoch: 9 [33280/60000 (55%)]	Loss: 0.256715
Train Epoch: 9 [33920/60000 (57%)]	Loss: 0.196984
Train Epoch: 9 [34560/60000 (58%)]	Loss: 0.205926
Train Epoch: 9 [35200/60000 (59%)]	Loss: 0.103880
Train Epoch: 9 [35840/60000 (60%)]	Loss: 0.053308
Train Epoch: 9 [36480/60000 (61%)]	Loss: 0.117932
Train Epoch: 9 [37120/60000 (62%)]	Loss: 0.080018
Train Epoch: 9 [37760/60000 (63%)]	Loss: 0.423203
Train Epoch: 9 [38400/60000 (64%)]	Loss: 0.088841
Train Epoch: 9 [39040/60000 (65%)]	Loss: 0.157737
Train Epoch: 9 [39680/60000 (66%)]	Loss: 0.196193
Train Epoch: 9 [40320/60000 (67%)]	Loss: 0.164245
Train Epoch: 9 [40960/60000 (68%)]	Loss: 0.199979
Train Epoch: 9 [41600/60000 (69%)]	Loss: 0.188702
Train Epoch: 9 [42240/60000 (70%)]	Loss: 0.199731
Train Epoch: 9 [42880/60000 (71%)]	Loss: 0.102235
Train Epoch: 9 [43520/60000 (72%)]	Loss: 0.087075
Train Epoch: 9 [44160/60000 (74%)]	Loss: 0.128069
Train Epoch: 9 [44800/60000 (75%)]	Loss: 0.148430
Train Epoch: 9 [45440/60000 (76%)]	Loss: 0.232641
Train Epoch: 9 [46080/60000 (77%)]	Loss: 0.082571
Train Epoch: 9 [46720/60000 (78%)]	Loss: 0.283418
Train Epoch: 9 [47360/60000 (79%)]	Loss: 0.233733
Train Epoch: 9 [48000/60000 (80%)]	Loss: 0.096537
Train Epoch: 9 [48640/60000 (81%)]	Loss: 0.109687
Train Epoch: 9 [49280/60000 (82%)]	Loss: 0.216523
Train Epoch: 9 [49920/60000 (83%)]	Loss: 0.181914
Train Epoch: 9 [50560/60000 (84%)]	Loss: 0.139312
Train Epoch: 9 [51200/60000 (85%)]	Loss: 0.238586
Train Epoch: 9 [51840/60000 (86%)]	Loss: 0.109351
Train Epoch: 9 [52480/60000 (87%)]	Loss: 0.076942
Train Epoch: 9 [53120/60000 (88%)]	Loss: 0.221999
Train Epoch: 9 [53760/60000 (90%)]	Loss: 0.178757
Train Epoch: 9 [54400/60000 (91%)]	Loss: 0.219890
Train Epoch: 9 [55040/60000 (92%)]	Loss: 0.136030
Train Epoch: 9 [55680/60000 (93%)]	Loss: 0.238617
Train Epoch: 9 [56320/60000 (94%)]	Loss: 0.195722
Train Epoch: 9 [56960/60000 (95%)]	Loss: 0.252661
Train Epoch: 9 [57600/60000 (96%)]	Loss: 0.149977
Train Epoch: 9 [58240/60000 (97%)]	Loss: 0.061803
Train Epoch: 9 [58880/60000 (98%)]	Loss: 0.105117
Train Epoch: 9 [59520/60000 (99%)]	Loss: 0.054359

Test set: Avg. loss: 0.0508, Accuracy: 9843/10000 (98%)
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;15&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(train_counter, train_losses, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;blue&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.scatter(test_counter, test_losses, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;red&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.legend([&lt;span class=&#34;string&#34;&gt;&amp;#x27;Train Loss&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Test Loss&amp;#x27;&lt;/span&gt;], loc=&lt;span class=&#34;string&#34;&gt;&amp;#x27;upper right&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;number of training examples seen&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;negative log likelihood loss&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;DL_files/DL_8_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;å€Ÿç‰©è¡¨&#34;&gt;å€Ÿç‰©è¡¨&lt;/h2&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-1&#39; href=&#39;#cite_ref-1&#39;&gt;[1]&lt;/a&gt;: &lt;a href=&#34;https://zhuanlan.zhihu.com/p/137571225&#34;&gt;ç”¨ PyTorch å®ç° MNIST æ‰‹å†™æ•°å­—è¯†åˆ«(éå¸¸è¯¦ç»†)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-2&#39; href=&#39;#cite_ref-2&#39;&gt;[2]&lt;/a&gt;: &lt;a href=&#34;https://www.bilibili.com/video/BV1cL411V7Gh?p=6&#34;&gt;PyTorch æ·±åº¦å­¦ä¹ å…¥é—¨ä¸å®æˆ˜ 2022 æœ€ç®€æ˜æ˜“æ‡‚çš„ PyTorch ä»£ç ç²¾è®² æœ€æ–°ç‰ˆæœ¬ PyTorch PyTorch å®‰è£…&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-3&#39; href=&#39;#cite_ref-3&#39;&gt;[3]&lt;/a&gt;: &lt;a href=&#34;https://www.jianshu.com/p/45a26d278473&#34;&gt;PyTorch ä¸­çš„ nn.Conv1d ä¸ nn.Conv2d&lt;/a&gt;&lt;/p&gt;
&lt;script type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/kity@2.0.4/dist/kity.min.js&#34;&gt;&lt;/script&gt;&lt;script type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js&#34;&gt;&lt;/script&gt;&lt;script defer=&#34;true&#34; type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js&#34;&gt;&lt;/script&gt;&lt;link rel=&#34;stylesheet&#34; type=&#34;text&amp;#x2F;css&#34; href=&#34;https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css&#34;&gt; ]]></description>
        </item>
        <item>
            <guid isPermalink="true">https://weidows.github.io/post/lang/python/code/ML/</guid>
            <title>ğŸ‘€Code-4-Machine-Learning</title>
            <link>https://weidows.github.io/post/lang/python/code/ML/</link>
            <category>äººå·¥æ™ºèƒ½</category>
            <category>ä¿¡æ¯è®º</category>
            <category>python</category>
            <category>æœºå™¨å­¦ä¹ </category>
            <pubDate>Mon, 11 Apr 2022 07:07:22 +0000</pubDate>
            <description><![CDATA[ &lt;!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @LastEditors: Weidows
 * @LastEditTime: 2023-04-20 18:34:18
 * @FilePath: \Blog-private\source\_posts\python\code\ML.md
 * @Description:
 * @!: *********************************************************************
--&gt;
&lt;h2 id=&#34;åº&#34;&gt;åº&lt;/h2&gt;
&lt;p&gt;æ­¤æ–‡ä¸ºå…¶ä»–æ–‡ç« çš„ä»£ç éƒ¨åˆ†:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&#34;../../AI/ML&#34;&gt;ğŸ¥µç¡¬å•ƒ-Machine-Learning&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¹Ÿæä¾›äº† notebook å½¢å¼: &lt;a href=&#34;https://github.com/Weidows-projects/public-post/blob/main/notebook/ML/_ML.ipynb&#34;&gt;ä»£ç åœ°å€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ•°æ®é¢„å¤„ç†æ–¹æ³•&#34;&gt;æ•°æ®é¢„å¤„ç†æ–¹æ³•&lt;/h2&gt;
&lt;h3 id=&#34;æ ‡å‡†åŒ–-å‡å€¼ç§»é™¤&#34;&gt;æ ‡å‡†åŒ–-å‡å€¼ç§»é™¤&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ•°æ®é¢„å¤„ç†ä¹‹ï¼šå‡å€¼ç§»é™¤ç¤ºä¾‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ ·æœ¬æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;raw_samples = np.array([&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    [&lt;span class=&#34;number&#34;&gt;3.0&lt;/span&gt;, -&lt;span class=&#34;number&#34;&gt;1.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2.0&lt;/span&gt;],\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    [&lt;span class=&#34;number&#34;&gt;0.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;4.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3.0&lt;/span&gt;], \&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    [&lt;span class=&#34;number&#34;&gt;1.0&lt;/span&gt;, -&lt;span class=&#34;number&#34;&gt;4.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2.0&lt;/span&gt;]]\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ±‚æ¯åˆ—çš„å¹³å‡å€¼ axis=0ä¸ºåˆ—, =1ä¸ºè¡Œ ä¸å¡«å°±è®¡ç®—æ‰€æœ‰å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(raw_samples.mean(axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ±‚æ¯åˆ—æ ‡å‡†å·®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(raw_samples.std(axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;std_samples = raw_samples.copy()  &lt;span class=&#34;comment&#34;&gt;# å¤åˆ¶æ ·æœ¬æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; col &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; std_samples.T:  &lt;span class=&#34;comment&#34;&gt;# .Tä¸ºè½¬ç½®,éå†æ¯åˆ—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    col_mean = col.mean()  &lt;span class=&#34;comment&#34;&gt;# è®¡ç®—å¹³å‡æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    col_std = col.std()  &lt;span class=&#34;comment&#34;&gt;# æ±‚æ ‡å‡†å·®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    col -= col_mean  &lt;span class=&#34;comment&#34;&gt;# å‡å¹³å‡å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    col /= col_std  &lt;span class=&#34;comment&#34;&gt;# é™¤æ ‡å‡†å·®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å‡å€¼æ— é™è¶‹è¿‘0,ä½†å¯èƒ½ä¸æ˜¯0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(std_samples.mean(axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(std_samples.std(axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# scale æ ‡å‡†ç§»é™¤,ä¸ä¸Šé¢åŠŸèƒ½ç›¸åŒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;std_samples = sp.scale(raw_samples)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(std_samples.mean(axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(std_samples.std(axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;[ 1.33333333 -0.33333333  2.33333333]
[1.24721913 3.29983165 0.47140452]
[ 5.55111512e-17  0.00000000e+00 -2.96059473e-16]
[1. 1. 1.]
[ 5.55111512e-17  0.00000000e+00 -2.96059473e-16]
[1. 1. 1.]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;èŒƒå›´ç¼©æ”¾&#34;&gt;èŒƒå›´ç¼©æ”¾&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ•°æ®é¢„å¤„ç†ä¹‹ï¼šèŒƒå›´ç¼©æ”¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ ·æœ¬æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;raw_samples = np.array([&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    [&lt;span class=&#34;number&#34;&gt;1.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3.0&lt;/span&gt;],\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    [&lt;span class=&#34;number&#34;&gt;4.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;5.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;6.0&lt;/span&gt;],\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    [&lt;span class=&#34;number&#34;&gt;7.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;8.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;9.0&lt;/span&gt;]]).astype(&lt;span class=&#34;string&#34;&gt;&amp;quot;float64&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mms_samples = raw_samples.copy()  &lt;span class=&#34;comment&#34;&gt;# å¤åˆ¶æ ·æœ¬æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; col &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; mms_samples.T:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    col_min = col.&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    col_max = col.&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    col -= col_min&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    col /= (col_max - col_min)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(mms_samples)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ ¹æ®ç»™å®šèŒƒå›´åˆ›å»ºä¸€ä¸ªèŒƒå›´ç¼©æ”¾å™¨å¯¹è±¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ä½¿ç”¨èŒƒå›´ç¼©æ”¾å™¨å®ç°ç‰¹å¾å€¼èŒƒå›´ç¼©æ”¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mms_samples = sp.MinMaxScaler(feature_range=(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;))\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  .fit_transform(raw_samples)  &lt;span class=&#34;comment&#34;&gt;# ç¼©æ”¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(mms_samples)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;[[0.  0.  0. ]
 [0.5 0.5 0.5]
 [1.  1.  1. ]]
[[0.  0.  0. ]
 [0.5 0.5 0.5]
 [1.  1.  1. ]]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;å½’ä¸€åŒ–&#34;&gt;å½’ä¸€åŒ–&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ ·æœ¬æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;raw_samples = np.array([&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    [&lt;span class=&#34;number&#34;&gt;10.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;20.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;5.0&lt;/span&gt;],\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    [&lt;span class=&#34;number&#34;&gt;8.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;10.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1.0&lt;/span&gt;]])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;nor_samples = raw_samples.copy()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; row &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; nor_samples:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    row /= &lt;span class=&#34;built_in&#34;&gt;abs&lt;/span&gt;(row).&lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;()  &lt;span class=&#34;comment&#34;&gt;# å…ˆå¯¹è¡Œæ±‚ç»å¯¹å€¼ï¼Œå†æ±‚å’Œï¼Œå†é™¤ä»¥ç»å¯¹å€¼ä¹‹å’Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(nor_samples)  &lt;span class=&#34;comment&#34;&gt;# æ‰“å°ç»“æœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# norm=l1  /=ç»å¯¹å€¼ä¹‹å’Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# norm=l2  /=å¹³æ–¹ä¹‹å’Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;nor_samples = sp.normalize(raw_samples.copy(), norm=&lt;span class=&#34;string&#34;&gt;&amp;#x27;l1&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(nor_samples)  &lt;span class=&#34;comment&#34;&gt;# æ‰“å°ç»“æœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;[[0.28571429 0.57142857 0.14285714]
 [0.42105263 0.52631579 0.05263158]]
[[0.28571429 0.57142857 0.14285714]
 [0.42105263 0.52631579 0.05263158]]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;äºŒå€¼åŒ–&#34;&gt;äºŒå€¼åŒ–&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# äºŒå€¼åŒ–&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;raw_samples = np.array([[&lt;span class=&#34;number&#34;&gt;65.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;89.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;73.0&lt;/span&gt;],\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        [&lt;span class=&#34;number&#34;&gt;55.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;99.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;98.5&lt;/span&gt;],\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        [&lt;span class=&#34;number&#34;&gt;45.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;22.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;60.0&lt;/span&gt;]])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin_samples = raw_samples.copy()  &lt;span class=&#34;comment&#34;&gt;# å¤åˆ¶æ•°ç»„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ç”Ÿæˆæ©ç æ•°ç»„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mask1 = bin_samples &amp;lt; &lt;span class=&#34;number&#34;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(mask1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mask2 = bin_samples &amp;gt;= &lt;span class=&#34;number&#34;&gt;60&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# é€šè¿‡æ©ç è¿›è¡ŒäºŒå€¼åŒ–å¤„ç† (åªè½¬æ¢Trueçš„ä½ç½®)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin_samples[mask1] = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(bin_samples)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin_samples[mask2] = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(bin_samples)  &lt;span class=&#34;comment&#34;&gt;# æ‰“å°ç»“æœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin_transformer = sp.Binarizer(threshold=&lt;span class=&#34;number&#34;&gt;60&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# åˆ›å»ºäºŒå€¼åŒ–å¯¹è±¡(æ³¨æ„è¾¹ç•Œå€¼)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;bin_samples = bin_transformer.transform(raw_samples.copy())  &lt;span class=&#34;comment&#34;&gt;# äºŒå€¼åŒ–é¢„å¤„ç†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(bin_samples)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;[[False False False]
 [ True False False]
 [ True  True False]]
[[65.5 89.  73. ]
 [ 0.  99.  98.5]
 [ 0.   0.  60. ]]
[[1. 1. 1.]
 [0. 1. 1.]
 [0. 0. 1.]]
[[1. 1. 1.]
 [0. 1. 1.]
 [0. 0. 1.]]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;ç‹¬çƒ­ç¼–ç ç¤ºä¾‹&#34;&gt;ç‹¬çƒ­ç¼–ç ç¤ºä¾‹&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;raw_samples = np.array([[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;],\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        [&lt;span class=&#34;number&#34;&gt;7&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;],\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        [&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;6&lt;/span&gt;],\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        [&lt;span class=&#34;number&#34;&gt;7&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;9&lt;/span&gt;]])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;one_hot_encoder = sp.OneHotEncoder(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    sparse=&lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;,  &lt;span class=&#34;comment&#34;&gt;# æ˜¯å¦é‡‡ç”¨ç¨€ç–æ ¼å¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    dtype=&lt;span class=&#34;string&#34;&gt;&amp;quot;int32&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    categories=&lt;span class=&#34;string&#34;&gt;&amp;quot;auto&amp;quot;&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# è‡ªåŠ¨ç¼–ç &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ‰§è¡Œç‹¬çƒ­ç¼–ç &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;oh_samples = one_hot_encoder.fit_transform(raw_samples.copy())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(oh_samples)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(one_hot_encoder.inverse_transform(oh_samples))  &lt;span class=&#34;comment&#34;&gt;# è§£ç &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;[[1 0 1 0 0 1 0 0 0]
 [0 1 0 1 0 0 1 0 0]
 [1 0 0 0 1 0 0 1 0]
 [0 1 1 0 0 0 0 0 1]]
[[1 3 2]
 [7 5 4]
 [1 8 6]
 [7 3 9]]
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;æ ‡ç­¾ç¼–ç &#34;&gt;æ ‡ç­¾ç¼–ç &lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;raw_samples = np.array([&lt;span class=&#34;string&#34;&gt;&amp;#x27;audi&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;ford&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;audi&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;bmw&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;ford&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;bmw&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lb_encoder = sp.LabelEncoder()  &lt;span class=&#34;comment&#34;&gt;# å®šä¹‰æ ‡ç­¾ç¼–ç å¯¹è±¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;lb_samples = lb_encoder.fit_transform(raw_samples.copy())  &lt;span class=&#34;comment&#34;&gt;# æ‰§è¡Œæ ‡ç­¾ç¼–ç &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(lb_samples)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(lb_encoder.inverse_transform(lb_samples))  &lt;span class=&#34;comment&#34;&gt;# é€†å‘è½¬æ¢&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;[0 2 0 1 2 1]
[&#39;audi&#39; &#39;ford&#39; &#39;audi&#39; &#39;bmw&#39; &#39;ford&#39; &#39;bmw&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;åŸºæœ¬é—®é¢˜&#34;&gt;åŸºæœ¬é—®é¢˜&lt;/h2&gt;
&lt;h3 id=&#34;å›å½’é—®é¢˜&#34;&gt;å›å½’é—®é¢˜&lt;/h3&gt;
&lt;h4 id=&#34;çº¿æ€§å›å½’&#34;&gt;çº¿æ€§å›å½’&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mpl_toolkits.mplot3d &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; axes3d&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è®­ç»ƒæ•°æ®é›†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train_x = np.array([&lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.6&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.8&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1.1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1.4&lt;/span&gt;])  &lt;span class=&#34;comment&#34;&gt;# è¾“å…¥é›†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train_y = np.array([&lt;span class=&#34;number&#34;&gt;5.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;5.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;6.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;6.8&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;7.0&lt;/span&gt;])  &lt;span class=&#34;comment&#34;&gt;# è¾“å‡ºé›†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;n_epochs = &lt;span class=&#34;number&#34;&gt;30&lt;/span&gt;  &lt;span class=&#34;comment&#34;&gt;# è¿­ä»£æ¬¡æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;l_rate = &lt;span class=&#34;number&#34;&gt;0.01&lt;/span&gt;  &lt;span class=&#34;comment&#34;&gt;# å­¦ä¹ ç‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;epochs = []  &lt;span class=&#34;comment&#34;&gt;# è®°å½•è¿­ä»£æ¬¡æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;losses = []  &lt;span class=&#34;comment&#34;&gt;# è®°å½•æŸå¤±å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;w0, w1 = [&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]  &lt;span class=&#34;comment&#34;&gt;# æ¨¡å‹åˆå§‹å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, n_epochs + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    epochs.append(i)  &lt;span class=&#34;comment&#34;&gt;# è®°å½•ç¬¬å‡ æ¬¡è¿­ä»£&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    y = w0[-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] + w1[-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] * train_x  &lt;span class=&#34;comment&#34;&gt;# å–å‡ºæœ€æ–°çš„w0,w1è®¡ç®—çº¿æ€§æ–¹ç¨‹è¾“å‡º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# æŸå¤±å‡½æ•°(å‡æ–¹å·®)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    loss = (((train_y - y)**&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;).&lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;()) / &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    losses.append(loss)  &lt;span class=&#34;comment&#34;&gt;# è®°å½•æ¯æ¬¡è¿­ä»£çš„æŸå¤±å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%d: w0=%f, w1=%f, loss=%f&amp;quot;&lt;/span&gt; % (i, w0[-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], w1[-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], loss))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# è®¡ç®—w0,w1çš„åå¯¼æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    d0 = -(train_y - y).&lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    d1 = -(train_x * (train_y - y)).&lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# æ›´æ–°w0,w1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    w0.append(w0[-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] - (d0 * l_rate))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    w1.append(w1[-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] - (d1 * l_rate))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;###################### è®­ç»ƒè¿‡ç¨‹å¯è§†åŒ– ######################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## æŸå¤±å‡½æ•°æ”¶æ•›è¿‡ç¨‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;w0 = np.array(w0[:-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;w1 = np.array(w1[:-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.figure(&lt;span class=&#34;string&#34;&gt;&amp;quot;Losses&amp;quot;&lt;/span&gt;, facecolor=&lt;span class=&#34;string&#34;&gt;&amp;quot;lightgray&amp;quot;&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# åˆ›å»ºä¸€ä¸ªçª—ä½“&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.title(&lt;span class=&#34;string&#34;&gt;&amp;quot;epoch&amp;quot;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;quot;loss&amp;quot;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.grid(linestyle=&lt;span class=&#34;string&#34;&gt;&amp;quot;:&amp;quot;&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# ç½‘æ ¼çº¿ï¼šè™šçº¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.plot(epochs, losses, c=&lt;span class=&#34;string&#34;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;, label=&lt;span class=&#34;string&#34;&gt;&amp;quot;loss&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.legend()  &lt;span class=&#34;comment&#34;&gt;# å›¾ä¾‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.tight_layout()  &lt;span class=&#34;comment&#34;&gt;# ç´§å‡‘æ ¼å¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;## æ˜¾ç¤ºæ¨¡å‹ç›´çº¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pred_y = w0[-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] + w1[-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] * train_x  &lt;span class=&#34;comment&#34;&gt;# æ ¹æ®xé¢„æµ‹y&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.figure(&lt;span class=&#34;string&#34;&gt;&amp;quot;Linear Regression&amp;quot;&lt;/span&gt;, facecolor=&lt;span class=&#34;string&#34;&gt;&amp;quot;lightgray&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.title(&lt;span class=&#34;string&#34;&gt;&amp;quot;Linear Regression&amp;quot;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;quot;x&amp;quot;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;quot;y&amp;quot;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.grid(linestyle=&lt;span class=&#34;string&#34;&gt;&amp;quot;:&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.scatter(train_x, train_y, c=&lt;span class=&#34;string&#34;&gt;&amp;quot;blue&amp;quot;&lt;/span&gt;, label=&lt;span class=&#34;string&#34;&gt;&amp;quot;Traing&amp;quot;&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# ç»˜åˆ¶æ ·æœ¬æ•£ç‚¹å›¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.plot(train_x, pred_y, c=&lt;span class=&#34;string&#34;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;, label=&lt;span class=&#34;string&#34;&gt;&amp;quot;Regression&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.legend()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ˜¾ç¤ºæ¢¯åº¦ä¸‹é™è¿‡ç¨‹(å¤åˆ¶ç²˜è´´å³å¯ï¼Œä¸éœ€è¦ç¼–å†™)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è®¡ç®—æŸå¤±å‡½æ•°æ›²é¢ä¸Šçš„ç‚¹ loss = f(w0, w1)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;arr1 = np.linspace(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;500&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# 0~9é—´äº§ç”Ÿ500ä¸ªå…ƒç´ çš„å‡åŒ€åˆ—è¡¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;arr2 = np.linspace(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;500&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# 0~3.5é—´äº§ç”Ÿ500ä¸ªå…ƒç´ çš„å‡åŒ€åˆ—è¡¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;grid_w0, grid_w1 = np.meshgrid(arr1, arr2)  &lt;span class=&#34;comment&#34;&gt;# äº§ç”ŸäºŒç»´çŸ©é˜µ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;flat_w0, flat_w1 = grid_w0.ravel(), grid_w1.ravel()  &lt;span class=&#34;comment&#34;&gt;# äºŒç»´çŸ©é˜µæ‰å¹³åŒ–&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;loss_metrix = train_y.reshape(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# ç”Ÿæˆè¯¯å·®çŸ©é˜µï¼ˆ-1,1ï¼‰è¡¨ç¤ºè‡ªåŠ¨è®¡ç®—ç»´åº¦&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;outer = np.outer(train_x, flat_w1)  &lt;span class=&#34;comment&#34;&gt;# æ±‚å¤–ç§¯ï¼ˆtrain_xå’Œflat_w1å…ƒç´ ä¸¤ä¸¤ç›¸ä¹˜çš„æ–°çŸ©é˜µï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è®¡ç®—æŸå¤±ï¼š((w0 + w1*x - y)**2)/2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;flat_loss = (((flat_w0 + outer - loss_metrix)**&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;).&lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;(axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)) / &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;grid_loss = flat_loss.reshape(grid_w0.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.figure(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Loss Function&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ax = mp.axes(projection=&lt;span class=&#34;string&#34;&gt;&amp;#x27;3d&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Loss Function&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ax.set_xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;w0&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ax.set_ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;w1&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ax.set_zlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;loss&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ax.plot_surface(grid_w0,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                grid_w1,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                grid_loss,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                rstride=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                cstride=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                cmap=&lt;span class=&#34;string&#34;&gt;&amp;#x27;jet&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ax.plot(w0, w1, losses, &lt;span class=&#34;string&#34;&gt;&amp;#x27;o-&amp;#x27;&lt;/span&gt;, c=&lt;span class=&#34;string&#34;&gt;&amp;#x27;orangered&amp;#x27;&lt;/span&gt;, label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;BGD&amp;#x27;&lt;/span&gt;, zorder=&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.legend(loc=&lt;span class=&#34;string&#34;&gt;&amp;#x27;lower left&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.show()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;1: w0=1.000000, w1=1.000000, loss=44.175000
2: w0=1.209000, w1=1.190600, loss=36.538828
3: w0=1.399164, w1=1.363579, loss=30.231687
4: w0=1.572208, w1=1.520546, loss=25.022227
5: w0=1.729693, w1=1.662961, loss=20.719373
6: w0=1.873039, w1=1.792151, loss=17.165309
7: w0=2.003532, w1=1.909325, loss=14.229691
8: w0=2.122345, w1=2.015577, loss=11.804865
9: w0=2.230542, w1=2.111905, loss=9.801916
10: w0=2.329091, w1=2.199215, loss=8.147408
11: w0=2.418871, w1=2.278330, loss=6.780688
12: w0=2.500681, w1=2.349997, loss=5.651660
13: w0=2.575247, w1=2.414898, loss=4.718950
14: w0=2.643230, w1=2.473648, loss=3.948384
15: w0=2.705228, w1=2.526811, loss=3.311740
16: w0=2.761786, w1=2.574896, loss=2.785706
17: w0=2.813402, w1=2.618367, loss=2.351029
18: w0=2.860524, w1=2.657645, loss=1.991807
19: w0=2.903561, w1=2.693114, loss=1.694907
20: w0=2.942886, w1=2.725122, loss=1.449482
21: w0=2.978836, w1=2.753985, loss=1.246572
22: w0=3.011719, w1=2.779990, loss=1.078777
23: w0=3.041814, w1=2.803399, loss=0.939987
24: w0=3.069373, w1=2.824449, loss=0.825153
25: w0=3.094629, w1=2.843355, loss=0.730107
26: w0=3.117790, w1=2.860315, loss=0.651405
27: w0=3.139046, w1=2.875507, loss=0.586204
28: w0=3.158572, w1=2.889091, loss=0.532154
29: w0=3.176523, w1=2.901216, loss=0.487315
30: w0=3.193044, w1=2.912016, loss=0.450086
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_13_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_13_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_13_3.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆ©ç”¨LinearRegressionå®ç°çº¿æ€§å›å½’&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.linear_model &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; lm  &lt;span class=&#34;comment&#34;&gt;# çº¿æ€§æ¨¡å‹# çº¿æ€§æ¨¡å‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sm  &lt;span class=&#34;comment&#34;&gt;# æ¨¡å‹æ€§èƒ½è¯„ä»·æ¨¡å—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train_x = np.array([[&lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;0.6&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;0.8&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;1.1&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;1.4&lt;/span&gt;]])  &lt;span class=&#34;comment&#34;&gt;# è¾“å…¥é›†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train_y = np.array([&lt;span class=&#34;number&#34;&gt;5.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;5.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;6.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;6.8&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;7.0&lt;/span&gt;])  &lt;span class=&#34;comment&#34;&gt;# è¾“å‡ºé›†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆ›å»ºçº¿æ€§å›å½’å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;line_model = lm.LinearRegression()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ç”¨å·²çŸ¥è¾“å…¥ã€è¾“å‡ºæ•°æ®é›†è®­ç»ƒå›å½’å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;line_model.fit(train_x, train_y)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ ¹æ®è®­ç»ƒæ¨¡å‹é¢„æµ‹è¾“å‡º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pred_y = line_model.predict(train_x)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;coef_:&amp;quot;&lt;/span&gt;, line_model.coef_)  &lt;span class=&#34;comment&#34;&gt;# ç³»æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;intercept_:&amp;quot;&lt;/span&gt;, line_model.intercept_)  &lt;span class=&#34;comment&#34;&gt;# æˆªè·&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å¯è§†åŒ–å›å½’æ›²çº¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.figure(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Linear Regression&amp;#x27;&lt;/span&gt;, facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;lightgray&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Linear Regression&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;x&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;y&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.tick_params(labelsize=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.grid(linestyle=&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ç»˜åˆ¶æ ·æœ¬ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.scatter(train_x, train_y, c=&lt;span class=&#34;string&#34;&gt;&amp;#x27;blue&amp;#x27;&lt;/span&gt;, alpha=&lt;span class=&#34;number&#34;&gt;0.8&lt;/span&gt;, s=&lt;span class=&#34;number&#34;&gt;60&lt;/span&gt;, label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;Sample&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ç»˜åˆ¶æ‹Ÿåˆç›´çº¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.plot(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    train_x,  &lt;span class=&#34;comment&#34;&gt;# xåæ ‡æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pred_y,  &lt;span class=&#34;comment&#34;&gt;# yåæ ‡æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    c=&lt;span class=&#34;string&#34;&gt;&amp;#x27;orangered&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;Regression Line&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.legend()  &lt;span class=&#34;comment&#34;&gt;# å·¦ä¸Šè§’çš„å›¾ä¾‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.show()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;coef_: [2.2189781]
intercept_: 4.107299270072994
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_14_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; datasets, linear_model, model_selection&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# science kit learn è‡ªå¸¦çš„ç³–å°¿ç—…æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;X, y = datasets.load_diabetes(return_X_y=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 442 * 10 å¤§å°çš„äºŒç»´æ•°ç»„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(X.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# No.1 * 10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(X[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åªå–ç¬¬äºŒç»´çš„ç¬¬ä¸‰åˆ—ä½œä¸ºç‰¹å¾è¾“å…¥ (ä¹Ÿå°±æ˜¯0.06169621è¿™ä¸€åˆ—)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;X = X[:, np.newaxis, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# train : test = 2 : 1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;X_train, X_test, y_train, y_test = model_selection.train_test_split(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    X, y, test_size=&lt;span class=&#34;number&#34;&gt;0.33&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = linear_model.LinearRegression()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.fit(X_train, y_train)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_pred = model.predict(X_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.scatter(X_test, y_test, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;black&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(X_test, y_pred, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;blue&amp;#x27;&lt;/span&gt;, linewidth=&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;(442, 10)
[ 0.03807591  0.05068012  0.06169621  0.02187235 -0.0442235  -0.03482076
 -0.04340085 -0.00259226  0.01990842 -0.01764613]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_15_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; datetime &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; datetime&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pumpkins = pd.read_csv(&lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/US-pumpkins.csv&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pumpkins = pumpkins[pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;.contains(&lt;span class=&#34;string&#34;&gt;&amp;#x27;bushel&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                     &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt;=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                     regex=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# pumpkins.head()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# pumpkins.isnull().sum()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# A set of new columns for a new dataframe. Filter out nonmatching columns&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pumpkins = pumpkins.drop([&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    c &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; c &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; pumpkins.columns &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; c &lt;span class=&#34;keyword&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; [&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Variety&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;City Name&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Month&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Low Price&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;High Price&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;&amp;#x27;Date&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                         axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Get an average between low and high price for the base pumpkin price&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;price = (pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Low Price&amp;#x27;&lt;/span&gt;] + pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;High Price&amp;#x27;&lt;/span&gt;]) / &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Create a new dataframe with this basic data&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_pumpkins = pd.DataFrame(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# Convert the date to its month only&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Month&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pd.DatetimeIndex(pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Date&amp;#x27;&lt;/span&gt;]).month,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;DayOfYear&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pd.to_datetime(pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Date&amp;#x27;&lt;/span&gt;]).apply(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;lambda&lt;/span&gt; dt: (dt - datetime(dt.year, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)).days),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Variety&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Variety&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;City&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;City Name&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Low Price&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Low Price&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;High Price&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;High Price&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Price&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    price&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Convert the price if the Package contains fractional bushel values&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# loc éå†Packageåˆ—ä¸­åŒ…å« &amp;#x27;1 1/9&amp;#x27; çš„è¡Œ, å¯¹æ¯è¡Œçš„ Price åˆ—è¿›è¡Œæ“ä½œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_pumpkins.loc[new_pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;.contains(&lt;span class=&#34;string&#34;&gt;&amp;#x27;1 1/9&amp;#x27;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                 &lt;span class=&#34;string&#34;&gt;&amp;#x27;Price&amp;#x27;&lt;/span&gt;] = price / (&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; / &lt;span class=&#34;number&#34;&gt;9&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_pumpkins.loc[new_pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;.contains(&lt;span class=&#34;string&#34;&gt;&amp;#x27;1/2&amp;#x27;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                 &lt;span class=&#34;string&#34;&gt;&amp;#x27;Price&amp;#x27;&lt;/span&gt;] = price / (&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; / &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ•£ç‚¹å›¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.scatter(new_pumpkins.Price, new_pumpkins.Month)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Price&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Month&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æŸ±çŠ¶å›¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_pumpkins.groupby([&lt;span class=&#34;string&#34;&gt;&amp;#x27;Month&amp;#x27;&lt;/span&gt;])[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Price&amp;#x27;&lt;/span&gt;].mean().plot(kind=&lt;span class=&#34;string&#34;&gt;&amp;#x27;bar&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Month&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ax = &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;colors = [&lt;span class=&#34;string&#34;&gt;&amp;#x27;red&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;blue&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;green&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;yellow&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i, var &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;enumerate&lt;/span&gt;(new_pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Variety&amp;#x27;&lt;/span&gt;].unique()):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ax = new_pumpkins[new_pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Variety&amp;#x27;&lt;/span&gt;] == var].plot.scatter(&lt;span class=&#34;string&#34;&gt;&amp;#x27;DayOfYear&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                                   &lt;span class=&#34;string&#34;&gt;&amp;#x27;Price&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                                   ax=ax,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                                   c=colors[i],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                                   label=var)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_16_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_16_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_16_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;å¤šé¡¹å¼å›å½’&#34;&gt;å¤šé¡¹å¼å›å½’&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; datetime &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; datetime&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.linear_model &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; LinearRegression&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; r2_score, mean_squared_error, mean_absolute_error&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; train_test_split&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; PolynomialFeatures&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.pipeline &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; make_pipeline&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pumpkins = pd.read_csv(&lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/US-pumpkins.csv&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pumpkins = pumpkins[pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;.contains(&lt;span class=&#34;string&#34;&gt;&amp;#x27;bushel&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                     &lt;span class=&#34;keyword&#34;&gt;case&lt;/span&gt;=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                     regex=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pumpkins = pumpkins.drop([&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    c &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; c &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; pumpkins.columns &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; c &lt;span class=&#34;keyword&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; [&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Variety&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;City Name&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Month&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Low Price&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;High Price&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;&amp;#x27;Date&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                         axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;price = (pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Low Price&amp;#x27;&lt;/span&gt;] + pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;High Price&amp;#x27;&lt;/span&gt;]) / &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_pumpkins = pd.DataFrame(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Month&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pd.DatetimeIndex(pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Date&amp;#x27;&lt;/span&gt;]).month,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;DayOfYear&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pd.to_datetime(pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Date&amp;#x27;&lt;/span&gt;]).apply(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;lambda&lt;/span&gt; dt: (dt - datetime(dt.year, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)).days),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Variety&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Variety&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;City&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;City Name&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Low Price&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Low Price&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;High Price&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;High Price&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Price&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    price&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_pumpkins.loc[new_pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;.contains(&lt;span class=&#34;string&#34;&gt;&amp;#x27;1 1/9&amp;#x27;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                 &lt;span class=&#34;string&#34;&gt;&amp;#x27;Price&amp;#x27;&lt;/span&gt;] = price / &lt;span class=&#34;number&#34;&gt;1.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_pumpkins.loc[new_pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;.contains(&lt;span class=&#34;string&#34;&gt;&amp;#x27;1/2&amp;#x27;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                 &lt;span class=&#34;string&#34;&gt;&amp;#x27;Price&amp;#x27;&lt;/span&gt;] = price * &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pie_pumpkins = new_pumpkins[new_pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Variety&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;string&#34;&gt;&amp;#x27;PIE TYPE&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;X_train, X_test, y_train, y_test = train_test_split(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pie_pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;DayOfYear&amp;#x27;&lt;/span&gt;].to_numpy().reshape(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pie_pumpkins[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Price&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    test_size=&lt;span class=&#34;number&#34;&gt;0.2&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    random_state=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pipeline = make_pipeline(PolynomialFeatures(&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;), LinearRegression())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pipeline.fit(X_train, y_train)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pred = pipeline.predict(X_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mse = np.sqrt(mean_squared_error(y_test, pred))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;f&amp;#x27;Mean error: &lt;span class=&#34;subst&#34;&gt;&amp;#123;mse:&lt;span class=&#34;number&#34;&gt;3.3&lt;/span&gt;&amp;#125;&lt;/span&gt; (&lt;span class=&#34;subst&#34;&gt;&amp;#123;mse/np.mean(pred)*&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;:&lt;span class=&#34;number&#34;&gt;3.3&lt;/span&gt;&amp;#125;&lt;/span&gt;%)&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;score = pipeline.score(X_train, y_train)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Model determination: &amp;#x27;&lt;/span&gt;, score)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.scatter(X_test, y_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(&lt;span class=&#34;built_in&#34;&gt;sorted&lt;/span&gt;(X_test), pipeline.predict(&lt;span class=&#34;built_in&#34;&gt;sorted&lt;/span&gt;(X_test)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;Mean error: 2.73 (17.0%)
Model determination:  0.07639977655280084





[&amp;lt;matplotlib.lines.Line2D at 0x19b75ee76d0&amp;gt;]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_18_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;å†³ç­–æ ‘-éšæœºæ£®æ—&#34;&gt;å†³ç­–æ ‘-éšæœºæ£®æ—&lt;/h3&gt;
&lt;h4 id=&#34;å†³ç­–æ ‘åˆ†ç±»&#34;&gt;å†³ç­–æ ‘åˆ†ç±»&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mpl&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; tree&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.tree &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; DecisionTreeClassifier&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; train_test_split&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; accuracy_score&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; LabelEncoder&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pydotplus&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;font.sans-serif&amp;#x27;&lt;/span&gt;] = [&lt;span class=&#34;string&#34;&gt;&amp;#x27;simHei&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;axes.unicode_minus&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;iris_feature_E = &lt;span class=&#34;string&#34;&gt;&amp;#x27;sepal length&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;sepal width&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;petal length&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;petal width&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;iris_feature = &lt;span class=&#34;string&#34;&gt;&amp;#x27;èŠ±è¼é•¿åº¦&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;èŠ±è¼å®½åº¦&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;èŠ±ç“£é•¿åº¦&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;èŠ±ç“£å®½åº¦&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;iris_class = &lt;span class=&#34;string&#34;&gt;&amp;#x27;Iris-setosa&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Iris-versicolor&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Iris-virginica&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path = &lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/iris_classification/iris.data&amp;#x27;&lt;/span&gt;  &lt;span class=&#34;comment&#34;&gt;# æ•°æ®æ–‡ä»¶è·¯å¾„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data = pd.read_csv(path, header=&lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x = data[&lt;span class=&#34;built_in&#34;&gt;list&lt;/span&gt;(&lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;))]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# y = pd.Categorical(data[4]).codes&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y = LabelEncoder().fit_transform(data[&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ä¸ºäº†å¯è§†åŒ–ï¼Œä»…ä½¿ç”¨å‰ä¸¤åˆ—ç‰¹å¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x = x[[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# x = x.iloc[:, :2]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x_train, x_test, y_train, y_test = train_test_split(x,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    y,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    test_size=&lt;span class=&#34;number&#34;&gt;0.3&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    random_state=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å†³ç­–æ ‘å‚æ•°ä¼°è®¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# min_samples_split = 10ï¼šå¦‚æœè¯¥ç»“ç‚¹åŒ…å«çš„æ ·æœ¬æ•°ç›®å¤§äº10ï¼Œåˆ™(æœ‰å¯èƒ½)å¯¹å…¶åˆ†æ”¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# min_samples_leaf = 10ï¼šè‹¥å°†æŸç»“ç‚¹åˆ†æ”¯åï¼Œå¾—åˆ°çš„æ¯ä¸ªå­ç»“ç‚¹æ ·æœ¬æ•°ç›®éƒ½å¤§äº10ï¼Œåˆ™å®Œæˆåˆ†æ”¯ï¼›å¦åˆ™ï¼Œä¸è¿›è¡Œåˆ†æ”¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = DecisionTreeClassifier(criterion=&lt;span class=&#34;string&#34;&gt;&amp;#x27;entropy&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.fit(x_train, y_train)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_train_pred = model.predict(x_train)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;è®­ç»ƒé›†æ­£ç¡®ç‡ï¼š&amp;#x27;&lt;/span&gt;, accuracy_score(y_train, y_train_pred))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_test_hat = model.predict(x_test)  &lt;span class=&#34;comment&#34;&gt;# æµ‹è¯•æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;æµ‹è¯•é›†æ­£ç¡®ç‡ï¼š&amp;#x27;&lt;/span&gt;, accuracy_score(y_test, y_test_hat))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ä¿å­˜&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# dot -Tpng my.dot -o my.png&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 1ã€è¾“å‡º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# with open(&amp;#x27;iris.dot&amp;#x27;, &amp;#x27;w&amp;#x27;) as f:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#     tree.export_graphviz(model, out_file=f, feature_names=iris_feature_E[0:2], class_names=iris_class,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#                          filled=True, rounded=True, special_characters=True)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;tree.export_graphviz(model,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                     out_file=&lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/iris_classification/iris.dot&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                     feature_names=iris_feature_E[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;:&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                     class_names=iris_class,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                     filled=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                     rounded=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                     special_characters=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 2ã€ç»™å®šæ–‡ä»¶å&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# tree.export_graphviz(model, out_file=&amp;#x27;iris.dot&amp;#x27;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# tree.export_graphviz(model, out_file=&amp;#x27;iris.dot&amp;#x27;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 3ã€è¾“å‡ºä¸ºpdfæ ¼å¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;dot_data = tree.export_graphviz(model,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                out_file=&lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                feature_names=iris_feature_E[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;:&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                class_names=iris_class,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                filled=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                rounded=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                special_characters=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;graph = pydotplus.graph_from_dot_data(dot_data)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;graph.write_pdf(&lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/iris_classification/iris.pdf&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;f = &lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/iris_classification/iris.png&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;wb&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;f.write(graph.create_png())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;f.close()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ç”»å›¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;N, M = &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;  &lt;span class=&#34;comment&#34;&gt;# æ¨ªçºµå„é‡‡æ ·å¤šå°‘ä¸ªå€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x1_min, x2_min = x.&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x1_max, x2_max = x.&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;t1 = np.linspace(x1_min, x1_max, N)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;t2 = np.linspace(x2_min, x2_max, M)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x1, x2 = np.meshgrid(t1, t2)  &lt;span class=&#34;comment&#34;&gt;# ç”Ÿæˆç½‘æ ¼é‡‡æ ·ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x_show = np.stack((x1.flat, x2.flat), axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# æµ‹è¯•ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(x_show.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;x_show = \n&amp;#x27;&lt;/span&gt;, x_show)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cm_light = mpl.colors.ListedColormap([&lt;span class=&#34;string&#34;&gt;&amp;#x27;#A0FFA0&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;#FFA0A0&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;#A0A0FF&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cm_dark = mpl.colors.ListedColormap([&lt;span class=&#34;string&#34;&gt;&amp;#x27;g&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_show_hat = model.predict(x_show)  &lt;span class=&#34;comment&#34;&gt;# é¢„æµ‹å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(y_show_hat.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(y_show_hat)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_show_hat = y_show_hat.reshape(x1.shape)  &lt;span class=&#34;comment&#34;&gt;# ä½¿ä¹‹ä¸è¾“å…¥çš„å½¢çŠ¶ç›¸åŒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(y_show_hat)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.pcolormesh(x1, x2, y_show_hat, cmap=cm_light, shading=&lt;span class=&#34;string&#34;&gt;&amp;#x27;auto&amp;#x27;&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# é¢„æµ‹å€¼çš„æ˜¾ç¤º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.scatter(x_test[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            x_test[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            c=y_test.ravel(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            edgecolors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            s=&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            zorder=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            cmap=cm_dark,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            marker=&lt;span class=&#34;string&#34;&gt;&amp;#x27;*&amp;#x27;&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# æµ‹è¯•æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.scatter(x[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], x[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], c=y.ravel(), edgecolors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;, s=&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            cmap=cm_dark)  &lt;span class=&#34;comment&#34;&gt;# å…¨éƒ¨æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(iris_feature[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], fontsize=&lt;span class=&#34;number&#34;&gt;13&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(iris_feature[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], fontsize=&lt;span class=&#34;number&#34;&gt;13&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlim(x1_min, x1_max)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylim(x2_min, x2_max)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.grid(b=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, ls=&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;#606060&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;é¸¢å°¾èŠ±æ•°æ®çš„å†³ç­–æ ‘åˆ†ç±»&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;15&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è®­ç»ƒé›†ä¸Šçš„é¢„æµ‹ç»“æœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_test = y_test.reshape(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(y_test_hat)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(y_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;result = (y_test_hat == y_test)  &lt;span class=&#34;comment&#34;&gt;# Trueåˆ™é¢„æµ‹æ­£ç¡®ï¼ŒFalseåˆ™é¢„æµ‹é”™è¯¯&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;acc = np.mean(result)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;å‡†ç¡®åº¦: %.2f%%&amp;#x27;&lt;/span&gt; % (&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt; * acc))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è¿‡æ‹Ÿåˆï¼šé”™è¯¯ç‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;depth = np.arange(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;15&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;err_train_list = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;err_test_list = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;clf = DecisionTreeClassifier(criterion=&lt;span class=&#34;string&#34;&gt;&amp;#x27;entropy&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; d &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; depth:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    clf.set_params(max_depth=d)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    clf.fit(x_train, y_train)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    y_train_pred = clf.predict(x_train)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    err_train = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; - accuracy_score(y_train, y_train_pred)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    err_train_list.append(err_train)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    y_test_pred = clf.predict(x_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    err_test = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; - accuracy_score(y_test, y_test_pred)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    err_test_list.append(err_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(d, &lt;span class=&#34;string&#34;&gt;&amp;#x27; æµ‹è¯•é›†é”™è¯¯ç‡: %.2f%%&amp;#x27;&lt;/span&gt; % (&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt; * err_test))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(depth,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         err_test_list,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;string&#34;&gt;&amp;#x27;ro-&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         markeredgecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         lw=&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;æµ‹è¯•é›†é”™è¯¯ç‡&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(depth,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         err_train_list,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         &lt;span class=&#34;string&#34;&gt;&amp;#x27;go-&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         markeredgecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         lw=&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;è®­ç»ƒé›†é”™è¯¯ç‡&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;å†³ç­–æ ‘æ·±åº¦&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;13&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;é”™è¯¯ç‡&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;13&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.legend(loc=&lt;span class=&#34;string&#34;&gt;&amp;#x27;lower left&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;13&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;å†³ç­–æ ‘æ·±åº¦ä¸è¿‡æ‹Ÿåˆ&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;15&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.grid(b=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, ls=&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;#606060&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;è®­ç»ƒé›†æ­£ç¡®ç‡ï¼š 0.9523809523809523
æµ‹è¯•é›†æ­£ç¡®ç‡ï¼š 0.6222222222222222
(2500, 2)
x_show =
 [[4.3        2.        ]
 [4.37346939 2.        ]
 [4.44693878 2.        ]
 ...
 [7.75306122 4.4       ]
 [7.82653061 4.4       ]
 [7.9        4.4       ]]
(2500,)
[0 0 0 ... 2 2 2]
[[0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 [0 0 0 ... 1 1 1]
 ...
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]
 [0 0 0 ... 2 2 2]]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_20_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[0 1 2 0 2 2 1 0 0 2 2 0 1 2 1 0 2 1 0 0 1 0 2 0 2 1 0 0 1 1 2 2 2 2 1 0 1
 0 2 1 2 0 1 1 1]
[0 1 1 0 2 1 2 0 0 2 1 0 2 1 1 0 1 1 0 0 1 1 1 0 2 1 0 0 1 2 1 2 1 2 2 0 1
 0 1 2 2 0 2 2 1]
å‡†ç¡®åº¦: 62.22%
1  æµ‹è¯•é›†é”™è¯¯ç‡: 44.44%
2  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%
3  æµ‹è¯•é›†é”™è¯¯ç‡: 20.00%
4  æµ‹è¯•é›†é”™è¯¯ç‡: 24.44%
5  æµ‹è¯•é›†é”™è¯¯ç‡: 24.44%
6  æµ‹è¯•é›†é”™è¯¯ç‡: 28.89%
7  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%
8  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%
9  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%
10  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%
11  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%
12  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%
13  æµ‹è¯•é›†é”™è¯¯ç‡: 40.00%
14  æµ‹è¯•é›†é”™è¯¯ç‡: 37.78%
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_20_3.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;éšæœºæ£®æ—&#34;&gt;éšæœºæ£®æ—&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mpl&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.tree &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; DecisionTreeClassifier&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; accuracy_score&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; train_test_split&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;font.sans-serif&amp;#x27;&lt;/span&gt;] = [&lt;span class=&#34;string&#34;&gt;&amp;#x27;SimHei&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;axes.unicode_minus&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;iris_feature = &lt;span class=&#34;string&#34;&gt;u&amp;#x27;èŠ±è¼é•¿åº¦&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;u&amp;#x27;èŠ±è¼å®½åº¦&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;u&amp;#x27;èŠ±ç“£é•¿åº¦&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;u&amp;#x27;èŠ±ç“£å®½åº¦&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path = &lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/iris_classification/iris.data&amp;#x27;&lt;/span&gt;  &lt;span class=&#34;comment&#34;&gt;# æ•°æ®æ–‡ä»¶è·¯å¾„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data = pd.read_csv(path, header=&lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x_prime = data[&lt;span class=&#34;built_in&#34;&gt;list&lt;/span&gt;(&lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;))]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y = pd.Categorical(data[&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;]).codes&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x_prime_train, x_prime_test, y_train, y_test = train_test_split(x_prime,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                                y,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                                train_size=&lt;span class=&#34;number&#34;&gt;0.7&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                                random_state=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;feature_pairs = [[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;6&lt;/span&gt;), facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;#FFFFFF&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i, pair &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;enumerate&lt;/span&gt;(feature_pairs):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# å‡†å¤‡æ•°æ®&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    x_train = x_prime_train[pair]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    x_test = x_prime_test[pair]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# å†³ç­–æ ‘å­¦ä¹ &lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    model = DecisionTreeClassifier(criterion=&lt;span class=&#34;string&#34;&gt;&amp;#x27;entropy&amp;#x27;&lt;/span&gt;, min_samples_leaf=&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    model.fit(x_train, y_train)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    N, M = &lt;span class=&#34;number&#34;&gt;500&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;500&lt;/span&gt;  &lt;span class=&#34;comment&#34;&gt;# æ¨ªçºµå„é‡‡æ ·å¤šå°‘ä¸ªå€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    x1_min, x2_min = x_train.&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    x1_max, x2_max = x_train.&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    t1 = np.linspace(x1_min, x1_max, N)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    t2 = np.linspace(x2_min, x2_max, M)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    x1, x2 = np.meshgrid(t1, t2)  &lt;span class=&#34;comment&#34;&gt;# ç”Ÿæˆç½‘æ ¼é‡‡æ ·ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    x_show = np.stack((x1.flat, x2.flat), axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# æµ‹è¯•ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# è®­ç»ƒé›†ä¸Šçš„é¢„æµ‹ç»“æœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    y_train_pred = model.predict(x_train)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    acc_train = accuracy_score(y_train, y_train_pred)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    y_test_pred = model.predict(x_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    acc_test = accuracy_score(y_test, y_test_pred)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;ç‰¹å¾ï¼š&amp;#x27;&lt;/span&gt;, iris_feature[pair[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;]], &lt;span class=&#34;string&#34;&gt;&amp;#x27; + &amp;#x27;&lt;/span&gt;, iris_feature[pair[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;\tè®­ç»ƒé›†å‡†ç¡®ç‡: %.4f%%&amp;#x27;&lt;/span&gt; % (&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt; * acc_train))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;\tæµ‹è¯•é›†å‡†ç¡®ç‡: %.4f%%\n&amp;#x27;&lt;/span&gt; % (&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt; * acc_test))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    cm_light = mpl.colors.ListedColormap([&lt;span class=&#34;string&#34;&gt;&amp;#x27;#A0FFA0&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;#FFA0A0&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;#A0A0FF&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    cm_dark = mpl.colors.ListedColormap([&lt;span class=&#34;string&#34;&gt;&amp;#x27;g&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    y_hat = model.predict(x_show)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    y_hat = y_hat.reshape(x1.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.subplot(&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, i + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.contour(x1,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                x2,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                y_hat,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                colors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                levels=[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                antialiased=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                linewidths=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.pcolormesh(x1, x2, y_hat, cmap=cm_light, shading=&lt;span class=&#34;string&#34;&gt;&amp;#x27;auto&amp;#x27;&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# é¢„æµ‹å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.scatter(x_train[pair[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;]],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                x_train[pair[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                c=y_train,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                s=&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                edgecolors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                cmap=cm_dark,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                label=&lt;span class=&#34;string&#34;&gt;u&amp;#x27;è®­ç»ƒé›†&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.scatter(x_test[pair[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;]],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                x_test[pair[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                c=y_test,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                s=&lt;span class=&#34;number&#34;&gt;80&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                marker=&lt;span class=&#34;string&#34;&gt;&amp;#x27;*&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                edgecolors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                cmap=cm_dark,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                label=&lt;span class=&#34;string&#34;&gt;u&amp;#x27;æµ‹è¯•é›†&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.xlabel(iris_feature[pair[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;]], fontsize=&lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.ylabel(iris_feature[pair[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]], fontsize=&lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# plt.legend(loc=&amp;#x27;upper right&amp;#x27;, fancybox=True, framealpha=0.3)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.xlim(x1_min, x1_max)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.ylim(x2_min, x2_max)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.grid(b=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, ls=&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;#606060&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.suptitle(&lt;span class=&#34;string&#34;&gt;u&amp;#x27;å†³ç­–æ ‘å¯¹é¸¢å°¾èŠ±æ•°æ®ä¸¤ç‰¹å¾ç»„åˆçš„åˆ†ç±»ç»“æœ&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;15&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.tight_layout(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, rect=(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.94&lt;/span&gt;))  &lt;span class=&#34;comment&#34;&gt;# (left, bottom, right, top)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;ç‰¹å¾ï¼š èŠ±è¼é•¿åº¦  +  èŠ±è¼å®½åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 85.7143%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 71.1111%

ç‰¹å¾ï¼š èŠ±è¼é•¿åº¦  +  èŠ±ç“£é•¿åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 96.1905%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 91.1111%

ç‰¹å¾ï¼š èŠ±è¼é•¿åº¦  +  èŠ±ç“£å®½åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 96.1905%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 86.6667%

ç‰¹å¾ï¼š èŠ±è¼å®½åº¦  +  èŠ±ç“£é•¿åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 97.1429%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 95.5556%

ç‰¹å¾ï¼š èŠ±è¼å®½åº¦  +  èŠ±ç“£å®½åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 96.1905%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 84.4444%

ç‰¹å¾ï¼š èŠ±ç“£é•¿åº¦  +  èŠ±ç“£å®½åº¦
	è®­ç»ƒé›†å‡†ç¡®ç‡: 98.0952%
	æµ‹è¯•é›†å‡†ç¡®ç‡: 97.7778%



C:\Users\utsuk\AppData\Local\Temp\ipykernel_25000\2108356862.py:83: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.
  plt.tight_layout(1, rect=(0, 0, 1, 0.94))  # (left, bottom, right, top)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_22_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’&#34;&gt;å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mpl&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.ensemble &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; RandomForestRegressor&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;N = &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [-3,3)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x = np.random.rand(N) * &lt;span class=&#34;number&#34;&gt;6&lt;/span&gt; - &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x.sort()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y = np.sin(x) + np.random.randn(N) * &lt;span class=&#34;number&#34;&gt;0.05&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x = x.reshape(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(x)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(y)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# model = DecisionTreeRegressor(criterion=&amp;#x27;mse&amp;#x27;, max_depth=10)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = RandomForestRegressor(n_estimators=&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;, criterion=&lt;span class=&#34;string&#34;&gt;&amp;#x27;mse&amp;#x27;&lt;/span&gt;, max_depth=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.fit(x, y)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x_test = np.linspace(-&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;).reshape(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_hat = model.predict(x_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;font.sans-serif&amp;#x27;&lt;/span&gt;] = [&lt;span class=&#34;string&#34;&gt;&amp;#x27;SimHei&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;axes.unicode_minus&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(x, y, &lt;span class=&#34;string&#34;&gt;&amp;#x27;r*&amp;#x27;&lt;/span&gt;, markersize=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, markeredgecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;, label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;å®é™…å€¼&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(x_test, y_hat, &lt;span class=&#34;string&#34;&gt;&amp;#x27;g-&amp;#x27;&lt;/span&gt;, linewidth=&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;é¢„æµ‹å€¼&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.legend(loc=&lt;span class=&#34;string&#34;&gt;&amp;#x27;upper left&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;X&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Y&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.grid(b=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, ls=&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;#606060&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;15&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.tight_layout(&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ¯”è¾ƒå†³ç­–æ ‘çš„æ·±åº¦å½±å“&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;depth = [&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;6&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;clr = &lt;span class=&#34;string&#34;&gt;&amp;#x27;rgbmy&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# model = DecisionTreeRegressor(criterion=&amp;#x27;mse&amp;#x27;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = RandomForestRegressor(n_estimators=&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;, criterion=&lt;span class=&#34;string&#34;&gt;&amp;#x27;mse&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(x, y, &lt;span class=&#34;string&#34;&gt;&amp;#x27;ro&amp;#x27;&lt;/span&gt;, ms=&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;, mec=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;, label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;å®é™…å€¼&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x_test = np.linspace(-&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;).reshape(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; d, c &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;zip&lt;/span&gt;(depth, clr):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    model.set_params(max_depth=d)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    model.fit(x, y)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    y_hat = model.predict(x_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.plot(x_test,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;             y_hat,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;             &lt;span class=&#34;string&#34;&gt;&amp;#x27;-&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;             color=c,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;             linewidth=&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;             markeredgecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;             label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;Depth=%d&amp;#x27;&lt;/span&gt; % d)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.legend(loc=&lt;span class=&#34;string&#34;&gt;&amp;#x27;upper left&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;X&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Y&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.grid(b=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, ls=&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;#606060&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;å†³ç­–æ ‘-éšæœºæ£®æ—å›å½’&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;15&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.tight_layout(&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;[[-2.95013857]
 [-2.91406777]
 [-2.90709403]
 [-2.90375999]
 [-2.87745415]
 [-2.86685497]
 [-2.84070033]
 [-2.81375697]
 [-2.77943784]
 [-2.77745775]
 [-2.66347611]
 [-2.65986762]
 [-2.64217075]
 [-2.63778267]
 [-2.63639243]
 [-2.60165162]
 [-2.48896096]
 [-2.43041085]
 [-2.39941506]
 [-2.38779079]
 [-2.37856289]
 [-2.32809632]
 [-2.29426051]
 [-2.25524085]
 [-2.23914776]
 [-2.16578847]
 [-2.0055294 ]
 [-1.9885004 ]
 [-1.73199798]
 [-1.61893958]
 [-1.58908223]
 [-1.54966302]
 [-1.49074428]
 [-1.46530843]
 [-1.40362808]
 [-1.3935955 ]
 [-1.3928819 ]
 [-1.37684247]
 [-1.3377295 ]
 [-1.33035029]
 [-1.24577529]
 [-1.15561278]
 [-1.12976361]
 [-0.92771942]
 [-0.91536325]
 [-0.83851709]
 [-0.54828961]
 [-0.54587447]
 [-0.54456521]
 [-0.51610774]
 [-0.38078143]
 [-0.27298529]
 [-0.20898971]
 [-0.20866835]
 [ 0.01703485]
 [ 0.03203468]
 [ 0.06107388]
 [ 0.07358949]
 [ 0.07361575]
 [ 0.10676155]
 [ 0.15818226]
 [ 0.20123638]
 [ 0.3410772 ]
 [ 0.45680655]
 [ 0.52384169]
 [ 0.65741898]
 [ 0.68306354]
 [ 0.82845395]
 [ 0.83952908]
 [ 0.99278446]
 [ 1.04865533]
 [ 1.16809926]
 [ 1.21294563]
 [ 1.44659934]
 [ 1.47606149]
 [ 1.48031876]
 [ 1.54476213]
 [ 1.54542061]
 [ 1.60452852]
 [ 1.85706958]
 [ 1.9814776 ]
 [ 2.07801869]
 [ 2.08420295]
 [ 2.08974078]
 [ 2.09458999]
 [ 2.21547939]
 [ 2.2354401 ]
 [ 2.2824592 ]
 [ 2.39313024]
 [ 2.4822308 ]
 [ 2.5275393 ]
 [ 2.56392915]
 [ 2.63696096]
 [ 2.65318554]
 [ 2.66286196]
 [ 2.67531127]
 [ 2.69337798]
 [ 2.78329004]
 [ 2.83409465]
 [ 2.94897411]]
[-0.16517944 -0.2651016  -0.26383212 -0.2408083  -0.21137157 -0.30729908
 -0.24489794 -0.42738593 -0.39536257 -0.34762803 -0.55252409 -0.40629331
 -0.47658554 -0.47459876 -0.50897455 -0.58933727 -0.57144697 -0.61564276
 -0.76543047 -0.64009055 -0.79612233 -0.77625958 -0.82824783 -0.74228023
 -0.6882561  -0.85479709 -0.9210133  -0.88824326 -0.94228155 -1.04205908
 -1.01456756 -1.0150173  -1.01319155 -0.93942161 -1.0101109  -1.00949492
 -1.00669835 -1.02762794 -0.90526463 -1.04873446 -0.98356087 -0.96345712
 -0.90790305 -0.78617335 -0.8215092  -0.7756252  -0.62805774 -0.61416394
 -0.55438357 -0.54877048 -0.24409899 -0.24654351 -0.22139215 -0.31816396
 -0.00948097  0.03731195  0.07871564  0.06089414  0.091661    0.10130855
  0.05916354  0.284293    0.32301758  0.47390064  0.43774825  0.59439442
  0.62285701  0.78479681  0.7888438   0.91498224  0.91654605  0.84583033
  0.90598404  0.99494553  1.05048367  0.97256267  1.04768316  1.09246729
  0.92367061  0.97097779  0.98148804  0.86766162  0.87249721  0.81545132
  0.80772307  0.75639662  0.73792794  0.75909448  0.71239606  0.63892773
  0.6373865   0.53978973  0.47836416  0.47544309  0.4156747   0.46233128
  0.43384357  0.32001956  0.2980857   0.16211947]


C:\Users\utsuk\AppData\Local\Temp\ipykernel_25000\2984870596.py:33: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.
  plt.tight_layout(2)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_24_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;C:\Users\utsuk\AppData\Local\Temp\ipykernel_25000\2984870596.py:60: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.
  plt.tight_layout(2)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_24_4.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;åˆ†ç±»é—®é¢˜&#34;&gt;åˆ†ç±»é—®é¢˜&lt;/h3&gt;
&lt;h4 id=&#34;é€»è¾‘å›å½’&#34;&gt;é€»è¾‘å›å½’&lt;/h4&gt;
&lt;h5 id=&#34;äºŒåˆ†ç±»&#34;&gt;äºŒåˆ†ç±»&lt;/h5&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.linear_model &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; lm&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x = np.array([[&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;6&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;],\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              [&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;7&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y = np.array([&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆ›å»ºé€»è¾‘åˆ†ç±»å™¨å¯¹è±¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Cå‚æ•°ï¼šæ­£åˆ™å¼ºåº¦ï¼Œè¶Šå¤§æ‹Ÿåˆæ•ˆæœè¶Šå°ï¼Œé€šè¿‡è°ƒæ•´è¯¥å‚æ•°é˜²æ­¢è¿‡æ‹Ÿåˆ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# solverå‚æ•°ï¼šé€»è¾‘å‡½æ•°ä¸­æŒ‡æ•°çš„å‡½æ•°å…³ç³»ï¼ˆliblinearè¡¨ç¤ºçº¿æ€§å…³ç³»ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = lm.LogisticRegression()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.fit(x, y)  &lt;span class=&#34;comment&#34;&gt;# è®­ç»ƒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# é¢„æµ‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;test_x = np.array([[&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;9&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;6&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;test_y = model.predict(test_x)  &lt;span class=&#34;comment&#34;&gt;# é¢„æµ‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(test_y)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è®¡ç®—æ˜¾ç¤ºåæ ‡çš„è¾¹ç•Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# x[:, 0].min()   x ä¸­æ‰€æœ‰æ•°ç»„çš„ç¬¬ä¸€ä½&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;left = x[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;() - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;right = x[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;() + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;buttom = x[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;() - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;top = x[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;() + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# äº§ç”Ÿç½‘æ ¼åŒ–çŸ©é˜µ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;grid_x, grid_y = np.meshgrid(np.arange(left, right, &lt;span class=&#34;number&#34;&gt;0.01&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                             np.arange(buttom, top, &lt;span class=&#34;number&#34;&gt;0.01&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;grid_x.shape:&amp;quot;&lt;/span&gt;, grid_x.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;grid_y.shape:&amp;quot;&lt;/span&gt;, grid_y.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å°†x,yåæ ‡åˆå¹¶æˆä¸¤åˆ—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mesh_x = np.column_stack((grid_x.ravel(), grid_y.ravel()))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;mesh_x.shape:&amp;quot;&lt;/span&gt;, mesh_x.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ ¹æ®æ¯ä¸ªç‚¹çš„xyåæ ‡è¿›è¡Œé¢„æµ‹ï¼Œå¹¶è¿˜åŸæˆäºŒç»´å½¢çŠ¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mesh_z = model.predict(mesh_x)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mesh_z = mesh_z.reshape(grid_x.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.figure(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Logistic Regression&amp;#x27;&lt;/span&gt;, facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;lightgray&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Logistic Regression&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;x&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;y&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.tick_params(labelsize=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.pcolormesh(grid_x, grid_y, mesh_z, cmap=&lt;span class=&#34;string&#34;&gt;&amp;#x27;gray&amp;#x27;&lt;/span&gt;, shading=&lt;span class=&#34;string&#34;&gt;&amp;#x27;auto&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.scatter(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    x[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;],  &lt;span class=&#34;comment&#34;&gt;# æ ·æœ¬xåæ ‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    x[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;],  &lt;span class=&#34;comment&#34;&gt;# æ ·æœ¬yåæ ‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    c=y,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    cmap=&lt;span class=&#34;string&#34;&gt;&amp;#x27;brg&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    s=&lt;span class=&#34;number&#34;&gt;80&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.scatter(test_x[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], test_x[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], c=&lt;span class=&#34;string&#34;&gt;&amp;quot;red&amp;quot;&lt;/span&gt;, marker=&lt;span class=&#34;string&#34;&gt;&amp;#x27;s&amp;#x27;&lt;/span&gt;, s=&lt;span class=&#34;number&#34;&gt;80&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;[1 0]
grid_x.shape: (1100, 700)
grid_y.shape: (1100, 700)
mesh_x.shape: (770000, 2)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_27_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h5 id=&#34;å¤šåˆ†ç±»&#34;&gt;å¤šåˆ†ç±»&lt;/h5&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.linear_model &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; lm&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è¾“å…¥&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x = np.array([[&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;7&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;3.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;3.1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;6.2&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;1.2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1.9&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;              [&lt;span class=&#34;number&#34;&gt;6&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;5.7&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1.5&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;5.4&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2.2&lt;/span&gt;]])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è¾“å‡ºï¼ˆå¤šä¸ªç±»åˆ«ï¼‰&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y = np.array([&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆ›å»ºé€»è¾‘åˆ†ç±»å™¨å¯¹è±¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = lm.LogisticRegression(C=&lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# è°ƒæ•´è¯¥å€¼ä¸º1çœ‹æ•ˆæœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.fit(x, y)  &lt;span class=&#34;comment&#34;&gt;# è®­ç»ƒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åæ ‡è½´èŒƒå›´&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;left = x[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;() - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;right = x[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;() + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;h = &lt;span class=&#34;number&#34;&gt;0.005&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;buttom = x[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;() - &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;top = x[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;].&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;() + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;v = &lt;span class=&#34;number&#34;&gt;0.005&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;grid_x, grid_y = np.meshgrid(np.arange(left, right, h),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                             np.arange(buttom, top, v))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mesh_x = np.column_stack((grid_x.ravel(), grid_y.ravel()))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mesh_z = model.predict(mesh_x)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mesh_z = mesh_z.reshape(grid_x.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å¯è§†åŒ–&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.figure(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Logistic Classification&amp;#x27;&lt;/span&gt;, facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;lightgray&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Logistic Classification&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;x&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;y&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.tick_params(labelsize=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.pcolormesh(grid_x, grid_y, mesh_z, cmap=&lt;span class=&#34;string&#34;&gt;&amp;#x27;gray&amp;#x27;&lt;/span&gt;, shading=&lt;span class=&#34;string&#34;&gt;&amp;#x27;auto&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.scatter(x[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], x[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], c=y, cmap=&lt;span class=&#34;string&#34;&gt;&amp;#x27;brg&amp;#x27;&lt;/span&gt;, s=&lt;span class=&#34;number&#34;&gt;80&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_29_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; datetime &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; datetime&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.linear_model &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; LinearRegression&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; r2_score, mean_squared_error, mean_absolute_error&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; train_test_split&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; PolynomialFeatures, LabelEncoder&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.pipeline &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; make_pipeline&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; seaborn &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sns&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pumpkins = pd.read_csv(&lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/US-pumpkins.csv&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# pumpkins = pumpkins[pumpkins[&amp;#x27;Package&amp;#x27;].str.contains(&amp;#x27;bushel&amp;#x27;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#                                                      case=True,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#                                                      regex=True)]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_pumpkins = pumpkins.drop([&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    c &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; c &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; pumpkins.columns &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; c &lt;span class=&#34;keyword&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    [&lt;span class=&#34;string&#34;&gt;&amp;#x27;Color&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Origin&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Item Size&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Variety&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;City Name&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Package&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                             axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_pumpkins.dropna(inplace=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_pumpkins = new_pumpkins.apply(LabelEncoder().fit_transform)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# é¢œè‰²æ•°æ®ä¸å…¶ä»–åˆ—çš„å…³ç³»&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sns.PairGrid(new_pumpkins).&lt;span class=&#34;built_in&#34;&gt;map&lt;/span&gt;(sns.scatterplot)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆ†ç±»æ•£ç‚¹å›¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# sns.swarmplot(x=&amp;quot;Color&amp;quot;, y=&amp;quot;Item Size&amp;quot;, data=new_pumpkins)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å°æç´å›¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sns.catplot(x=&lt;span class=&#34;string&#34;&gt;&amp;quot;Color&amp;quot;&lt;/span&gt;, y=&lt;span class=&#34;string&#34;&gt;&amp;quot;Item Size&amp;quot;&lt;/span&gt;, kind=&lt;span class=&#34;string&#34;&gt;&amp;quot;violin&amp;quot;&lt;/span&gt;, data=new_pumpkins)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;seaborn.axisgrid.FacetGrid at 0x19b7ed39fd0&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_30_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_30_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;æ”¯æŒå‘é‡æœº-SVM&#34;&gt;æ”¯æŒå‘é‡æœº-SVM&lt;/h4&gt;
&lt;h5 id=&#34;æ ¸å‡½æ•°&#34;&gt;æ ¸å‡½æ•°&lt;/h5&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;çº¿æ€§&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¾„å‘åŸº-é«˜æ–¯&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mpl&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; svm&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; train_test_split&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; accuracy_score&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; GridSearchCV&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; time &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; time&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;iris_feature = &lt;span class=&#34;string&#34;&gt;&amp;#x27;èŠ±è¼é•¿åº¦&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;èŠ±è¼å®½åº¦&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;èŠ±ç“£é•¿åº¦&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;èŠ±ç“£å®½åº¦&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;path = &lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/iris_classification/iris.data&amp;#x27;&lt;/span&gt;  &lt;span class=&#34;comment&#34;&gt;# æ•°æ®æ–‡ä»¶è·¯å¾„&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data = pd.read_csv(path, header=&lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x, y = data[[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]], pd.Categorical(data[&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;]).codes&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x_train, x_test, y_train, y_test = train_test_split(x,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    y,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    random_state=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    test_size=&lt;span class=&#34;number&#34;&gt;0.4&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆ†ç±»å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# svm_clf = svm.SVC(C=10, gamma=1, kernel=&amp;#x27;rbf&amp;#x27;, decision_function_shape=&amp;#x27;ovo&amp;#x27;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# svm_clf = svm.SVC(C=3, kernel=&amp;#x27;poly&amp;#x27;, degree=3)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;svm_clf = svm.SVC(C=&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, kernel=&lt;span class=&#34;string&#34;&gt;&amp;#x27;linear&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;GridSearchCV begin...&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;t = time()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;clf = svm_clf&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# clf = GridSearchCV(svm_clf, param_grid=&amp;#123;&amp;#x27;gamma&amp;#x27;:np.logspace(-2, 2, 10), &amp;#x27;C&amp;#x27;:np.logspace(-2, 2, 10)&amp;#125;, cv=3)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;clf.fit(x_train, y_train.ravel())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;t_end = time()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;è€—æ—¶ï¼š%dç§’&amp;#x27;&lt;/span&gt; % (t_end - t))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# print(&amp;#x27;æœ€ä¼˜å‚æ•°ï¼š&amp;#x27;, clf.best_params_)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å‡†ç¡®ç‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(clf.score(x_train, y_train))  &lt;span class=&#34;comment&#34;&gt;# ç²¾åº¦&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;è®­ç»ƒé›†å‡†ç¡®ç‡ï¼š&amp;#x27;&lt;/span&gt;, accuracy_score(y_train, clf.predict(x_train)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(clf.score(x_test, y_test))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;æµ‹è¯•é›†å‡†ç¡®ç‡ï¼š&amp;#x27;&lt;/span&gt;, accuracy_score(y_test, clf.predict(x_test)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# decision_function&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(x_train[:&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;decision_function:\n&amp;#x27;&lt;/span&gt;, clf.decision_function(x_train))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;\npredict:\n&amp;#x27;&lt;/span&gt;, clf.predict(x_train))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ç”»å›¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x1_min, x2_min = x.&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x1_max, x2_max = x.&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x1, x2 = np.mgrid[x1_min:x1_max:&lt;span class=&#34;number&#34;&gt;300j&lt;/span&gt;, x2_min:x2_max:&lt;span class=&#34;number&#34;&gt;300j&lt;/span&gt;]  &lt;span class=&#34;comment&#34;&gt;# ç”Ÿæˆç½‘æ ¼é‡‡æ ·ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;grid_test = np.stack((x1.flat, x2.flat), axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# æµ‹è¯•ç‚¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;grid_hat = clf.predict(grid_test)  &lt;span class=&#34;comment&#34;&gt;# é¢„æµ‹åˆ†ç±»å€¼&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;grid_hat = grid_hat.reshape(x1.shape)  &lt;span class=&#34;comment&#34;&gt;# ä½¿ä¹‹ä¸è¾“å…¥çš„å½¢çŠ¶ç›¸åŒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;font.sans-serif&amp;#x27;&lt;/span&gt;] = [&lt;span class=&#34;string&#34;&gt;&amp;#x27;SimHei&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;axes.unicode_minus&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cm_light = mpl.colors.ListedColormap([&lt;span class=&#34;string&#34;&gt;&amp;#x27;#A0FFA0&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;#FFA0A0&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;#A0A0FF&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cm_dark = mpl.colors.ListedColormap([&lt;span class=&#34;string&#34;&gt;&amp;#x27;g&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.pcolormesh(x1, x2, grid_hat, cmap=cm_light, shading=&lt;span class=&#34;string&#34;&gt;&amp;#x27;auto&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.scatter(x[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], x[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], c=y, edgecolors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;, s=&lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;, cmap=cm_dark)  &lt;span class=&#34;comment&#34;&gt;# æ ·æœ¬&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.scatter(x_test[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], x_test[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], s=&lt;span class=&#34;number&#34;&gt;120&lt;/span&gt;, facecolors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;none&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            zorder=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;)  &lt;span class=&#34;comment&#34;&gt;# åœˆä¸­æµ‹è¯•é›†æ ·æœ¬&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(iris_feature[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], fontsize=&lt;span class=&#34;number&#34;&gt;13&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(iris_feature[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], fontsize=&lt;span class=&#34;number&#34;&gt;13&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlim(x1_min, x1_max)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylim(x2_min, x2_max)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;é¸¢å°¾èŠ±SVMäºŒç‰¹å¾åˆ†ç±»&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.grid(b=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, ls=&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.tight_layout(pad=&lt;span class=&#34;number&#34;&gt;1.5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;GridSearchCV begin...
è€—æ—¶ï¼š0ç§’
0.7888888888888889
è®­ç»ƒé›†å‡†ç¡®ç‡ï¼š 0.7888888888888889
0.7833333333333333
æµ‹è¯•é›†å‡†ç¡®ç‡ï¼š 0.7833333333333333
       0    1
11   4.8  3.4
113  5.7  2.5
123  6.3  2.7
12   4.8  3.0
2    4.7  3.2
decision_function:
 [[ 2.27077043  0.77466667 -0.23050192]
 [-0.26084184  2.25751125  1.0560141 ]
 [-0.28293421  2.25843306  1.22796515]
 [ 2.24308998  0.92588576 -0.2355186 ]
 [ 2.26643883  0.80879936 -0.24170145]
 [-0.28069428  1.23581332  2.24817619]
 [ 2.28018898  0.76457517 -0.24714914]
 [-0.25832462  1.21350955  2.20811726]
 [-0.27289547  1.20094518  2.249947  ]
 [-0.28479994  1.2318958   2.26058535]
 [-0.23449614  2.22389578  1.08207816]
 [-0.27824598  1.19362022  2.2618816 ]
 [-0.24940836  1.20624284  2.19142888]
 [ 2.2732283  -0.2577432   0.82271427]
 [-0.2872948   2.27977562  1.1680301 ]
 [-0.28016055  1.24346593  2.23969255]
 [-0.28069428  1.23581332  2.24817619]
 [-0.17539161  2.25364746  0.77515212]
 [-0.25325305  1.14281388  2.23566431]
 [-0.2421088   2.25159667  0.90072452]
 [ 2.24374936 -0.23761503  0.93581753]
 [ 2.24150985  0.87804111 -0.2241573 ]
 [ 2.28041834 -0.27382086  0.86293615]
 [-0.27824598  1.19362022  2.2618816 ]
 [ 2.27361996  0.84008337 -0.26180365]
 [-0.26919985  2.24943754  1.18347413]
 [-0.28629221  2.26101768  1.23745359]
 [-0.23808639  1.19803786  2.16960812]
 [ 2.24670891 -0.21840299  0.83780678]
 [ 2.23817757  0.82105098 -0.19112107]
 [-0.2549617   2.24213564  1.1247623 ]
 [ 2.24150985  0.87804111 -0.2241573 ]
 [-0.30409023  1.27536123  2.28319903]
 [-0.27073104  1.23503534  2.2197061 ]
 [-0.30441277  1.26883084  2.28803158]
 [-0.28752494  1.24411663  2.25991942]
 [-0.29292012  2.28000741  1.22212062]
 [-0.23176304  1.04104242  2.22722296]
 [-0.28694643  1.15125962  2.28088265]
 [-0.19956441  2.19653578  1.01742803]
 [ 2.26878977 -0.27918692  1.16597018]
 [-0.2549617   2.24213564  1.1247623 ]
 [ 2.18519501  1.23494087 -0.26146238]
 [-0.2512831   2.2597216   0.89408741]
 [-0.29066599  1.240849    2.26933123]
 [ 2.25729439 -0.2129225   0.79411601]
 [-0.29441953  1.26382422  2.26345809]
 [ 2.26377705 -0.22976306  0.79617407]
 [ 2.27077043  0.77466667 -0.23050192]
 [-0.2445374   1.07681969  2.23683943]
 [-0.21840757  2.21786592  1.00447438]
 [-0.28524498  1.22203776  2.26581127]
 [ 2.24947915  0.81045802 -0.20787766]
 [ 2.2684482  -0.24915018  0.81973595]
 [-0.20907334  1.12013512  2.17603067]
 [ 2.26728139  0.82893904 -0.24984081]
 [-0.2549617   2.24213564  1.1247623 ]
 [ 2.25207771  0.85867453 -0.23431088]
 [-0.28069428  1.23581332  2.24817619]
 [ 1.05055292  2.22662497 -0.23240122]
 [ 2.2722284   0.7997718  -0.24896247]
 [-0.26723747  1.19201787  2.24286157]
 [ 2.27827649  0.82682975 -0.26630655]
 [-0.17333043  2.16553945  1.02939988]
 [ 2.26890439  0.89311197 -0.26243597]
 [-0.2512831   2.2597216   0.89408741]
 [-0.23341849  2.27309387  0.7709214 ]
 [ 2.25617562 -0.22437834  0.81410784]
 [ 2.22986475  0.96247553 -0.22562355]
 [ 0.93771503  2.24006469 -0.23365567]
 [ 2.28631446 -0.25590025  0.75474384]
 [-0.23808639  1.19803786  2.16960812]
 [-0.2646401   1.23019768  2.20613126]
 [ 2.25729439 -0.2129225   0.79411601]
 [-0.28479994  1.2318958   2.26058535]
 [-0.22087216  2.20491832  1.08971052]
 [-0.29260626  2.28238001  1.20719635]
 [-0.29101034  1.23272406  2.27341138]
 [-0.2549617   2.24213564  1.1247623 ]
 [ 2.19974418 -0.17699012  0.91119813]
 [ 2.21209755  1.01040036 -0.21350121]
 [-0.27849238  2.26059076  1.19977637]
 [-0.26997469  2.24280567  1.20408124]
 [-0.29874557  1.25977449  2.27874043]
 [-0.25377271  2.24886239  1.06528288]
 [-0.27961589  2.2500049   1.22933155]
 [-0.27219081  1.21466357  2.24182934]
 [-0.2884762   2.2710352   1.22512174]
 [-0.28479994  1.2318958   2.26058535]
 [ 2.24150985  0.87804111 -0.2241573 ]]

predict:
 [0 1 1 0 0 2 0 2 2 2 1 2 2 0 1 2 2 1 2 1 0 0 0 2 0 1 1 2 0 0 1 0 2 2 2 2 1
 2 2 1 0 1 0 1 2 0 2 0 0 2 1 2 0 0 2 0 1 0 2 1 0 2 0 1 0 1 1 0 0 1 0 2 2 0
 2 1 1 2 1 0 0 1 1 2 1 1 2 1 2 0]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_32_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; svm&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; scipy &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; stats&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; accuracy_score&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mpl&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;extend&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;a, b, r=&lt;span class=&#34;number&#34;&gt;0.01&lt;/span&gt;&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; a * (&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; + r) - b * r, -a * r + b * (&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; + r)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;np.random.seed(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;N = &lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x = np.empty((&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt; * N, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;means = [(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), (&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), (&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), (-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sigmas = [&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    np.eye(&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;), &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt; * np.eye(&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    np.diag((&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;)),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    np.array(((&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;), (&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mn = stats.multivariate_normal(means[i], sigmas[i] * &lt;span class=&#34;number&#34;&gt;0.07&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    x[i * N:(i + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) * N, :] = mn.rvs(N)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;a = np.array((&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;)).reshape((-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y = np.tile(a, N).flatten()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;clf = svm.SVC(C=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, kernel=&lt;span class=&#34;string&#34;&gt;&amp;#x27;rbf&amp;#x27;&lt;/span&gt;, gamma=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, decision_function_shape=&lt;span class=&#34;string&#34;&gt;&amp;#x27;ovo&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# clf = svm.SVC(C=1, kernel=&amp;#x27;linear&amp;#x27;, decision_function_shape=&amp;#x27;ovr&amp;#x27;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;clf.fit(x, y)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_hat = clf.predict(x)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;acc = accuracy_score(y, y_hat)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;np.set_printoptions(suppress=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬ä¸ªæ•°ï¼š%dï¼Œæ­£ç¡®ç‡ï¼š%.2f%%&amp;#x27;&lt;/span&gt; % (&lt;span class=&#34;built_in&#34;&gt;round&lt;/span&gt;(acc * &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt; * N), &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt; * acc))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# decision_function&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(clf.decision_function(x))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(y_hat)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x1_min, x2_min = np.&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;(x, axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x1_max, x2_max = np.&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;(x, axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x1_min, x1_max = extend(x1_min, x1_max)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x2_min, x2_max = extend(x2_min, x2_max)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x1, x2 = np.mgrid[x1_min:x1_max:&lt;span class=&#34;number&#34;&gt;500j&lt;/span&gt;, x2_min:x2_max:&lt;span class=&#34;number&#34;&gt;500j&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x_test = np.stack((x1.flat, x2.flat), axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_test = clf.predict(x_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_test = y_test.reshape(x1.shape)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cm_light = mpl.colors.ListedColormap(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    [&lt;span class=&#34;string&#34;&gt;&amp;#x27;#FF8080&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;#80FF80&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;#8080FF&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;#F0F080&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cm_dark = mpl.colors.ListedColormap([&lt;span class=&#34;string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;g&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;y&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;font.sans-serif&amp;#x27;&lt;/span&gt;] = [&lt;span class=&#34;string&#34;&gt;&amp;#x27;SimHei&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;axes.unicode_minus&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.pcolormesh(x1, x2, y_test, cmap=cm_light, shading=&lt;span class=&#34;string&#34;&gt;&amp;#x27;auto&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.contour(x1, x2, y_test, levels=(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;), colors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;, linestyles=&lt;span class=&#34;string&#34;&gt;&amp;#x27;--&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.scatter(x[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            x[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            s=&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            c=y,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            cmap=cm_dark,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            edgecolors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            alpha=&lt;span class=&#34;number&#34;&gt;0.7&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;$X_1$&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;11&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;$X_2$&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;11&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlim((x1_min, x1_max))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylim((x2_min, x2_max))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.grid(b=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.tight_layout(pad=&lt;span class=&#34;number&#34;&gt;2.5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;SVMå¤šåˆ†ç±»æ–¹æ³•ï¼šOne/One or One/Other&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;é¢„æµ‹æ­£ç¡®çš„æ ·æœ¬ä¸ªæ•°ï¼š793ï¼Œæ­£ç¡®ç‡ï¼š99.12%
[[ 1.30403817  1.18371967  1.61069453  0.53379555  0.10282667 -0.6639782 ]
 [ 1.20484592  1.00041165  1.13023042  0.32840742  0.16888308 -0.33559223]
 [ 1.28448754  1.15305262  1.24310512  0.59725054 -0.31474389 -0.97622623]
 ...
 [-0.23584035 -0.08224918 -1.09483656  0.1554822  -1.12200744 -1.12840424]
 [ 0.2447751   0.34444513 -1.55255237  0.17064062 -1.24348982 -1.41973039]
 [-0.03070327 -0.15566364 -1.9254549  -0.09600454 -1.23897289 -1.44257329]]
[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_33_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;æœ´ç´ è´å¶æ–¯&#34;&gt;æœ´ç´ è´å¶æ–¯&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;class&lt;/span&gt; &lt;span class=&#34;title class_&#34;&gt;NBClassify&lt;/span&gt;(&lt;span class=&#34;title class_ inherited__&#34;&gt;object&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;__init__&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self, fillNa=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.fillNa = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;pass&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;train&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self, trainSet&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# è®¡ç®—æ¯ç§ç±»åˆ«çš„æ¦‚ç‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# ä¿å­˜æ‰€æœ‰tagçš„æ‰€æœ‰ç§ç±»ï¼ŒåŠå®ƒä»¬å‡ºç°çš„é¢‘æ¬¡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dictTag = &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; subTuple &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; trainSet:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            dictTag[&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                subTuple[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;])] = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;(subTuple[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]) &lt;span class=&#34;keyword&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictTag.keys(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                ) &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; dictTag[&lt;span class=&#34;built_in&#34;&gt;str&lt;/span&gt;(subTuple[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;])] + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# ä¿å­˜æ¯ä¸ªtagæœ¬èº«çš„æ¦‚ç‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        tagProbablity = &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        totalFreq = &lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;([value &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; value &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictTag.values()])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; key, value &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictTag.items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            tagProbablity[key] = value / totalFreq&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# print(tagProbablity)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.tagProbablity = tagProbablity&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;##############################################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# è®¡ç®—ç‰¹å¾çš„æ¡ä»¶æ¦‚ç‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# ä¿å­˜ç‰¹å¾å±æ€§åŸºæœ¬ä¿¡æ¯&amp;#123;ç‰¹å¾1:&amp;#123;å€¼1:å‡ºç°5æ¬¡, å€¼2:å‡ºç°1æ¬¡&amp;#125;, ç‰¹å¾2:&amp;#123;å€¼1:å‡ºç°1æ¬¡, å€¼2:å‡ºç°5æ¬¡&amp;#125;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dictFeaturesBase = &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; subTuple &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; trainSet:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; key, value &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; subTuple[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; key &lt;span class=&#34;keyword&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictFeaturesBase.keys():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    dictFeaturesBase[key] = &amp;#123;value: &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; value &lt;span class=&#34;keyword&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictFeaturesBase[key].keys():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        dictFeaturesBase[key][value] = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        dictFeaturesBase[key][value] += &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# dictFeaturesBase = &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# &amp;#x27;èŒä¸š&amp;#x27;: &amp;#123;&amp;#x27;å†œå¤«&amp;#x27;: 1, &amp;#x27;æ•™å¸ˆ&amp;#x27;: 2, &amp;#x27;å»ºç­‘å·¥äºº&amp;#x27;: 2, &amp;#x27;æŠ¤å£«&amp;#x27;: 1&amp;#125;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# &amp;#x27;ç—‡çŠ¶&amp;#x27;: &amp;#123;&amp;#x27;æ‰“å–·åš&amp;#x27;: 3, &amp;#x27;å¤´ç—›&amp;#x27;: 3&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        dictFeatures = &amp;#123;&amp;#125;.fromkeys([key &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; key &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictTag])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; key &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictFeatures.keys():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            dictFeatures[key] = &amp;#123;&amp;#125;.fromkeys([key &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; key &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictFeaturesBase])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; key, value &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictFeatures.items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; subkey &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; value.keys():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                value[subkey] = &amp;#123;&amp;#125;.fromkeys(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    [x &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; x &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictFeaturesBase[subkey].keys()])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# dictFeatures = &amp;#123;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;#  &amp;#x27;æ„Ÿå†’ &amp;#x27;: &amp;#123;&amp;#x27;ç—‡çŠ¶&amp;#x27;: &amp;#123;&amp;#x27;æ‰“å–·åš&amp;#x27;: None, &amp;#x27;å¤´ç—›&amp;#x27;: None&amp;#125;, &amp;#x27;èŒä¸š&amp;#x27;: &amp;#123;&amp;#x27;æŠ¤å£«&amp;#x27;: None, &amp;#x27;å†œå¤«&amp;#x27;: None, &amp;#x27;å»ºç­‘å·¥äºº&amp;#x27;: None, &amp;#x27;æ•™å¸ˆ&amp;#x27;: None&amp;#125;&amp;#125;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;#  &amp;#x27;è„‘éœ‡è¡&amp;#x27;: &amp;#123;&amp;#x27;ç—‡çŠ¶&amp;#x27;: &amp;#123;&amp;#x27;æ‰“å–·åš&amp;#x27;: None, &amp;#x27;å¤´ç—›&amp;#x27;: None&amp;#125;, &amp;#x27;èŒä¸š&amp;#x27;: &amp;#123;&amp;#x27;æŠ¤å£«&amp;#x27;: None, &amp;#x27;å†œå¤«&amp;#x27;: None, &amp;#x27;å»ºç­‘å·¥äºº&amp;#x27;: None, &amp;#x27;æ•™å¸ˆ&amp;#x27;: None&amp;#125;&amp;#125;,&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;#  &amp;#x27;è¿‡æ• &amp;#x27;: &amp;#123;&amp;#x27;ç—‡çŠ¶&amp;#x27;: &amp;#123;&amp;#x27;æ‰“å–·åš&amp;#x27;: None, &amp;#x27;å¤´ç—›&amp;#x27;: None&amp;#125;, &amp;#x27;èŒä¸š&amp;#x27;: &amp;#123;&amp;#x27;æŠ¤å£«&amp;#x27;: None, &amp;#x27;å†œå¤«&amp;#x27;: None, &amp;#x27;å»ºç­‘å·¥äºº&amp;#x27;: None, &amp;#x27;æ•™å¸ˆ&amp;#x27;: None&amp;#125;&amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;#  &amp;#125;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# initialise dictFeatures&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; subTuple &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; trainSet:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; key, value &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; subTuple[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                dictFeatures[subTuple[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]][key][value] = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; dictFeatures[&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    subTuple[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]][key][value] == &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; dictFeatures[&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        subTuple[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;]][key][value] + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# print(dictFeatures)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# å°†é©¯è‰¯æ ·æœ¬ä¸­æ²¡æœ‰çš„é¡¹ç›®ï¼Œç”±Noneæ”¹ä¸ºä¸€ä¸ªéå¸¸å°çš„æ•°å€¼ï¼Œè¡¨ç¤ºå…¶æ¦‚ç‡æå°è€Œå¹¶éæ˜¯é›¶&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; tag, featuresDict &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictFeatures.items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; featureName, fetureValueDict &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; featuresDict.items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; featureKey, featureValues &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; fetureValueDict.items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; featureValues == &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        fetureValueDict[featureKey] = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# ç”±ç‰¹å¾é¢‘ç‡è®¡ç®—ç‰¹å¾çš„æ¡ä»¶æ¦‚ç‡P(feature|tag)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; tag, featuresDict &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; dictFeatures.items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; featureName, fetureValueDict &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; featuresDict.items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                totalCount = &lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    [x &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; x &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; fetureValueDict.values() &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; x != &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; featureKey, featureValues &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; fetureValueDict.items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    fetureValueDict[&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        featureKey] = featureValues / totalCount &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; featureValues != &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.featuresProbablity = dictFeatures&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;##############################################################################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;classify&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;self, featureDict&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        resultDict = &amp;#123;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# è®¡ç®—æ¯ä¸ªtagçš„æ¡ä»¶æ¦‚ç‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; key, value &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.tagProbablity.items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            iNumList = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; f, v &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; featureDict.items():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.featuresProbablity[key][f][v]:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                    iNumList.append(&lt;span class=&#34;variable language_&#34;&gt;self&lt;/span&gt;.featuresProbablity[key][f][v])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            conditionPr = &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; iNum &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; iNumList:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                conditionPr *= iNum&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            resultDict[key] = value * conditionPr&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;comment&#34;&gt;# å¯¹æ¯”æ¯ä¸ªtagçš„æ¡ä»¶æ¦‚ç‡çš„å¤§å°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        resultList = &lt;span class=&#34;built_in&#34;&gt;sorted&lt;/span&gt;(resultDict.items(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                            key=&lt;span class=&#34;keyword&#34;&gt;lambda&lt;/span&gt; x: x[&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                            reverse=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; resultList[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;][&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; __name__ == &lt;span class=&#34;string&#34;&gt;&amp;#x27;__main__&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    trainSet = [&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        (&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;ç—‡çŠ¶&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;æ‰“å–·åš&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;èŒä¸š&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;æŠ¤å£«&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;, &lt;span class=&#34;string&#34;&gt;&amp;quot;æ„Ÿå†’ &amp;quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        (&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;ç—‡çŠ¶&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;æ‰“å–·åš&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;èŒä¸š&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;å†œå¤«&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;, &lt;span class=&#34;string&#34;&gt;&amp;quot;è¿‡æ• &amp;quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        (&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;ç—‡çŠ¶&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;å¤´ç—›&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;èŒä¸š&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;å»ºç­‘å·¥äºº&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;, &lt;span class=&#34;string&#34;&gt;&amp;quot;è„‘éœ‡è¡&amp;quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        (&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;ç—‡çŠ¶&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;å¤´ç—›&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;èŒä¸š&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;å»ºç­‘å·¥äºº&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;, &lt;span class=&#34;string&#34;&gt;&amp;quot;æ„Ÿå†’ &amp;quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        (&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;ç—‡çŠ¶&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;æ‰“å–·åš&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;èŒä¸š&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;æ•™å¸ˆ&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;, &lt;span class=&#34;string&#34;&gt;&amp;quot;æ„Ÿå†’ &amp;quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        (&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;ç—‡çŠ¶&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;å¤´ç—›&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            &lt;span class=&#34;string&#34;&gt;&amp;quot;èŒä¸š&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;æ•™å¸ˆ&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &amp;#125;, &lt;span class=&#34;string&#34;&gt;&amp;quot;è„‘éœ‡è¡&amp;quot;&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    monitor = NBClassify()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# trainSet is something like that [(featureDict, tag), ]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    monitor.train(trainSet)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# æ‰“å–·åšçš„å»ºç­‘å·¥äºº&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# è¯·é—®ä»–æ‚£ä¸Šæ„Ÿå†’çš„æ¦‚ç‡æœ‰å¤šå¤§ï¼Ÿ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    result = monitor.classify(&amp;#123;&lt;span class=&#34;string&#34;&gt;&amp;quot;ç—‡çŠ¶&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;æ‰“å–·åš&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;èŒä¸š&amp;quot;&lt;/span&gt;: &lt;span class=&#34;string&#34;&gt;&amp;quot;å»ºç­‘å·¥äºº&amp;quot;&lt;/span&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(result)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;æ„Ÿå†’
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;å¤šå…ƒé—®é¢˜-èœè‚´åˆ†ç±»&#34;&gt;å¤šå…ƒé—®é¢˜-èœè‚´åˆ†ç±»&lt;/h4&gt;
&lt;h5 id=&#34;æ•°æ®åŠ è½½ä¸æ¸…æ´—&#34;&gt;æ•°æ®åŠ è½½ä¸æ¸…æ´—&lt;/h5&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mpl&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; imblearn.over_sampling &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; SMOTE&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;df = pd.read_csv(&lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/cuisines_classification/cuisines.csv&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;df.head()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# df.info()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th &amp;#123;
    vertical-align: top;
&amp;#125;

.dataframe thead th &amp;#123;
    text-align: right;
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;/style&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Unnamed: 0&lt;/th&gt;
      &lt;th&gt;cuisine&lt;/th&gt;
      &lt;th&gt;almond&lt;/th&gt;
      &lt;th&gt;angelica&lt;/th&gt;
      &lt;th&gt;anise&lt;/th&gt;
      &lt;th&gt;anise_seed&lt;/th&gt;
      &lt;th&gt;apple&lt;/th&gt;
      &lt;th&gt;apple_brandy&lt;/th&gt;
      &lt;th&gt;apricot&lt;/th&gt;
      &lt;th&gt;armagnac&lt;/th&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;th&gt;whiskey&lt;/th&gt;
      &lt;th&gt;white_bread&lt;/th&gt;
      &lt;th&gt;white_wine&lt;/th&gt;
      &lt;th&gt;whole_grain_wheat_flour&lt;/th&gt;
      &lt;th&gt;wine&lt;/th&gt;
      &lt;th&gt;wood&lt;/th&gt;
      &lt;th&gt;yam&lt;/th&gt;
      &lt;th&gt;yeast&lt;/th&gt;
      &lt;th&gt;yogurt&lt;/th&gt;
      &lt;th&gt;zucchini&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;65&lt;/td&gt;
      &lt;td&gt;indian&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;66&lt;/td&gt;
      &lt;td&gt;indian&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;67&lt;/td&gt;
      &lt;td&gt;indian&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;68&lt;/td&gt;
      &lt;td&gt;indian&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;69&lt;/td&gt;
      &lt;td&gt;indian&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;5 rows Ã— 385 columns&lt;/p&gt;
&lt;/div&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# èœè‚´æˆåˆ†åˆ†æ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;create_ingredient_df&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;df&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ingredient_df = df.T.drop([&lt;span class=&#34;string&#34;&gt;&amp;#x27;cuisine&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                               &lt;span class=&#34;string&#34;&gt;&amp;#x27;Unnamed: 0&amp;#x27;&lt;/span&gt;]).&lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;(axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;).to_frame(&lt;span class=&#34;string&#34;&gt;&amp;#x27;value&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ingredient_df = ingredient_df[(ingredient_df.T != &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;).&lt;span class=&#34;built_in&#34;&gt;any&lt;/span&gt;()]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ingredient_df = ingredient_df.sort_values(by=&lt;span class=&#34;string&#34;&gt;&amp;#x27;value&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                              ascending=&lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                              inplace=&lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; ingredient_df&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆ†æåŸæ–™ä½¿ç”¨ç‡å‰å&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; [&lt;span class=&#34;string&#34;&gt;&amp;quot;thai&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;japanese&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;chinese&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;indian&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;korean&amp;quot;&lt;/span&gt;]:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ingredient_df = create_ingredient_df(df[(df.cuisine == i)])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ingredient_df.head(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;).plot.barh().set_title(i)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆ æ‰å¹¶ä¸é‡è¦çš„ç‰¹å¾&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;feature_df = df.drop([&lt;span class=&#34;string&#34;&gt;&amp;#x27;cuisine&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Unnamed: 0&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;rice&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;garlic&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;ginger&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                     axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;labels_df = df.cuisine&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_38_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_38_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_38_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_38_3.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_38_4.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# èœè‚´æ ·æœ¬ä¸å‡,å¹³è¡¡æ•°æ®é›†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;transformed_feature_df, transformed_label_df = SMOTE().fit_resample(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    feature_df, labels_df)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# çƒ‚æ–¹æ³•å±•ç¤º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# for i in [&amp;quot;thai&amp;quot;, &amp;quot;japanese&amp;quot;, &amp;quot;chinese&amp;quot;, &amp;quot;indian&amp;quot;, &amp;quot;korean&amp;quot;]:&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;#     print(i, df.loc[df[&amp;#x27;cuisine&amp;#x27;] == i].shape)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# nicer one&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;f&amp;#x27;===================== old label count: ===================== \n&lt;span class=&#34;subst&#34;&gt;&amp;#123;labels_df.value_counts()&amp;#125;&lt;/span&gt;\&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;    \n===================== new label count: ===================== \n&lt;span class=&#34;subst&#34;&gt;&amp;#123;transformed_label_df.value_counts()&amp;#125;&lt;/span&gt;&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;transformed_df = pd.concat([transformed_label_df, transformed_feature_df],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                           axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                           join=&lt;span class=&#34;string&#34;&gt;&amp;#x27;outer&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# transformed_df.head()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;transformed_df.info()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;transformed_df.to_csv(&lt;span class=&#34;string&#34;&gt;&amp;quot;./_data_set/cuisines_classification/cleaned_cuisines.csv&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;===================== old label count: =====================
korean      799
indian      598
chinese     442
japanese    320
thai        289
Name: cuisine, dtype: int64
===================== new label count: =====================
indian      799
thai        799
chinese     799
japanese    799
korean      799
Name: cuisine, dtype: int64
&amp;lt;class &#39;pandas.core.frame.DataFrame&#39;&amp;gt;
RangeIndex: 3995 entries, 0 to 3994
Columns: 381 entries, cuisine to zucchini
dtypes: int64(380), object(1)
memory usage: 11.6+ MB
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;åˆ†ç±»-1&#34;&gt;åˆ†ç±»-1&lt;/h5&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.linear_model &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; LogisticRegression&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; train_test_split, cross_val_score&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; accuracy_score, precision_score, confusion_matrix, classification_report, precision_recall_curve&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.svm &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; SVC&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cuisines_df = pd.read_csv(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;quot;./_data_set/cuisines_classification/cleaned_cuisines.csv&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cuisines_df.head()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th &amp;#123;
    vertical-align: top;
&amp;#125;

.dataframe thead th &amp;#123;
    text-align: right;
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;/style&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;Unnamed: 0&lt;/th&gt;
      &lt;th&gt;cuisine&lt;/th&gt;
      &lt;th&gt;almond&lt;/th&gt;
      &lt;th&gt;angelica&lt;/th&gt;
      &lt;th&gt;anise&lt;/th&gt;
      &lt;th&gt;anise_seed&lt;/th&gt;
      &lt;th&gt;apple&lt;/th&gt;
      &lt;th&gt;apple_brandy&lt;/th&gt;
      &lt;th&gt;apricot&lt;/th&gt;
      &lt;th&gt;armagnac&lt;/th&gt;
      &lt;th&gt;...&lt;/th&gt;
      &lt;th&gt;whiskey&lt;/th&gt;
      &lt;th&gt;white_bread&lt;/th&gt;
      &lt;th&gt;white_wine&lt;/th&gt;
      &lt;th&gt;whole_grain_wheat_flour&lt;/th&gt;
      &lt;th&gt;wine&lt;/th&gt;
      &lt;th&gt;wood&lt;/th&gt;
      &lt;th&gt;yam&lt;/th&gt;
      &lt;th&gt;yeast&lt;/th&gt;
      &lt;th&gt;yogurt&lt;/th&gt;
      &lt;th&gt;zucchini&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;indian&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;indian&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;2&lt;/td&gt;
      &lt;td&gt;indian&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;3&lt;/td&gt;
      &lt;td&gt;indian&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;4&lt;/td&gt;
      &lt;td&gt;indian&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;...&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
      &lt;td&gt;1&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;5 rows Ã— 382 columns&lt;/p&gt;
&lt;/div&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;cuisines_label_df = cuisines_df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;cuisine&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cuisines_feature_df = cuisines_df.drop([&lt;span class=&#34;string&#34;&gt;&amp;#x27;Unnamed: 0&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;cuisine&amp;#x27;&lt;/span&gt;], axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;X_train, X_test, y_train, y_test = train_test_split(cuisines_feature_df,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    cuisines_label_df,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    test_size=&lt;span class=&#34;number&#34;&gt;0.3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;1137      korean&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;428         thai&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;191       indian&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;1336      korean&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;3947        thai&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;          ...&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;3335    japanese&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;3539        thai&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;436         thai&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;1875      indian&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;3079    japanese&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;Name: cuisine, Length: 2796, dtype: object&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;[&amp;#x27;korean&amp;#x27; &amp;#x27;thai&amp;#x27; &amp;#x27;indian&amp;#x27; ... &amp;#x27;thai&amp;#x27; &amp;#x27;indian&amp;#x27; &amp;#x27;japanese&amp;#x27;]&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt; &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# print(y_train)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# print(np.ravel(y_train))&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# lbfgs = LogisticRegression(solver=&amp;#x27;lbfgs&amp;#x27;)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = LogisticRegression(multi_class=&lt;span class=&#34;string&#34;&gt;&amp;#x27;ovr&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                           solver=&lt;span class=&#34;string&#34;&gt;&amp;#x27;liblinear&amp;#x27;&lt;/span&gt;).fit(X_train, np.ravel(y_train))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;accuracy = model.score(X_test, y_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# print(&amp;quot;Accuracy is &amp;#123;&amp;#125;&amp;quot;.format(accuracy))&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;f&amp;quot;Accuracy is &lt;span class=&#34;subst&#34;&gt;&amp;#123;accuracy&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;Accuracy is 0.7906588824020017
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [é€‰æ‹©æ€§ test] é’ˆå¯¹æŸä¸€è¡Œæµ‹è¯•&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;line_num = &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;f&amp;#x27;ingredients: &lt;span class=&#34;subst&#34;&gt;&amp;#123;X_test.iloc[line_num][X_test.iloc[line_num]!=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;].keys()&amp;#125;&lt;/span&gt;&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;f&amp;#x27;cuisine: &lt;span class=&#34;subst&#34;&gt;&amp;#123;y_test.iloc[line_num]&amp;#125;&lt;/span&gt;&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;test = X_test.iloc[line_num].values.reshape(-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;).T&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;proba = model.predict_proba(test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;classes = model.classes_&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;resultdf = pd.DataFrame(data=proba, columns=classes)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;topPrediction = resultdf.T.sort_values(by=[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], ascending=[&lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;topPrediction.head()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;ingredients: Index([&#39;butter&#39;, &#39;cayenne&#39;, &#39;cheese&#39;, &#39;cinnamon&#39;, &#39;coriander&#39;, &#39;onion&#39;,
       &#39;tomato&#39;, &#39;turmeric&#39;],
      dtype=&#39;object&#39;)
cuisine: indian


D:\Scoop\apps\anaconda3\current\lib\site-packages\sklearn\base.py:450: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
  warnings.warn(
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th &amp;#123;
    vertical-align: top;
&amp;#125;

.dataframe thead th &amp;#123;
    text-align: right;
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;/style&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;0&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;indian&lt;/th&gt;
      &lt;td&gt;0.962110&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;thai&lt;/th&gt;
      &lt;td&gt;0.021403&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;korean&lt;/th&gt;
      &lt;td&gt;0.011124&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;japanese&lt;/th&gt;
      &lt;td&gt;0.003710&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;chinese&lt;/th&gt;
      &lt;td&gt;0.001653&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;y_pred = model.predict(X_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(classification_report(y_test, y_pred))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;              precision    recall  f1-score   support

     chinese       0.76      0.68      0.72       242
      indian       0.91      0.93      0.92       239
    japanese       0.72      0.76      0.74       222
      korean       0.84      0.80      0.82       264
        thai       0.77      0.84      0.80       232

    accuracy                           0.80      1199
   macro avg       0.80      0.80      0.80      1199
weighted avg       0.80      0.80      0.80      1199
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;åˆ†ç±»-2&#34;&gt;åˆ†ç±»-2&lt;/h5&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.neighbors &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; KNeighborsClassifier&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.linear_model &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; LogisticRegression&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.svm &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; SVC&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.ensemble &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; RandomForestClassifier, AdaBoostClassifier&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; train_test_split, cross_val_score&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; accuracy_score, precision_score, confusion_matrix, classification_report, precision_recall_curve&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cuisines_df = pd.read_csv(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;quot;./_data_set/cuisines_classification/cleaned_cuisines.csv&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cuisines_label_df = cuisines_df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;cuisine&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cuisines_feature_df = cuisines_df.drop([&lt;span class=&#34;string&#34;&gt;&amp;#x27;Unnamed: 0&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;cuisine&amp;#x27;&lt;/span&gt;], axis=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;X_train, X_test, y_train, y_test = train_test_split(cuisines_feature_df,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    cuisines_label_df,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    test_size=&lt;span class=&#34;number&#34;&gt;0.3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ­£åˆ™åŒ–ç³»æ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;C = &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆ›å»ºä¸åŒçš„åˆ†ç±»å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;classifiers = &amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# çº¿æ€§ SVC åˆ†ç±»å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Linear SVC&amp;#x27;&lt;/span&gt;: SVC(kernel=&lt;span class=&#34;string&#34;&gt;&amp;#x27;linear&amp;#x27;&lt;/span&gt;, C=C, probability=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, random_state=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# K-è¿‘é‚»åˆ†ç±»å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;KNN classifier&amp;#x27;&lt;/span&gt;: KNeighborsClassifier(C),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# Support Vector åˆ†ç±»å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;SVC&amp;#x27;&lt;/span&gt;: SVC(),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# é›†æˆåˆ†ç±»å™¨, éšæœºæ£®æ— ä¸ ADA&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;RFST&amp;#x27;&lt;/span&gt;: RandomForestClassifier(n_estimators=&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;ADA&amp;#x27;&lt;/span&gt;: AdaBoostClassifier(n_estimators=&lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; index, (name, classifier) &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;enumerate&lt;/span&gt;(classifiers.items()):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    classifier.fit(X_train, np.ravel(y_train))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    y_pred = classifier.predict(X_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    accuracy = accuracy_score(y_test, y_pred)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;Accuracy (train) for %s: %0.1f%%&amp;quot;&lt;/span&gt; % (name, accuracy * &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(classification_report(y_test, y_pred))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;Accuracy (train) for Linear SVC: 80.2%
              precision    recall  f1-score   support

     chinese       0.73      0.76      0.74       250
      indian       0.86      0.89      0.88       235
    japanese       0.78      0.78      0.78       245
      korean       0.88      0.74      0.80       227
        thai       0.78      0.84      0.81       242

    accuracy                           0.80      1199
   macro avg       0.81      0.80      0.80      1199
weighted avg       0.81      0.80      0.80      1199

Accuracy (train) for KNN classifier: 73.6%
              precision    recall  f1-score   support

     chinese       0.71      0.73      0.72       250
      indian       0.80      0.86      0.83       235
    japanese       0.67      0.80      0.73       245
      korean       0.91      0.51      0.65       227
        thai       0.69      0.77      0.73       242

    accuracy                           0.74      1199
   macro avg       0.76      0.73      0.73      1199
weighted avg       0.75      0.74      0.73      1199

Accuracy (train) for SVC: 82.8%
              precision    recall  f1-score   support

     chinese       0.77      0.81      0.79       250
      indian       0.88      0.93      0.90       235
    japanese       0.82      0.76      0.79       245
      korean       0.90      0.77      0.83       227
        thai       0.79      0.88      0.83       242

    accuracy                           0.83      1199
   macro avg       0.83      0.83      0.83      1199
weighted avg       0.83      0.83      0.83      1199

Accuracy (train) for RFST: 84.5%
              precision    recall  f1-score   support

     chinese       0.82      0.81      0.82       250
      indian       0.85      0.93      0.89       235
    japanese       0.86      0.81      0.83       245
      korean       0.90      0.83      0.86       227
        thai       0.81      0.85      0.83       242

    accuracy                           0.84      1199
   macro avg       0.85      0.85      0.85      1199
weighted avg       0.85      0.84      0.84      1199

Accuracy (train) for ADA: 69.3%
              precision    recall  f1-score   support

     chinese       0.64      0.42      0.51       250
      indian       0.81      0.85      0.83       235
    japanese       0.65      0.61      0.63       245
      korean       0.62      0.82      0.71       227
        thai       0.73      0.79      0.76       242

    accuracy                           0.69      1199
   macro avg       0.69      0.70      0.69      1199
weighted avg       0.69      0.69      0.68      1199
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&#34;èšç±»é—®é¢˜&#34;&gt;èšç±»é—®é¢˜&lt;/h3&gt;
&lt;h4 id=&#34;èšç±»å…¥é—¨-æ•°æ®åˆ†å¸ƒ&#34;&gt;èšç±»å…¥é—¨-æ•°æ®åˆ†å¸ƒ&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;df = pd.read_csv(&lt;span class=&#34;string&#34;&gt;&amp;quot;./_data_set/Clustering/nigerian-songs.csv&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# df.head()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;df.info()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# object ç±»å‹é™¤å¤–&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;df.describe()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;class &#39;pandas.core.frame.DataFrame&#39;&amp;gt;
RangeIndex: 530 entries, 0 to 529
Data columns (total 16 columns):
 #   Column            Non-Null Count  Dtype
---  ------            --------------  -----
 0   name              530 non-null    object
 1   album             530 non-null    object
 2   artist            530 non-null    object
 3   artist_top_genre  530 non-null    object
 4   release_date      530 non-null    int64
 5   length            530 non-null    int64
 6   popularity        530 non-null    int64
 7   danceability      530 non-null    float64
 8   acousticness      530 non-null    float64
 9   energy            530 non-null    float64
 10  instrumentalness  530 non-null    float64
 11  liveness          530 non-null    float64
 12  loudness          530 non-null    float64
 13  speechiness       530 non-null    float64
 14  tempo             530 non-null    float64
 15  time_signature    530 non-null    int64
dtypes: float64(8), int64(4), object(4)
memory usage: 66.4+ KB
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th &amp;#123;
    vertical-align: top;
&amp;#125;

.dataframe thead th &amp;#123;
    text-align: right;
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;/style&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;release_date&lt;/th&gt;
      &lt;th&gt;length&lt;/th&gt;
      &lt;th&gt;popularity&lt;/th&gt;
      &lt;th&gt;danceability&lt;/th&gt;
      &lt;th&gt;acousticness&lt;/th&gt;
      &lt;th&gt;energy&lt;/th&gt;
      &lt;th&gt;instrumentalness&lt;/th&gt;
      &lt;th&gt;liveness&lt;/th&gt;
      &lt;th&gt;loudness&lt;/th&gt;
      &lt;th&gt;speechiness&lt;/th&gt;
      &lt;th&gt;tempo&lt;/th&gt;
      &lt;th&gt;time_signature&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;count&lt;/th&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
      &lt;td&gt;530.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;mean&lt;/th&gt;
      &lt;td&gt;2015.390566&lt;/td&gt;
      &lt;td&gt;222298.169811&lt;/td&gt;
      &lt;td&gt;17.507547&lt;/td&gt;
      &lt;td&gt;0.741619&lt;/td&gt;
      &lt;td&gt;0.265412&lt;/td&gt;
      &lt;td&gt;0.760623&lt;/td&gt;
      &lt;td&gt;0.016305&lt;/td&gt;
      &lt;td&gt;0.147308&lt;/td&gt;
      &lt;td&gt;-4.953011&lt;/td&gt;
      &lt;td&gt;0.130748&lt;/td&gt;
      &lt;td&gt;116.487864&lt;/td&gt;
      &lt;td&gt;3.986792&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;std&lt;/th&gt;
      &lt;td&gt;3.131688&lt;/td&gt;
      &lt;td&gt;39696.822259&lt;/td&gt;
      &lt;td&gt;18.992212&lt;/td&gt;
      &lt;td&gt;0.117522&lt;/td&gt;
      &lt;td&gt;0.208342&lt;/td&gt;
      &lt;td&gt;0.148533&lt;/td&gt;
      &lt;td&gt;0.090321&lt;/td&gt;
      &lt;td&gt;0.123588&lt;/td&gt;
      &lt;td&gt;2.464186&lt;/td&gt;
      &lt;td&gt;0.092939&lt;/td&gt;
      &lt;td&gt;23.518601&lt;/td&gt;
      &lt;td&gt;0.333701&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;min&lt;/th&gt;
      &lt;td&gt;1998.000000&lt;/td&gt;
      &lt;td&gt;89488.000000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.255000&lt;/td&gt;
      &lt;td&gt;0.000665&lt;/td&gt;
      &lt;td&gt;0.111000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.028300&lt;/td&gt;
      &lt;td&gt;-19.362000&lt;/td&gt;
      &lt;td&gt;0.027800&lt;/td&gt;
      &lt;td&gt;61.695000&lt;/td&gt;
      &lt;td&gt;3.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;25%&lt;/th&gt;
      &lt;td&gt;2014.000000&lt;/td&gt;
      &lt;td&gt;199305.000000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.681000&lt;/td&gt;
      &lt;td&gt;0.089525&lt;/td&gt;
      &lt;td&gt;0.669000&lt;/td&gt;
      &lt;td&gt;0.000000&lt;/td&gt;
      &lt;td&gt;0.075650&lt;/td&gt;
      &lt;td&gt;-6.298750&lt;/td&gt;
      &lt;td&gt;0.059100&lt;/td&gt;
      &lt;td&gt;102.961250&lt;/td&gt;
      &lt;td&gt;4.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;50%&lt;/th&gt;
      &lt;td&gt;2016.000000&lt;/td&gt;
      &lt;td&gt;218509.000000&lt;/td&gt;
      &lt;td&gt;13.000000&lt;/td&gt;
      &lt;td&gt;0.761000&lt;/td&gt;
      &lt;td&gt;0.220500&lt;/td&gt;
      &lt;td&gt;0.784500&lt;/td&gt;
      &lt;td&gt;0.000004&lt;/td&gt;
      &lt;td&gt;0.103500&lt;/td&gt;
      &lt;td&gt;-4.558500&lt;/td&gt;
      &lt;td&gt;0.097950&lt;/td&gt;
      &lt;td&gt;112.714500&lt;/td&gt;
      &lt;td&gt;4.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;75%&lt;/th&gt;
      &lt;td&gt;2017.000000&lt;/td&gt;
      &lt;td&gt;242098.500000&lt;/td&gt;
      &lt;td&gt;31.000000&lt;/td&gt;
      &lt;td&gt;0.829500&lt;/td&gt;
      &lt;td&gt;0.403000&lt;/td&gt;
      &lt;td&gt;0.875750&lt;/td&gt;
      &lt;td&gt;0.000234&lt;/td&gt;
      &lt;td&gt;0.164000&lt;/td&gt;
      &lt;td&gt;-3.331000&lt;/td&gt;
      &lt;td&gt;0.177000&lt;/td&gt;
      &lt;td&gt;125.039250&lt;/td&gt;
      &lt;td&gt;4.000000&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;max&lt;/th&gt;
      &lt;td&gt;2020.000000&lt;/td&gt;
      &lt;td&gt;511738.000000&lt;/td&gt;
      &lt;td&gt;73.000000&lt;/td&gt;
      &lt;td&gt;0.966000&lt;/td&gt;
      &lt;td&gt;0.954000&lt;/td&gt;
      &lt;td&gt;0.995000&lt;/td&gt;
      &lt;td&gt;0.910000&lt;/td&gt;
      &lt;td&gt;0.811000&lt;/td&gt;
      &lt;td&gt;0.582000&lt;/td&gt;
      &lt;td&gt;0.514000&lt;/td&gt;
      &lt;td&gt;206.007000&lt;/td&gt;
      &lt;td&gt;5.000000&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; seaborn &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sns&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;draw&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;df&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    top = df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;].value_counts()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;7&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    sns.barplot(x=top[:&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;].index, y=top[:&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;].values)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.xticks(rotation=&lt;span class=&#34;number&#34;&gt;45&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Top genres&amp;#x27;&lt;/span&gt;, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;blue&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;draw(df)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è¿‡æ»¤æ‰ Missing&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;new_df = df[df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;] != &lt;span class=&#34;string&#34;&gt;&amp;#x27;Missing&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;draw(new_df)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;featured_df = new_df[((new_df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;string&#34;&gt;&amp;#x27;afro dancehall&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                      | (new_df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;string&#34;&gt;&amp;#x27;afropop&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                      | (new_df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;string&#34;&gt;&amp;#x27;nigerian pop&amp;#x27;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                     &amp;amp; (new_df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;popularity&amp;#x27;&lt;/span&gt;] &amp;gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;draw(featured_df)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;corrmat = featured_df.corr()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;f, ax = plt.subplots(figsize=(&lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;9&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sns.heatmap(corrmat, vmax=&lt;span class=&#34;number&#34;&gt;.8&lt;/span&gt;, square=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;AxesSubplot:&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_50_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_50_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_50_3.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_50_4.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;K-Means-ä¸è¡¡é‡æŒ‡æ ‡&#34;&gt;K-Means-ä¸è¡¡é‡æŒ‡æ ‡&lt;/h4&gt;
&lt;h5 id=&#34;å…¥é—¨-éŸ³ä¹åˆ†ç±»&#34;&gt;å…¥é—¨-éŸ³ä¹åˆ†ç±»&lt;/h5&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# è¿™ç§æ ¼å¼å¯ä»¥è¿è¡Œ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;!pip install seaborn&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; seaborn &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sns&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;df = pd.read_csv(&lt;span class=&#34;string&#34;&gt;&amp;quot;./_data_set/Clustering/nigerian-songs.csv&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;df.head()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;Looking in indexes: http://mirrors.aliyun.com/pypi/simple/
Requirement already satisfied: seaborn in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (0.11.2)
Requirement already satisfied: scipy&amp;gt;=1.0 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from seaborn) (1.7.1)
Requirement already satisfied: numpy&amp;gt;=1.15 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from seaborn) (1.20.3)
Requirement already satisfied: pandas&amp;gt;=0.23 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from seaborn) (1.4.2)
Requirement already satisfied: matplotlib&amp;gt;=2.2 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from seaborn) (3.4.3)
Requirement already satisfied: python-dateutil&amp;gt;=2.7 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from matplotlib&amp;gt;=2.2-&amp;gt;seaborn) (2.8.2)
Requirement already satisfied: cycler&amp;gt;=0.10 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from matplotlib&amp;gt;=2.2-&amp;gt;seaborn) (0.11.0)
Requirement already satisfied: pyparsing&amp;gt;=2.2.1 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from matplotlib&amp;gt;=2.2-&amp;gt;seaborn) (3.0.4)
Requirement already satisfied: kiwisolver&amp;gt;=1.0.1 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from matplotlib&amp;gt;=2.2-&amp;gt;seaborn) (1.3.2)
Requirement already satisfied: pillow&amp;gt;=6.2.0 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from matplotlib&amp;gt;=2.2-&amp;gt;seaborn) (9.0.1)
Requirement already satisfied: pytz&amp;gt;=2020.1 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from pandas&amp;gt;=0.23-&amp;gt;seaborn) (2021.3)
Requirement already satisfied: six&amp;gt;=1.5 in d:\scoop\apps\anaconda3\2021.11\lib\site-packages (from python-dateutil&amp;gt;=2.7-&amp;gt;matplotlib&amp;gt;=2.2-&amp;gt;seaborn) (1.16.0)
&lt;/code&gt;&lt;/pre&gt;
&lt;div&gt;
&lt;style scoped&gt;
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }
&lt;pre&gt;&lt;code&gt;.dataframe tbody tr th &amp;#123;
    vertical-align: top;
&amp;#125;

.dataframe thead th &amp;#123;
    text-align: right;
&amp;#125;
&lt;/code&gt;&lt;/pre&gt;
&lt;/style&gt;
&lt;table border=&#34;1&#34; class=&#34;dataframe&#34;&gt;
  &lt;thead&gt;
    &lt;tr style=&#34;text-align: right;&#34;&gt;
      &lt;th&gt;&lt;/th&gt;
      &lt;th&gt;name&lt;/th&gt;
      &lt;th&gt;album&lt;/th&gt;
      &lt;th&gt;artist&lt;/th&gt;
      &lt;th&gt;artist_top_genre&lt;/th&gt;
      &lt;th&gt;release_date&lt;/th&gt;
      &lt;th&gt;length&lt;/th&gt;
      &lt;th&gt;popularity&lt;/th&gt;
      &lt;th&gt;danceability&lt;/th&gt;
      &lt;th&gt;acousticness&lt;/th&gt;
      &lt;th&gt;energy&lt;/th&gt;
      &lt;th&gt;instrumentalness&lt;/th&gt;
      &lt;th&gt;liveness&lt;/th&gt;
      &lt;th&gt;loudness&lt;/th&gt;
      &lt;th&gt;speechiness&lt;/th&gt;
      &lt;th&gt;tempo&lt;/th&gt;
      &lt;th&gt;time_signature&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;th&gt;0&lt;/th&gt;
      &lt;td&gt;Sparky&lt;/td&gt;
      &lt;td&gt;Mandy &amp;amp; The Jungle&lt;/td&gt;
      &lt;td&gt;Cruel Santino&lt;/td&gt;
      &lt;td&gt;alternative r&amp;amp;b&lt;/td&gt;
      &lt;td&gt;2019&lt;/td&gt;
      &lt;td&gt;144000&lt;/td&gt;
      &lt;td&gt;48&lt;/td&gt;
      &lt;td&gt;0.666&lt;/td&gt;
      &lt;td&gt;0.8510&lt;/td&gt;
      &lt;td&gt;0.420&lt;/td&gt;
      &lt;td&gt;0.534000&lt;/td&gt;
      &lt;td&gt;0.1100&lt;/td&gt;
      &lt;td&gt;-6.699&lt;/td&gt;
      &lt;td&gt;0.0829&lt;/td&gt;
      &lt;td&gt;133.015&lt;/td&gt;
      &lt;td&gt;5&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;1&lt;/th&gt;
      &lt;td&gt;shuga rush&lt;/td&gt;
      &lt;td&gt;EVERYTHING YOU HEARD IS TRUE&lt;/td&gt;
      &lt;td&gt;Odunsi (The Engine)&lt;/td&gt;
      &lt;td&gt;afropop&lt;/td&gt;
      &lt;td&gt;2020&lt;/td&gt;
      &lt;td&gt;89488&lt;/td&gt;
      &lt;td&gt;30&lt;/td&gt;
      &lt;td&gt;0.710&lt;/td&gt;
      &lt;td&gt;0.0822&lt;/td&gt;
      &lt;td&gt;0.683&lt;/td&gt;
      &lt;td&gt;0.000169&lt;/td&gt;
      &lt;td&gt;0.1010&lt;/td&gt;
      &lt;td&gt;-5.640&lt;/td&gt;
      &lt;td&gt;0.3600&lt;/td&gt;
      &lt;td&gt;129.993&lt;/td&gt;
      &lt;td&gt;3&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;2&lt;/th&gt;
      &lt;td&gt;LITT!&lt;/td&gt;
      &lt;td&gt;LITT!&lt;/td&gt;
      &lt;td&gt;AYLÃ˜&lt;/td&gt;
      &lt;td&gt;indie r&amp;amp;b&lt;/td&gt;
      &lt;td&gt;2018&lt;/td&gt;
      &lt;td&gt;207758&lt;/td&gt;
      &lt;td&gt;40&lt;/td&gt;
      &lt;td&gt;0.836&lt;/td&gt;
      &lt;td&gt;0.2720&lt;/td&gt;
      &lt;td&gt;0.564&lt;/td&gt;
      &lt;td&gt;0.000537&lt;/td&gt;
      &lt;td&gt;0.1100&lt;/td&gt;
      &lt;td&gt;-7.127&lt;/td&gt;
      &lt;td&gt;0.0424&lt;/td&gt;
      &lt;td&gt;130.005&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;3&lt;/th&gt;
      &lt;td&gt;Confident / Feeling Cool&lt;/td&gt;
      &lt;td&gt;Enjoy Your Life&lt;/td&gt;
      &lt;td&gt;Lady Donli&lt;/td&gt;
      &lt;td&gt;nigerian pop&lt;/td&gt;
      &lt;td&gt;2019&lt;/td&gt;
      &lt;td&gt;175135&lt;/td&gt;
      &lt;td&gt;14&lt;/td&gt;
      &lt;td&gt;0.894&lt;/td&gt;
      &lt;td&gt;0.7980&lt;/td&gt;
      &lt;td&gt;0.611&lt;/td&gt;
      &lt;td&gt;0.000187&lt;/td&gt;
      &lt;td&gt;0.0964&lt;/td&gt;
      &lt;td&gt;-4.961&lt;/td&gt;
      &lt;td&gt;0.1130&lt;/td&gt;
      &lt;td&gt;111.087&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;th&gt;4&lt;/th&gt;
      &lt;td&gt;wanted you&lt;/td&gt;
      &lt;td&gt;rare.&lt;/td&gt;
      &lt;td&gt;Odunsi (The Engine)&lt;/td&gt;
      &lt;td&gt;afropop&lt;/td&gt;
      &lt;td&gt;2018&lt;/td&gt;
      &lt;td&gt;152049&lt;/td&gt;
      &lt;td&gt;25&lt;/td&gt;
      &lt;td&gt;0.702&lt;/td&gt;
      &lt;td&gt;0.1160&lt;/td&gt;
      &lt;td&gt;0.833&lt;/td&gt;
      &lt;td&gt;0.910000&lt;/td&gt;
      &lt;td&gt;0.3480&lt;/td&gt;
      &lt;td&gt;-6.044&lt;/td&gt;
      &lt;td&gt;0.0447&lt;/td&gt;
      &lt;td&gt;105.115&lt;/td&gt;
      &lt;td&gt;4&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;/div&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;fetured_df = df[((df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;string&#34;&gt;&amp;#x27;afro dancehall&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                 | (df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;string&#34;&gt;&amp;#x27;afropop&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                 | (df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;] == &lt;span class=&#34;string&#34;&gt;&amp;#x27;nigerian pop&amp;#x27;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                &amp;amp; (df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;popularity&amp;#x27;&lt;/span&gt;] &amp;gt; &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;top = fetured_df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;].value_counts()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;7&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sns.barplot(x=top.index, y=top.values)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xticks(rotation=&lt;span class=&#34;number&#34;&gt;45&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Top genres&amp;#x27;&lt;/span&gt;, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;blue&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ç®±çº¿å›¾, å¯ä»¥ç›´è§‚çœ‹å‡ºæ•°æ®çš„åˆ†å¸ƒ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;), dpi=&lt;span class=&#34;number&#34;&gt;200&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 1)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;popularity&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 2)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;acousticness&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 3)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;energy&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 4)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;instrumentalness&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 5)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;liveness&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 6)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;loudness&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 7)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;speechiness&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 8)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;tempo&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 9)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;time_signature&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 10)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;danceability&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 11)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;length&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  plt.subplot(4, 3, 12)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt;  sns.boxplot(x=&amp;#x27;release_date&amp;#x27;, data=df)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;string&#34;&gt; &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i, v &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;enumerate&lt;/span&gt;([&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;&amp;quot;popularity&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;acousticness&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;energy&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;instrumentalness&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;liveness&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;&amp;quot;loudness&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;speechiness&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;tempo&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;time_signature&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;danceability&amp;quot;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;string&#34;&gt;&amp;quot;length&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;release_date&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;]):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.subplot(&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;, i + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    sns.boxplot(x=v, data=df)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# plt.title(v)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_53_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_53_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; LabelEncoder&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.cluster &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; KMeans&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; metrics&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;le = LabelEncoder()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;X = df.loc[:, (&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;popularity&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;danceability&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;               &lt;span class=&#34;string&#34;&gt;&amp;#x27;acousticness&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;loudness&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;energy&amp;#x27;&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;X[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;] = le.fit_transform(X[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y = le.transform(df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;artist_top_genre&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# èšä¸º3ç±»&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;nclusters = &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;seed = &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;km = KMeans(n_clusters=nclusters, random_state=seed).fit(X)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Predict the cluster for each data point&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_cluster_kmeans = km.predict(X)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(y_cluster_kmeans)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;score = metrics.silhouette_score(X, y_cluster_kmeans)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# score ä» [-1,1], è¶Šå¤§è¡¨ç¤ºèšç±»æ•ˆæœè¶Šå¥½&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(score)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;[2 0 2 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 2 0 0 0 0 0 2 0 0 1 0 0 2 1 1 2 2 2 0
 2 0 1 2 2 2 0 1 1 2 1 0 0 0 0 1 1 1 1 1 2 0 2 1 0 2 0 1 2 1 2 1 1 1 1 2 1
 0 2 2 0 0 0 1 0 0 1 1 1 1 0 0 1 1 1 2 1 0 0 1 1 1 0 0 1 0 1 2 0 1 1 2 0 1
 1 1 1 1 1 1 0 1 0 1 0 1 0 2 1 2 0 1 1 1 0 0 1 1 0 2 0 1 1 0 0 0 1 1 0 1 0
 2 0 1 1 0 0 0 1 0 1 1 0 1 0 1 0 0 1 1 1 0 0 0 1 1 1 0 0 1 0 2 1 1 1 1 1 0
 1 1 1 1 0 2 0 0 0 0 0 0 1 1 2 1 1 1 1 1 2 1 1 0 0 1 1 1 1 1 0 0 1 0 1 0 0
 1 2 1 1 1 1 0 1 1 1 1 0 1 1 1 0 1 0 1 2 1 1 1 1 1 1 0 1 0 1 0 1 0 1 1 1 1
 2 0 0 1 1 0 0 0 1 0 0 1 1 1 2 1 1 2 0 0 1 0 1 1 0 1 1 1 0 2 1 1 2 2 2 0 2
 2 2 2 2 2 2 2 1 2 2 1 2 1 2 1 2 2 2 0 1 0 1 1 0 1 2 1 1 2 1 0 2 2 0 0 0 1
 0 1 0 1 1 1 1 2 1 1 2 2 1 0 2 0 2 1 1 2 2 2 0 0 2 2 1 1 0 0 0 1 1 1 1 1 1
 1 1 1 1 2 1 1 0 1 1 1 1 0 1 1 1 1 0 0 1 0 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1
 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 2 1 2 2 1 0 0 0 1 2 1 1 2 1 0 0 0 2 2 2 0 2
 2 2 0 2 2 0 1 0 1 2 0 1 1 1 1 1 1 0 1 1 0 0 1 0 1 0 1 1 1 1 1 1 1 1 1 0 1
 0 1 1 1 1 1 1 0 1 1 1 2 0 0 1 1 1 1 2 1 0 2 1 1 1 0 1 1 2 1 0 0 0 0 0 1 1
 1 1 1 0 0 1 1 1 1 1 1 1]
0.5918299843029218
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ‰‹è‚˜æ–¹æ³•: æ‹ç‚¹é™„è¿‘å°±æ˜¯è¾ƒå¥½çš„èšç±»åˆ’åˆ†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;wcss = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;11&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    kmeans = KMeans(n_clusters=i, init=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k-means++&amp;#x27;&lt;/span&gt;, random_state=&lt;span class=&#34;number&#34;&gt;42&lt;/span&gt;).fit(X)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    wcss.append(kmeans.inertia_)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;sns.lineplot(&lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;11&lt;/span&gt;), wcss, marker=&lt;span class=&#34;string&#34;&gt;&amp;#x27;o&amp;#x27;&lt;/span&gt;, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;red&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Elbow&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Number of clusters&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;WCSS&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;D:\Scoop\apps\anaconda3\current\lib\site-packages\sklearn\cluster\_kmeans.py:1036: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=3.
  warnings.warn(
D:\Scoop\apps\anaconda3\current\lib\site-packages\seaborn\_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.
  warnings.warn(
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_55_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆå§‹å€¼çš„éšæœºé€‰å–ä¼šå½±å“æ¯æ¬¡çš„ç»“æœ&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;kmeans = KMeans(n_clusters=&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;).fit(X)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 0 | 1 | 2&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;labels = kmeans.predict(X)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.scatter(df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;popularity&amp;#x27;&lt;/span&gt;], df[&lt;span class=&#34;string&#34;&gt;&amp;#x27;danceability&amp;#x27;&lt;/span&gt;], c=labels)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;popularity&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;danceability&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# çœŸå®å€¼ ä¸ ä¸é¢„æµ‹å€¼é›†åˆçš„äº¤é›† å…ƒç´ ä¸ªæ•°&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;correct_labels = &lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;(y == kmeans.labels_)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;%d/%d samples were correctly labeled.&amp;quot;&lt;/span&gt; %&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;      (correct_labels, y.size))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Accuracy score: &amp;#123;0:0.2f&amp;#125;&amp;#x27;&lt;/span&gt;.&lt;span class=&#34;built_in&#34;&gt;format&lt;/span&gt;(correct_labels / &lt;span class=&#34;built_in&#34;&gt;float&lt;/span&gt;(y.size)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_56_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;93/530 samples were correctly labeled.
Accuracy score: 0.18
&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&#34;sample-2&#34;&gt;sample-2&lt;/h5&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.colors&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.datasets &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; ds&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; homogeneity_score, completeness_score, v_measure_score, adjusted_mutual_info_score,\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    adjusted_rand_score, silhouette_score&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.cluster &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; KMeans&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; mpl_toolkits.mplot3d &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; Axes3D&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;expand&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;a, b&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    d = (b - a) * &lt;span class=&#34;number&#34;&gt;0.1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; a - d, b + d&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;N = &lt;span class=&#34;number&#34;&gt;400&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;centers = &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data, y = ds.make_blobs(N, n_features=&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, centers=centers, random_state=&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data2, y2 = ds.make_blobs(N,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                          n_features=&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                          centers=centers,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                          cluster_std=(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                          random_state=&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data3 = np.vstack(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    (data[y == &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;][:], data[y == &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;][:&lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;], data[y == &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;][:&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;], data[y == &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;][:&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;]))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y3 = np.array([&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;] * &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt; + [&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] * &lt;span class=&#34;number&#34;&gt;50&lt;/span&gt; + [&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;] * &lt;span class=&#34;number&#34;&gt;20&lt;/span&gt; + [&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;] * &lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;m = np.array(((&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), (&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;)))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data_r = data.dot(m)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;matplotlib.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;font.sans-serif&amp;#x27;&lt;/span&gt;] = [&lt;span class=&#34;string&#34;&gt;&amp;#x27;SimHei&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;matplotlib.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;axes.unicode_minus&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;cm = matplotlib.colors.ListedColormap(&lt;span class=&#34;built_in&#34;&gt;list&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;rgbm&amp;#x27;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data_list = data, data, data_r, data_r, data2, data2, data3, data3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_list = y, y, y, y, y2, y2, y3, y3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;titles = &lt;span class=&#34;string&#34;&gt;&amp;#x27;åŸå§‹æ•°æ®&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;KMeans++èšç±»&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;æ—‹è½¬åæ•°æ®&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;æ—‹è½¬åKMeans++èšç±»&amp;#x27;&lt;/span&gt;,\&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;          &lt;span class=&#34;string&#34;&gt;&amp;#x27;æ–¹å·®ä¸ç›¸ç­‰æ•°æ®&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;æ–¹å·®ä¸ç›¸ç­‰KMeans++èšç±»&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;æ•°é‡ä¸ç›¸ç­‰æ•°æ®&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;æ•°é‡ä¸ç›¸ç­‰KMeans++èšç±»&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = KMeans(n_clusters=&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, init=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k-means++&amp;#x27;&lt;/span&gt;, n_init=&lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fig = plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;9&lt;/span&gt;), facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i, (x, y, title) &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;enumerate&lt;/span&gt;(&lt;span class=&#34;built_in&#34;&gt;zip&lt;/span&gt;(data_list, y_list, titles), start=&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;comment&#34;&gt;# plt.subplot(4, 2, i)&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ax = fig.add_subplot(&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, i)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.title(title)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; i % &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt; == &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        y_pred = y&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        y_pred = model.fit_predict(x)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(i)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Homogeneity:&amp;#x27;&lt;/span&gt;, homogeneity_score(y, y_pred))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;completeness:&amp;#x27;&lt;/span&gt;, completeness_score(y, y_pred))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;V measure:&amp;#x27;&lt;/span&gt;, v_measure_score(y, y_pred))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;AMI:&amp;#x27;&lt;/span&gt;, adjusted_mutual_info_score(y, y_pred))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;ARI:&amp;#x27;&lt;/span&gt;, adjusted_rand_score(y, y_pred))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Silhouette:&amp;#x27;&lt;/span&gt;, silhouette_score(x, y_pred), &lt;span class=&#34;string&#34;&gt;&amp;#x27;\n&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ax.scatter(x[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], x[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], s=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, c=y_pred, cmap=cm, edgecolors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;none&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    ax.grid(b=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, ls=&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.tight_layout(&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, rect=(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.95&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.suptitle(&lt;span class=&#34;string&#34;&gt;&amp;#x27;æ•°æ®åˆ†å¸ƒå¯¹KMeansèšç±»çš„å½±å“&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;18&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;1
Homogeneity: 1.0
completeness: 1.0
V measure: 1.0
AMI: 1.0
ARI: 1.0
Silhouette: 0.616436816839852

2
Homogeneity: 0.9898828240244267
completeness: 0.9899006758819153
V measure: 0.9898917498726852
AMI: 0.9898081557479033
ARI: 0.9933165272203728
Silhouette: 0.6189656317733315

3
Homogeneity: 1.0
completeness: 1.0
V measure: 1.0
AMI: 1.0
ARI: 1.0
Silhouette: 0.5275987244664399

4
Homogeneity: 0.7296158940840607
completeness: 0.7315285272632114
V measure: 0.7305709588584066
AMI: 0.7283397010755561
ARI: 0.6783811042853299
Silhouette: 0.5366236044449266

5
Homogeneity: 1.0
completeness: 1.0
V measure: 1.0
AMI: 1.0
ARI: 1.0
Silhouette: 0.4790725752982868

6
Homogeneity: 0.7449364376693913
completeness: 0.7755445167472191
V measure: 0.7599323988656883
AMI: 0.757903292819801
ARI: 0.7113213508090338
Silhouette: 0.5737260449304202

7
Homogeneity: 1.0
completeness: 1.0
V measure: 1.0
AMI: 1.0
ARI: 1.0
Silhouette: 0.5975066093204152

8
Homogeneity: 0.9776347312784609
completeness: 0.9728632742060752
V measure: 0.975243166591057
AMI: 0.9745709993295113
ARI: 0.9906840043816505
Silhouette: 0.6013877858619149



C:\Users\utsuk\AppData\Local\Temp\ipykernel_28356\867049078.py:57: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.
  plt.tight_layout(2, rect=(0, 0, 1, 0.95))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_58_2.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h4 id=&#34;å±‚æ¬¡èšç±»&#34;&gt;å±‚æ¬¡èšç±»&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mpl&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.cluster &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; AgglomerativeClustering&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.neighbors &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; kneighbors_graph&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.datasets &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; ds&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; warnings&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;expand&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;a, b, r&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    d = (b - a) * r&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; a - d, b + d&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; __name__ == &lt;span class=&#34;string&#34;&gt;&amp;#x27;__main__&amp;#x27;&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    warnings.filterwarnings(action=&lt;span class=&#34;string&#34;&gt;&amp;#x27;ignore&amp;#x27;&lt;/span&gt;, category=UserWarning)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    np.set_printoptions(suppress=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    np.random.seed(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    n_clusters = &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    N = &lt;span class=&#34;number&#34;&gt;400&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data1, y1 = ds.make_blobs(n_samples=N,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                              n_features=&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                              centers=((-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), (&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), (&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;), (-&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, -&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                              cluster_std=(&lt;span class=&#34;number&#34;&gt;0.1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.2&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.3&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.4&lt;/span&gt;),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                              random_state=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data1 = np.array(data1)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    n_noise = &lt;span class=&#34;built_in&#34;&gt;int&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;0.1&lt;/span&gt; * N)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    r = np.random.rand(n_noise, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data_min1, data_min2 = np.&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;(data1, axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data_max1, data_max2 = np.&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;(data1, axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    r[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;] = r[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;] * (data_max1 - data_min1) + data_min1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    r[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] = r[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] * (data_max2 - data_min2) + data_min2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data1_noise = np.concatenate((data1, r), axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    y1_noise = np.concatenate((y1, [&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;] * n_noise))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data2, y2 = ds.make_moons(n_samples=N, noise=&lt;span class=&#34;number&#34;&gt;.05&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data2 = np.array(data2)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    n_noise = &lt;span class=&#34;built_in&#34;&gt;int&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;0.1&lt;/span&gt; * N)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    r = np.random.rand(n_noise, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data_min1, data_min2 = np.&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;(data2, axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data_max1, data_max2 = np.&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;(data2, axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    r[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;] = r[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;] * (data_max1 - data_min1) + data_min1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    r[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] = r[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;] * (data_max2 - data_min2) + data_min2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    data2_noise = np.concatenate((data2, r), axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    y2_noise = np.concatenate((y2, [&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;] * n_noise))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;font.sans-serif&amp;#x27;&lt;/span&gt;] = [&lt;span class=&#34;string&#34;&gt;&amp;#x27;SimHei&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    mpl.rcParams[&lt;span class=&#34;string&#34;&gt;&amp;#x27;axes.unicode_minus&amp;#x27;&lt;/span&gt;] = &lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    cm = mpl.colors.ListedColormap([&lt;span class=&#34;string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;g&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;b&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;m&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;c&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.figure(figsize=(&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;8&lt;/span&gt;), facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;w&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.cla()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    linkages = (&lt;span class=&#34;string&#34;&gt;&amp;quot;ward&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;complete&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;average&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; index, (n_clusters, data, y) &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;enumerate&lt;/span&gt;(&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        ((&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, data1, y1), (&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, data1_noise, y1_noise), (&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, data2, y2),&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;         (&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, data2_noise, y2_noise))):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        plt.subplot(&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt; * index + &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        plt.scatter(data[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], data[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;], c=y, s=&lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;, edgecolors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;, cmap=cm)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        plt.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Prime&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        plt.grid(b=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, ls=&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        data_min1, data_min2 = np.&lt;span class=&#34;built_in&#34;&gt;min&lt;/span&gt;(data, axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        data_max1, data_max2 = np.&lt;span class=&#34;built_in&#34;&gt;max&lt;/span&gt;(data, axis=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        plt.xlim(expand(data_min1, data_max1, &lt;span class=&#34;number&#34;&gt;0.05&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        plt.ylim(expand(data_min2, data_max2, &lt;span class=&#34;number&#34;&gt;0.05&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        connectivity = kneighbors_graph(data,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                        n_neighbors=&lt;span class=&#34;number&#34;&gt;7&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                        mode=&lt;span class=&#34;string&#34;&gt;&amp;#x27;distance&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                        metric=&lt;span class=&#34;string&#34;&gt;&amp;#x27;minkowski&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                        p=&lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                        include_self=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        connectivity = &lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt; * (connectivity + connectivity.T)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i, linkage &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;enumerate&lt;/span&gt;(linkages):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            ac = AgglomerativeClustering(n_clusters=n_clusters,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                         affinity=&lt;span class=&#34;string&#34;&gt;&amp;#x27;euclidean&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                         connectivity=connectivity,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                         linkage=linkage)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            ac.fit(data)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            y = ac.labels_&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            plt.subplot(&lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt;, i + &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt; + &lt;span class=&#34;number&#34;&gt;4&lt;/span&gt; * index)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            plt.scatter(data[:, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        data[:, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        c=y,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        s=&lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        edgecolors=&lt;span class=&#34;string&#34;&gt;&amp;#x27;k&amp;#x27;&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                        cmap=cm)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            plt.title(linkage, fontsize=&lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            plt.grid(b=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, ls=&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            plt.xlim(expand(data_min1, data_max1, &lt;span class=&#34;number&#34;&gt;0.05&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            plt.ylim(expand(data_min2, data_max2, &lt;span class=&#34;number&#34;&gt;0.05&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.suptitle(&lt;span class=&#34;string&#34;&gt;&amp;#x27;å±‚æ¬¡èšç±»çš„ä¸åŒåˆå¹¶ç­–ç•¥&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;15&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.tight_layout(&lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt;, rect=(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;0.95&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    plt.show()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_60_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;é™ç»´é—®é¢˜&#34;&gt;é™ç»´é—®é¢˜&lt;/h3&gt;
&lt;h4 id=&#34;ç¼ºå¤±å€¼æ¯”ç‡&#34;&gt;ç¼ºå¤±å€¼æ¯”ç‡&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# import required libraries&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# read the data&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train = pd.read_csv(&lt;span class=&#34;string&#34;&gt;&amp;quot;./_data_set/é™ç»´é—®é¢˜/train_v9rqX0R.csv&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# checking the percentage of missing values in each variable&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ•°æ®å®Œæ•´ç‡ = (ç©ºæ•° / æ‰€æœ‰æ•°) * 100&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;a = train.isnull().&lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;() / &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(train) * &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# saving column names in a variable&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;variable = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; a[i] &amp;lt;= &lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;:  &lt;span class=&#34;comment&#34;&gt;#setting the threshold as 20%&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        variable.append(train.columns[i])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ç¼ºå¤±ç‡å¤§äºé˜ˆå€¼çš„åˆ—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(variable)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;[&#39;Item_Identifier&#39;, &#39;Item_Weight&#39;, &#39;Item_Fat_Content&#39;, &#39;Item_Visibility&#39;, &#39;Item_Type&#39;, &#39;Item_MRP&#39;, &#39;Outlet_Identifier&#39;, &#39;Outlet_Establishment_Year&#39;, &#39;Outlet_Location_Type&#39;, &#39;Outlet_Type&#39;, &#39;Item_Outlet_Sales&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ä½æ–¹å·®è¿‡æ»¤&#34;&gt;ä½æ–¹å·®è¿‡æ»¤&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# import required libraries&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# read the data&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train = pd.read_csv(&lt;span class=&#34;string&#34;&gt;&amp;quot;./_data_set/é™ç»´é—®é¢˜/train_v9rqX0R.csv&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å¡«å……ç©ºé¡¹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Item_Weight&amp;#x27;&lt;/span&gt;].fillna(train[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Item_Weight&amp;#x27;&lt;/span&gt;].median(), inplace=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;train[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Outlet_Size&amp;#x27;&lt;/span&gt;].fillna(train[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Outlet_Size&amp;#x27;&lt;/span&gt;].mode()[&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;], inplace=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å¡«å……åçš„ç¼ºå¤±ç‡&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(train.isnull().&lt;span class=&#34;built_in&#34;&gt;sum&lt;/span&gt;() / &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(train) * &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;numeric = train[[&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Item_Weight&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Item_Visibility&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Item_MRP&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Outlet_Establishment_Year&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;var = numeric.var()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;numeric = numeric.columns&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;variable = []&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;for&lt;/span&gt; i &lt;span class=&#34;keyword&#34;&gt;in&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;range&lt;/span&gt;(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;, &lt;span class=&#34;built_in&#34;&gt;len&lt;/span&gt;(var)):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; var[i] &amp;gt;= &lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;:  &lt;span class=&#34;comment&#34;&gt;#setting the threshold as 10%&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        variable.append(numeric[i])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(variable)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;Item_Identifier              0.0
Item_Weight                  0.0
Item_Fat_Content             0.0
Item_Visibility              0.0
Item_Type                    0.0
Item_MRP                     0.0
Outlet_Identifier            0.0
Outlet_Establishment_Year    0.0
Outlet_Size                  0.0
Outlet_Location_Type         0.0
Outlet_Type                  0.0
Item_Outlet_Sales            0.0
dtype: float64
[&#39;Item_Weight&#39;, &#39;Item_MRP&#39;, &#39;Outlet_Establishment_Year&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&#34;ä»£ç ç›¸å…³&#34;&gt;ä»£ç ç›¸å…³&lt;/h2&gt;
&lt;h3 id=&#34;å­˜å‚¨-è¯»å–æ¨¡å‹&#34;&gt;å­˜å‚¨-è¯»å–æ¨¡å‹&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.linear_model &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; lm  &lt;span class=&#34;comment&#34;&gt;# çº¿æ€§æ¨¡å‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; sm  &lt;span class=&#34;comment&#34;&gt;# æ¨¡å‹æ€§èƒ½è¯„ä»·æ¨¡å—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; mp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pickle&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x = np.array([[&lt;span class=&#34;number&#34;&gt;0.5&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;0.6&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;0.8&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;1.1&lt;/span&gt;], [&lt;span class=&#34;number&#34;&gt;1.4&lt;/span&gt;]])  &lt;span class=&#34;comment&#34;&gt;# è¾“å…¥é›†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y = np.array([&lt;span class=&#34;number&#34;&gt;5.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;5.5&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;6.0&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;6.8&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;7.0&lt;/span&gt;])  &lt;span class=&#34;comment&#34;&gt;# è¾“å‡ºé›†&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆ›å»ºçº¿æ€§å›å½’å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = lm.LinearRegression()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ç”¨å·²çŸ¥è¾“å…¥ã€è¾“å‡ºæ•°æ®é›†è®­ç»ƒå›å½’å™¨&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.fit(x, y)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;è®­ç»ƒå®Œæˆ.&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ä¿å­˜è®­ç»ƒåçš„æ¨¡å‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;linear_model.pkl&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;wb&amp;#x27;&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; f:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    pickle.dump(model, f)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;ä¿å­˜æ¨¡å‹å®Œæˆ.&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;######################### åŠ è½½æ¨¡å‹ #########################&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ä¸Šé¢é€šè¿‡è®­ç»ƒæ•°æ®x,y è®­ç»ƒå¥½äº† x -&amp;gt; y çš„çº¿æ€§å›å½’æ¨¡å‹&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ä¸‹é¢åŠ è½½æ¨¡å‹, å†ç»™å‡ºæµ‹è¯•æ•°æ® x, æŸ¥çœ‹æ¨¡å‹é¢„æµ‹ç»“æœç›´çº¿ä¸åŸå§‹æ•°æ® (x,y) çš„æ‹Ÿåˆåº¦&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;linear_model.pkl&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;rb&amp;#x27;&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; f:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    model = pickle.load(f)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;åŠ è½½æ¨¡å‹å®Œæˆ.&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# æ ¹æ®åŠ è½½çš„æ¨¡å‹é¢„æµ‹è¾“å‡º&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pred_y = model.predict(x)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å¯è§†åŒ–å›å½’æ›²çº¿&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.figure(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Linear Regression&amp;#x27;&lt;/span&gt;, facecolor=&lt;span class=&#34;string&#34;&gt;&amp;#x27;lightgray&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Linear Regression&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;20&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;x&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;y&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.tick_params(labelsize=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.grid(linestyle=&lt;span class=&#34;string&#34;&gt;&amp;#x27;:&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.scatter(x, y, c=&lt;span class=&#34;string&#34;&gt;&amp;#x27;blue&amp;#x27;&lt;/span&gt;, alpha=&lt;span class=&#34;number&#34;&gt;0.8&lt;/span&gt;, s=&lt;span class=&#34;number&#34;&gt;60&lt;/span&gt;, label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;Sample Points&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.plot(x, pred_y, c=&lt;span class=&#34;string&#34;&gt;&amp;#x27;orangered&amp;#x27;&lt;/span&gt;, label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;Regression&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.legend()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;mp.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;è®­ç»ƒå®Œæˆ.
ä¿å­˜æ¨¡å‹å®Œæˆ.
åŠ è½½æ¨¡å‹å®Œæˆ.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_66_1.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;Web-app&#34;&gt;Web-app&lt;/h3&gt;
&lt;h4 id=&#34;ä¸€&#34;&gt;ä¸€&lt;/h4&gt;
&lt;p&gt;train ä¸€ä¸ªé€»è¾‘å›å½’æ¨¡å‹å¹¶ç”¨ pickle æ‰“åŒ…&lt;/p&gt;
&lt;p&gt;ç„¶åload&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.preprocessing &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; LabelEncoder&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; train_test_split&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; accuracy_score, classification_report&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.linear_model &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; LogisticRegression&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pickle&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ufos = pd.read_csv(&lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/web-app/1/ufos.csv&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ufos.head()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ufos = pd.DataFrame(&amp;#123;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Seconds&amp;#x27;&lt;/span&gt;: ufos[&lt;span class=&#34;string&#34;&gt;&amp;#x27;duration (seconds)&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Country&amp;#x27;&lt;/span&gt;: ufos[&lt;span class=&#34;string&#34;&gt;&amp;#x27;country&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Latitude&amp;#x27;&lt;/span&gt;: ufos[&lt;span class=&#34;string&#34;&gt;&amp;#x27;latitude&amp;#x27;&lt;/span&gt;],&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;string&#34;&gt;&amp;#x27;Longitude&amp;#x27;&lt;/span&gt;: ufos[&lt;span class=&#34;string&#34;&gt;&amp;#x27;longitude&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ufos.Country.unique()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ufos.dropna(inplace=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ufos = ufos[(ufos[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Seconds&amp;#x27;&lt;/span&gt;] &amp;gt;= &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt;) &amp;amp; (ufos[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Seconds&amp;#x27;&lt;/span&gt;] &amp;lt;= &lt;span class=&#34;number&#34;&gt;60&lt;/span&gt;)]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ufos.info()&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [&amp;#x27;us&amp;#x27;, nan, &amp;#x27;gb&amp;#x27;, &amp;#x27;ca&amp;#x27;, &amp;#x27;au&amp;#x27;, &amp;#x27;de&amp;#x27;] -&amp;gt; 0-5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ufos[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Country&amp;#x27;&lt;/span&gt;] = LabelEncoder().fit_transform(ufos[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Country&amp;#x27;&lt;/span&gt;])&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ufos.head()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ======================== å‡†å¤‡å®Œæˆ ==============================&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;x = ufos[[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Seconds&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Latitude&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Longitude&amp;#x27;&lt;/span&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y = ufos[&lt;span class=&#34;string&#34;&gt;&amp;#x27;Country&amp;#x27;&lt;/span&gt;]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# [&amp;#x27;Seconds&amp;#x27;, &amp;#x27;Latitude&amp;#x27;, &amp;#x27;Longitude&amp;#x27;]  ==&amp;gt;  &amp;#x27;Country&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;X_train, X_test, y_train, y_test = train_test_split(x,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    y,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    test_size=&lt;span class=&#34;number&#34;&gt;0.2&lt;/span&gt;,&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;                                                    random_state=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# default max_iter=100 ä¼šè¶…é™&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = LogisticRegression(max_iter=&lt;span class=&#34;number&#34;&gt;1000&lt;/span&gt;).fit(X_train, y_train)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_pred = model.predict(X_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(classification_report(y_test, y_pred))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Predicted labels: &amp;#x27;&lt;/span&gt;, y_pred)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Accuracy: &amp;#x27;&lt;/span&gt;, accuracy_score(y_test, y_pred))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ======================== æ‰“åŒ… model ==============================&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model_name = &lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/web-app/1/ufo-model.pkl&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;pickle.dump(model, &lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;(model_name, &lt;span class=&#34;string&#34;&gt;&amp;#x27;wb&amp;#x27;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;              precision    recall  f1-score   support

           0       1.00      1.00      1.00        41
           1       0.85      0.47      0.60       250
           2       1.00      1.00      1.00         8
           3       1.00      1.00      1.00       131
           4       0.97      1.00      0.98      4743

    accuracy                           0.97      5173
   macro avg       0.96      0.89      0.92      5173
weighted avg       0.97      0.97      0.97      5173

Predicted labels:  [4 4 4 ... 3 4 4]
Accuracy:  0.9702300405953992
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;model_load = pickle.load(&lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;(model_name, &lt;span class=&#34;string&#34;&gt;&amp;#x27;rb&amp;#x27;&lt;/span&gt;))&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(model_load.predict([[&lt;span class=&#34;number&#34;&gt;50&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;44&lt;/span&gt;, -&lt;span class=&#34;number&#34;&gt;12&lt;/span&gt;]]))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;[3]


D:\Scoop\apps\anaconda3\current\lib\site-packages\sklearn\base.py:450: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names
  warnings.warn(
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;äºŒ&#34;&gt;äºŒ&lt;/h4&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; pandas &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; pd&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; train_test_split&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.svm &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; SVC&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.model_selection &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; cross_val_score&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; sklearn.metrics &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; accuracy_score, precision_score, confusion_matrix, classification_report&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;data = pd.read_csv(&lt;span class=&#34;string&#34;&gt;&amp;#x27;./_data_set/cuisines_classification/cleaned_cuisines.csv&amp;#x27;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# åˆ é™¤å‰ä¸¤åˆ—æ— ç”¨çš„åˆ—&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;X = data.iloc[:, &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;:]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y = data[[&lt;span class=&#34;string&#34;&gt;&amp;#x27;cuisine&amp;#x27;&lt;/span&gt;]]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=&lt;span class=&#34;number&#34;&gt;0.3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model = SVC(kernel=&lt;span class=&#34;string&#34;&gt;&amp;#x27;linear&amp;#x27;&lt;/span&gt;, C=&lt;span class=&#34;number&#34;&gt;10&lt;/span&gt;, probability=&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, random_state=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# model.fit(X_train, np.revel(y_train))&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;model.fit(X_train, y_train.values.ravel())&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;y_pred = model.predict(X_test)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(classification_report(y_test, y_pred))&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;pre&gt;&lt;code&gt;              precision    recall  f1-score   support

     chinese       0.73      0.68      0.70       242
      indian       0.89      0.88      0.88       246
    japanese       0.80      0.79      0.79       262
      korean       0.82      0.75      0.78       229
        thai       0.75      0.88      0.81       220

    accuracy                           0.79      1199
   macro avg       0.79      0.80      0.79      1199
weighted avg       0.80      0.79      0.79      1199
&lt;/code&gt;&lt;/pre&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; skl2onnx &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; convert_sklearn&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;from&lt;/span&gt; skl2onnx.common.data_types &lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; FloatTensorType&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å¼ é‡ä¸º 380&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;initial_type = [(&lt;span class=&#34;string&#34;&gt;&amp;#x27;float_input&amp;#x27;&lt;/span&gt;, FloatTensorType([&lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;, &lt;span class=&#34;number&#34;&gt;380&lt;/span&gt;]))]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;options = &amp;#123;&lt;span class=&#34;built_in&#34;&gt;id&lt;/span&gt;(model): &amp;#123;&lt;span class=&#34;string&#34;&gt;&amp;#x27;nocl&amp;#x27;&lt;/span&gt;: &lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;zipmap&amp;#x27;&lt;/span&gt;: &lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;&amp;#125;&amp;#125;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;onx = convert_sklearn(model, initial_types=initial_type, options=options)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;./_data_set/web-app/2/model.onnx&amp;quot;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;quot;wb&amp;quot;&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; f:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    f.write(onx.SerializeToString())&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;h2 id=&#34;ä¿¡æ¯è®º&#34;&gt;ä¿¡æ¯è®º&lt;/h2&gt;
&lt;h3 id=&#34;ä¸¤ç‚¹åˆ†å¸ƒä¿¡æ¯ç†µ&#34;&gt;ä¸¤ç‚¹åˆ†å¸ƒä¿¡æ¯ç†µ&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# å› ä¸º ln0 æ— å®šä¹‰, ç”¨æ­¤å€¼æ¨¡æ‹Ÿè¶‹è¿‘ 0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;eps = &lt;span class=&#34;number&#34;&gt;1e-5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# probability&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p = np.linspace(eps, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; - eps, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# Information entropy&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;h = -(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; - p) * np.log2(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; - p) - p * np.log2(p)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(p, h, label=&lt;span class=&#34;string&#34;&gt;&amp;#x27;Information entropy&amp;#x27;&lt;/span&gt;, color=&lt;span class=&#34;string&#34;&gt;&amp;#x27;red&amp;#x27;&lt;/span&gt;, lw=&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Probability&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Entropy&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.legend(loc=&lt;span class=&#34;string&#34;&gt;&amp;#x27;best&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.grid(&lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# ç»“æœä¸­ä¿¡æ¯ç†µçš„å³°å€¼å–å†³äº log åº•æ•°, eä¸ºåº•æ—¶å³°å€¼ä¸º0.7å·¦å³, 2ä¸ºåº•å³°å€¼ä¸º1&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_74_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;h3 id=&#34;åŸºå°¼ç³»æ•°ä¸-ln&#34;&gt;åŸºå°¼ç³»æ•°ä¸-ln&lt;/h3&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; numpy &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; np&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; matplotlib.pyplot &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; plt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;eps = &lt;span class=&#34;number&#34;&gt;1e-4&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;p = np.linspace(eps, &lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; - eps, &lt;span class=&#34;number&#34;&gt;100&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;h = -(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; - p) * np.log2(&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; - p) - p * np.log2(p)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;gini = &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt; * (&lt;span class=&#34;number&#34;&gt;1&lt;/span&gt; - p) * p&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(p, gini, &lt;span class=&#34;string&#34;&gt;&amp;#x27;r-&amp;#x27;&lt;/span&gt;, lw=&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.plot(p, h / &lt;span class=&#34;number&#34;&gt;2&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;g-&amp;#x27;&lt;/span&gt;, lw=&lt;span class=&#34;number&#34;&gt;3&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.title(&lt;span class=&#34;string&#34;&gt;&amp;#x27;Gini(p) / Ln(p)&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;16&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.xlabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;p&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.ylabel(&lt;span class=&#34;string&#34;&gt;&amp;#x27;H&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.legend([&lt;span class=&#34;string&#34;&gt;&amp;#x27;Gini&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;Ln&amp;#x27;&lt;/span&gt;], loc=&lt;span class=&#34;string&#34;&gt;&amp;#x27;best&amp;#x27;&lt;/span&gt;, fontsize=&lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;plt.show()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;p&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;ML_files/ML_76_0.png&#34; alt=&#34;png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;a&gt;&lt;img src= &#34;https://pan.weidows.tech/d/local/img/loading.svg&#34; data-lazy-src=&#34;https://pan.weidows.tech/d/local/img/divider.png&#34; alt=&#34;åˆ†å‰²çº¿&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;å€Ÿç‰©è¡¨&#34;&gt;å€Ÿç‰©è¡¨&lt;/h2&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-1&#39; href=&#39;#cite_ref-1&#39;&gt;[1]&lt;/a&gt;: &lt;a href=&#34;https://discover304.top/&#34;&gt;https://discover304.top/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-2&#39; href=&#39;#cite_ref-2&#39;&gt;[2]&lt;/a&gt;: &lt;a href=&#34;https://www.bilibili.com/video/BV16L411w7oQ?p=6&#34;&gt;ã€ä¸Šæµ·äº¤å¤§ã€‘ã€è…¾è®¯ã€‘å¼ºå¼ºè”åˆ æœºå™¨å­¦ä¹ +æ·±åº¦å­¦ä¹ &lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-3&#39; href=&#39;#cite_ref-3&#39;&gt;[3]&lt;/a&gt;: &lt;a href=&#34;https://www.analyticsvidhya.com/blog/2018/08/dimensionality-reduction-techniques-python/&#34;&gt;The Ultimate Guide to 12 Dimensionality Reduction Techniques (with Python codes)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a name=&#39;cite_note-4&#39; href=&#39;#cite_ref-4&#39;&gt;[4]&lt;/a&gt;: &lt;a href=&#34;https://github.com/microsoft/ML-For-Beginners&#34;&gt;https://github.com/microsoft/ML-For-Beginners&lt;/a&gt;&lt;/p&gt;
&lt;script type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/kity@2.0.4/dist/kity.min.js&#34;&gt;&lt;/script&gt;&lt;script type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js&#34;&gt;&lt;/script&gt;&lt;script defer=&#34;true&#34; type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js&#34;&gt;&lt;/script&gt;&lt;link rel=&#34;stylesheet&#34; type=&#34;text&amp;#x2F;css&#34; href=&#34;https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css&#34;&gt; ]]></description>
        </item>
    </channel>
</rss>
