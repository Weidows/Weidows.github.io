{
    "version": "https://jsonfeed.org/version/1",
    "title": "⭐️齐下无贰⭐️ • All posts by \"server\" tag",
    "description": "May all the beauty be bless.✨",
    "home_page_url": "https://blog.weidows.tech",
    "items": [
        {
            "id": "https://blog.weidows.tech/post/system/server/AWS/",
            "url": "https://blog.weidows.tech/post/system/server/AWS/",
            "title": "🤧AWS-matters",
            "date_published": "2023-07-28T11:35:28.000Z",
            "content_html": "<h1>AWS-matters</h1>\n<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2023-09-04 15:07:59\n * @FilePath: \\Blog-private\\source\\_posts\\system\\server\\AWS.md\n * @Description:\n * @!: *********************************************************************\n-->\n<blockquote class=\"pullquote mindmap mindmap-sm\"><ul>\n<li><a href=\"#aws-matters\">AWS-matters</a>\n<ul>\n<li><a href=\"#%E5%88%9B%E5%BB%BA%E5%AD%90%E8%B4%A6%E6%88%B7\">创建子账户</a></li>\n<li><a href=\"#ec2\">EC2</a>\n<ul>\n<li><a href=\"#vcpu-%E9%99%90%E5%88%B6\">vCPU-限制</a></li>\n<li><a href=\"#gpu-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E9%80%89%E5%9E%8B\">GPU-服务器的选型</a>\n<ul>\n<li><a href=\"#%E5%9C%A8%E5%93%AA%E9%87%8C%E5%92%8C%E4%BC%9A%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91\">在哪里和会遇到的坑</a></li>\n<li><a href=\"#%E4%BB%B7%E6%A0%BC\">价格</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9E%E6%8E%A5\">服务器连接</a>\n<ul>\n<li><a href=\"#%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7-ssh-%E8%BF%9E%E6%8E%A5\">服务器创建用户-ssh 连接</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%AE%9A%E6%97%B6%E5%BC%80%E5%85%B3%E6%9C%BA\">定时开关机</a></li>\n</ul>\n</li>\n<li><a href=\"#credits\">Credits</a>\n<ul>\n<li><a href=\"#%E5%88%9B%E4%B8%9A%E8%AE%A1%E5%88%92%E9%87%91%E9%A2%9D\">创业计划金额</a></li>\n<li><a href=\"#%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8\">如何使用</a></li>\n</ul>\n</li>\n<li><a href=\"#router-53\">Router-53</a>\n<ul>\n<li><a href=\"#domain-register\">domain-register</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%B8%B8%E7%94%A8%E6%8C%87%E4%BB%A4\">常用指令</a>\n<ul>\n<li><a href=\"#aws-cli-login\">AWS-Cli-Login</a></li>\n<li><a href=\"#ec2-instance-manage\">EC2-instance-manage</a></li>\n<li><a href=\"#%E6%9C%AA%E5%88%86%E7%B1%BB\">未分类</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%80%9F%E7%89%A9%E8%A1%A8\">借物表</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"创建子账户\">创建子账户</h2>\n<style>.bbplayer{width: 100%; max-width: 850px; margin: auto}</style><div class=\"bbplayer\"><iframe class=\"bbplayer\" id=\"mmedia-cpTOdiHcQcsxTBHZ\" src=\"https://player.bilibili.com/player.html?bvid=BV11h4y157Pe&page=1&high_quality=1&danmaku=true&autoplay=0\" allowfullscreen=\"allowfullscreen\" scrolling=\"no\" border=\"0\" frameborder=\"0\" framespacing=\"0\" sandbox=\"allow-top-navigation allow-same-origin allow-forms allow-scripts allow-popups\"></iframe></div><script> document.getElementById(\"mmedia-cpTOdiHcQcsxTBHZ\").style.height=document.getElementById(\"mmedia-cpTOdiHcQcsxTBHZ\").scrollWidth*0.76+\"px\";\n    window.onresize = function(){\n      document.getElementById(\"mmedia-cpTOdiHcQcsxTBHZ\").style.height=document.getElementById(\"mmedia-cpTOdiHcQcsxTBHZ\").scrollWidth*0.76+\"px\";\n    }; </script>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"EC2\">EC2</h2>\n<h3 id=\"vCPU-限制\">vCPU-限制</h3>\n<p>新账号默认是 0, 得提交工单去申请, 改为比如 16/32/64 这样 (need n hrs) <sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup></p>\n<hr>\n<h3 id=\"GPU-服务器的选型\">GPU-服务器的选型</h3>\n<h4 id=\"在哪里和会遇到的坑\">在哪里和会遇到的坑</h4>\n<p><a href=\"https://aws.amazon.com/cn/ec2/instance-types\">Amazon EC2 实例类型-EC2 虚拟云服务器托管-AWS 云服务</a></p>\n<p>AWS 属实有点迷宫, 比如我想找个合适的算力资源用于开发, 搜了半天 GPU 发现有很多卖 AI 服务的项目挂着, 但没找到服务器</p>\n<p>那么就直奔 EC2 吧, 下一步迷的是机型挑选, 列了一大排没标 GPU 型号的服务器</p>\n<p>你还得去搜 g 系列服务器配的卡, 比如 2023 年是 g5-A10G</p>\n<p>确定目标后想 create instance, 又会发现有 region 限制 (比如国内香港还没有 g5 系列)</p>\n<hr>\n<h4 id=\"价格\">价格</h4>\n<p>美 &gt; 欧 &gt; 亚太 &gt; 南美</p>\n<p>同一区域差别不大, 跨区差额比较大</p>\n<p>比如 2023.7-g5.xlarge-server 美区 1<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi mathvariant=\"normal\">/</mi><mi>h</mi><mo separator=\"true\">,</mo><mtext>欧区</mtext><mn>1.2</mn></mrow><annotation encoding=\"application/x-tex\">/h, 欧区1.2</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">/</span><span class=\"mord mathnormal\">h</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord cjk_fallback\">欧区</span><span class=\"mord\">1.2</span></span></span></span>/h</p>\n<hr>\n<h3 id=\"服务器连接\">服务器连接</h3>\n<ol>\n<li>我用 aws 自动创建的公私钥对登录, 一直是 access denied</li>\n<li>web console 登录进去, 直接 vim 修改</li>\n<li>ssh 登录, 也可以改 root 密码切到 root</li>\n</ol>\n<h4 id=\"服务器创建用户-ssh-连接\">服务器创建用户-ssh 连接</h4>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">sudo</span> passwd root</span><br><span class=\"line\">passwd ubuntu</span><br><span class=\"line\">su root</span><br><span class=\"line\"></span><br><span class=\"line\">adduser project-1</span><br><span class=\"line\"><span class=\"comment\"># userdel -r project-1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 一定要切到新用户, 不要用 root 执行后面的</span></span><br><span class=\"line\">su project-1</span><br><span class=\"line\"><span class=\"built_in\">mkdir</span> ~/.ssh</span><br><span class=\"line\"><span class=\"built_in\">touch</span> ~/.ssh/authorized_keys</span><br><span class=\"line\"><span class=\"built_in\">chmod</span> 600 ~/.ssh/authorized_keys</span><br><span class=\"line\"></span><br><span class=\"line\">su root</span><br><span class=\"line\">service sshd restart</span><br><span class=\"line\">ssh project-1@localhost</span><br></pre></td></tr></table></figure>\n<h3 id=\"定时开关机\">定时开关机</h3>\n<blockquote>\n<p><a href=\"https://repost.aws/zh-Hans/knowledge-center/start-stop-lambda-eventbridge\">使用 Lambda 以设定的间隔停止和启动 EC2 实例</a> <br>\n<a href=\"https://blog.csdn.net/m0_61418822/article/details/129008798\">AWS EC2 定时开关机（lambda+cloudwatch 实现）<em>aws cloud watch</em>干运维的 yds 的博客-CSDN 博客</a></p>\n</blockquote>\n<ol>\n<li>EventBridge -&gt; cron</li>\n<li>Lambda -&gt; py\n<ol>\n<li>IAM -&gt; 执行角色权限</li>\n</ol>\n</li>\n<li>EC2 -&gt; start/stop</li>\n</ol>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"Credits\">Credits</h2>\n<blockquote>\n<p><a href=\"https://jinshuju.net/f/e8uNNU\">亚马逊云 Startup 免费云资源申请</a> <br>\n<a href=\"https://aws.amazon.com/cn/campaigns/activate/\">亚马逊云科技云创计划-亚马逊云科技初创公司起步云资源服务-亚马逊云科技中国区域网络服务解决方案</a></p>\n</blockquote>\n<h3 id=\"创业计划金额\">创业计划金额</h3>\n<ol>\n<li>\n<p>填写表格, 介绍项目</p>\n</li>\n<li>\n<p>需要与负责人会议沟通, 讲明给的金额</p>\n<p>是按每批 5000$ credit 发, 用完再给, 过期可以续</p>\n</li>\n<li>\n<p>第二次会议讲 AWS 可以为我们提供什么个性化服务 (因为有很多方便的服务我们可能并不知道)</p>\n</li>\n</ol>\n<hr>\n<h3 id=\"如何使用\">如何使用</h3>\n<p>这个很坑, 我找了半天 Doc/设置/付款选项也没找到哪里能更换为 credits 抵扣</p>\n<p>问了 AWS 工作人员才知道, 是先花后付, 每个月的账单会自动扣在 credits 头上, 不够的才扣银行卡</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"Router-53\">Router-53</h2>\n<h3 id=\"domain-register\">domain-register</h3>\n<blockquote>\n<p>You can’t use AWS credits to pay the fee for registering a new domain with Route 53. <sup id='cite_ref-3'><a href=\"#cite_note-3\">[3]</a></sup> <br>\nAWS 注册域名不能用 credits 抵扣</p>\n</blockquote>\n<p>我翻开文档一查，这文档没有年代。歪歪斜斜的每页上都写着“抵扣金额”几个字，我横竖睡不着，仔细看了半夜，才从字缝里看出来，满本上都写着两个字“付费&quot;！</p>\n<p>woc 藏挺深, 这不坑人嘛, 买了之后看了半天账单没看明白, 原来是扣的信用卡的</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"常用指令\">常用指令</h2>\n<h3 id=\"AWS-Cli-Login\">AWS-Cli-Login</h3>\n<blockquote>\n<p><a href=\"https://github.com/aws/aws-cli\">GitHub - aws/aws-cli: Universal Command Line Interface for Amazon Web Services</a> &gt; <a href=\"https://us-east-1.console.aws.amazon.com/iamv2/home#/security_credentials\">https://us-east-1.console.aws.amazon.com/iamv2/home#/security_credentials</a> <br>\n创建访问秘钥对</p>\n</blockquote>\n<figure class=\"highlight markdown\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"quote\">&gt; aws configure</span></span><br><span class=\"line\">AWS Access Key ID [<span class=\"strong\">****</span><span class=\"strong\">****</span><span class=\"strong\">****</span><span class=\"strong\">****</span>JFP2]: XXXXXXXXXXXXXXXXXXXX</span><br><span class=\"line\">AWS Secret Access Key [<span class=\"strong\">****</span><span class=\"strong\">****</span><span class=\"strong\">****</span><span class=\"strong\">****</span>Rb0A]: XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX</span><br><span class=\"line\">Default region name [us-east-1]: 直接回车</span><br><span class=\"line\">Default output format [None]: 直接回车</span><br></pre></td></tr></table></figure>\n<h3 id=\"EC2-instance-manage\">EC2-instance-manage</h3>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">开机</span></span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">aws ec2 start-instances --instance-ids i-036c4cc27119d3b8e</span></span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">查询</span></span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">aws ec2 describe-instances</span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;Reservations&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;Groups&quot;: [],</span><br><span class=\"line\">            &quot;Instances&quot;: [</span><br><span class=\"line\">                &#123;</span><br><span class=\"line\">                    &quot;AmiLaunchIndex&quot;: 0,</span><br><span class=\"line\">                    &quot;ImageId&quot;: &quot;xxxxxx&quot;,</span><br><span class=\"line\">                    &quot;InstanceId&quot;: &quot;xxxxxx&quot;,</span><br><span class=\"line\">                    &quot;InstanceType&quot;: &quot;g5.2xlarge&quot;,</span><br><span class=\"line\">                    &quot;KeyName&quot;: &quot;Login&quot;,</span><br><span class=\"line\">                    &quot;LaunchTime&quot;: &quot;2023-07-31T03:11:29+00:00&quot;,</span><br><span class=\"line\">                    &quot;Monitoring&quot;: &#123;</span><br><span class=\"line\">                        &quot;State&quot;: &quot;enabled&quot;</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    &quot;Placement&quot;: &#123;</span><br><span class=\"line\">                        &quot;AvailabilityZone&quot;: &quot;us-east-1b&quot;,</span><br><span class=\"line\">                        &quot;GroupName&quot;: &quot;&quot;,</span><br><span class=\"line\">                        &quot;Tenancy&quot;: &quot;default&quot;</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    &quot;PrivateDnsName&quot;: &quot;ip-172-31-95-130.ec2.internal&quot;,</span><br><span class=\"line\">                    &quot;PrivateIpAddress&quot;: &quot;172.31.95.130&quot;,</span><br><span class=\"line\">                    &quot;ProductCodes&quot;: [],</span><br><span class=\"line\">                    &quot;PublicDnsName&quot;: &quot;xxxxxx&quot;,</span><br><span class=\"line\">                    &quot;PublicIpAddress&quot;: &quot;xxxxxx&quot;,</span><br><span class=\"line\">                    &quot;State&quot;: &#123;</span><br><span class=\"line\">                        &quot;Code&quot;: 16,</span><br><span class=\"line\">                        &quot;Name&quot;: &quot;running&quot;</span><br><span class=\"line\">                    &#125;,</span><br><span class=\"line\">                    &quot;StateTransitionReason&quot;: &quot;&quot;,</span><br><span class=\"line\">                    &quot;SubnetId&quot;: &quot;xxxxxx&quot;,</span><br><span class=\"line\">                    &quot;VpcId&quot;: &quot;xxxxxx&quot;,</span><br><span class=\"line\">                    &quot;Architecture&quot;: &quot;x86_64&quot;,</span><br><span class=\"line\">                    &quot;BlockDeviceMappings&quot;: [</span><br><span class=\"line\">                        &#123;</span><br><span class=\"line\">                            &quot;DeviceName&quot;: &quot;/dev/sda1&quot;,</span><br><span class=\"line\">                            &quot;Ebs&quot;: &#123;</span><br><span class=\"line\">                                &quot;AttachTime&quot;: &quot;2023-07-23T04:38:13+00:00&quot;,</span><br><span class=\"line\">                                &quot;DeleteOnTermination&quot;: true,</span><br><span class=\"line\">                                &quot;Status&quot;: &quot;attached&quot;,</span><br><span class=\"line\">                                &quot;VolumeId&quot;: &quot;xxxxxx&quot;</span><br><span class=\"line\">                            &#125;</span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    ],</span><br><span class=\"line\">                    &quot;ClientToken&quot;: &quot;xxxxxx&quot;,</span><br><span class=\"line\">                    &quot;EbsOptimized&quot;: true,</span><br><span class=\"line\">                    &quot;EnaSupport&quot;: true,</span><br><span class=\"line\">                    &quot;Hypervisor&quot;: &quot;xen&quot;,</span><br><span class=\"line\">                    &quot;NetworkInterfaces&quot;: [</span><br><span class=\"line\">-- More  --</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">筛选</span></span><br><span class=\"line\"><span class=\"meta prompt_\">&gt; </span><span class=\"language-bash\">aws ec2 describe-instances --query <span class=\"string\">&quot;Reservations[].Instances[].PublicIpAddress&quot;</span></span></span><br><span class=\"line\">[</span><br><span class=\"line\">    &quot;1.2.3.4&quot;</span><br><span class=\"line\">]</span><br></pre></td></tr></table></figure>\n<h3 id=\"未分类\">未分类</h3>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"code\"><pre><span class=\"line\">aws organizations <span class=\"keyword\">enable</span>-aws-service-<span class=\"keyword\">access</span> <span class=\"comment\">--service-principal account.amazonaws.com</span></span><br></pre></td></tr></table></figure>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://www.runoob.com/linux/linux-user-manage.html\">Linux 用户和用户组管理</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://repost.aws/zh-Hans/knowledge-center/ec2-on-demand-instance-vcpu-increase\">计算可为 Amazon EC2 按需型实例请求提高的 vCPU 限制</a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/domain-register.html\">Registering a new domain - Amazon Route 53</a></p>\n<p><a name='cite_note-4' href='#cite_ref-4'>[4]</a>: <a href=\"https://docs.aws.amazon.com/zh_cn/cli/latest/userguide/cli-services-ec2-instances.html\">启动、列出和终止 Amazon EC2 实例 - AWS Command Line Interface</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "AWS",
                "Server"
            ]
        }
    ]
}