{
    "version": "https://jsonfeed.org/version/1",
    "title": "⭐️齐下无贰⭐️ • All posts by \"system\" tag",
    "description": "May all the beauty be bless.✨",
    "home_page_url": "https://weidows.github.io",
    "items": [
        {
            "id": "https://weidows.github.io/post/system/server/serv00/",
            "url": "https://weidows.github.io/post/system/server/serv00/",
            "title": "serv00-服务搭建记录",
            "date_published": "2024-08-02T19:42:31.000Z",
            "content_html": "<h1>serv00-服务搭建记录</h1>\n<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2024-08-07 12:20:39\n * @FilePath: \\Blog-private\\source\\_posts\\system\\serv00.md\n * @Description:\n * @!: *********************************************************************\n-->\n<blockquote class=\"pullquote mindmap mindmap-sm\"><ul>\n<li><a href=\"#serv00-%E6%9C%8D%E5%8A%A1%E6%90%AD%E5%BB%BA%E8%AE%B0%E5%BD%95\">serv00-服务搭建记录</a>\n<ul>\n<li><a href=\"#%E6%9C%8D%E5%8A%A1%E5%99%A8\">服务器</a>\n<ul>\n<li><a href=\"#login-failed\">login-failed</a></li>\n<li><a href=\"#%E6%96%87%E4%BB%B6%E5%90%8C%E6%AD%A5\">文件同步</a></li>\n<li><a href=\"#%E9%87%8D%E5%90%AF%E5%90%8E%E6%9C%8D%E5%8A%A1%E6%81%A2%E5%A4%8D\">重启后服务恢复</a></li>\n</ul>\n</li>\n<li><a href=\"#alist-%E5%9B%BE%E5%BA%8A\">alist-图床</a>\n<ul>\n<li><a href=\"#%E5%9B%BE%E7%89%87%E4%B8%8B%E8%BD%BD%E9%97%AE%E9%A2%98\">图片下载问题</a></li>\n</ul>\n</li>\n<li><a href=\"#cloudflare\">cloudflare</a></li>\n<li><a href=\"#%E5%80%9F%E7%89%A9%E8%A1%A8\">借物表</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"服务器\">服务器</h2>\n<h3 id=\"login-failed\">login-failed</h3>\n<p>官方邮件给的地址 <code>s4.serv00.com</code> 之前还行, 现在无法登录, 全球无解析状态</p>\n<p>ssh host 换为 <code>web4.serv00.com</code></p>\n<hr>\n<h3 id=\"文件同步\">文件同步</h3>\n<p>在 duck / rclone / rsync 中选择的 duck+WebDAV</p>\n<p>其他两个不方便/有报错</p>\n<p>我的配置: 主要用来备份服务器上的图片文件 <sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"code\"><pre><span class=\"line\">duck --synchronize davs://pan.weidows.tech/dav/local/ ./backup --username xxx --password xxx --parallel --quiet</span><br></pre></td></tr></table></figure>\n<hr>\n<h3 id=\"重启后服务恢复\">重启后服务恢复</h3>\n<p>serv00 服务器每天会不定时重启, 网上提供的方法大多是重启后进一下 cron, 但似乎不太好用</p>\n<p>我自己改了下, 启用定时 cron:</p>\n<figure class=\"highlight gradle\"><table><tr><td class=\"code\"><pre><span class=\"line\">ps aux | <span class=\"keyword\">grep</span> <span class=\"string\">&#x27;[P]M2&#x27;</span> || <span class=\"regexp\">/home/</span>Weidows<span class=\"regexp\">/.npm-global/</span>bin/pm2 resurrect</span><br></pre></td></tr></table></figure>\n<p>可以用这个杀一下用户进程</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"code\"><pre><span class=\"line\">pkill -<span class=\"built_in\">kill</span> -u Weidows</span><br></pre></td></tr></table></figure>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"alist-图床\">alist-图床</h2>\n<p>我的目标是搭建一个 alist , 同时用本地那 3 个 G 存储做 <code>个人图床</code> (相当够用了, 不够再加其他盘), 看网上别人踩坑的记录挺少的</p>\n<p>首先在 serv00 上正常搭建起来, 有两种方法能对外开放: <code>argo cloudflared</code> 或者 <code>panel 添加网站</code></p>\n<p>还是更推荐直连, 速度和延迟都很不错, argo 并不稳</p>\n<hr>\n<h3 id=\"图片下载问题\">图片下载问题</h3>\n<p>按上面那样搭好后, 在网页中图片显示没有问题, 但是右键 -&gt; 新页面打开后会直接弹到下载 (是 header 设置的问题)</p>\n<p>可以使用 cloudflare 的服务给在中间截胡更改了:</p>\n<ol>\n<li>cloudflare -&gt; 点开用的域名 -&gt; 规则 -&gt; 转换规则 -&gt; 修改响应头</li>\n<li>名字随便起 -&gt; 自定义筛选表达式</li>\n<li>匹配: <code>主机名 等于 pan.weidows.tech</code></li>\n<li>设置静态 -&gt; <code>Content-Disposition</code> = <code>inline; filename=&quot;from-pan.weidows.tech.jpg&quot;</code> , 当然可以改一改自定义内容</li>\n</ol>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"cloudflare\">cloudflare</h2>\n<p><a href=\"../../../Web/cloudflare\">cloudflare-使用及问题记录</a></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://docs.duck.sh/cli/#synchronize-folders-with-synchronize\">https://docs.duck.sh/cli/#synchronize-folders-with-synchronize</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "cloudflare",
                "alist",
                "system"
            ]
        }
    ]
}