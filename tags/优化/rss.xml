<?xml version="1.0"?>
<rss version="2.0">
    <channel>
        <title>⭐️齐下无贰⭐️ • Posts by &#34;优化&#34; tag</title>
        <link>https://weidows.github.io</link>
        <description>May all the beauty be bless.✨</description>
        <language>zh-CN</language>
        <pubDate>Sat, 06 Feb 2021 17:11:24 +0000</pubDate>
        <lastBuildDate>Sat, 06 Feb 2021 17:11:24 +0000</lastBuildDate>
        <category>java</category>
        <category>javadoc</category>
        <category>编码</category>
        <category>vscode</category>
        <category>maven</category>
        <category>对象</category>
        <category>设计模式</category>
        <category>jvm</category>
        <category>lambda</category>
        <category>备忘录</category>
        <category>api</category>
        <category>推荐</category>
        <category>浏览器</category>
        <category>扩展</category>
        <category>ffmpeg</category>
        <category>算法</category>
        <category>hexdump</category>
        <category>hls</category>
        <category>openssl</category>
        <category>shell</category>
        <category>密码学</category>
        <category>qq</category>
        <category>ps</category>
        <category>设计</category>
        <category>摄影</category>
        <category>latex</category>
        <category>php</category>
        <category>website</category>
        <category>ssh</category>
        <category>linux</category>
        <category>regex</category>
        <category>yaml</category>
        <category>音乐</category>
        <category>哲学</category>
        <category>生活</category>
        <category>健身</category>
        <category>面试</category>
        <category>闲鱼</category>
        <category>购物</category>
        <category>笔记</category>
        <category>english</category>
        <category>idea</category>
        <category>html</category>
        <category>css</category>
        <category>javascript</category>
        <category>成长路线</category>
        <category>deprecated</category>
        <category>font</category>
        <category>vr</category>
        <category>网课</category>
        <category>manjaro</category>
        <category>计算机系统</category>
        <category>服务器</category>
        <category>虚拟机</category>
        <category>树莓派</category>
        <category>windows</category>
        <category>docker</category>
        <category>多线程</category>
        <category>进程</category>
        <category>cpu</category>
        <category>scoop</category>
        <category>git</category>
        <category>python</category>
        <category>node</category>
        <category>ubuntu</category>
        <category>wsl2</category>
        <category>环境变量</category>
        <category>aria2</category>
        <category>工具</category>
        <category>pycharm</category>
        <category>goland</category>
        <category>图床</category>
        <category>爬虫</category>
        <category>sm.ms</category>
        <category>package</category>
        <category>tomcat</category>
        <category>mybatis</category>
        <category>map</category>
        <category>crud</category>
        <category>日志</category>
        <category>分页</category>
        <category>数据库</category>
        <category>注解</category>
        <category>mysql</category>
        <category>jdbc</category>
        <category>sql</category>
        <category>前端</category>
        <category>json</category>
        <category>javaweb</category>
        <category>servlet</category>
        <category>cookie</category>
        <category>session</category>
        <category>jsp</category>
        <category>filter</category>
        <category>架构</category>
        <category>反射</category>
        <category>cors</category>
        <category>大前端</category>
        <category>jquery</category>
        <category>npm</category>
        <category>yarn</category>
        <category>vue</category>
        <category>opengl</category>
        <category>c</category>
        <category>conan</category>
        <category>计网</category>
        <category>硬件</category>
        <category>onenote</category>
        <category>复变函数</category>
        <category>通信</category>
        <category>音频</category>
        <category>傅里叶变换</category>
        <category>极化码</category>
        <category>信息论</category>
        <category>powershell</category>
        <category>宝塔面板</category>
        <category>搞笑</category>
        <category>高能</category>
        <category>快捷键</category>
        <category>cmake</category>
        <category>区块链</category>
        <category>golang</category>
        <category>markdown</category>
        <category>processing</category>
        <category>anaconda</category>
        <category>hexo</category>
        <category>github</category>
        <category>gitee</category>
        <category>action</category>
        <category>branch</category>
        <category>release</category>
        <category>pages</category>
        <category>copilot</category>
        <category>插件</category>
        <category>emmet</category>
        <category>美化</category>
        <category>snippet</category>
        <category>seo</category>
        <category>node.js</category>
        <category>butterfly</category>
        <category>pug</category>
        <category>styl</category>
        <category>pjax</category>
        <category>优化</category>
        <category>魔改</category>
        <item>
            <guid isPermalink="true">https://weidows.github.io/post/Web/Node/Hexo/optimize/</guid>
            <title>🚀网站优化记录.</title>
            <link>https://weidows.github.io/post/Web/Node/Hexo/optimize/</link>
            <category>website</category>
            <category>hexo</category>
            <category>优化</category>
            <category>魔改</category>
            <pubDate>Sat, 06 Feb 2021 17:11:24 +0000</pubDate>
            <description><![CDATA[ &lt;!--
 * @?: *********************************************************************
 * @Author: Weidows
 * @Date: 2021-02-07 01:11:24
 * @LastEditors: Weidows
 * @LastEditTime: 2021-08-29 15:15:38
 * @FilePath: \Blog-private\source\_posts\Web\Node\Hexo\optimize.md
 * @Description:
 * @!: *********************************************************************
--&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#why&#34;&gt;Why?&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#why-do-this&#34;&gt;&lt;code&gt;Why do this?&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#%E6%A6%82%E8%A7%88&#34;&gt;概览&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#%E5%A5%91%E5%90%88&#34;&gt;契合&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#%E4%BC%98%E5%8C%96-css&#34;&gt;优化 css&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#%E4%BC%98%E5%8C%96-js&#34;&gt;优化 js&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#%E5%86%8D%E6%AC%A1%E9%AD%94%E6%94%B9&#34;&gt;再次魔改&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png&#34; alt=&#34;分割线&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;Why&#34;&gt;Why?&lt;/h2&gt;
&lt;h3 id=&#34;Why-do-this&#34;&gt;&lt;code&gt;Why do this?&lt;/code&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;这网站有太多需要简化的东西了, 很多样式是 &lt;code&gt; 直接引入的 css 和 js&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;巨耗费渲染性能和时间(可以感觉出来加载这网站挺费劲的)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png&#34; alt=&#34;分割线&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;概览&#34;&gt;概览&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;对于 css 的所有修改, 全部整合进&lt;code&gt;mine.styl&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;编译时就已经做好美化, 额外资源负载几乎降为 0&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注入到 &lt;code&gt;index.styl&lt;/code&gt; 末尾.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;js 的美化, 全部整合到 &lt;code&gt;utils.js&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;请求数加 0, 加载策略优化, 时间降低; Weidows 对象直接全局加载生效且不被 GC.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;把 js 代码全堆在最后, 暴露 &lt;code&gt;Weidows.re()&lt;/code&gt; 供 pjax 调用.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;pug 的修改降低为 3 处, 方便升级换代, 都在此目录下: &lt;code&gt;themes\butterfly\layout\includes\&lt;/code&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;additional-js.pug&lt;/code&gt; - 末尾追加樱花特效&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;footer.pug&lt;/code&gt;- 页脚标签 + 改注脚样式&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;third-party\pjax.pug&lt;/code&gt; - 调用 &lt;a href=&#34;http://Weidows.re&#34;&gt;Weidows.re&lt;/a&gt;(), 适配 pjax 刷新&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png&#34; alt=&#34;分割线&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;契合&#34;&gt;契合&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;结合 &lt;a href=&#34;./butterfly_modify&#34;&gt;butterfly 内部魔改记录&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png&#34; alt=&#34;分割线&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;优化 -css&#34;&gt;优化 css&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;以往的 css 是直接引入的文件, 在客户端加载时还是会耗费一些不菲时间加载 + 渲染出来&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;优化思路就是把 css 变成&lt;code&gt;styl&lt;/code&gt;, 使之在编译生成 HTML 文件时就把样式改了, 节省客户端耗费.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;如下:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;新建一个名为 &lt;code&gt;mine.styl&lt;/code&gt; 的文件.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;原 css 文件就是 &lt;code&gt;mine.css&lt;/code&gt;, 用&lt;a href=&#34;https://html5beta.com/tools/css2stylus.html&#34;&gt;&lt;code&gt;css2styl&lt;/code&gt;&lt;/a&gt; 转换为 styl 格式, 粘贴到 &lt;code&gt;mine.styl&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;注意这个网站转换成的 styl 有很多 bug(包括缩进和括号, 需要人工检验)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;img src=&#34;https://www.helloimg.com/images/2022/02/27/GVFlgb.png&#34; alt=&#34;20210207134449&#34; /&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;包括原先 &lt;code&gt;source/css/_global/function.styl&lt;/code&gt; 之类的内添加或修改的样式, 也可以转入 mine.styl.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;然后在 &lt;code&gt;index.styl&lt;/code&gt; 中引入:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在末尾加上&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight styl&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;//mine&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;@import&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;#x27;_mine/mine.styl&amp;#x27;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;用 &lt;code&gt;hexo server&lt;/code&gt; 测试一下, 应该没问题~&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;这样 css 优化就完成了&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;a&gt;&lt;img src=&#34;https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png&#34; alt=&#34;分割线&#34;&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;优化 -js&#34;&gt;优化 js&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;跟 css 一样, 我原先也是直接一个 &lt;code&gt;mine.js&lt;/code&gt; 引入的&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;虽然没啥问题, 但是会导致页面第二次加载渲染, 而且多了一个请求数&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;于是, 我想直接把它淦进 &lt;code&gt;main.js&lt;/code&gt; 中!&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;操作不复杂, 直接复制 &lt;code&gt;mine.js&lt;/code&gt; 内容, 粘贴进 &lt;code&gt;main.js&lt;/code&gt; 最后&lt;/li&gt;
&lt;li&gt;注意不是最末尾&lt;/li&gt;
&lt;/ul&gt;
&lt;figure class=&#34;highlight js&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;  &lt;span class=&#34;comment&#34;&gt;// 粘贴到这里&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  refreshFn();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;  unRefreshFn();&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&amp;#125;)&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;再次魔改&#34;&gt;再次魔改&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;因为某些美化函数会被 pjax 功能搞失效, 直接把函数放进 main.js 的话,pjax 无法再次使用&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;所以我把美化 js 打包并弄进 &lt;code&gt;butterfly/layout/head.pug&lt;/code&gt; 中, 在页面编译时就会被添加到 &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; 内, 加载时间和请求数不增加!&lt;/p&gt;
&lt;p&gt;现在, 加载逻辑是: js 美化代码在 HTML 文件的 head 中, 然后在 main.js 最后写一句调用命令; 在页面用了 pjax 加载时,pjax.pug 中的重渲染函数会被调用.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;script type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/kity@2.0.4/dist/kity.min.js&#34;&gt;&lt;/script&gt;&lt;script type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js&#34;&gt;&lt;/script&gt;&lt;script defer=&#34;true&#34; type=&#34;text&amp;#x2F;javascript&#34; src=&#34;https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js&#34;&gt;&lt;/script&gt;&lt;link rel=&#34;stylesheet&#34; type=&#34;text&amp;#x2F;css&#34; href=&#34;https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css&#34;&gt; ]]></description>
        </item>
    </channel>
</rss>
