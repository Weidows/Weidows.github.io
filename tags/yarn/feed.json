{
    "version": "https://jsonfeed.org/version/1",
    "title": "⭐️齐下无贰⭐️ • All posts by \"yarn\" tag",
    "description": "May all the beauty be bless.✨",
    "home_page_url": "https://weidows.github.io",
    "items": [
        {
            "id": "https://weidows.github.io/post/Web/Node/node/",
            "url": "https://weidows.github.io/post/Web/Node/node/",
            "title": "⬆ Node.js-环境配置-使用",
            "date_published": "2020-11-24T13:59:29.000Z",
            "content_html": "<h1>Node.js-环境配置-使用</h1>\n<!--\n * @Author: Weidows\n * @Date: 2020-11-24 21:59:29\n * @LastEditors: Weidows\n * @LastEditTime: 2022-04-20 23:41:18\n * @FilePath: \\Blog-private\\source\\_posts\\Web\\Node\\node.md\n * @Description:\n-->\n<blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li><a href=\"#nodejs-%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE-%E4%BD%BF%E7%94%A8\">Node.js-环境配置-使用</a>\n<ul>\n<li><a href=\"#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE\">环境配置</a></li>\n<li><a href=\"#%E5%AE%89%E8%A3%85-yarn\">安装 yarn</a></li>\n<li><a href=\"#%E5%8A%A0%E9%80%9F\">加速</a>\n<ul>\n<li><a href=\"#%E6%8D%A2%E6%BA%90\">换源</a></li>\n<li><a href=\"#%E4%BB%A3%E7%90%86\">代理</a></li>\n</ul>\n</li>\n<li><a href=\"#%E4%BE%9D%E8%B5%96%E5%8D%87%E7%BA%A7\">依赖升级</a></li>\n<li><a href=\"#%E5%8F%82%E6%95%B0%E5%8F%8A%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4\">参数及常用命令</a>\n<ul>\n<li><a href=\"#-gglobal\"><code>-g(global)</code></a></li>\n<li><a href=\"#-save\"><code>-save</code></a></li>\n</ul>\n</li>\n<li><a href=\"#local-%E5%85%A8%E5%B1%80%E4%BE%9D%E8%B5%96\">local 全局依赖</a></li>\n<li><a href=\"#%E8%BF%90%E8%A1%8C%E6%8A%A5%E9%94%99\">运行报错</a></li>\n<li><a href=\"#%E6%8E%A8%E8%8D%90%E6%96%87%E7%AB%A0\">推荐文章</a></li>\n<li><a href=\"#node-%E5%A4%9A%E7%89%88%E6%9C%AC%E7%AE%A1%E7%90%86\">node-多版本管理</a>\n<ul>\n<li><a href=\"#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%8E%9F%E5%9B%A0%E6%8A%A5%E9%94%99\">环境变量原因报错</a></li>\n<li><a href=\"#%E5%88%87%E6%8D%A2%E7%89%88%E6%9C%AC%E6%8A%A5%E9%94%99\">切换版本报错</a></li>\n</ul>\n</li>\n<li><a href=\"#%E7%89%88%E6%9C%AC%E6%8B%9F%E5%AE%9A\">版本拟定</a></li>\n<li><a href=\"#%E5%80%9F%E7%89%A9%E8%A1%A8\">借物表</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"环境配置-2\">环境配置</h2>\n<ul>\n<li>\n<p>之前一直在乐此不疲的修改 npm 和 yarn 的 global 路径,因为每次 Node.js 更新会导致目录索引失效…</p>\n</li>\n<li>\n<p>后来发现,Scoop 完美解决了这个问题! 它使用<code>Scoop/persist</code>这个文件夹来挂载数据,不影响程序本身,即使更新也不会影响.</p>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"安装-yarn\">安装 yarn</h2>\n<ul>\n<li>\n<p>Node.js 是 JavaScript 运行环境,某个项目运行起来会需要一些依赖</p>\n</li>\n<li>\n<p><code>npm/yarn/cnpm</code> 就是管理这些依赖的, 安装 node.js 后自带 npm,不会带 yarn/cnpm, 这三个中我比较推荐用 <code>yarn</code></p>\n<ol>\n<li>\n<p>yarn 比 npm 更快一些</p>\n</li>\n<li>\n<p>默认锁定版本.</p>\n</li>\n</ol>\n</li>\n</ul>\n<hr>\n<ul>\n<li>\n<p>虽然 npm 与 yarn 是同一类东西,但是可以用 npm 安装 yarn (也可以去官网下载安装,不过那样更复杂麻烦)</p>\n<p>神不神奇,因为 npm 和 yarn 本身也是依赖,但是这样安装的话需要进行一些目录配置</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g  yarn</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p><code>强烈推荐</code>: 用 Scoop 安装(<code>零配置</code>)</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scoop install yarn</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"加速-2\">加速</h2>\n<h3 id=\"换源-3\">换源</h3>\n<ul>\n<li>\n<p>推荐: 使用 <a href=\"https://www.npmjs.com/package/yrm\"><code>yrm</code></a>, 会同时将你的 npm 和 yarn 一起切换 <sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup></p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yrm add njupt https:<span class=\"regexp\">//mi</span>rrors.njupt.edu.cn<span class=\"regexp\">/nexus/</span>repository<span class=\"regexp\">/npm/</span> https:<span class=\"regexp\">//mi</span>rrors.njupt.edu.cn<span class=\"regexp\">/help/</span>npm/</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">╰─ yrm test</span><br><span class=\"line\"></span><br><span class=\"line\">  npm ---- 1311ms</span><br><span class=\"line\">* cnpm --- Fetch Error</span><br><span class=\"line\">  taobao - 470ms</span><br><span class=\"line\">  nj ----- Fetch Error</span><br><span class=\"line\">  rednpm - 221ms</span><br><span class=\"line\">  npmMirror  1204ms</span><br><span class=\"line\">  edunpm - 1408ms</span><br><span class=\"line\">  yarn --- Fetch Error</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight actionscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yrm <span class=\"keyword\">use</span> taobao</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>当然不嫌麻烦可以手动修改</p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm config set registry https://registry.npm.taobao.org</span><br><span class=\"line\">yarn config set registry https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure>\n<p>也可以直接定位 npm 和 yarn 的配置文件 -&gt; <code>~/.npmrc和.yarnrc</code></p>\n<hr>\n</li>\n<li>\n<p>检查</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm<span class=\"built_in\"> config </span><span class=\"builtin-name\">get</span> registry</span><br><span class=\"line\">yarn<span class=\"built_in\"> config </span><span class=\"builtin-name\">get</span> registry</span><br></pre></td></tr></table></figure>\n<hr>\n</li>\n<li>\n<p>问题: 有时会遇到淘宝源某个文件验证失败问题 (Integrity check failed for “@types/body-parser” (computed integrity doesn’t match our records)</p>\n<p>解决办法是: 换回官方的源,用完之后再换成淘宝源.</p>\n<figure class=\"highlight arduino\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm config set registry https:<span class=\"comment\">//registry.npmjs.org</span></span><br><span class=\"line\">yarn config set registry https:<span class=\"comment\">//registry.npmjs.org</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<hr>\n<h3 id=\"代理\">代理</h3>\n<ul>\n<li>\n<p>设置代理</p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm config set proxy http://127.0.0.1:7890</span><br><span class=\"line\">npm config set https-proxy http://127.0.0.1:7890</span><br><span class=\"line\">yarn config set proxy http://127.0.0.1:7890</span><br><span class=\"line\">yarn config set https-proxy http://127.0.0.1:7890</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>删除代理</p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm config delete proxy</span><br><span class=\"line\">npm config delete https-proxy</span><br><span class=\"line\">yarn config delete proxy</span><br><span class=\"line\">yarn config delete https-proxy</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"依赖升级\">依赖升级</h2>\n<ul>\n<li>\n<p>package path 简介</p>\n<ul>\n<li>Node.Js 的包管理器有<code>npm,cnpm,yarn</code>等,通过上面操作后咱就用<code>npm</code></li>\n<li>Node.Js 通过 npm 可以安装 hexo 模块,hexo 里面的插件也是通过 npm 安装</li>\n<li>npm 安装/升级/移除的模块都在<code>node_modules/</code>里面,不会影响外面的东西</li>\n</ul>\n</li>\n<li>\n<p>npm check &amp;&amp; upgrade(node 插件)</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g npm-check</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g npm-upgrade</span><br></pre></td></tr></table></figure>\n<ul>\n<li>使用:直接<code>npm-check</code>/<code>npm-upgrade</code></li>\n</ul>\n</li>\n<li>\n<p>缓存清理</p>\n<ul>\n<li>会清空 node_cache</li>\n</ul>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm cache clean --force</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"参数及常用命令\">参数及常用命令</h2>\n<blockquote>\n<p><a href=\"https://www.cnblogs.com/lililia/p/10482169.html\">详见 yarn 的常用命令</a></p>\n</blockquote>\n<ul>\n<li>按照 package.json 文件的配置安装 module 到 node_modules/里面</li>\n</ul>\n<h3 id=\"g-global\"><code>-g(global)</code></h3>\n<ul>\n<li>全局安装/卸载</li>\n<li>注意脚手架如果是全局安装的话,卸载也要加上<code>-g</code>才能全局卸载.</li>\n</ul>\n<hr>\n<h3 id=\"save\"><code>-save</code></h3>\n<ul>\n<li>默认直接 install 会安装进那个目录,但是不会修改 package.json 文件</li>\n<li>加上-save 会修改文件,使下次 npm install 也会安装</li>\n<li>写在前面和后面都可以\n<ul>\n<li><code>npm install --save hexo-tag-aplayer</code></li>\n<li><code>npm install hexo-tag-aplayer --save</code></li>\n</ul>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"local-全局依赖\">local 全局依赖</h2>\n<ul>\n<li>\n<p>npm</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">npm install -g eslint</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>yarn</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yarn global add hexo-cli</span><br><span class=\"line\">yarn global add vsce</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<hr>\n<ul>\n<li>\n<p><code>全局依赖路径</code>: 用 Scoop 安装的,其数据挂载<code>摆脱了C盘!</code>, npm 与 yarn 管理方式并不全然一样</p>\n<ul>\n<li>\n<p>node-npm: <code>Scoop\\persist\\nodejs\\bin</code></p>\n</li>\n<li>\n<p>yarn: <code>Scoop\\persist\\yarn\\global</code></p>\n</li>\n</ul>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"运行报错\">运行报错</h2>\n<figure class=\"highlight delphi\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">node_modules\\<span class=\"keyword\">pascal</span>-<span class=\"keyword\">case</span>\\dist\\<span class=\"keyword\">index</span>.js:<span class=\"number\">21</span></span><br><span class=\"line\">...</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>有可能是依赖有故障了,其实用不着挨个排除是哪个依赖有问题</p>\n</li>\n<li>\n<p>直接把<code>node_modules</code>整个删掉,然后<code>npm install</code>就好了.</p>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"推荐文章-2\">推荐文章</h2>\n<blockquote>\n<p><a href=\"https://mp.weixin.qq.com/s?__biz=MzIyMDkwODczNw==&amp;mid=2247496886&amp;idx=1&amp;sn=513b863b8468fcfaf8c8e750ce266899&amp;chksm=97c66918a0b1e00eb920d278ae03b10ebe1d765db0e17cb8fe5bc60b737fb3c6af1d96fcf724&amp;mpshare=1&amp;scene=23&amp;srcid=0327cIro7WXAp1jgObHXuKCE&amp;sharer_sharetime=1616807246544&amp;sharer_shareid=ff6bb8cfd138294e80df076b8b76232d#rd\">很多人上来就删除的 package-lock.json，还有这么多你不知道的（深度内容）</a></p>\n</blockquote>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"node-多版本管理\">node-多版本管理</h2>\n<ul>\n<li>\n<p>主流的有 nvm / n 两种</p>\n<ul>\n<li>n 在 mac 和 linux 上比较好装,在 win 上就别想了.</li>\n</ul>\n</li>\n<li>\n<p>安装 nvm</p>\n<figure class=\"highlight mipsasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">scoop </span><span class=\"keyword\">install </span>nvm</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>使用 nvm</p>\n<blockquote>\n<p><a href=\"https://segmentfault.com/a/1190000021690038\">node 多版本管理工具——nvm</a></p>\n</blockquote>\n</li>\n</ul>\n<h3 id=\"环境变量原因报错\">环境变量原因报错</h3>\n<figure class=\"highlight subunit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">ERROR </span>open \\settings.txt: The system cannot find the file specified.</span><br></pre></td></tr></table></figure>\n<p>遇到这个报错的话,是因为环境变量还没起效,重启电脑</p>\n<hr>\n<h3 id=\"切换版本报错\">切换版本报错</h3>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">exit</span> status <span class=\"number\">145</span>: The directory is not empty.</span><br></pre></td></tr></table></figure>\n<ul>\n<li>\n<p>有可能是在安装/切换 node 版本时退出了终端导致非正常终止, 解决办法为重装/排查 <code>nvm/settings.txt</code></p>\n<p>看到下面 origin 开头的两行了吗? 直接删掉</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">root: D:\\Game\\Scoop\\persist\\nvm\\nodejs</span><br><span class=\"line\">arch: <span class=\"number\">64</span></span><br><span class=\"line\">proxy: http:<span class=\"regexp\">//</span><span class=\"number\">127.0</span>.<span class=\"number\">0.1</span>:<span class=\"number\">7890</span></span><br><span class=\"line\">originalpath: .</span><br><span class=\"line\">originalversion:</span><br><span class=\"line\">node_mirror: https:<span class=\"regexp\">//</span>npm.taobao.org<span class=\"regexp\">/mirrors/</span>node/</span><br><span class=\"line\">npm_mirror: https:<span class=\"regexp\">//</span>npm.taobao.org<span class=\"regexp\">/mirrors/</span>npm/</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"版本拟定\">版本拟定</h2>\n<ul>\n<li>\n<p>之前一直手动起草 package.json 中的 version,略显笨拙</p>\n<p>不知道 npm 自带 version 管理功能</p>\n</li>\n<li>\n<p><code>npm version</code></p>\n<blockquote>\n<p>npm version [<newversion> | major | minor | patch | premajor | preminor | prepatch | prerelease [–preid=<prerelease-id>] | from-git]</p>\n</blockquote>\n<p>喏,可以拟定大小版本.</p>\n<p>一般用这三个: major(大) -&gt; minor(小) -&gt; patch(补丁)</p>\n<p>另外需要注意,使用之前要 <code>git commit</code>,不然没法使用.</p>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表-24\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://www.jianshu.com/p/dbe3cda1ac11\">yarn 源管理工具 yrm</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "node",
                "package",
                "npm",
                "yarn"
            ]
        }
    ]
}