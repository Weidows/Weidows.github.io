{
    "version": "https://jsonfeed.org/version/1",
    "title": "⭐️齐下无贰⭐️ • All posts by \"虚拟机\" tag",
    "description": "May all the beauty be bless.✨",
    "home_page_url": "https://weidows.github.io",
    "items": [
        {
            "id": "https://weidows.github.io/post/system/Manjaro-Server/",
            "url": "https://weidows.github.io/post/system/Manjaro-Server/",
            "title": "😍Manjaro虚拟机充当服务器记录.",
            "date_published": "2021-02-03T06:00:21.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @Date: 2021-02-03 14:00:21\n * @LastEditors: Weidows\n * @LastEditTime: 2021-09-08 20:07:37\n * @FilePath: \\Blog-private\\source\\_posts\\system\\Manjaro-Server.md\n * @Description:\n * @!: *********************************************************************\n-->\n<ul>\n<li><a href=\"#%E7%B3%BB%E7%BB%9F%E9%80%89%E6%8B%A9\">系统选择</a>\n<ul>\n<li><a href=\"#%E6%88%91%E7%9A%84%E9%9C%80%E6%B1%82\">我的需求</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%90%AF%E7%94%A8-ssh-%E6%9C%8D%E5%8A%A1\">启用 ssh 服务</a>\n<ul>\n<li><a href=\"#%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4\">故障排除</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%8D%A2%E6%BA%90\">换源</a>\n<ul>\n<li><a href=\"#%E8%87%AA%E5%8A%A8\">自动</a></li>\n<li><a href=\"#%E6%89%8B%E5%8A%A8\">手动</a></li>\n<li><a href=\"#%E6%9B%B4%E6%96%B0\">更新</a></li>\n</ul>\n</li>\n<li><a href=\"#%E9%85%8D%E7%BD%AE-docker\">配置 docker</a></li>\n<li><a href=\"#%E8%BD%AF%E4%BB%B6%E5%AE%89%E8%A3%85\">软件安装</a></li>\n<li><a href=\"#%E6%9B%B4%E6%96%B0%E5%A4%B1%E8%B4%A5\">更新失败</a>\n<ul>\n<li><a href=\"#%E6%96%87%E4%BB%B6%E5%86%B2%E7%AA%81\">文件冲突</a></li>\n</ul>\n</li>\n<li><a href=\"#%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%BB%A3%E7%90%86\">虚拟机代理</a></li>\n</ul>\n<h2 id=\"系统选择\">系统选择</h2>\n<ul>\n<li>关于我为什么最后选择了作为 Server 来说比较冷门的 <code>Manjaro</code></li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">系统</th>\n<th style=\"text-align:center\">特性</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">CentOS</td>\n<td style=\"text-align:center\">系统特别稳健,bug 少,出了问题解决方案多,服务型软件丰富;标准 server,不怎么需要特殊配置,维护难度低</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Ubuntu</td>\n<td style=\"text-align:center\">跟 CentOS 差不多,但是因为生态惯性问题确实比 CentOS 用得少,现在由 CentOS 转向 Ubuntu 的很多;server 安装后需要做很多配置才能使用,维护性难度中等;server 安装后默认没有 root 用户</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Manjaro</td>\n<td style=\"text-align:center\">Arch 分支的 Linux 发行版,desktop-KDE,内核滚动更新很快,更新比 Arch 慢但更稳定,软件生态很丰富,图形化好维护;定位并非 Server,是桌面操作系统所以功耗稍大;默认不启用 ssh 服务</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">RaspberryPi</td>\n<td style=\"text-align:center\">树莓派定制化系统,可以说啥都干得了,但是啥都干不好</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Deepin</td>\n<td style=\"text-align:center\">生态正在逐步扩大,但是对于服务器端还是太差了,毕竟它的定位也是桌面操作系统;图形化卡顿比较严重,有些无解决方案的 bug;不开放 root 用户</td>\n</tr>\n</tbody>\n</table>\n<hr>\n<h3 id=\"我的需求\">我的需求</h3>\n<ul>\n<li>\n<p>我想让服务器比较稳定,因为在主机上用<code>VMware</code> 开的虚拟机,所以性能消耗要求不高.</p>\n</li>\n<li>\n<p>最好是带有图形界面,这样维护比较方便</p>\n</li>\n<li>\n<p>与<code>VScode-ssh</code>连接必须稳定!</p>\n<ul>\n<li>有些服务需要把代码拉到服务器上</li>\n</ul>\n<blockquote>\n<p>已经有解决方案了,参见 <a href=\"../../experience/SSH#VScode-ssh-%E6%96%AD%E5%BC%80%E8%BF%9E%E6%8E%A5\">✨SSH 远程连接.#VScode-ssh-断开连接</a></p>\n</blockquote>\n</li>\n<li>\n<p>有且要开放 root</p>\n<ul>\n<li>有的系统不带 root 账户,有的不开放.</li>\n</ul>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"启用-ssh-服务\">启用 ssh 服务</h2>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/SUDDEV/article/details/85314469\">Manjaro Linux 系统 ssh：connect to host localhost port 22: Connection refused 解决方法</a></p>\n</blockquote>\n<ul>\n<li>\n<p>默认情况下 manjaro 有 ssh 但是不开启.</p>\n</li>\n<li>\n<p>用 ssh 连接它会出现以下报错:</p>\n<figure class=\"highlight pgsql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">connect</span> <span class=\"keyword\">to</span> host localhost port <span class=\"number\">22</span>: <span class=\"keyword\">Connection</span> refused</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>开启 ssh 服务</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl enable sshd.service</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>开启后需要<code>重启</code>下才能生效.</p>\n</li>\n</ul>\n<hr>\n<h3 id=\"故障排除\">故障排除</h3>\n<ul>\n<li>\n<p>如果 ssh 服务开启了,连接步骤也没错,但是就是连不上,有可能是 ssh 旧记录的问题</p>\n</li>\n<li>\n<p>报错信息包含如下</p>\n<figure class=\"highlight gauss\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     <span class=\"comment\">@</span></span><br><span class=\"line\"><span class=\"comment\">&gt; @</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span><span class=\"comment\">@@</span></span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>去主机电脑上找到<code>~/.ssh/known_hosts</code>,这里面有过去连接的 ip 记录和公钥,删除对应的就可.</p>\n<ul>\n<li>Windows 上那个位置就是<code>C:\\Users\\你的用户名\\.ssh</code></li>\n</ul>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"换源\">换源</h2>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/weixin_43968923/article/details/86349914\">arch/Manjaro 添加国内源以及社区源</a></p>\n</blockquote>\n<h3 id=\"自动\">自动</h3>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo pacman-mirrors -<span class=\"selector-tag\">i</span> -c China -m rank</span><br></pre></td></tr></table></figure>\n<hr>\n<h3 id=\"手动\">手动</h3>\n<ul>\n<li>\n<p>找到<code>/etc/pacman.d/mirrorlist</code>,备份之后修改:</p>\n<ul>\n<li>越靠上优先级越高.</li>\n</ul>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 中科大</span></span><br><span class=\"line\">Server = https:<span class=\"regexp\">//mi</span>rrors.ustc.edu.cn<span class=\"regexp\">/manjaro/</span>stable<span class=\"regexp\">/$repo/</span><span class=\"variable\">$arch</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#  清华大学</span></span><br><span class=\"line\">Server = https:<span class=\"regexp\">//mi</span>rrors.tuna.tsinghua.edu.cn<span class=\"regexp\">/manjaro/</span>stable<span class=\"regexp\">/$repo/</span><span class=\"variable\">$arch</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 上海交通大学</span></span><br><span class=\"line\">Server = https:<span class=\"regexp\">//mi</span>rrors.sjtug.sjtu.edu.cn<span class=\"regexp\">/manjaro/</span>stable<span class=\"regexp\">/$repo/</span><span class=\"variable\">$arch</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 浙江大学</span></span><br><span class=\"line\">Server = https:<span class=\"regexp\">//mi</span>rrors.zju.edu.cn<span class=\"regexp\">/manjaro/</span>stable<span class=\"regexp\">/$repo/</span><span class=\"variable\">$arch</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<hr>\n<h3 id=\"更新\">更新</h3>\n<p>换源后执行一下,更新本地软件包数据库.</p>\n<ul>\n<li>\n<p>更新软件包</p>\n<figure class=\"highlight ebnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">pacman -Sy</span></span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>更新所有</p>\n<figure class=\"highlight ebnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">pacman -Syyu</span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"配置-docker\">配置 docker</h2>\n<blockquote>\n<p>详见 <a href=\"../../system/docker\">🌈 初探 Docker.</a></p>\n</blockquote>\n<blockquote>\n<p><a href=\"https://blog.huangz.me/2020/docker-on-linux.html\">在 Manjaro Linux 系统使用 Docker</a></p>\n</blockquote>\n<h2 id=\"软件安装\">软件安装</h2>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/john_bh/article/details/104652224\">msys2 pacman 常用命令以及添加国内源加速 pacman</a></p>\n</blockquote>\n<figure class=\"highlight ebnf\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">sudo pacman -S docker</span></span><br></pre></td></tr></table></figure>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"更新失败\">更新失败</h2>\n<h3 id=\"文件冲突\">文件冲突</h3>\n<ul>\n<li>\n<p>这种删掉它提示的文件就好了,可能会报好多个,如下:</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">有冲突的文件:</span><br><span class=\"line\">- plasma-workspace：<span class=\"regexp\">/usr/</span>lib<span class=\"regexp\">/qt/</span>plugins/kcm_formats.so 已经存在于文件系统中（所有者为plasma-desktop-primex）</span><br><span class=\"line\">- plasma-workspace：<span class=\"regexp\">/usr/</span>lib<span class=\"regexp\">/qt/</span>plugins<span class=\"regexp\">/kcms/</span>kcm_autostart.so 已经存在于文件系统中（所有者为plasma-desktop-primex）</span><br><span class=\"line\">- plasma-workspace：<span class=\"regexp\">/usr/</span>lib<span class=\"regexp\">/qt/</span>plugins<span class=\"regexp\">/kcms/</span>kcm_nightcolor.so 已经存在于文件系统中（所有者为plasma-desktop-primex）</span><br><span class=\"line\">- plasma-workspace：<span class=\"regexp\">/usr/</span>lib<span class=\"regexp\">/qt/</span>plugins<span class=\"regexp\">/kcms/</span>kcm_notifications.so 已经存在于文件系统中（所有者为plasma-desktop-primex）</span><br><span class=\"line\">- plasma-workspace：<span class=\"regexp\">/usr/</span>share<span class=\"regexp\">/doc/</span>HTML<span class=\"regexp\">/ca/</span>kcontrol<span class=\"regexp\">/autostart/i</span>ndex.cache.bz2 已经存在于文件系统中（所有者为plasma-desktop-primex）</span><br><span class=\"line\">- plasma-workspace：<span class=\"regexp\">/usr/</span>share<span class=\"regexp\">/doc/</span>HTML<span class=\"regexp\">/ca/</span>kcontrol<span class=\"regexp\">/autostart/i</span>ndex.docbook 已经存在于文件系统中（所有者为plasma-desktop-primex）</span><br><span class=\"line\">- plasma-workspace：<span class=\"regexp\">/usr/</span>share<span class=\"regexp\">/doc/</span>HTML<span class=\"regexp\">/ca/</span>kcontrol<span class=\"regexp\">/formats/i</span>ndex.cache.bz2 已经存在于文件系统中（所有者为plasma-desktop-primex）</span><br><span class=\"line\">- plasma-workspace：<span class=\"regexp\">/usr/</span>share<span class=\"regexp\">/doc/</span>HTML<span class=\"regexp\">/ca/</span>kcontrol<span class=\"regexp\">/formats/i</span>ndex.docbook 已经存在于文件系统中（所有者为plasma-desktop-primex）</span><br><span class=\"line\">- plasma-workspace：<span class=\"regexp\">/usr/</span>share<span class=\"regexp\">/doc/</span>HTML<span class=\"regexp\">/ca/</span>kcontrol<span class=\"regexp\">/notifications/i</span>ndex.cache.bz2 已经存在于文件系统中（所有者为plasma-desktop-primex）</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>把提示的内容复制进文本编辑器 (比如 VScode)</p>\n<p><code>- plasma-workspace：</code> 和 <code>已经存在于文件系统中（所有者为plasma-desktop-primex）</code> 都是重复的,按 <code>Ctrl + shift + L</code> 可以选中全部,然后删掉,再去掉换行符整合到一行,结果如下:</p>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo rm <span class=\"regexp\">/usr/</span>lib<span class=\"regexp\">/qt/</span>plugins<span class=\"regexp\">/kcm_formats.so /u</span>sr<span class=\"regexp\">/lib/</span>qt<span class=\"regexp\">/plugins/</span>kcms<span class=\"regexp\">/kcm_autostart.so /u</span>sr<span class=\"regexp\">/lib/</span>qt<span class=\"regexp\">/plugins/</span>kcms<span class=\"regexp\">/kcm_nightcolor.so /u</span>sr<span class=\"regexp\">/lib/</span>qt<span class=\"regexp\">/plugins/</span>kcms<span class=\"regexp\">/kcm_notifications.so /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>ca<span class=\"regexp\">/kcontrol/</span>autostart<span class=\"regexp\">/index.cache.bz2 /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>ca<span class=\"regexp\">/kcontrol/</span>autostart<span class=\"regexp\">/index.docbook /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>ca<span class=\"regexp\">/kcontrol/</span>formats<span class=\"regexp\">/index.cache.bz2 /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>ca<span class=\"regexp\">/kcontrol/</span>formats<span class=\"regexp\">/index.docbook /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>ca<span class=\"regexp\">/kcontrol/</span>notifications<span class=\"regexp\">/index.cache.bz2 /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>ca<span class=\"regexp\">/kcontrol/</span>notifications<span class=\"regexp\">/index.docbook /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>de<span class=\"regexp\">/kcontrol/</span>autostart<span class=\"regexp\">/index.cache.bz2 /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>de<span class=\"regexp\">/kcontrol/</span>autostart<span class=\"regexp\">/index.docbook /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>de<span class=\"regexp\">/kcontrol/</span>formats<span class=\"regexp\">/index.cache.bz2 /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>de<span class=\"regexp\">/kcontrol/</span>formats<span class=\"regexp\">/index.docbook /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>en<span class=\"regexp\">/kcontrol/</span>autostart<span class=\"regexp\">/index.cache.bz2 /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>en<span class=\"regexp\">/kcontrol/</span>autostart<span class=\"regexp\">/index.docbook /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>en<span class=\"regexp\">/kcontrol/</span>formats<span class=\"regexp\">/index.cache.bz2 /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>en<span class=\"regexp\">/kcontrol/</span>formats<span class=\"regexp\">/index.docbook /u</span>sr<span class=\"regexp\">/share/</span>doc<span class=\"regexp\">/HTML/</span>en<span class=\"regexp\">/kcontrol/</span>notifications/index.cache.bz2</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>然后复制进 console 执行-&gt;再次更新-&gt;成功!</p>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"虚拟机代理\">虚拟机代理</h2>\n<p><s>好久没更新这篇了,冲冲水</s></p>\n<ul>\n<li>\n<p>服务器端当安装某些软件时也会有 <code>访问-国外</code> 的需求,在服务器再安装一个软件的话,也可以</p>\n<p>但是节点维护会烦人一些,我想的是: 直接让虚拟机服务器用主机开的代理</p>\n<hr>\n</li>\n<li>\n<p>首先需要主机 &lt;–&gt; 虚拟机 可实现互通,这过程中遇到了几个弯</p>\n<ol>\n<li>\n<p>首先,虚拟机网络<code>不要用桥接模式</code>,这个模式下,每次主机换 WIFI 都需要虚拟机端重新配置主机的 IP(麻烦得很)</p>\n</li>\n<li>\n<p><code>用NAT模式!</code> 这种模式下主机地址(192.168.114.1) ,路由地址(192.168.114.2) ,虚拟机地址(<a href=\"http://192.168.114.xxx\">192.168.114.xxx</a>) 不手动改的话都<code>固定</code>,而且主机换网络环境也不会变. (提一嘴,必须开启 DHCP 虚拟机才能连上主机,默认是开启的不用动)</p>\n</li>\n</ol>\n</li>\n<li>\n<p>实际操作的话</p>\n<p>比如我主机端代理是: localhost:7890</p>\n<p>虚拟机里代理填 192.168.114.1:7890</p>\n</li>\n<li>\n<p>重启.(<s>灵药</s>)</p>\n</li>\n</ul>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "manjaro",
                "操作系统",
                "服务器",
                "虚拟机"
            ]
        },
        {
            "id": "https://weidows.github.io/post/system/virtual-server/",
            "url": "https://weidows.github.io/post/system/virtual-server/",
            "title": "🟡Ubuntu-Server搞机记录.",
            "date_published": "2021-02-01T18:04:38.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @Date: 2021-02-02 02:04:38\n * @LastEditors: Weidows\n * @LastEditTime: 2021-09-02 15:47:06\n * @FilePath: \\Blog-private\\source\\_posts\\system\\virtual-server.md\n * @Description:\n * @!: *********************************************************************\n-->\n<ul>\n<li><a href=\"#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85\">下载安装</a></li>\n<li><a href=\"#%E6%8D%A2%E6%BA%90\">换源</a></li>\n<li><a href=\"#%E9%85%8D%E7%BD%AE%E9%9D%99%E6%80%81-ip\">配置静态 IP</a></li>\n<li><a href=\"#%E8%BD%AF%E4%BB%B6%E5%A4%87%E4%BB%BD\">软件备份</a></li>\n</ul>\n<h2 id=\"下载安装\">下载安装</h2>\n<ul>\n<li>\n<p>官网上下载 ISO 文件就行,挺快的</p>\n<ul>\n<li>\n<p>desktop 是桌面版,有图形界面</p>\n</li>\n<li>\n<p>server 是服务器版,没有图形界面(也就是只有命令行界面)</p>\n</li>\n</ul>\n<hr>\n</li>\n<li>\n<p>我用的<code>VMware</code>安装的,用其他软件也可,个人比较喜欢这个.</p>\n<ul>\n<li>安装时可以选择附带的服务软件,比如<code>docker</code>,<code>k8s</code>等等…</li>\n</ul>\n<hr>\n</li>\n<li>\n<p>安装完成后长这样</p>\n<img src=\"https://www.helloimg.com/images/2022/02/27/GV4SqX.png\" alt=\"20210202144325\" />\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"换源-2\">换源</h2>\n<blockquote>\n<p><a href=\"https://blog.csdn.net/xiangxianghehe/article/details/105688062\">Ubuntu 20.04 换国内源 清华源 阿里源 中科大源 163 源</a></p>\n</blockquote>\n<ul>\n<li>安装系统过程中就有换源选项.</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"配置静态-IP\">配置静态 IP</h2>\n<blockquote>\n<p><a href=\"https://www.cnblogs.com/yaohong/p/11593989.html\">ubuntu 18.04 设置静态 ip 方法</a></p>\n</blockquote>\n<ul>\n<li>\n<p>初始的 Ubuntu-Server 没有<code>net-tools</code>,需要<a href=\"#%E8%BD%AF%E4%BB%B6%E5%A4%87%E4%BB%BD\">安装</a></p>\n</li>\n<li>\n<p>默认情况下使用<code>DHCP</code>,连接网络会自动分配一个 IP,使用<code>ifconfig</code>查看(这个 ifconfig 就是上面 net-tools 里面的)</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">weidows</span>@ubuntu-server:~/Code$ ifconfig</span><br><span class=\"line\"><span class=\"attribute\">ens33</span>: flags=<span class=\"number\">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class=\"number\">1500</span></span><br><span class=\"line\">        <span class=\"attribute\">inet</span> <span class=\"number\">192.168.2.122</span>  netmask <span class=\"number\">255.255.255.0</span>  broadcast <span class=\"number\">192.168.2.255</span></span><br><span class=\"line\">        <span class=\"attribute\">inet6</span> fe<span class=\"number\">80</span>::<span class=\"number\">20</span>c:<span class=\"number\">29</span>ff:fe<span class=\"number\">28</span>:c<span class=\"number\">082</span>  prefixlen <span class=\"number\">64</span>  scopeid <span class=\"number\">0</span>x<span class=\"number\">20</span>&lt;link&gt;</span><br><span class=\"line\">        <span class=\"attribute\">ether</span> <span class=\"number\">00</span>:<span class=\"number\">0</span>c:<span class=\"number\">29</span>:<span class=\"number\">28</span>:c<span class=\"number\">0</span>:<span class=\"number\">82</span>  txqueuelen <span class=\"number\">1000</span>  (Ethernet)</span><br><span class=\"line\">        <span class=\"attribute\">RX</span> packets <span class=\"number\">114664</span>  bytes <span class=\"number\">143722941</span> (<span class=\"number\">143</span>.<span class=\"number\">7</span> MB)</span><br><span class=\"line\">        <span class=\"attribute\">RX</span> errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span>  overruns <span class=\"number\">0</span>  frame <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"attribute\">TX</span> packets <span class=\"number\">52086</span>  bytes <span class=\"number\">37199464</span> (<span class=\"number\">37</span>.<span class=\"number\">1</span> MB)</span><br><span class=\"line\">        <span class=\"attribute\">TX</span> errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span> overruns <span class=\"number\">0</span>  carrier <span class=\"number\">0</span>  collisions <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">lo</span>: flags=<span class=\"number\">73</span>&lt;UP,LOOPBACK,RUNNING&gt;  mtu <span class=\"number\">65536</span></span><br><span class=\"line\">        <span class=\"attribute\">inet</span> <span class=\"number\">127.0.0.1</span>  netmask <span class=\"number\">255.0.0.0</span></span><br><span class=\"line\">        <span class=\"attribute\">inet6</span> ::<span class=\"number\">1</span>  prefixlen <span class=\"number\">128</span>  scopeid <span class=\"number\">0</span>x<span class=\"number\">10</span>&lt;host&gt;</span><br><span class=\"line\">        <span class=\"attribute\">loop</span>  txqueuelen <span class=\"number\">1000</span>  (Local Loopback)</span><br><span class=\"line\">        <span class=\"attribute\">RX</span> packets <span class=\"number\">14643</span>  bytes <span class=\"number\">53874531</span> (<span class=\"number\">53</span>.<span class=\"number\">8</span> MB)</span><br><span class=\"line\">        <span class=\"attribute\">RX</span> errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span>  overruns <span class=\"number\">0</span>  frame <span class=\"number\">0</span></span><br><span class=\"line\">        <span class=\"attribute\">TX</span> packets <span class=\"number\">14643</span>  bytes <span class=\"number\">53874531</span> (<span class=\"number\">53</span>.<span class=\"number\">8</span> MB)</span><br><span class=\"line\">        <span class=\"attribute\">TX</span> errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span> overruns <span class=\"number\">0</span>  carrier <span class=\"number\">0</span>  collisions <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"attribute\">weidows</span>@ubuntu-server:~/Code$</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>可以看到第三行<code>192.168.2.122</code>就是分配的 ip 了,用它就行.</p>\n</li>\n<li>\n<p>进入<code>/etc/netplan/</code>这个目录,使用<code>ll</code>查看内部有啥东西</p>\n<ul>\n<li>\n<p>发现第六行<code>00-installer-config.yaml</code>这个文件是我们要找的(可能名字不一样,后缀是.yaml 就对了)</p>\n</li>\n<li>\n<p>使用<code>cat</code>查看文件内容,核实没错,然后修改它!</p>\n</li>\n</ul>\n<figure class=\"highlight gradle\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">weidows@ubuntu-server:~<span class=\"regexp\">/Code$ cd /</span>etc<span class=\"regexp\">/netplan/</span></span><br><span class=\"line\">weidows@ubuntu-server:<span class=\"regexp\">/etc/</span>netplan$ ll</span><br><span class=\"line\">total <span class=\"number\">12</span></span><br><span class=\"line\">drwxr-xr-x  <span class=\"number\">2</span> root root <span class=\"number\">4096</span> Feb  <span class=\"number\">1</span> <span class=\"number\">17</span>:<span class=\"number\">55</span> ./</span><br><span class=\"line\">drwxr-xr-x <span class=\"number\">92</span> root root <span class=\"number\">4096</span> Feb  <span class=\"number\">2</span> <span class=\"number\">06</span>:<span class=\"number\">25</span> ../</span><br><span class=\"line\">-rw-r--r--  <span class=\"number\">1</span> root root  <span class=\"number\">116</span> Feb  <span class=\"number\">1</span> <span class=\"number\">17</span>:<span class=\"number\">55</span> <span class=\"number\">00</span>-installer-config.yaml</span><br><span class=\"line\">weidows@ubuntu-server:<span class=\"regexp\">/etc/</span>netplan$ cat <span class=\"number\">00</span>-installer-config.yaml</span><br><span class=\"line\"># <span class=\"keyword\">This</span> is the network config written by <span class=\"string\">&#x27;subiquity&#x27;</span></span><br><span class=\"line\">network:</span><br><span class=\"line\">  ethernets:</span><br><span class=\"line\">    ens33:</span><br><span class=\"line\">      dhcp4: <span class=\"keyword\">true</span></span><br><span class=\"line\">  version: <span class=\"number\">2</span></span><br><span class=\"line\">weidows@ubuntu-server:<span class=\"regexp\">/etc/</span>netplan$</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>使用<code>vi</code>修改<code> sudo vi /etc/netplan/00-installer-config.yaml</code></p>\n<ul>\n<li>地址啥的按照规则设</li>\n</ul>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">## This is the network config written by &#x27;subiquity&#x27;</span></span><br><span class=\"line\"><span class=\"attr\">network:</span></span><br><span class=\"line\">  <span class=\"attr\">ethernets:</span></span><br><span class=\"line\">    <span class=\"attr\">ens33:</span></span><br><span class=\"line\">      <span class=\"attr\">dhcp4:</span> <span class=\"literal\">false</span></span><br><span class=\"line\">      <span class=\"attr\">addresses:</span> [<span class=\"number\">192.168</span><span class=\"number\">.2</span><span class=\"number\">.122</span><span class=\"string\">/24</span>]</span><br><span class=\"line\">      <span class=\"attr\">gateway4:</span> <span class=\"number\">192.168</span><span class=\"number\">.2</span><span class=\"number\">.1</span></span><br><span class=\"line\">      <span class=\"attr\">nameservers:</span></span><br><span class=\"line\">        <span class=\"attr\">addresses:</span></span><br><span class=\"line\">          <span class=\"bullet\">-</span> <span class=\"number\">192.168</span><span class=\"number\">.2</span><span class=\"number\">.1</span></span><br><span class=\"line\">  <span class=\"attr\">version:</span> <span class=\"number\">2</span></span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>然后应用<code>sudo netplan apply</code>设置,完事!</p>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"软件备份\">软件备份</h2>\n<ul>\n<li>\n<p>找软件的话可以用<code>apt search XXX</code>来找</p>\n</li>\n<li>\n<p>个人安装的一些服务型软件(在主机上做的开发,用这个 Server 跑服务)</p>\n</li>\n</ul>\n<figure class=\"highlight cmake\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt <span class=\"keyword\">install</span> docker</span><br><span class=\"line\">sudo apt <span class=\"keyword\">install</span> net-tools</span><br></pre></td></tr></table></figure>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "操作系统",
                "服务器",
                "虚拟机",
                "ubuntu"
            ]
        }
    ]
}