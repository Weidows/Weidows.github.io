{
    "version": "https://jsonfeed.org/version/1",
    "title": "⭐️齐下无贰⭐️ • All posts by \"算法\" tag",
    "description": "May all the beauty be bless.✨",
    "home_page_url": "https://weidows.github.io",
    "items": [
        {
            "id": "https://weidows.github.io/post/Web/get-resources/",
            "url": "https://weidows.github.io/post/Web/get-resources/",
            "title": "🌏媒体资源加密 -and- 解密获取",
            "date_published": "2022-02-22T11:49:20.000Z",
            "content_html": "<h1>媒体资源加密 -and- 解密获取</h1>\n<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2022-02-24 13:26:35\n * @FilePath: \\Blog-private\\source\\_posts\\Web\\get-resources.md\n * @Description:\n * @!: *********************************************************************\n--><blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li><a href=\"#%E5%AA%92%E4%BD%93%E8%B5%84%E6%BA%90%E5%8A%A0%E5%AF%86-and-%E8%A7%A3%E5%AF%86%E8%8E%B7%E5%8F%96\">媒体资源加密 -and- 解密获取</a>\n<ul>\n<li><a href=\"#ffmpeg-hls-aes_128\">FFmpeg-HLS-AES_128</a>\n<ul>\n<li><a href=\"#%E5%88%87%E7%89%87\">切片</a></li>\n<li><a href=\"#%E5%8A%A0%E5%AF%86\">加密</a></li>\n</ul>\n</li>\n<li><a href=\"#%E8%8E%B7%E5%8F%96\">获取</a>\n<ul>\n<li><a href=\"#%E8%A7%86%E9%A2%91\">视频</a></li>\n<li><a href=\"#%E5%9B%BE%E7%89%87\">图片</a></li>\n<li><a href=\"#%E6%89%93%E5%8C%85%E5%B8%A6%E8%B5%B0\">打包带走</a>\n<ul>\n<li><a href=\"#%E6%A2%A6%E6%83%B3%E8%B5%84%E6%BA%90%E4%B8%8B%E8%BD%BD%E5%99%A8\">梦想资源下载器</a></li>\n<li><a href=\"#%E7%BD%91%E9%A1%B5%E5%8F%B3%E9%94%AE\">网页右键</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E5%8F%82%E7%85%A7\">参照</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<ul>\n<li>\n<p>各类平台网页中的视频通常会被 <code>加密处理</code> 以防止别人拿走; 防盗技术还是有很多种的:<sup id='cite_ref-3'><a href=\"#cite_note-3\">[3]</a></sup></p>\n<ol>\n<li>FFmpeg-HLS-AES_128 加密</li>\n<li>验证用户身份再给链接(session,cookie)</li>\n<li>视频加水印</li>\n<li>限制跨域访问</li>\n<li>…etc</li>\n</ol>\n</li>\n</ul>\n<p>下面只摸一下技术层面的 <code>1.</code></p>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"FFmpeg-HLS-AES-128\">FFmpeg-HLS-AES_128</h2>\n<p>浅入深出, 别急慢慢吃… 推荐看一下这个库<sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup></p>\n<h3 id=\"切片\">切片</h3>\n<ul>\n<li>\n<p>切片的方式比较简单, 这里我们准备好一个 <code>demo.mp4</code>, 丢给 FFmpeg 下面的命令</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ffmpeg -i demo.mp4 -codec copy -f segment -segment_list index.m3u8 -segment_time 30 切片_%d.ts</span><br></pre></td></tr></table></figure>\n<p>执行完会出来下面这些东西 (绿色名字标记的)</p>\n<p><img src=\"https://api.onedrive.com/v1.0/shares/s!AlhRaqfosSZYi3FMEMHIj6E24jGg/root/content\" alt=\"\"></p>\n<hr>\n</li>\n<li>\n<p>上面命令中 <code>index.m3u8</code> 这个文件是切片的索引文件, 指明了 ts 文件的先后顺序, 时长, 版本和加密等信息</p>\n<blockquote>\n<ul>\n<li>TS: MPEG2-Transport Stream, 高清相机拍摄视频的封装格式; 特点就是要求从视频流的任一片段开始都是可以独立解码的</li>\n<li>m3u8: HTTP Live Streaming（HLS） 协议格式的基础,Unicode 版本的 M3U，此文件用 UTF-8 编码<sup id='cite_ref-01'><a href=\"#cite_note-01\">[1]</a></sup></li>\n</ul>\n</blockquote>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#EXTM3U</span><br><span class=\"line\">#EXT-X-VERSION:3</span><br><span class=\"line\">#EXT-X-MEDIA-SEQUENCE:0</span><br><span class=\"line\">#EXT-X-ALLOW-CACHE:YES</span><br><span class=\"line\">#EXT-X-TARGETDURATION:32</span><br><span class=\"line\">#EXTINF:30.720000,</span><br><span class=\"line\">切片_0.ts</span><br><span class=\"line\">#EXTINF:29.280000,</span><br><span class=\"line\">切片_1.ts</span><br><span class=\"line\">#EXTINF:31.880000,</span><br><span class=\"line\">切片_2.ts</span><br><span class=\"line\">#EXTINF:29.040000,</span><br><span class=\"line\">切片_3.ts</span><br><span class=\"line\">#EXTINF:29.320000,</span><br><span class=\"line\">切片_4.ts</span><br><span class=\"line\">#EXTINF:6.280000,</span><br><span class=\"line\">切片_5.ts</span><br><span class=\"line\">#EXT-X-ENDLIST</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>切片可以让用户无法 <code> 直接通过链接 </code> 在浏览器获取完整的 mp4 视频</p>\n<p>随后插件市场出现了一些插件, 可以通过 .m3u8 获取并合并.ts 间接获取 .MP4</p>\n<p>于是为了反破解出现了 <code>某些花活 </code> 和 <code> 视频加密</code></p>\n<hr>\n</li>\n<li>\n<p>花活:</p>\n<ol>\n<li>把 .m3u8 文件伪装成 .mp4, 可以让大部分没有伪装识别能力的爬虫找不着北</li>\n</ol>\n<p><img src=\"https://api.onedrive.com/v1.0/shares/s!AlhRaqfosSZYi3I0hRWBARzrYioc/root/content\" alt=\"\"><br>\n比如 CoCocut<br>\n<img src=\"https://api.onedrive.com/v1.0/shares/s!AlhRaqfosSZYi3Uo0eTjPcPV0l6L/root/content\" alt=\"\"></p>\n<ol start=\"2\">\n<li>m3u8 中嵌套另一个 m3u8 (套娃)</li>\n<li>…etc</li>\n</ol>\n</li>\n</ul>\n<hr>\n<h3 id=\"加密\">加密</h3>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"获取\">获取</h2>\n<h3 id=\"视频\">视频</h3>\n<blockquote>\n<p>CoCocut</p>\n</blockquote>\n<blockquote>\n<p>QQ 浏览器手机版 -&gt; 视频解析</p>\n</blockquote>\n<h3 id=\"图片\">图片</h3>\n<p>awesome…<br>\n方向转变: 有的网页中的原图并没有展示, 只是给出了链接</p>\n<p>所以通过插件 / 保存网页的方式没办法爬下来</p>\n<hr>\n<h3 id=\"打包带走\">打包带走</h3>\n<h4 id=\"梦想资源下载器\">梦想资源下载器</h4>\n<h4 id=\"网页右键\">网页右键</h4>\n<p><img src=\"https://api.onedrive.com/v1.0/shares/s!AlhRaqfosSZYi2040yjiZvLETkkO/root/content\" alt=\"\"></p>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"参照 -3\">参照</h2>\n<p><a name='cite_note-01' href='#cite_ref-01'>[1]</a>: <a href=\"https://blog.csdn.net/beyond706/article/details/111772810\">使用 openssl m3u8 解密 EXT-X-KEY:METHOD=AES-128,URI=xxx</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://github.com/fftt2017/hls-m3u8-sample\">https://github.com/fftt2017/hls-m3u8-sample</a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://zhuanlan.zhihu.com/p/32014463\">在线教育类网站视频加密视频安全的一些方法</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "推荐",
                "浏览器",
                "扩展",
                "ffmpeg",
                "算法"
            ]
        }
    ]
}