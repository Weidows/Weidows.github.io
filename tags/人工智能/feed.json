{
    "version": "https://jsonfeed.org/version/1",
    "title": "⭐️齐下无贰⭐️ • All posts by \"人工智能\" tag",
    "description": "May all the beauty be bless.✨",
    "home_page_url": "https://blog.weidows.tech",
    "items": [
        {
            "id": "https://blog.weidows.tech/post/experience/research/research/",
            "url": "https://blog.weidows.tech/post/experience/research/research/",
            "title": "⏲️误入科研海",
            "date_published": "2022-07-10T13:21:09.000Z",
            "content_html": "<h1>误入科研海</h1>\n<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2023-04-20 18:28:55\n * @FilePath: \\Blog-private\\source\\_posts\\experience\\research\\research.md\n * @Description:\n * @!: *********************************************************************\n-->\n<blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li><a href=\"#%E8%AF%AF%E5%85%A5%E7%A7%91%E7%A0%94%E6%B5%B7\">误入科研海</a>\n<ul>\n<li><a href=\"#%E5%BA%8F\">序</a></li>\n<li><a href=\"#%E5%85%B3%E4%BA%8E%E8%B0%83%E7%A0%94\">关于调研</a></li>\n<li><a href=\"#%E4%B8%80%E4%BA%9B%E7%BB%8F%E9%AA%8C\">一些经验</a>\n<ul>\n<li><a href=\"#%E5%AD%A6%E4%BC%9A%E6%8B%86%E5%AD%97\">学会拆字</a></li>\n<li><a href=\"#%E8%AF%BB%E8%AE%BA%E6%96%87\">读论文</a></li>\n<li><a href=\"#%E6%89%BE%E8%AE%BA%E6%96%87\">找论文</a></li>\n</ul>\n</li>\n<li><a href=\"#%E7%82%B9%E4%BA%91\">点云</a>\n<ul>\n<li><a href=\"#%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7\">分析工具</a>\n<ul>\n<li><a href=\"#cloudcompare\">CloudCompare</a></li>\n<li><a href=\"#pcd-decode\">PCD-Decode</a></li>\n</ul>\n</li>\n<li><a href=\"#%E6%9F%90%E6%AC%A1%E7%BB%84%E4%BC%9A%E5%88%86%E4%BA%AB\">某次组会分享</a>\n<ul>\n<li><a href=\"#%E7%BB%84%E6%88%90%E6%88%90%E5%88%86-%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2%E5%88%86%E6%9E%90\">组成成分-数据转换分析</a></li>\n<li><a href=\"#virtuallidar-%E8%BD%AC%E6%8D%A2%E5%92%8C%E7%BB%84%E6%88%90\">VirtualLiDAR-转换和组成</a></li>\n<li><a href=\"#%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5-%E9%85%8D%E5%87%86%E9%97%AE%E9%A2%98\">时间同步-配准问题</a></li>\n<li><a href=\"#%E8%99%9A%E6%8B%9F%E9%97%AE%E9%A2%98%E5%8F%8A%E5%8F%8C%E7%AB%AF%E4%BB%BB%E5%8A%A1%E6%B5%81\">虚拟问题及双端任务流</a></li>\n<li><a href=\"#%E6%A0%87%E6%B3%A8%E9%97%AE%E9%A2%98\">标注问题</a></li>\n<li><a href=\"#%E5%85%B6%E5%AE%83%E9%97%AE%E9%A2%98\">其它问题</a></li>\n<li><a href=\"#%E6%AC%A7%E9%98%B3%E8%80%81%E5%B8%88%E7%BB%99%E7%9A%84%E6%8F%90%E8%AE%AE\">欧阳老师给的提议</a></li>\n</ul>\n</li>\n<li><a href=\"#auto-mos\">auto-mos</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%80%9F%E7%89%A9%E8%A1%A8\">借物表</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"序\">序</h2>\n<p>偶然的机会进了某大学的 Lab (简历里写了), 很感谢某位大佬 🥰</p>\n<p>就这样, 下面记一些个人经验…</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"关于调研\">关于调研</h2>\n<p>师姐开会时经常提到, 要站在第三人称视角读 paper, 不要被代入读者身份或者完全顺着作者思路思考</p>\n<p>now.clear, 意思大概就是: <code>how &gt; what</code></p>\n<ol>\n<li>\n<p>how they think, not what…</p>\n</li>\n<li>\n<p>how they do, not what…</p>\n</li>\n<li>\n<p>how they show, not what…</p>\n</li>\n</ol>\n<hr>\n<ul>\n<li>\n<p>在做调研时着重看下:</p>\n<ol>\n<li>\n<p>paper 提出的问题</p>\n</li>\n<li>\n<p>如何着手解决和实现 (精髓就是 1. -&gt; 2. 中间的思路, 应该叫<code>问题建模</code>)</p>\n</li>\n</ol>\n<p>对于优秀和有借鉴价值的实现, 可以看一看. 至于研究背景, 结果分析对比之类的, 是作者为了给 paper 加分, 对我们调研没啥用</p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"一些经验\">一些经验</h2>\n<h3 id=\"学会拆字\">学会拆字</h3>\n<p>听到一个概念不要马上去大脑数据库搜索, 之所以叫脑海, 是因为它有乱流和旋涡</p>\n<p>比如 <code>元数据</code> 这个词, 乍一听很抽象是吧, 脑子也能马上返回 Metadata 这个词, 但具体想解释就会云里雾里</p>\n<blockquote>\n<p>‘元’即为’关于…的’, 所以一组元数据是指’一组关于 xxx 的映射数据’ <sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup></p>\n</blockquote>\n<hr>\n<h3 id=\"读论文\">读论文</h3>\n<p>入门时还是相当困难的, 拿过来一篇英文文献不知道怎么下手, 来回翻译也不知所云</p>\n<p>所以还是建议练一下 <code>论文跟读</code> <sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup></p>\n<p>按注意力/重要程度分级:</p>\n<ol>\n<li>\n<p>abstract: 60%</p>\n<p>现状 &amp; paper 大体上做了什么</p>\n</li>\n<li>\n<p>introduction: 80%</p>\n<p>paper 为什么要做这个工作</p>\n</li>\n<li>\n<p>related works: 50%</p>\n<p>别人怎么做的, 同时支撑起本 paper 的意义和推进</p>\n</li>\n<li>\n<p>contributions/goal: 80%</p>\n<p>此工作做了哪些要点 (大标题的作用)</p>\n</li>\n<li>\n<p>figure image: 100%</p>\n<p>好的论文, 营养全浓缩在图里</p>\n</li>\n<li>\n<p>LaTeX math: 40%~90%</p>\n<p>公式虽然很优雅, 但是远不如图直观, 除非想深入研究改进, 不然不建议耗费蛮力看公式</p>\n</li>\n<li>\n<p>experiment: 20%~50%</p>\n<p>一般是作为论文科学性和可行性的支撑, 大部分是给审稿人看的, 除非想入手复现研究此工作, 但更建议去代码库研究</p>\n</li>\n<li>\n<p>conclusion: 30%</p>\n<p>大多数都是走个形式, 没啥作用的段落…</p>\n</li>\n</ol>\n<hr>\n<h3 id=\"找论文\">找论文</h3>\n<p>关键词, 关键词, 关键词!</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Zh_CN</th>\n<th style=\"text-align:center\">En</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">综述</td>\n<td style=\"text-align:center\">survey, overview, review</td>\n</tr>\n</tbody>\n</table>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"点云\">点云</h2>\n<p>没地方写了, 暂时写在这…</p>\n<h3 id=\"分析工具\">分析工具</h3>\n<h4 id=\"CloudCompare\">CloudCompare</h4>\n<p>默认密度颜色 蓝-&gt;绿-&gt;黄-&gt;红</p>\n<p>双击右键拖动, 按下中键上下移动会缩放</p>\n<hr>\n<h4 id=\"PCD-Decode\">PCD-Decode</h4>\n<p>如下通过 ImHex 提取出来的 PCD 文件头, 第三行说的是含有反射率 intensity 信息</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># .PCD v0.7 - Point Cloud Data file format</span></span><br><span class=\"line\"><span class=\"attribute\">VERSION</span> <span class=\"number\">0</span>.<span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"attribute\">FIELDS</span> x y z intensity</span><br><span class=\"line\"><span class=\"attribute\">SIZE</span> <span class=\"number\">4</span> <span class=\"number\">4</span> <span class=\"number\">4</span> <span class=\"number\">4</span></span><br><span class=\"line\"><span class=\"attribute\">TYPE</span> F F F F</span><br><span class=\"line\"><span class=\"attribute\">COUNT</span> <span class=\"number\">1</span> <span class=\"number\">1</span> <span class=\"number\">1</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"attribute\">WIDTH</span> <span class=\"number\">54298</span></span><br><span class=\"line\"><span class=\"attribute\">HEIGHT</span> <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"attribute\">VIEWPOINT</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">1</span> <span class=\"number\">0</span> <span class=\"number\">0</span> <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"attribute\">POINTS</span> <span class=\"number\">54298</span></span><br><span class=\"line\"><span class=\"attribute\">DATA</span> binary_compressed</span><br><span class=\"line\"><span class=\"attribute\">5</span>�</span><br></pre></td></tr></table></figure>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"某次组会分享\">某次组会分享</h3>\n<h4 id=\"组成成分-数据转换分析\">组成成分-数据转换分析</h4>\n<p>此数据集并没很清晰的给出制作流程/数据流向, 分析起来难在这里, 就像是分析饭店里的菜是怎么做的一样, 知道原料和结果但不知道过程</p>\n<p>下面通过数据流形式做的分析, 下图全流程为核心, 本质上是 <code>两个跨模态融合系统+一个通信系统</code></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z0AQzP.png\" alt=\"\"></p>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;images&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;file_name&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;/root/DataSets/DAIR-V2X/cooperative-vehicle-infrastructure//infrastructure-sideimage/000009.jpg&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">      <span class=\"attr\">&quot;calib&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;cam_intrinsic&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">          <span class=\"number\">2186.359688</span><span class=\"punctuation\">,</span> <span class=\"number\">0.0</span><span class=\"punctuation\">,</span> <span class=\"number\">968.712906</span><span class=\"punctuation\">,</span> <span class=\"number\">0.0</span><span class=\"punctuation\">,</span> <span class=\"number\">2332.160319</span><span class=\"punctuation\">,</span> <span class=\"number\">542.356703</span><span class=\"punctuation\">,</span> <span class=\"number\">0.0</span><span class=\"punctuation\">,</span> <span class=\"number\">0.0</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          <span class=\"number\">1.0</span></span><br><span class=\"line\">        <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">        <span class=\"attr\">&quot;Tr_velo_to_cam&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;translation&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">            <span class=\"punctuation\">[</span><span class=\"number\">-5.779144404715124</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"punctuation\">[</span><span class=\"number\">6.037615758600886</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"punctuation\">[</span><span class=\"number\">1.0636424034755758</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">          <span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">          <span class=\"attr\">&quot;rotation&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">[</span></span><br><span class=\"line\">            <span class=\"punctuation\">[</span><span class=\"number\">-0.0638033225610772</span><span class=\"punctuation\">,</span> <span class=\"number\">-0.9910914864003576</span><span class=\"punctuation\">,</span> <span class=\"number\">-0.04429948490729328</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"punctuation\">[</span><span class=\"number\">-0.2102873406178483</span><span class=\"punctuation\">,</span> <span class=\"number\">0.043997692433495696</span><span class=\"punctuation\">,</span> <span class=\"number\">-0.7987692871343754</span><span class=\"punctuation\">]</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">            <span class=\"punctuation\">[</span><span class=\"number\">0.97575114561348</span><span class=\"punctuation\">,</span> <span class=\"number\">-0.06031492538699515</span><span class=\"punctuation\">,</span> <span class=\"number\">-0.17158543199893228</span><span class=\"punctuation\">]</span></span><br><span class=\"line\">          <span class=\"punctuation\">]</span></span><br><span class=\"line\">        <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">      <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">    <span class=\"punctuation\">&#125;</span></span><br><span class=\"line\">  <span class=\"punctuation\">]</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>上面是 annos 内的文件格式, 为图像的内/外参, 下面是分析 (<code>-&gt;</code>所指向的为&quot;原料&quot;)</p>\n<figure class=\"highlight clean\"><table><tr><td class=\"code\"><pre><span class=\"line\"># annotations 标注</span><br><span class=\"line\">annos</span><br><span class=\"line\">  # 图片文件</span><br><span class=\"line\">  <span class=\"string\">&quot;file_name&quot;</span> -&gt; image</span><br><span class=\"line\"></span><br><span class=\"line\">  # 相机内参</span><br><span class=\"line\">  <span class=\"string\">&quot;cam_intrinsic&quot;</span> -&gt; calib/camera_intrinsic.<span class=\"string\">&quot;cam_K&quot;</span></span><br><span class=\"line\"></span><br><span class=\"line\">  # LiDAR 到 Camera 的外参矩阵, 反过来就是 Camera 到 LiDAR 的 (相机外参)</span><br><span class=\"line\">  <span class=\"string\">&quot;Tr_velo_to_cam&quot;</span>-&gt; calib/virtuallidar_to_camera</span><br></pre></td></tr></table></figure>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"VirtualLiDAR-转换和组成\">VirtualLiDAR-转换和组成</h4>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z0ADvR.png\" alt=\"\"></p>\n<p>image + annos + label/camera =&gt; 图像的 3D 标注</p>\n<p>velodyne(点云 pcd 文件) + label/virtuallidar =&gt; 点云的 3D 标注</p>\n<p>虚拟 LiDAR 坐标系到虚拟世界坐标系的转换就简单了, 只需要通过 <code>calib/virtuallidar_to_world</code> 就可以</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"时间同步-配准问题\">时间同步-配准问题</h4>\n<p>路端/车端分别有个 GPS 管位置和时间同步, 同一端内 Camera 和 LiDAR 的时间通过 GPS 授时应该是一致的</p>\n<p>所以在硬件不出问题的情况下, 同一端的时间问题可以不用考虑, 可以考虑跨端问题 (但是个人感觉, 在 GPS 授时准确的情况下, 车端与路端通信距离最远也就几十米, 也不用考虑跨端导致的时差问题)</p>\n<p>插一嘴, 感觉文档里所说的 “分别以 Camera 和 LiDAR 时间戳为基准” 有歧义, 他想表达的应该是 “同一时间戳下的 Camera 与 LiDAR 是一对”, 而不是说 Camera 与 LiDAR 各自为政分别计时</p>\n<p>在时间方面, 需要考虑的应该是车-路两端的通信时延, 几十 ms 的短时延是没问题的, 可以视为软实时, 车端的决策可以滞后一些来等待路端的指示</p>\n<p>从经验上来看, 难点应该是如何让车-路两端设备 <code>迅速匹配连接</code>, 日常用的手机 4G/5G 网正常就是几十 ms 延迟, 但是手机与基站在匹配连接阶段需要耗费好几秒 (不知道在设备选用方面能不能解决这问题)</p>\n<hr>\n<blockquote>\n<p>提出问题: 车端接收到路端给的数据, 必然是几十 ms 之前的, 我们可以考虑做这个配准</p>\n</blockquote>\n<ol>\n<li>决策滞后, 比如设置阈值 100ms, 如未收到路端返回的数据,就只用车端的进行决策</li>\n<li>让路端进行路线预测, 逼近实时</li>\n</ol>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"虚拟问题及双端任务流\">虚拟问题及双端任务流</h4>\n<p>GPS 是精准到经纬度位置的, 为了防止路端信息泄露/侵犯隐私权(车端数据自用所以不用转换), 路端设备需要把绝对位置通过 GPS 转为相对位置 (也就是虚拟化)</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z0ANiM.png\" alt=\"\"></p>\n<ul>\n<li>\n<p>车端做的是:</p>\n<ol>\n<li>探测到前方 xx 米处有辆车, 记下来路况</li>\n<li>连接路端告诉路端本车 GPS, 等待并接收路端传回的虚拟世界坐标系, 对路况查漏补缺</li>\n<li>根据记下的路况规划行驶</li>\n</ol>\n</li>\n</ul>\n<hr>\n<ul>\n<li>\n<p>路端做的是:</p>\n<ol>\n<li>探测到周围有车 A 和 B, 以路端设备 GPS 位置为中心构建虚拟世界坐标系</li>\n<li>收到某车 GPS 实时定位/relative pose (比如 A 车的), 把虚拟世界坐标系中心转为 A 车的 GPS, 并传给 A</li>\n</ol>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"标注问题\">标注问题</h4>\n<p>下面分别为图像与 LiDAR 的标注文件, 我原以为的精度问题以及数据转换是误解, 实际上是两模态都做了标注</p>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Car&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;truncated_state&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;0&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;occluded_state&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;0&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;alpha&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;0&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;2d_box&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;xmin&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">768.12085</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;ymin&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">747.97583</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;xmax&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">1002.4884040000001</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;ymax&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">1021.312134</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;3d_dimensions&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span> <span class=\"attr\">&quot;h&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">0.955531</span><span class=\"punctuation\">,</span> <span class=\"attr\">&quot;w&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">2.036715</span><span class=\"punctuation\">,</span> <span class=\"attr\">&quot;l&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">4.234148</span> <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;3d_location&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span> <span class=\"attr\">&quot;x&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;20.233591&quot;</span><span class=\"punctuation\">,</span> <span class=\"attr\">&quot;y&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;-6.118915&quot;</span><span class=\"punctuation\">,</span> <span class=\"attr\">&quot;z&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;-1.906110&quot;</span> <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;rotation&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">0.02090169484402715</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight json\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;type&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;Car&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;truncated_state&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;0&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;occluded_state&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;0&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;alpha&quot;</span><span class=\"punctuation\">:</span> <span class=\"string\">&quot;0&quot;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;2d_box&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;xmin&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">768.12085</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;ymin&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">747.97583</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;xmax&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">1002.4884040000001</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;ymax&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">1021.312134</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;3d_dimensions&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span> <span class=\"attr\">&quot;h&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">1.688849</span><span class=\"punctuation\">,</span> <span class=\"attr\">&quot;w&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">1.804866</span><span class=\"punctuation\">,</span> <span class=\"attr\">&quot;l&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">4.234148</span> <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;3d_location&quot;</span><span class=\"punctuation\">:</span> <span class=\"punctuation\">&#123;</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;x&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">20.22032661649286</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;y&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">-6.165649086415965</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">    <span class=\"attr\">&quot;z&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">-0.8846375190174429</span></span><br><span class=\"line\">  <span class=\"punctuation\">&#125;</span><span class=\"punctuation\">,</span></span><br><span class=\"line\">  <span class=\"attr\">&quot;rotation&quot;</span><span class=\"punctuation\">:</span> <span class=\"number\">0.02090180743721963</span></span><br><span class=\"line\"><span class=\"punctuation\">&#125;</span></span><br></pre></td></tr></table></figure>\n<p>图像做的是 2D+3D, 点云只做了 3D 标注, 2D 标注一模一样所以不用分析</p>\n<p>关于两模态的 3D 标注框重合度问题, 暂且认为是点云标注质量不好 (点云下车辆形状大小需要人为估量)</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"其它问题\">其它问题</h4>\n<p>annos.images.file_name 存在格式问题</p>\n<p>“/root/DataSets/DAIR-V2X/cooperative-vehicle-infrastructure//infrastructure-sideimage/000028.jpg”</p>\n<!-- TODO -->\n<p>fix_require</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"欧阳老师给的提议\">欧阳老师给的提议</h4>\n<p>(有待商榷)</p>\n<p>清标签/找一个工具改一下</p>\n<p>图像到点云不准, 过滤地面可以降低标注难度<br>\n有可能外参有问题</p>\n<p>一波人做数据清洗/标注修正<br>\n另一拨人, 做一下 IoU 统计, 融合分析</p>\n<p>寻找问题所在: 什么噪声导致 3D 框重合度有问题</p>\n<p>欧阳老师提到的 <code>Cloud Compare</code> 可以对比两点云之间的差别</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"auto-mos\">auto-mos</h3>\n<p>是这个 paper 的流程总结 <sup id='cite_ref-3'><a href=\"#cite_note-3\">[3]</a></sup></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z6OgZ9.png\" alt=\"\"></p>\n<p>主要需要的数据是连续帧雷达点云数据, 论文所提出的 pipeline 是一套 offline 模块:</p>\n<ol>\n<li>\n<p>输入进 SLAM/测距, 首先估计位姿信息</p>\n</li>\n<li>\n<p>应用 ERASOR 地图清理方法 (dynamic removal) 检测出 moving object</p>\n</li>\n<li>\n<p>利用基于密度的聚类方法 HDBSCAN 对其进行实例分割</p>\n</li>\n<li>\n<p>通过卡尔曼滤波进行多目标跟踪检测, 并通过跟踪结果判断是否为动态物体并确定其标签</p>\n<p>中心距离, 重叠的边界框量以及基于其边界框之间的每对实例之间的 volume 更改</p>\n<p>根据运动确定其标签</p>\n</li>\n</ol>\n<p>连续帧雷达点云数据 -&gt; 自动检测移动物体并生成标签</p>\n<p>之后使用生成的 label 作为监督数据训练 online 模型, 测试多个方法以及多组不同场景的雷达数据, 结果显示生成结果与人为标注结果差距小</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z6cOvP.png\" alt=\"\"></p>\n<p>线性插值生成的汽车的轨迹显示灰色, 插值还考虑了旋转和缩放。</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z67vqX.png\" alt=\"\"></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"http://www.ruanyifeng.com/blog/2007/03/metadata.html\">元数据（MetaData）</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://www.bilibili.com/video/BV1XU4y1X7b5/\">【论文必读 ResNet】residual 如此多娇，引无数英雄竞折腰</a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://github.com/PRBonn/auto-mos\">GitHub - PRBonn/auto-mos: Automatic Labeling to Generate Training Data for Online LiDAR-based Moving Object Segmentation</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "人工智能",
                "research",
                "math",
                "dataset",
                "深度学习",
                "点云",
                "自动驾驶"
            ]
        },
        {
            "id": "https://blog.weidows.tech/post/lang/python/%E6%9D%82/",
            "url": "https://blog.weidows.tech/post/lang/python/%E6%9D%82/",
            "title": "😑python-mess-code",
            "date_published": "2022-04-22T08:22:34.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2023-04-20 18:38:53\n * @FilePath: \\Blog-private\\source\\_posts\\python\\杂.md\n * @Description:\n * @!: *********************************************************************\n-->\n<h2 id=\"basic\">basic</h2>\n<h3 id=\"static-method\">static-method</h3>\n<p>python 中并没有像是 Java 里的 static 关键字,取代的是 <code>@classmethod</code> 和 <code>@staticmethod</code></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">A</span>:</span><br><span class=\"line\"></span><br><span class=\"line\">    name = <span class=\"string\">&#x27;A&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 至少有一个隐式形参 (本类 cls 对象), 可以访问类属性</span></span><br><span class=\"line\"><span class=\"meta\">    @classmethod</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">a</span>(<span class=\"params\">cls</span>):</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(cls.name)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 无形参, 也就是说拿不到类属性</span></span><br><span class=\"line\"><span class=\"meta\">    @staticmethod</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">b</span>():</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;b&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">A.a()</span><br><span class=\"line\">A.b()</span><br></pre></td></tr></table></figure>\n<pre><code>A\nb\n</code></pre>\n<h3 id=\"multi-condition\">multi-condition</h3>\n<p>if(a||b)当 a 为真时，还会对 b 求值吗?</p>\n<blockquote>\n<p>不会</p>\n</blockquote>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">calculate</span>(<span class=\"params\">name, t</span>):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;calculating: &quot;</span>, name, <span class=\"string\">&quot;seconds needs: &quot;</span>, t)</span><br><span class=\"line\">    time.sleep(t)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"literal\">True</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> (calculate(<span class=\"string\">&#x27;A&#x27;</span>, <span class=\"number\">2</span>) <span class=\"keyword\">or</span> calculate(<span class=\"string\">&#x27;B&#x27;</span>, <span class=\"number\">2</span>)):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Done&quot;</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>calculating:  A seconds needs:  2\nDone\n</code></pre>\n<h3 id=\"下划线\">下划线</h3>\n<p>教程来自: <sup id='cite_ref-4'><a href=\"#cite_note-4\">[4]</a></sup></p>\n<h4 id=\"\">_</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 单个 _ 指向最后一次执行表达式 (结果)</span></span><br><span class=\"line\"><span class=\"comment\"># 在 python 命令行中可以跑, 在这里不行</span></span><br><span class=\"line\"><span class=\"comment\"># 1 + 2</span></span><br><span class=\"line\"><span class=\"comment\"># _</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 格式化数字</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"number\">114_514_1919_810</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 类似 golang 的遍历</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(_)</span><br></pre></td></tr></table></figure>\n<pre><code>1145141919810\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n</code></pre>\n<h4 id=\"xxx\">__xxx__</h4>\n<p>魔术方法 / 魔法函数, 一般作为内置方法</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> random</span><br><span class=\"line\"></span><br><span class=\"line\">random.__name__</span><br></pre></td></tr></table></figure>\n<pre><code>'random'\n</code></pre>\n<h4 id=\"xxx-2\">_xxx</h4>\n<p>私有化, 仅提供模块内部调用, 类似Java里的 protect</p>\n<h4 id=\"xxx-3\">__xxx</h4>\n<p>也是私有化, 类似 Java 内的 private, 无法直接访问此变量/方法, 但可以间接访问</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Person</span>:</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, name, age</span>):</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.name = name</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.__age = age</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">get_age</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable language_\">self</span>.__age</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">me = Person(<span class=\"string\">&#x27;张三&#x27;</span>, <span class=\"number\">18</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(me.name)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># print(me.age)</span></span><br><span class=\"line\"><span class=\"comment\"># print(me.__age)</span></span><br><span class=\"line\"><span class=\"comment\"># 上面两种都会报错, __age -&gt; _Person__age</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(me._Person__age)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(me.get_age())</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"built_in\">dir</span>(me))</span><br></pre></td></tr></table></figure>\n<pre><code>张三\n18\n18\n['_Person__age', '__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', 'get_age', 'name']\n</code></pre>\n<h4 id=\"xxx-xxx\">_xxx__xxx</h4>\n<p>从上面例子可以看到, 能通过这个访问类私有化属性</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">you = Person(<span class=\"string\">&#x27;李四&#x27;</span>, <span class=\"number\">20</span>)</span><br><span class=\"line\">you._Person__age += <span class=\"number\">1</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(you.get_age())</span><br></pre></td></tr></table></figure>\n<pre><code>21\n</code></pre>\n<h4 id=\"xxx-4\">xxx_</h4>\n<p>类似转义, 让某些关键词无效化</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">max_ = <span class=\"built_in\">max</span>(<span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(max_)</span><br></pre></td></tr></table></figure>\n<pre><code>3\n</code></pre>\n<h3 id=\"闭包\">闭包</h3>\n<p>听起来挺抽象的, 下面这个例子实现的静态代理的功能, 只不过这种通过函数包裹函数并且回传函数的形式称为闭包</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">func_1</span>(<span class=\"params\">func</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">wrapper</span>():</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;func&#125;</span> running&#x27;</span>)</span><br><span class=\"line\">        func()</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;<span class=\"subst\">&#123;func&#125;</span> finished&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> wrapper</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">my_func = func_1(<span class=\"keyword\">lambda</span>: <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;hello&#x27;</span>))</span><br><span class=\"line\">my_func()</span><br></pre></td></tr></table></figure>\n<pre><code>&lt;function &lt;lambda&gt; at 0x000002C6132A50D0&gt; running\nhello\n&lt;function &lt;lambda&gt; at 0x000002C6132A50D0&gt; finished\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">login_user</span>(<span class=\"params\">username, password</span>):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;login success&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">check</span>(<span class=\"params\">func</span>):</span><br><span class=\"line\">    <span class=\"comment\"># 这里的 argv 可以直接获取 func 的</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">wrapper</span>(<span class=\"params\">username, password</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> username == <span class=\"string\">&#x27;user&#x27;</span> <span class=\"keyword\">and</span> password == <span class=\"string\">&#x27;password&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> func(username, password)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;login failed&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> wrapper</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">login_user = check(login_user)</span><br><span class=\"line\">login_user(<span class=\"string\">&#x27;user&#x27;</span>, <span class=\"string\">&#x27;password&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<pre><code>login success\n</code></pre>\n<h3 id=\"装饰器\">装饰器</h3>\n<p>decorator-@, 从Java里叫注解, 上面的例子可写成下面这样</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">@check</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">login_user</span>(<span class=\"params\">username, password</span>):</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;login success&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">check</span>(<span class=\"params\">func</span>):</span><br><span class=\"line\">    <span class=\"comment\"># 这里的 argv 可以直接获取 func 的</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">wrapper</span>(<span class=\"params\">username, password</span>):</span><br><span class=\"line\">        <span class=\"keyword\">if</span> username == <span class=\"string\">&#x27;user&#x27;</span> <span class=\"keyword\">and</span> password == <span class=\"string\">&#x27;password&#x27;</span>:</span><br><span class=\"line\">            <span class=\"keyword\">return</span> func(username, password)</span><br><span class=\"line\">        <span class=\"keyword\">else</span>:</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;login failed&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> wrapper</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">login_user(<span class=\"string\">&#x27;user&#x27;</span>, <span class=\"string\">&#x27;password&#x27;</span>)</span><br></pre></td></tr></table></figure>\n<pre><code>login success\n</code></pre>\n<h2 id=\"modules\">modules</h2>\n<h3 id=\"base64\">base64</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> base64</span><br><span class=\"line\"></span><br><span class=\"line\">username = <span class=\"string\">&#x27;Weidows&#x27;</span></span><br><span class=\"line\">password = <span class=\"string\">&#x27;123456&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">encode = base64.b64encode((username + <span class=\"string\">&quot;:&quot;</span> + password).encode())</span><br><span class=\"line\"><span class=\"comment\"># Basic V2VpZG93czoxMjM0NTY==</span></span><br><span class=\"line\">headers = &#123;<span class=\"string\">&quot;Authorization&quot;</span>: <span class=\"string\">&quot;Basic &quot;</span> + encode.decode()&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(headers)</span><br></pre></td></tr></table></figure>\n<pre><code>&#123;'Authorization': 'Basic V2VpZG93czoxMjM0NTY='&#125;\n</code></pre>\n<h3 id=\"多线程-进程\">多线程-进程</h3>\n<blockquote>\n<p>Python 多线程不能利用 CPU 多核优势，IO 密集型可用多线程，CPU 密集型适合用多进程 <sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup></p>\n</blockquote>\n<p>也就是说只有 IO 密集型任务适用多线程,其他情况: <code>多进程 &gt; 不用 &gt; 多线程</code>, API 区别如下:<sup id='cite_ref-3'><a href=\"#cite_note-3\">[3]</a></sup></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R9zQZh.png\" alt=\"R9zQZh.png\"></p>\n<p>虽然但是,很多情况下涉及到资源共享, 多进程处理起来比较麻烦,还是多线程舒服.</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> concurrent.futures <span class=\"keyword\">import</span> ThreadPoolExecutor</span><br><span class=\"line\"><span class=\"keyword\">import</span> threading</span><br><span class=\"line\"><span class=\"keyword\">import</span> multiprocessing</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"></span><br><span class=\"line\">multi_num = multiprocessing.cpu_count() * <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">counter</span>(<span class=\"params\">num</span>):</span><br><span class=\"line\">    time.sleep(num)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(threading.currentThread().name, num, end=<span class=\"string\">&#x27;\\t&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    <span class=\"keyword\">with</span> ThreadPoolExecutor(max_workers=multi_num) <span class=\"keyword\">as</span> thread_pool:</span><br><span class=\"line\">        start = time.time()</span><br><span class=\"line\">        thread_pool.<span class=\"built_in\">map</span>(counter, <span class=\"built_in\">range</span>(<span class=\"number\">10</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># 等待任务执行完再跳回 main</span></span><br><span class=\"line\">        thread_pool.shutdown(wait=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        <span class=\"built_in\">print</span>(<span class=\"string\">&quot;多线程: &quot;</span>, time.time() - start)</span><br></pre></td></tr></table></figure>\n<pre><code>ThreadPoolExecutor-0_0 0\tThreadPoolExecutor-0_1 1\tThreadPoolExecutor-0_0 2\tThreadPoolExecutor-0_2 3\tThreadPoolExecutor-0_3 4\tThreadPoolExecutor-0_4 5\tThreadPoolExecutor-0_5 6\tThreadPoolExecutor-0_6 7\tThreadPoolExecutor-0_7 8\tThreadPoolExecutor-0_8 9\t多线程:  9.009207010269165\n</code></pre>\n<h2 id=\"opengl\">opengl</h2>\n<h3 id=\"彩色三角形\">彩色三角形</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># -------------------------------------------</span></span><br><span class=\"line\"><span class=\"comment\"># quidam_01.py 三维空间的世界坐标系和三角形</span></span><br><span class=\"line\"><span class=\"comment\"># -------------------------------------------</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GL <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GLUT <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">draw</span>():</span><br><span class=\"line\">    <span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\">    glBegin(GL_LINES)  <span class=\"comment\"># 开始绘制线段（世界坐标系）</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 以红色绘制x轴</span></span><br><span class=\"line\">    glColor4f(<span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>)  <span class=\"comment\"># 设置当前颜色为红色不透明</span></span><br><span class=\"line\">    glVertex3f(-<span class=\"number\">0.8</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>)  <span class=\"comment\"># 设置x轴顶点（x轴负方向）</span></span><br><span class=\"line\">    glVertex3f(<span class=\"number\">0.8</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>)  <span class=\"comment\"># 设置x轴顶点（x轴正方向）</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 以绿色绘制y轴</span></span><br><span class=\"line\">    glColor4f(<span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>)  <span class=\"comment\"># 设置当前颜色为绿色不透明</span></span><br><span class=\"line\">    glVertex3f(<span class=\"number\">0.0</span>, -<span class=\"number\">0.8</span>, <span class=\"number\">0.0</span>)  <span class=\"comment\"># 设置y轴顶点（y轴负方向）</span></span><br><span class=\"line\">    glVertex3f(<span class=\"number\">0.0</span>, <span class=\"number\">0.8</span>, <span class=\"number\">0.0</span>)  <span class=\"comment\"># 设置y轴顶点（y轴正方向）</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 以蓝色绘制z轴</span></span><br><span class=\"line\">    glColor4f(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">1.0</span>)  <span class=\"comment\"># 设置当前颜色为蓝色不透明</span></span><br><span class=\"line\">    glVertex3f(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, -<span class=\"number\">0.8</span>)  <span class=\"comment\"># 设置z轴顶点（z轴负方向）</span></span><br><span class=\"line\">    glVertex3f(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.8</span>)  <span class=\"comment\"># 设置z轴顶点（z轴正方向）</span></span><br><span class=\"line\"></span><br><span class=\"line\">    glEnd()  <span class=\"comment\"># 结束绘制线段</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\">    glBegin(GL_TRIANGLES)  <span class=\"comment\"># 开始绘制三角形（z轴负半区）</span></span><br><span class=\"line\"></span><br><span class=\"line\">    glColor4f(<span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>)  <span class=\"comment\"># 设置当前颜色为红色不透明</span></span><br><span class=\"line\">    glVertex3f(-<span class=\"number\">0.5</span>, -<span class=\"number\">0.366</span>, -<span class=\"number\">0.5</span>)  <span class=\"comment\"># 设置三角形顶点</span></span><br><span class=\"line\">    glColor4f(<span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>)  <span class=\"comment\"># 设置当前颜色为绿色不透明</span></span><br><span class=\"line\">    glVertex3f(<span class=\"number\">0.5</span>, -<span class=\"number\">0.366</span>, -<span class=\"number\">0.5</span>)  <span class=\"comment\"># 设置三角形顶点</span></span><br><span class=\"line\">    glColor4f(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">1.0</span>)  <span class=\"comment\"># 设置当前颜色为蓝色不透明</span></span><br><span class=\"line\">    glVertex3f(<span class=\"number\">0.0</span>, <span class=\"number\">0.5</span>, -<span class=\"number\">0.5</span>)  <span class=\"comment\"># 设置三角形顶点</span></span><br><span class=\"line\"></span><br><span class=\"line\">    glEnd()  <span class=\"comment\"># 结束绘制三角形</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># ---------------------------------------------------------------</span></span><br><span class=\"line\">    glFlush()  <span class=\"comment\"># 清空缓冲区，将指令送往硬件立即执行</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&quot;__main__&quot;</span>:</span><br><span class=\"line\">    glutInit()  <span class=\"comment\"># 1. 初始化glut库</span></span><br><span class=\"line\">    glutCreateWindow(<span class=\"string\">&#x27;Quidam Of OpenGL&#x27;</span>)  <span class=\"comment\"># 2. 创建glut窗口</span></span><br><span class=\"line\">    glutDisplayFunc(draw)  <span class=\"comment\"># 3. 注册回调函数draw()</span></span><br><span class=\"line\">    glutMainLoop()  <span class=\"comment\"># 4. 进入glut主循环</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"点线抛物线\">点线抛物线</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GL <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GLU <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GLUT <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> numpy <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> sys</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">init</span>():</span><br><span class=\"line\">    glClearColor(<span class=\"number\">1.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">1.0</span>, <span class=\"number\">1.0</span>)</span><br><span class=\"line\">    gluOrtho2D(-<span class=\"number\">5.0</span>, <span class=\"number\">5.0</span>, -<span class=\"number\">5.0</span>, <span class=\"number\">5.0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">plotfunc</span>():</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT)</span><br><span class=\"line\">    glColor3f(<span class=\"number\">1.0</span>, <span class=\"number\">0.2</span>, <span class=\"number\">0.6</span>)</span><br><span class=\"line\">    glPointSize(<span class=\"number\">3.0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    glBegin(GL_POINTS)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> arange(-<span class=\"number\">5.0</span>, <span class=\"number\">5.0</span>, <span class=\"number\">0.1</span>):  <span class=\"comment\">#from -5.0 to 5.0 plus 0.1 every time</span></span><br><span class=\"line\">        y = x * x</span><br><span class=\"line\">        glVertex2f(x, y)</span><br><span class=\"line\">    glEnd()</span><br><span class=\"line\">    glFlush()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">main</span>():</span><br><span class=\"line\">    glutInit(sys.argv)</span><br><span class=\"line\">    glutInitDisplayMode(GLUT_SINGLE | GLUT_RGB)</span><br><span class=\"line\">    glutInitWindowPosition(<span class=\"number\">50</span>, <span class=\"number\">100</span>)</span><br><span class=\"line\">    glutInitWindowSize(<span class=\"number\">400</span>, <span class=\"number\">400</span>)</span><br><span class=\"line\">    glutCreateWindow(<span class=\"string\">&quot;Function Plotter&quot;</span>)</span><br><span class=\"line\">    glutDisplayFunc(plotfunc)</span><br><span class=\"line\"></span><br><span class=\"line\">    init()</span><br><span class=\"line\">    glutMainLoop()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">main()</span><br></pre></td></tr></table></figure>\n<h3 id=\"转动时钟\">转动时钟</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GL <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GLU <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GLUT <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">import</span> math</span><br><span class=\"line\"><span class=\"keyword\">import</span> time</span><br><span class=\"line\"></span><br><span class=\"line\">h = <span class=\"number\">0</span></span><br><span class=\"line\">m = <span class=\"number\">0</span></span><br><span class=\"line\">s = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">Draw</span>():</span><br><span class=\"line\">    PI = <span class=\"number\">3.1415926</span></span><br><span class=\"line\">    R = <span class=\"number\">0.5</span></span><br><span class=\"line\">    TR = R - <span class=\"number\">0.05</span></span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT)</span><br><span class=\"line\">    glLineWidth(<span class=\"number\">5</span>)</span><br><span class=\"line\">    glBegin(GL_LINE_LOOP)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">        glVertex2f(R * math.cos(<span class=\"number\">2</span> * PI / <span class=\"number\">100</span> * i),</span><br><span class=\"line\">                   R * math.sin(<span class=\"number\">2</span> * PI / <span class=\"number\">100</span> * i))</span><br><span class=\"line\">    glEnd()</span><br><span class=\"line\">    glLineWidth(<span class=\"number\">2</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">        glBegin(GL_LINES)</span><br><span class=\"line\">        glVertex2f(TR * math.sin(<span class=\"number\">2</span> * PI / <span class=\"number\">12</span> * i),</span><br><span class=\"line\">                   TR * math.cos(<span class=\"number\">2</span> * PI / <span class=\"number\">12</span> * i))</span><br><span class=\"line\">        glVertex2f(R * math.sin(<span class=\"number\">2</span> * PI / <span class=\"number\">12</span> * i),</span><br><span class=\"line\">                   R * math.cos(<span class=\"number\">2</span> * PI / <span class=\"number\">12</span> * i))</span><br><span class=\"line\">        glEnd()</span><br><span class=\"line\">    glLineWidth(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    h_Length = <span class=\"number\">0.2</span></span><br><span class=\"line\">    m_Length = <span class=\"number\">0.3</span></span><br><span class=\"line\">    s_Length = <span class=\"number\">0.4</span></span><br><span class=\"line\">    count = <span class=\"number\">60.0</span></span><br><span class=\"line\">    s_Angle = s / count</span><br><span class=\"line\">    count *= <span class=\"number\">60</span></span><br><span class=\"line\">    m_Angle = (m * <span class=\"number\">60</span> + s) / count</span><br><span class=\"line\">    count *= <span class=\"number\">12</span></span><br><span class=\"line\">    h_Angle = (h * <span class=\"number\">60</span> * <span class=\"number\">60</span> + m * <span class=\"number\">60</span> + s) / count</span><br><span class=\"line\">    glLineWidth(<span class=\"number\">1</span>)</span><br><span class=\"line\">    glBegin(GL_LINES)</span><br><span class=\"line\">    glVertex2f(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>)</span><br><span class=\"line\">    glVertex2f(s_Length * math.sin(<span class=\"number\">2</span> * PI * s_Angle),</span><br><span class=\"line\">               s_Length * math.cos(<span class=\"number\">2</span> * PI * s_Angle))</span><br><span class=\"line\">    glEnd()</span><br><span class=\"line\">    glLineWidth(<span class=\"number\">5</span>)</span><br><span class=\"line\">    glBegin(GL_LINES)</span><br><span class=\"line\">    glVertex2f(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>)</span><br><span class=\"line\">    glVertex2f(h_Length * math.sin(<span class=\"number\">2</span> * PI * h_Angle),</span><br><span class=\"line\">               h_Length * math.cos(<span class=\"number\">2</span> * PI * h_Angle))</span><br><span class=\"line\">    glEnd()</span><br><span class=\"line\">    glLineWidth(<span class=\"number\">3</span>)</span><br><span class=\"line\">    glBegin(GL_LINES)</span><br><span class=\"line\">    glVertex2f(<span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>)</span><br><span class=\"line\">    glVertex2f(m_Length * math.sin(<span class=\"number\">2</span> * PI * m_Angle),</span><br><span class=\"line\">               m_Length * math.cos(<span class=\"number\">2</span> * PI * m_Angle))</span><br><span class=\"line\">    glEnd()</span><br><span class=\"line\">    glLineWidth(<span class=\"number\">1</span>)</span><br><span class=\"line\">    glBegin(GL_POLYGON)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">100</span>):</span><br><span class=\"line\">        glVertex2f(<span class=\"number\">0.03</span> * math.cos(<span class=\"number\">2</span> * PI / <span class=\"number\">100</span> * i),</span><br><span class=\"line\">                   <span class=\"number\">0.03</span> * math.sin(<span class=\"number\">2</span> * PI / <span class=\"number\">100</span> * i))</span><br><span class=\"line\">    glEnd()</span><br><span class=\"line\">    glFlush()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">Update</span>():</span><br><span class=\"line\">    <span class=\"keyword\">global</span> h, m, s</span><br><span class=\"line\">    t = time.localtime(time.time())</span><br><span class=\"line\">    h = <span class=\"built_in\">int</span>(time.strftime(<span class=\"string\">&#x27;%H&#x27;</span>, t))</span><br><span class=\"line\">    m = <span class=\"built_in\">int</span>(time.strftime(<span class=\"string\">&#x27;%M&#x27;</span>, t))</span><br><span class=\"line\">    s = <span class=\"built_in\">int</span>(time.strftime(<span class=\"string\">&#x27;%S&#x27;</span>, t))</span><br><span class=\"line\">    glutPostRedisplay()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">glutInit()</span><br><span class=\"line\">glutInitDisplayMode(GLUT_SINGLE | GLUT_RGBA)</span><br><span class=\"line\">glutInitWindowSize(<span class=\"number\">400</span>, <span class=\"number\">400</span>)</span><br><span class=\"line\">glutCreateWindow(<span class=\"string\">&quot;My clock&quot;</span>)</span><br><span class=\"line\">glutDisplayFunc(Draw)</span><br><span class=\"line\">glutIdleFunc(Update)</span><br><span class=\"line\">glutMainLoop()</span><br></pre></td></tr></table></figure>\n<h3 id=\"Hello-World-pyglet\">Hello-World-pyglet</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pyglet</span><br><span class=\"line\"></span><br><span class=\"line\">window = pyglet.window.Window()</span><br><span class=\"line\"></span><br><span class=\"line\">label = pyglet.text.Label(<span class=\"string\">&#x27;Hello, world&#x27;</span>,</span><br><span class=\"line\">                          font_name=<span class=\"string\">&#x27;Times New Roman&#x27;</span>,</span><br><span class=\"line\">                          font_size=<span class=\"number\">36</span>,</span><br><span class=\"line\">                          x=window.width // <span class=\"number\">2</span>,</span><br><span class=\"line\">                          y=window.height // <span class=\"number\">2</span>,</span><br><span class=\"line\">                          anchor_x=<span class=\"string\">&#x27;center&#x27;</span>,</span><br><span class=\"line\">                          anchor_y=<span class=\"string\">&#x27;center&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@window.event</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">on_draw</span>():</span><br><span class=\"line\">    window.clear()</span><br><span class=\"line\">    label.draw()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">pyglet.app.run()</span><br></pre></td></tr></table></figure>\n<h3 id=\"茶壶\">茶壶</h3>\n<h4 id=\"动态\">动态</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GL <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GLU <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GLUT <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">drawFunc</span>():</span><br><span class=\"line\">    <span class=\"comment\">#清楚之前画面</span></span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT)</span><br><span class=\"line\">    glRotatef(<span class=\"number\">0.1</span>, <span class=\"number\">5</span>, <span class=\"number\">5</span>, <span class=\"number\">0</span>)  <span class=\"comment\">#(角度,x,y,z)</span></span><br><span class=\"line\">    glutWireTeapot(<span class=\"number\">0.5</span>)</span><br><span class=\"line\">    <span class=\"comment\">#刷新显示</span></span><br><span class=\"line\">    glFlush()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#使用glut初始化OpenGL</span></span><br><span class=\"line\">glutInit()</span><br><span class=\"line\"><span class=\"comment\">#显示模式:GLUT_SINGLE无缓冲直接显示|GLUT_RGBA采用RGB(A非alpha)</span></span><br><span class=\"line\">glutInitDisplayMode(GLUT_SINGLE | GLUT_RGBA)</span><br><span class=\"line\"><span class=\"comment\">#窗口位置及大小-生成</span></span><br><span class=\"line\">glutInitWindowPosition(<span class=\"number\">0</span>, <span class=\"number\">0</span>)</span><br><span class=\"line\">glutInitWindowSize(<span class=\"number\">400</span>, <span class=\"number\">400</span>)</span><br><span class=\"line\">glutCreateWindow(<span class=\"string\">b&quot;first&quot;</span>)</span><br><span class=\"line\"><span class=\"comment\">#调用函数绘制图像</span></span><br><span class=\"line\">glutDisplayFunc(drawFunc)</span><br><span class=\"line\">glutIdleFunc(drawFunc)</span><br><span class=\"line\"><span class=\"comment\">#主循环</span></span><br><span class=\"line\">glutMainLoop()</span><br></pre></td></tr></table></figure>\n<h4 id=\"静态\">静态</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GL <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GLU <span class=\"keyword\">import</span> *</span><br><span class=\"line\"><span class=\"keyword\">from</span> OpenGL.GLUT <span class=\"keyword\">import</span> *</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">drawFunc</span>():</span><br><span class=\"line\">    glClear(GL_COLOR_BUFFER_BIT)</span><br><span class=\"line\">    <span class=\"comment\"># 设置为红色</span></span><br><span class=\"line\">    glColor3f(<span class=\"number\">1.0</span>, <span class=\"number\">0.0</span>, <span class=\"number\">0.0</span>)</span><br><span class=\"line\">    glutWireTeapot(<span class=\"number\">0.5</span>)</span><br><span class=\"line\">    glFlush()</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">glutInit()</span><br><span class=\"line\">glutInitDisplayMode(GLUT_SINGLE | GLUT_RGBA)</span><br><span class=\"line\">glutInitWindowSize(<span class=\"number\">400</span>, <span class=\"number\">400</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">#参数为b类型而不是string</span></span><br><span class=\"line\">glutCreateWindow(<span class=\"string\">b&quot;Teapot&quot;</span>)</span><br><span class=\"line\">glutDisplayFunc(drawFunc)</span><br><span class=\"line\">glutMainLoop()</span><br></pre></td></tr></table></figure>\n<h2 id=\"数据分析\">数据分析</h2>\n<h3 id=\"numpy\">numpy</h3>\n<h4 id=\"newaxis\">newaxis</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\">A = np.array([[<span class=\"number\">2</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">1</span>], [<span class=\"number\">2</span>, <span class=\"number\">0</span>, <span class=\"number\">2</span>, <span class=\"number\">2</span>]])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(A)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;A.shape: &quot;</span>, A.shape)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># new 一个一维数组,然后把 A 整个怼进去</span></span><br><span class=\"line\">B = A[np.newaxis, :]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(B)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;B.shape: &quot;</span>, B.shape)</span><br><span class=\"line\"></span><br><span class=\"line\">C = A[:, np.newaxis]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(C)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;C.shape: &quot;</span>, C.shape)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 把每个第二维第四位的元素怼进一个新数组,把原第二位替换为此新数组</span></span><br><span class=\"line\">D = A[:, np.newaxis, <span class=\"number\">3</span>]</span><br><span class=\"line\"><span class=\"built_in\">print</span>(D)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;D.shape: &quot;</span>, D.shape)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>[[2 0 2 1]\n [2 0 2 2]]\nA.shape:  (2, 4)\n[[[2 0 2 1]\n  [2 0 2 2]]]\nB.shape:  (1, 2, 4)\n[[[2 0 2 1]]\n\n [[2 0 2 2]]]\nC.shape:  (2, 1, 4)\n[[1]\n [2]]\nD.shape:  (2, 1)\n</code></pre>\n<h3 id=\"Matplotlib\">Matplotlib</h3>\n<h4 id=\"figure\">figure</h4>\n<p>可以用 figure 对输出的图片进行缩放</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\">plt.imshow(plt.imread(<span class=\"string\">&#x27;./_data_set/kitti_000008_pred.png&#x27;</span>))</span><br></pre></td></tr></table></figure>\n<pre><code>&lt;matplotlib.image.AxesImage at 0x22c4640aa90&gt;\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"%E6%9D%82_files/%E6%9D%82_40_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">25</span>, <span class=\"number\">20</span>))</span><br><span class=\"line\">plt.imshow(plt.imread(<span class=\"string\">&#x27;./_data_set/kitti_000008_pred.png&#x27;</span>))</span><br></pre></td></tr></table></figure>\n<pre><code>&lt;matplotlib.image.AxesImage at 0x22c4651a1c0&gt;\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"%E6%9D%82_files/%E6%9D%82_41_1.png\" alt=\"png\"></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://stackoverflow.com/questions/29241056/how-does-numpy-newaxis-work-and-when-to-use-it\">How does numpy.newaxis work and when to use it?</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://blog.csdn.net/gzmgzm_ming/article/details/81783450\">Python threadpool与multiprocessing</a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://www.bilibili.com/video/BV1yp4y1679u\">Python并发实战，怎样使用多进程multiprocessing加速程序运行</a></p>\n<p><a name='cite_note-4' href='#cite_ref-4'>[4]</a>: <a href=\"https://www.bilibili.com/video/BV1z94y1U7j9?vd_source=bc13275071d678583f4bfdd8d344efda\">Python 中各种下划线的骚操作：_、<em>xx、xx</em>、__xx、<strong>xx</strong>、_classname__xx</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "多线程",
                "人工智能",
                "python",
                "opengl"
            ]
        },
        {
            "id": "https://blog.weidows.tech/post/lang/python/code/DL/",
            "url": "https://blog.weidows.tech/post/lang/python/code/DL/",
            "title": "👩‍❤️‍💋‍👨Code-4-Deep-Learning",
            "date_published": "2022-04-20T16:26:11.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2024-08-07 12:54:47\n * @FilePath: \\Blog-private\\source\\_posts\\python\\code\\DL.md\n * @Description:\n * @!: *********************************************************************\n-->\n<h2 id=\"序\">序</h2>\n<p>此文为其他文章的代码部分:</p>\n<blockquote>\n<p><a href=\"../../AI/DL\">⚡再啃-Deep-Learning</a></p>\n</blockquote>\n<p>也提供了 notebook 形式: <a href=\"https://github.com/Weidows-projects/public-post/blob/main/notebook/DL/DL.ipynb\">代码地址</a></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"神经网络\">神经网络</h2>\n<h3 id=\"感知器\">感知器</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">AND</span>(<span class=\"params\">x1, x2</span>):</span><br><span class=\"line\">    w1, w2, theta = <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.7</span></span><br><span class=\"line\">    tmp = x1 * w1 + x2 * w2</span><br><span class=\"line\">    <span class=\"keyword\">if</span> tmp &lt;= theta:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">OR</span>(<span class=\"params\">x1, x2</span>):</span><br><span class=\"line\">    w1, w2, theta = <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.2</span></span><br><span class=\"line\">    tmp = x1 * w1 + x2 * w2</span><br><span class=\"line\">    <span class=\"keyword\">if</span> tmp &lt;= theta:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 非门只取一个输入,另一个不管</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">NOT</span>(<span class=\"params\">x1, x2</span>):</span><br><span class=\"line\">    w1, w2, theta = -<span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span></span><br><span class=\"line\">    tmp = x1 * w1 + x2 * w2 + <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> tmp</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 异或门是非线性运算, 需要多层感知器组合</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">XOR</span>(<span class=\"params\">x1, x2</span>):</span><br><span class=\"line\">    <span class=\"comment\"># 异或门 = (与非门 与 或门)</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> AND(OR(x1, x2), <span class=\"keyword\">not</span> AND(x1, x2))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(AND(<span class=\"number\">0</span>, <span class=\"number\">1</span>), AND(<span class=\"number\">1</span>, <span class=\"number\">1</span>), OR(<span class=\"number\">0</span>, <span class=\"number\">1</span>), OR(<span class=\"number\">0</span>, <span class=\"number\">0</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(NOT(<span class=\"number\">0</span>, <span class=\"number\">1</span>), NOT(<span class=\"number\">1</span>, <span class=\"number\">1</span>), NOT(<span class=\"number\">0</span>, <span class=\"number\">0</span>), NOT(<span class=\"number\">1</span>, <span class=\"number\">0</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(XOR(<span class=\"number\">0</span>, <span class=\"number\">1</span>), XOR(<span class=\"number\">1</span>, <span class=\"number\">1</span>), XOR(<span class=\"number\">0</span>, <span class=\"number\">0</span>), XOR(<span class=\"number\">1</span>, <span class=\"number\">0</span>))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>0 1 1 0\n1 0 1 0\n1 0 0 1\n</code></pre>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"Pytorch\">Pytorch</h2>\n<h3 id=\"MNIST-手写数字识别\">MNIST-手写数字识别</h3>\n<p>入门典中典 <sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup>, 具体教程推荐 <sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup> <sup id='cite_ref-3'><a href=\"#cite_note-3\">[3]</a></sup></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> torch</span><br><span class=\"line\"><span class=\"keyword\">import</span> torchvision</span><br><span class=\"line\"><span class=\"keyword\">from</span> torch.utils.data <span class=\"keyword\">import</span> DataLoader</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 超参</span></span><br><span class=\"line\">n_epochs = <span class=\"number\">3</span></span><br><span class=\"line\">batch_size_train = <span class=\"number\">64</span></span><br><span class=\"line\">batch_size_test = <span class=\"number\">1000</span></span><br><span class=\"line\">learning_rate = <span class=\"number\">0.01</span></span><br><span class=\"line\">momentum = <span class=\"number\">0.5</span></span><br><span class=\"line\">log_interval = <span class=\"number\">10</span></span><br><span class=\"line\">random_seed = <span class=\"number\">42</span></span><br><span class=\"line\">torch.manual_seed(random_seed)</span><br><span class=\"line\">MINST_mean = <span class=\"number\">0.1307</span></span><br><span class=\"line\">MINST_std = <span class=\"number\">0.3081</span></span><br><span class=\"line\"></span><br><span class=\"line\">train_loader = torch.utils.data.DataLoader(torchvision.datasets.MNIST(</span><br><span class=\"line\">    <span class=\"string\">&#x27;./_data_set/&#x27;</span>,</span><br><span class=\"line\">    train=<span class=\"literal\">True</span>,</span><br><span class=\"line\">    download=<span class=\"literal\">True</span>,</span><br><span class=\"line\">    transform=torchvision.transforms.Compose([</span><br><span class=\"line\">        torchvision.transforms.ToTensor(),</span><br><span class=\"line\">        torchvision.transforms.Normalize((MINST_mean, ), (MINST_std, ))</span><br><span class=\"line\">    ])),</span><br><span class=\"line\">                                           batch_size=batch_size_train,</span><br><span class=\"line\">                                           shuffle=<span class=\"literal\">True</span>)</span><br><span class=\"line\">test_loader = torch.utils.data.DataLoader(torchvision.datasets.MNIST(</span><br><span class=\"line\">    <span class=\"string\">&#x27;./_data_set/&#x27;</span>,</span><br><span class=\"line\">    train=<span class=\"literal\">False</span>,</span><br><span class=\"line\">    download=<span class=\"literal\">True</span>,</span><br><span class=\"line\">    transform=torchvision.transforms.Compose([</span><br><span class=\"line\">        torchvision.transforms.ToTensor(),</span><br><span class=\"line\">        torchvision.transforms.Normalize((MINST_mean, ), (MINST_std, ))</span><br><span class=\"line\">    ])),</span><br><span class=\"line\">                                          batch_size=batch_size_test,</span><br><span class=\"line\">                                          shuffle=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">batch_idx, (example_data, example_targets) = <span class=\"built_in\">next</span>(<span class=\"built_in\">enumerate</span>(train_loader))</span><br><span class=\"line\"><span class=\"comment\"># 每批次有 64 张单通道 28x28 大小的图片</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(example_data.shape)</span><br><span class=\"line\"><span class=\"comment\"># 每个图片实际的数字标签</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(example_targets)</span><br><span class=\"line\"></span><br><span class=\"line\">fig = plt.figure()</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">9</span>):</span><br><span class=\"line\">    plt.subplot(<span class=\"number\">3</span>, <span class=\"number\">3</span>, i + <span class=\"number\">1</span>)</span><br><span class=\"line\">    plt.tight_layout()</span><br><span class=\"line\">    plt.imshow(example_data[i][<span class=\"number\">0</span>], cmap=<span class=\"string\">&#x27;gray&#x27;</span>, interpolation=<span class=\"string\">&#x27;none&#x27;</span>)</span><br><span class=\"line\">    <span class=\"comment\"># plt.title(&quot;数字: &#123;&#125;&quot;.format(example_targets[i]))</span></span><br><span class=\"line\">    plt.title(<span class=\"string\">f&#x27;number: <span class=\"subst\">&#123;example_targets[i]&#125;</span>&#x27;</span>)</span><br><span class=\"line\">    plt.xticks([])</span><br><span class=\"line\">    plt.yticks([])</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<pre><code>torch.Size([64, 1, 28, 28])\ntensor([1, 2, 8, 5, 2, 6, 9, 9, 9, 4, 0, 3, 9, 9, 5, 6, 7, 8, 8, 9, 2, 6, 9, 3,\n        0, 5, 0, 7, 6, 1, 2, 0, 7, 4, 6, 0, 6, 9, 7, 0, 7, 3, 2, 5, 9, 0, 4, 8,\n        3, 6, 4, 0, 3, 2, 6, 6, 3, 2, 2, 3, 6, 7, 8, 4])\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"DL_files/DL_4_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> torch.nn <span class=\"keyword\">as</span> nn</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch.nn.functional <span class=\"keyword\">as</span> F</span><br><span class=\"line\"><span class=\"keyword\">import</span> torch.optim <span class=\"keyword\">as</span> optim</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Net</span>(nn.Module):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self</span>):</span><br><span class=\"line\">        <span class=\"built_in\">super</span>(Net, <span class=\"variable language_\">self</span>).__init__()</span><br><span class=\"line\">        <span class=\"comment\"># 卷积层</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.conv1 = nn.Conv2d(<span class=\"number\">1</span>, <span class=\"number\">10</span>, kernel_size=<span class=\"number\">5</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.conv2 = nn.Conv2d(<span class=\"number\">10</span>, <span class=\"number\">20</span>, kernel_size=<span class=\"number\">5</span>)</span><br><span class=\"line\">        <span class=\"comment\"># 加一层 dropout (删除神经元), 防止过拟合; 不要直接用 F.dropout2d</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.conv2_drop = nn.Dropout2d()</span><br><span class=\"line\">        <span class=\"comment\"># 全连接层</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.fc1 = nn.Linear(<span class=\"number\">320</span>, <span class=\"number\">50</span>)</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.fc2 = nn.Linear(<span class=\"number\">50</span>, <span class=\"number\">10</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">forward</span>(<span class=\"params\">self, x</span>):</span><br><span class=\"line\">        <span class=\"comment\"># 原28x28x1 -&gt; 卷积24x24x10 -&gt; 池化12x12x10 -&gt; 激活12x12x10</span></span><br><span class=\"line\">        x = F.relu(F.max_pool2d(<span class=\"variable language_\">self</span>.conv1(x), <span class=\"number\">2</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\"># 原12x12x10 -&gt; 卷积8x8x20 -&gt; 池化4x4x20 -&gt; 激活4x4x20</span></span><br><span class=\"line\">        x = F.relu(F.max_pool2d(<span class=\"variable language_\">self</span>.conv2_drop(<span class=\"variable language_\">self</span>.conv2(x)), <span class=\"number\">2</span>))</span><br><span class=\"line\">        <span class=\"comment\"># 320 = 4x4x20 将张量x变形成一维向量形式，总特征数不变，为全连接层做准备</span></span><br><span class=\"line\">        x = x.view(-<span class=\"number\">1</span>, <span class=\"number\">320</span>)</span><br><span class=\"line\">        x = F.relu(<span class=\"variable language_\">self</span>.fc1(x))</span><br><span class=\"line\">        x = F.dropout(x, training=<span class=\"variable language_\">self</span>.training)</span><br><span class=\"line\">        x = <span class=\"variable language_\">self</span>.fc2(x)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> F.log_softmax(x)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">network = Net()</span><br><span class=\"line\">optimizer = optim.SGD(network.parameters(),</span><br><span class=\"line\">                      lr=learning_rate,</span><br><span class=\"line\">                      momentum=momentum)</span><br><span class=\"line\"></span><br><span class=\"line\">train_losses = []</span><br><span class=\"line\">train_counter = []</span><br><span class=\"line\">test_losses = []</span><br><span class=\"line\">test_counter = [i * <span class=\"built_in\">len</span>(train_loader.dataset) <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n_epochs + <span class=\"number\">1</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">train</span>(<span class=\"params\">epoch</span>):</span><br><span class=\"line\">    network.train()</span><br><span class=\"line\">    <span class=\"keyword\">for</span> batch_idx, (data, target) <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(train_loader):</span><br><span class=\"line\">        optimizer.zero_grad()</span><br><span class=\"line\">        output = network(data)</span><br><span class=\"line\">        loss = F.nll_loss(output, target)</span><br><span class=\"line\">        loss.backward()</span><br><span class=\"line\">        optimizer.step()</span><br><span class=\"line\">        <span class=\"keyword\">if</span> batch_idx % log_interval == <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Train Epoch: &#123;&#125; [&#123;&#125;/&#123;&#125; (&#123;:.0f&#125;%)]\\tLoss: &#123;:.6f&#125;&#x27;</span>.<span class=\"built_in\">format</span>(</span><br><span class=\"line\">                epoch + <span class=\"number\">1</span>, batch_idx * <span class=\"built_in\">len</span>(data), <span class=\"built_in\">len</span>(train_loader.dataset),</span><br><span class=\"line\">                <span class=\"number\">100.</span> * batch_idx / <span class=\"built_in\">len</span>(train_loader), loss.item()))</span><br><span class=\"line\">            train_losses.append(loss.item())</span><br><span class=\"line\">            train_counter.append((batch_idx * <span class=\"number\">64</span>) +</span><br><span class=\"line\">                                 (epoch * <span class=\"built_in\">len</span>(train_loader.dataset)))</span><br><span class=\"line\">            torch.save(network.state_dict(), <span class=\"string\">&#x27;./_data_set/MNIST/model.pth&#x27;</span>)</span><br><span class=\"line\">            torch.save(optimizer.state_dict(),</span><br><span class=\"line\">                       <span class=\"string\">&#x27;./_data_set/MNIST/optimizer.pth&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">test</span>():</span><br><span class=\"line\">    network.<span class=\"built_in\">eval</span>()</span><br><span class=\"line\">    test_loss = <span class=\"number\">0</span></span><br><span class=\"line\">    correct = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"comment\"># 测试集不需要反向传播，所以使用 torch.no_grad() 方法关闭计算图</span></span><br><span class=\"line\">    <span class=\"keyword\">with</span> torch.no_grad():</span><br><span class=\"line\">        <span class=\"keyword\">for</span> data, target <span class=\"keyword\">in</span> test_loader:</span><br><span class=\"line\">            output = network(data)</span><br><span class=\"line\">            test_loss += F.nll_loss(output, target, reduction=<span class=\"string\">&#x27;sum&#x27;</span>).item()</span><br><span class=\"line\">            pred = output.data.<span class=\"built_in\">max</span>(<span class=\"number\">1</span>, keepdim=<span class=\"literal\">True</span>)[<span class=\"number\">1</span>]</span><br><span class=\"line\">            correct += pred.eq(target.data.view_as(pred)).<span class=\"built_in\">sum</span>()</span><br><span class=\"line\">    test_loss /= <span class=\"built_in\">len</span>(test_loader.dataset)</span><br><span class=\"line\">    test_losses.append(test_loss)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\nTest set: Avg. loss: &#123;:.4f&#125;, Accuracy: &#123;&#125;/&#123;&#125; (&#123;:.0f&#125;%)\\n&#x27;</span>.<span class=\"built_in\">format</span>(</span><br><span class=\"line\">        test_loss, correct, <span class=\"built_in\">len</span>(test_loader.dataset),</span><br><span class=\"line\">        <span class=\"number\">100.</span> * correct / <span class=\"built_in\">len</span>(test_loader.dataset)))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    <span class=\"comment\"># train(0)</span></span><br><span class=\"line\">    <span class=\"comment\"># 不加这个，后面画图就会报错：x and y must be the same size</span></span><br><span class=\"line\">    test()</span><br><span class=\"line\">    <span class=\"keyword\">for</span> epoch <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(n_epochs):</span><br><span class=\"line\">        train(epoch)</span><br><span class=\"line\">        test()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>C:\\Users\\Administrator\\AppData\\Local\\Temp\\ipykernel_18752\\2337744027.py:29: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.\n  return F.log_softmax(x)\n\n\nTrain Epoch: 1 [0/60000 (0%)]\tLoss: 2.306355\nTrain Epoch: 1 [640/60000 (1%)]\tLoss: 2.309732\nTrain Epoch: 1 [1280/60000 (2%)]\tLoss: 2.263060\nTrain Epoch: 1 [1920/60000 (3%)]\tLoss: 2.253021\nTrain Epoch: 1 [2560/60000 (4%)]\tLoss: 2.239486\nTrain Epoch: 1 [3200/60000 (5%)]\tLoss: 2.232780\nTrain Epoch: 1 [3840/60000 (6%)]\tLoss: 2.223558\nTrain Epoch: 1 [4480/60000 (7%)]\tLoss: 2.174626\nTrain Epoch: 1 [5120/60000 (9%)]\tLoss: 2.122881\nTrain Epoch: 1 [5760/60000 (10%)]\tLoss: 2.025848\nTrain Epoch: 1 [6400/60000 (11%)]\tLoss: 1.923471\nTrain Epoch: 1 [7040/60000 (12%)]\tLoss: 1.832063\nTrain Epoch: 1 [7680/60000 (13%)]\tLoss: 1.906025\nTrain Epoch: 1 [8320/60000 (14%)]\tLoss: 1.673950\nTrain Epoch: 1 [8960/60000 (15%)]\tLoss: 1.537203\nTrain Epoch: 1 [9600/60000 (16%)]\tLoss: 1.439621\nTrain Epoch: 1 [10240/60000 (17%)]\tLoss: 1.275429\nTrain Epoch: 1 [10880/60000 (18%)]\tLoss: 1.183242\nTrain Epoch: 1 [11520/60000 (19%)]\tLoss: 1.182200\nTrain Epoch: 1 [12160/60000 (20%)]\tLoss: 1.154036\nTrain Epoch: 1 [12800/60000 (21%)]\tLoss: 0.921464\nTrain Epoch: 1 [13440/60000 (22%)]\tLoss: 0.877538\nTrain Epoch: 1 [14080/60000 (23%)]\tLoss: 0.917646\nTrain Epoch: 1 [14720/60000 (25%)]\tLoss: 0.928683\nTrain Epoch: 1 [15360/60000 (26%)]\tLoss: 0.883320\nTrain Epoch: 1 [16000/60000 (27%)]\tLoss: 0.829271\nTrain Epoch: 1 [16640/60000 (28%)]\tLoss: 0.843372\nTrain Epoch: 1 [17280/60000 (29%)]\tLoss: 0.962177\nTrain Epoch: 1 [17920/60000 (30%)]\tLoss: 0.816695\nTrain Epoch: 1 [18560/60000 (31%)]\tLoss: 0.803838\nTrain Epoch: 1 [19200/60000 (32%)]\tLoss: 0.706732\nTrain Epoch: 1 [19840/60000 (33%)]\tLoss: 0.697531\nTrain Epoch: 1 [20480/60000 (34%)]\tLoss: 0.748919\nTrain Epoch: 1 [21120/60000 (35%)]\tLoss: 0.599384\nTrain Epoch: 1 [21760/60000 (36%)]\tLoss: 0.873525\nTrain Epoch: 1 [22400/60000 (37%)]\tLoss: 0.730187\nTrain Epoch: 1 [23040/60000 (38%)]\tLoss: 0.780188\nTrain Epoch: 1 [23680/60000 (39%)]\tLoss: 0.688149\nTrain Epoch: 1 [24320/60000 (41%)]\tLoss: 0.578381\nTrain Epoch: 1 [24960/60000 (42%)]\tLoss: 0.679022\nTrain Epoch: 1 [25600/60000 (43%)]\tLoss: 0.597318\nTrain Epoch: 1 [26240/60000 (44%)]\tLoss: 0.885319\nTrain Epoch: 1 [26880/60000 (45%)]\tLoss: 0.586243\nTrain Epoch: 1 [27520/60000 (46%)]\tLoss: 0.832649\nTrain Epoch: 1 [28160/60000 (47%)]\tLoss: 0.541850\nTrain Epoch: 1 [28800/60000 (48%)]\tLoss: 0.997807\nTrain Epoch: 1 [29440/60000 (49%)]\tLoss: 0.680030\nTrain Epoch: 1 [30080/60000 (50%)]\tLoss: 0.546325\nTrain Epoch: 1 [30720/60000 (51%)]\tLoss: 0.812084\nTrain Epoch: 1 [31360/60000 (52%)]\tLoss: 0.659495\nTrain Epoch: 1 [32000/60000 (53%)]\tLoss: 0.880883\nTrain Epoch: 1 [32640/60000 (54%)]\tLoss: 0.788217\nTrain Epoch: 1 [33280/60000 (55%)]\tLoss: 0.810931\nTrain Epoch: 1 [33920/60000 (57%)]\tLoss: 0.572216\nTrain Epoch: 1 [34560/60000 (58%)]\tLoss: 0.481873\nTrain Epoch: 1 [35200/60000 (59%)]\tLoss: 0.502513\nTrain Epoch: 1 [35840/60000 (60%)]\tLoss: 0.410055\nTrain Epoch: 1 [36480/60000 (61%)]\tLoss: 0.489813\nTrain Epoch: 1 [37120/60000 (62%)]\tLoss: 0.507667\nTrain Epoch: 1 [37760/60000 (63%)]\tLoss: 0.497175\nTrain Epoch: 1 [38400/60000 (64%)]\tLoss: 0.433524\nTrain Epoch: 1 [39040/60000 (65%)]\tLoss: 0.448550\nTrain Epoch: 1 [39680/60000 (66%)]\tLoss: 0.451818\nTrain Epoch: 1 [40320/60000 (67%)]\tLoss: 0.501129\nTrain Epoch: 1 [40960/60000 (68%)]\tLoss: 0.605211\nTrain Epoch: 1 [41600/60000 (69%)]\tLoss: 0.332027\nTrain Epoch: 1 [42240/60000 (70%)]\tLoss: 0.483988\nTrain Epoch: 1 [42880/60000 (71%)]\tLoss: 0.887791\nTrain Epoch: 1 [43520/60000 (72%)]\tLoss: 0.273152\nTrain Epoch: 1 [44160/60000 (74%)]\tLoss: 0.590317\nTrain Epoch: 1 [44800/60000 (75%)]\tLoss: 0.459316\nTrain Epoch: 1 [45440/60000 (76%)]\tLoss: 0.492083\nTrain Epoch: 1 [46080/60000 (77%)]\tLoss: 0.477218\nTrain Epoch: 1 [46720/60000 (78%)]\tLoss: 0.421333\nTrain Epoch: 1 [47360/60000 (79%)]\tLoss: 0.576612\nTrain Epoch: 1 [48000/60000 (80%)]\tLoss: 0.359032\nTrain Epoch: 1 [48640/60000 (81%)]\tLoss: 0.434221\nTrain Epoch: 1 [49280/60000 (82%)]\tLoss: 0.506898\nTrain Epoch: 1 [49920/60000 (83%)]\tLoss: 0.342816\nTrain Epoch: 1 [50560/60000 (84%)]\tLoss: 0.287471\nTrain Epoch: 1 [51200/60000 (85%)]\tLoss: 0.250604\nTrain Epoch: 1 [51840/60000 (86%)]\tLoss: 0.386828\nTrain Epoch: 1 [52480/60000 (87%)]\tLoss: 0.331759\nTrain Epoch: 1 [53120/60000 (88%)]\tLoss: 0.388772\nTrain Epoch: 1 [53760/60000 (90%)]\tLoss: 0.509017\nTrain Epoch: 1 [54400/60000 (91%)]\tLoss: 0.517717\nTrain Epoch: 1 [55040/60000 (92%)]\tLoss: 0.393285\nTrain Epoch: 1 [55680/60000 (93%)]\tLoss: 0.341990\nTrain Epoch: 1 [56320/60000 (94%)]\tLoss: 0.434098\nTrain Epoch: 1 [56960/60000 (95%)]\tLoss: 0.342924\nTrain Epoch: 1 [57600/60000 (96%)]\tLoss: 0.617892\nTrain Epoch: 1 [58240/60000 (97%)]\tLoss: 0.488426\nTrain Epoch: 1 [58880/60000 (98%)]\tLoss: 0.356584\nTrain Epoch: 1 [59520/60000 (99%)]\tLoss: 0.548745\n\nTest set: Avg. loss: 0.1674, Accuracy: 9512/10000 (95%)\n\nTrain Epoch: 2 [0/60000 (0%)]\tLoss: 0.315766\nTrain Epoch: 2 [640/60000 (1%)]\tLoss: 0.468051\nTrain Epoch: 2 [1280/60000 (2%)]\tLoss: 0.464737\nTrain Epoch: 2 [1920/60000 (3%)]\tLoss: 0.357223\nTrain Epoch: 2 [2560/60000 (4%)]\tLoss: 0.317739\nTrain Epoch: 2 [3200/60000 (5%)]\tLoss: 0.684018\nTrain Epoch: 2 [3840/60000 (6%)]\tLoss: 0.464855\nTrain Epoch: 2 [4480/60000 (7%)]\tLoss: 0.420857\nTrain Epoch: 2 [5120/60000 (9%)]\tLoss: 0.508732\nTrain Epoch: 2 [5760/60000 (10%)]\tLoss: 0.318191\nTrain Epoch: 2 [6400/60000 (11%)]\tLoss: 0.346217\nTrain Epoch: 2 [7040/60000 (12%)]\tLoss: 0.559674\nTrain Epoch: 2 [7680/60000 (13%)]\tLoss: 0.409686\nTrain Epoch: 2 [8320/60000 (14%)]\tLoss: 0.535685\nTrain Epoch: 2 [8960/60000 (15%)]\tLoss: 0.480220\nTrain Epoch: 2 [9600/60000 (16%)]\tLoss: 0.519283\nTrain Epoch: 2 [10240/60000 (17%)]\tLoss: 0.329807\nTrain Epoch: 2 [10880/60000 (18%)]\tLoss: 0.393071\nTrain Epoch: 2 [11520/60000 (19%)]\tLoss: 0.444064\nTrain Epoch: 2 [12160/60000 (20%)]\tLoss: 0.533698\nTrain Epoch: 2 [12800/60000 (21%)]\tLoss: 0.511128\nTrain Epoch: 2 [13440/60000 (22%)]\tLoss: 0.346371\nTrain Epoch: 2 [14080/60000 (23%)]\tLoss: 0.307755\nTrain Epoch: 2 [14720/60000 (25%)]\tLoss: 0.536841\nTrain Epoch: 2 [15360/60000 (26%)]\tLoss: 0.310219\nTrain Epoch: 2 [16000/60000 (27%)]\tLoss: 0.493684\nTrain Epoch: 2 [16640/60000 (28%)]\tLoss: 0.395575\nTrain Epoch: 2 [17280/60000 (29%)]\tLoss: 0.252499\nTrain Epoch: 2 [17920/60000 (30%)]\tLoss: 0.238181\nTrain Epoch: 2 [18560/60000 (31%)]\tLoss: 0.323044\nTrain Epoch: 2 [19200/60000 (32%)]\tLoss: 0.421634\nTrain Epoch: 2 [19840/60000 (33%)]\tLoss: 0.409919\nTrain Epoch: 2 [20480/60000 (34%)]\tLoss: 0.325331\nTrain Epoch: 2 [21120/60000 (35%)]\tLoss: 0.396984\nTrain Epoch: 2 [21760/60000 (36%)]\tLoss: 0.395612\nTrain Epoch: 2 [22400/60000 (37%)]\tLoss: 0.378807\nTrain Epoch: 2 [23040/60000 (38%)]\tLoss: 0.368943\nTrain Epoch: 2 [23680/60000 (39%)]\tLoss: 0.525262\nTrain Epoch: 2 [24320/60000 (41%)]\tLoss: 0.227805\nTrain Epoch: 2 [24960/60000 (42%)]\tLoss: 0.278575\nTrain Epoch: 2 [25600/60000 (43%)]\tLoss: 0.404145\nTrain Epoch: 2 [26240/60000 (44%)]\tLoss: 0.467817\nTrain Epoch: 2 [26880/60000 (45%)]\tLoss: 0.279880\nTrain Epoch: 2 [27520/60000 (46%)]\tLoss: 0.539638\nTrain Epoch: 2 [28160/60000 (47%)]\tLoss: 0.257472\nTrain Epoch: 2 [28800/60000 (48%)]\tLoss: 0.220950\nTrain Epoch: 2 [29440/60000 (49%)]\tLoss: 0.448459\nTrain Epoch: 2 [30080/60000 (50%)]\tLoss: 0.280728\nTrain Epoch: 2 [30720/60000 (51%)]\tLoss: 0.321694\nTrain Epoch: 2 [31360/60000 (52%)]\tLoss: 0.234594\nTrain Epoch: 2 [32000/60000 (53%)]\tLoss: 0.249877\nTrain Epoch: 2 [32640/60000 (54%)]\tLoss: 0.443569\nTrain Epoch: 2 [33280/60000 (55%)]\tLoss: 0.358985\nTrain Epoch: 2 [33920/60000 (57%)]\tLoss: 0.350358\nTrain Epoch: 2 [34560/60000 (58%)]\tLoss: 0.240932\nTrain Epoch: 2 [35200/60000 (59%)]\tLoss: 0.400578\nTrain Epoch: 2 [35840/60000 (60%)]\tLoss: 0.451478\nTrain Epoch: 2 [36480/60000 (61%)]\tLoss: 0.366277\nTrain Epoch: 2 [37120/60000 (62%)]\tLoss: 0.464619\nTrain Epoch: 2 [37760/60000 (63%)]\tLoss: 0.219236\nTrain Epoch: 2 [38400/60000 (64%)]\tLoss: 0.310383\nTrain Epoch: 2 [39040/60000 (65%)]\tLoss: 0.318048\nTrain Epoch: 2 [39680/60000 (66%)]\tLoss: 0.598020\nTrain Epoch: 2 [40320/60000 (67%)]\tLoss: 0.248990\nTrain Epoch: 2 [40960/60000 (68%)]\tLoss: 0.153452\nTrain Epoch: 2 [41600/60000 (69%)]\tLoss: 0.155354\nTrain Epoch: 2 [42240/60000 (70%)]\tLoss: 0.249885\nTrain Epoch: 2 [42880/60000 (71%)]\tLoss: 0.198647\nTrain Epoch: 2 [43520/60000 (72%)]\tLoss: 0.394697\nTrain Epoch: 2 [44160/60000 (74%)]\tLoss: 0.450222\nTrain Epoch: 2 [44800/60000 (75%)]\tLoss: 0.202541\nTrain Epoch: 2 [45440/60000 (76%)]\tLoss: 0.268529\nTrain Epoch: 2 [46080/60000 (77%)]\tLoss: 0.348173\nTrain Epoch: 2 [46720/60000 (78%)]\tLoss: 0.359101\nTrain Epoch: 2 [47360/60000 (79%)]\tLoss: 0.522160\nTrain Epoch: 2 [48000/60000 (80%)]\tLoss: 0.488034\nTrain Epoch: 2 [48640/60000 (81%)]\tLoss: 0.350620\nTrain Epoch: 2 [49280/60000 (82%)]\tLoss: 0.523037\nTrain Epoch: 2 [49920/60000 (83%)]\tLoss: 0.124925\nTrain Epoch: 2 [50560/60000 (84%)]\tLoss: 0.299917\nTrain Epoch: 2 [51200/60000 (85%)]\tLoss: 0.302186\nTrain Epoch: 2 [51840/60000 (86%)]\tLoss: 0.323338\nTrain Epoch: 2 [52480/60000 (87%)]\tLoss: 0.256383\nTrain Epoch: 2 [53120/60000 (88%)]\tLoss: 0.313699\nTrain Epoch: 2 [53760/60000 (90%)]\tLoss: 0.442143\nTrain Epoch: 2 [54400/60000 (91%)]\tLoss: 0.234823\nTrain Epoch: 2 [55040/60000 (92%)]\tLoss: 0.356765\nTrain Epoch: 2 [55680/60000 (93%)]\tLoss: 0.425722\nTrain Epoch: 2 [56320/60000 (94%)]\tLoss: 0.260159\nTrain Epoch: 2 [56960/60000 (95%)]\tLoss: 0.307709\nTrain Epoch: 2 [57600/60000 (96%)]\tLoss: 0.368729\nTrain Epoch: 2 [58240/60000 (97%)]\tLoss: 0.554495\nTrain Epoch: 2 [58880/60000 (98%)]\tLoss: 0.151344\nTrain Epoch: 2 [59520/60000 (99%)]\tLoss: 0.332558\n\nTest set: Avg. loss: 0.1095, Accuracy: 9664/10000 (97%)\n\nTrain Epoch: 3 [0/60000 (0%)]\tLoss: 0.606901\nTrain Epoch: 3 [640/60000 (1%)]\tLoss: 0.217843\nTrain Epoch: 3 [1280/60000 (2%)]\tLoss: 0.225650\nTrain Epoch: 3 [1920/60000 (3%)]\tLoss: 0.359506\nTrain Epoch: 3 [2560/60000 (4%)]\tLoss: 0.380754\nTrain Epoch: 3 [3200/60000 (5%)]\tLoss: 0.283387\nTrain Epoch: 3 [3840/60000 (6%)]\tLoss: 0.318688\nTrain Epoch: 3 [4480/60000 (7%)]\tLoss: 0.335678\nTrain Epoch: 3 [5120/60000 (9%)]\tLoss: 0.157370\nTrain Epoch: 3 [5760/60000 (10%)]\tLoss: 0.220007\nTrain Epoch: 3 [6400/60000 (11%)]\tLoss: 0.291860\nTrain Epoch: 3 [7040/60000 (12%)]\tLoss: 0.464692\nTrain Epoch: 3 [7680/60000 (13%)]\tLoss: 0.229839\nTrain Epoch: 3 [8320/60000 (14%)]\tLoss: 0.342332\nTrain Epoch: 3 [8960/60000 (15%)]\tLoss: 0.313431\nTrain Epoch: 3 [9600/60000 (16%)]\tLoss: 0.341073\nTrain Epoch: 3 [10240/60000 (17%)]\tLoss: 0.208354\nTrain Epoch: 3 [10880/60000 (18%)]\tLoss: 0.188568\nTrain Epoch: 3 [11520/60000 (19%)]\tLoss: 0.213437\nTrain Epoch: 3 [12160/60000 (20%)]\tLoss: 0.327615\nTrain Epoch: 3 [12800/60000 (21%)]\tLoss: 0.240687\nTrain Epoch: 3 [13440/60000 (22%)]\tLoss: 0.347590\nTrain Epoch: 3 [14080/60000 (23%)]\tLoss: 0.367349\nTrain Epoch: 3 [14720/60000 (25%)]\tLoss: 0.270027\nTrain Epoch: 3 [15360/60000 (26%)]\tLoss: 0.549701\nTrain Epoch: 3 [16000/60000 (27%)]\tLoss: 0.265491\nTrain Epoch: 3 [16640/60000 (28%)]\tLoss: 0.264681\nTrain Epoch: 3 [17280/60000 (29%)]\tLoss: 0.259617\nTrain Epoch: 3 [17920/60000 (30%)]\tLoss: 0.193016\nTrain Epoch: 3 [18560/60000 (31%)]\tLoss: 0.405925\nTrain Epoch: 3 [19200/60000 (32%)]\tLoss: 0.230640\nTrain Epoch: 3 [19840/60000 (33%)]\tLoss: 0.298929\nTrain Epoch: 3 [20480/60000 (34%)]\tLoss: 0.508493\nTrain Epoch: 3 [21120/60000 (35%)]\tLoss: 0.253897\nTrain Epoch: 3 [21760/60000 (36%)]\tLoss: 0.201565\nTrain Epoch: 3 [22400/60000 (37%)]\tLoss: 0.276484\nTrain Epoch: 3 [23040/60000 (38%)]\tLoss: 0.447977\nTrain Epoch: 3 [23680/60000 (39%)]\tLoss: 0.542686\nTrain Epoch: 3 [24320/60000 (41%)]\tLoss: 0.340117\nTrain Epoch: 3 [24960/60000 (42%)]\tLoss: 0.238209\nTrain Epoch: 3 [25600/60000 (43%)]\tLoss: 0.151151\nTrain Epoch: 3 [26240/60000 (44%)]\tLoss: 0.365213\nTrain Epoch: 3 [26880/60000 (45%)]\tLoss: 0.362948\nTrain Epoch: 3 [27520/60000 (46%)]\tLoss: 0.237704\nTrain Epoch: 3 [28160/60000 (47%)]\tLoss: 0.398583\nTrain Epoch: 3 [28800/60000 (48%)]\tLoss: 0.397255\nTrain Epoch: 3 [29440/60000 (49%)]\tLoss: 0.262200\nTrain Epoch: 3 [30080/60000 (50%)]\tLoss: 0.152108\nTrain Epoch: 3 [30720/60000 (51%)]\tLoss: 0.372339\nTrain Epoch: 3 [31360/60000 (52%)]\tLoss: 0.372472\nTrain Epoch: 3 [32000/60000 (53%)]\tLoss: 0.259656\nTrain Epoch: 3 [32640/60000 (54%)]\tLoss: 0.435441\nTrain Epoch: 3 [33280/60000 (55%)]\tLoss: 0.378388\nTrain Epoch: 3 [33920/60000 (57%)]\tLoss: 0.177515\nTrain Epoch: 3 [34560/60000 (58%)]\tLoss: 0.283689\nTrain Epoch: 3 [35200/60000 (59%)]\tLoss: 0.131174\nTrain Epoch: 3 [35840/60000 (60%)]\tLoss: 0.171783\nTrain Epoch: 3 [36480/60000 (61%)]\tLoss: 0.104585\nTrain Epoch: 3 [37120/60000 (62%)]\tLoss: 0.389055\nTrain Epoch: 3 [37760/60000 (63%)]\tLoss: 0.360526\nTrain Epoch: 3 [38400/60000 (64%)]\tLoss: 0.259271\nTrain Epoch: 3 [39040/60000 (65%)]\tLoss: 0.525336\nTrain Epoch: 3 [39680/60000 (66%)]\tLoss: 0.196208\nTrain Epoch: 3 [40320/60000 (67%)]\tLoss: 0.374461\nTrain Epoch: 3 [40960/60000 (68%)]\tLoss: 0.216166\nTrain Epoch: 3 [41600/60000 (69%)]\tLoss: 0.221857\nTrain Epoch: 3 [42240/60000 (70%)]\tLoss: 0.223318\nTrain Epoch: 3 [42880/60000 (71%)]\tLoss: 0.185287\nTrain Epoch: 3 [43520/60000 (72%)]\tLoss: 0.382659\nTrain Epoch: 3 [44160/60000 (74%)]\tLoss: 0.262684\nTrain Epoch: 3 [44800/60000 (75%)]\tLoss: 0.388742\nTrain Epoch: 3 [45440/60000 (76%)]\tLoss: 0.286496\nTrain Epoch: 3 [46080/60000 (77%)]\tLoss: 0.301708\nTrain Epoch: 3 [46720/60000 (78%)]\tLoss: 0.451360\nTrain Epoch: 3 [47360/60000 (79%)]\tLoss: 0.279125\nTrain Epoch: 3 [48000/60000 (80%)]\tLoss: 0.197034\nTrain Epoch: 3 [48640/60000 (81%)]\tLoss: 0.240700\nTrain Epoch: 3 [49280/60000 (82%)]\tLoss: 0.594597\nTrain Epoch: 3 [49920/60000 (83%)]\tLoss: 0.108885\nTrain Epoch: 3 [50560/60000 (84%)]\tLoss: 0.199601\nTrain Epoch: 3 [51200/60000 (85%)]\tLoss: 0.184297\nTrain Epoch: 3 [51840/60000 (86%)]\tLoss: 0.175885\nTrain Epoch: 3 [52480/60000 (87%)]\tLoss: 0.365624\nTrain Epoch: 3 [53120/60000 (88%)]\tLoss: 0.236363\nTrain Epoch: 3 [53760/60000 (90%)]\tLoss: 0.508030\nTrain Epoch: 3 [54400/60000 (91%)]\tLoss: 0.379145\nTrain Epoch: 3 [55040/60000 (92%)]\tLoss: 0.304528\nTrain Epoch: 3 [55680/60000 (93%)]\tLoss: 0.184158\nTrain Epoch: 3 [56320/60000 (94%)]\tLoss: 0.323510\nTrain Epoch: 3 [56960/60000 (95%)]\tLoss: 0.192909\nTrain Epoch: 3 [57600/60000 (96%)]\tLoss: 0.275473\nTrain Epoch: 3 [58240/60000 (97%)]\tLoss: 0.397780\nTrain Epoch: 3 [58880/60000 (98%)]\tLoss: 0.159153\nTrain Epoch: 3 [59520/60000 (99%)]\tLoss: 0.231473\n\nTest set: Avg. loss: 0.0909, Accuracy: 9709/10000 (97%)\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">plt.figure(figsize=(<span class=\"number\">15</span>, <span class=\"number\">12</span>))</span><br><span class=\"line\">plt.plot(train_counter, train_losses, color=<span class=\"string\">&#x27;blue&#x27;</span>)</span><br><span class=\"line\">plt.scatter(test_counter, test_losses, color=<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">plt.legend([<span class=\"string\">&#x27;Train Loss&#x27;</span>, <span class=\"string\">&#x27;Test Loss&#x27;</span>], loc=<span class=\"string\">&#x27;upper right&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;number of training examples seen&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;negative log likelihood loss&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"DL_files/DL_6_0.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">continued_network = Net()</span><br><span class=\"line\">continued_optimizer = optim.SGD(network.parameters(),</span><br><span class=\"line\">                                lr=learning_rate,</span><br><span class=\"line\">                                momentum=momentum)</span><br><span class=\"line\"></span><br><span class=\"line\">network_state_dict = torch.load(<span class=\"string\">&#x27;./_data_set/MNIST/model.pth&#x27;</span>)</span><br><span class=\"line\">continued_network.load_state_dict(network_state_dict)</span><br><span class=\"line\">optimizer_state_dict = torch.load(<span class=\"string\">&#x27;./_data_set/MNIST/optimizer.pth&#x27;</span>)</span><br><span class=\"line\">continued_optimizer.load_state_dict(optimizer_state_dict)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">3</span>, <span class=\"number\">9</span>):</span><br><span class=\"line\">    train(i)</span><br><span class=\"line\">    test()</span><br><span class=\"line\">    test_counter.append(i * <span class=\"built_in\">len</span>(train_loader.dataset))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>C:\\Users\\Administrator\\AppData\\Local\\Temp\\ipykernel_18752\\2337744027.py:29: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.\n  return F.log_softmax(x)\n\n\nTrain Epoch: 4 [0/60000 (0%)]\tLoss: 0.180916\nTrain Epoch: 4 [640/60000 (1%)]\tLoss: 0.188782\nTrain Epoch: 4 [1280/60000 (2%)]\tLoss: 0.250786\nTrain Epoch: 4 [1920/60000 (3%)]\tLoss: 0.185484\nTrain Epoch: 4 [2560/60000 (4%)]\tLoss: 0.295455\nTrain Epoch: 4 [3200/60000 (5%)]\tLoss: 0.172000\nTrain Epoch: 4 [3840/60000 (6%)]\tLoss: 0.117650\nTrain Epoch: 4 [4480/60000 (7%)]\tLoss: 0.423349\nTrain Epoch: 4 [5120/60000 (9%)]\tLoss: 0.285250\nTrain Epoch: 4 [5760/60000 (10%)]\tLoss: 0.360192\nTrain Epoch: 4 [6400/60000 (11%)]\tLoss: 0.362748\nTrain Epoch: 4 [7040/60000 (12%)]\tLoss: 0.292238\nTrain Epoch: 4 [7680/60000 (13%)]\tLoss: 0.238687\nTrain Epoch: 4 [8320/60000 (14%)]\tLoss: 0.150868\nTrain Epoch: 4 [8960/60000 (15%)]\tLoss: 0.427452\nTrain Epoch: 4 [9600/60000 (16%)]\tLoss: 0.230040\nTrain Epoch: 4 [10240/60000 (17%)]\tLoss: 0.275437\nTrain Epoch: 4 [10880/60000 (18%)]\tLoss: 0.158874\nTrain Epoch: 4 [11520/60000 (19%)]\tLoss: 0.162058\nTrain Epoch: 4 [12160/60000 (20%)]\tLoss: 0.177609\nTrain Epoch: 4 [12800/60000 (21%)]\tLoss: 0.416331\nTrain Epoch: 4 [13440/60000 (22%)]\tLoss: 0.255415\nTrain Epoch: 4 [14080/60000 (23%)]\tLoss: 0.150464\nTrain Epoch: 4 [14720/60000 (25%)]\tLoss: 0.285846\nTrain Epoch: 4 [15360/60000 (26%)]\tLoss: 0.175966\nTrain Epoch: 4 [16000/60000 (27%)]\tLoss: 0.385556\nTrain Epoch: 4 [16640/60000 (28%)]\tLoss: 0.217486\nTrain Epoch: 4 [17280/60000 (29%)]\tLoss: 0.243101\nTrain Epoch: 4 [17920/60000 (30%)]\tLoss: 0.182876\nTrain Epoch: 4 [18560/60000 (31%)]\tLoss: 0.094987\nTrain Epoch: 4 [19200/60000 (32%)]\tLoss: 0.225338\nTrain Epoch: 4 [19840/60000 (33%)]\tLoss: 0.145325\nTrain Epoch: 4 [20480/60000 (34%)]\tLoss: 0.165757\nTrain Epoch: 4 [21120/60000 (35%)]\tLoss: 0.218088\nTrain Epoch: 4 [21760/60000 (36%)]\tLoss: 0.085633\nTrain Epoch: 4 [22400/60000 (37%)]\tLoss: 0.122317\nTrain Epoch: 4 [23040/60000 (38%)]\tLoss: 0.272857\nTrain Epoch: 4 [23680/60000 (39%)]\tLoss: 0.155769\nTrain Epoch: 4 [24320/60000 (41%)]\tLoss: 0.212894\nTrain Epoch: 4 [24960/60000 (42%)]\tLoss: 0.117393\nTrain Epoch: 4 [25600/60000 (43%)]\tLoss: 0.211204\nTrain Epoch: 4 [26240/60000 (44%)]\tLoss: 0.071398\nTrain Epoch: 4 [26880/60000 (45%)]\tLoss: 0.091613\nTrain Epoch: 4 [27520/60000 (46%)]\tLoss: 0.267689\nTrain Epoch: 4 [28160/60000 (47%)]\tLoss: 0.194783\nTrain Epoch: 4 [28800/60000 (48%)]\tLoss: 0.207981\nTrain Epoch: 4 [29440/60000 (49%)]\tLoss: 0.367123\nTrain Epoch: 4 [30080/60000 (50%)]\tLoss: 0.179464\nTrain Epoch: 4 [30720/60000 (51%)]\tLoss: 0.204890\nTrain Epoch: 4 [31360/60000 (52%)]\tLoss: 0.219245\nTrain Epoch: 4 [32000/60000 (53%)]\tLoss: 0.229217\nTrain Epoch: 4 [32640/60000 (54%)]\tLoss: 0.139216\nTrain Epoch: 4 [33280/60000 (55%)]\tLoss: 0.300938\nTrain Epoch: 4 [33920/60000 (57%)]\tLoss: 0.133212\nTrain Epoch: 4 [34560/60000 (58%)]\tLoss: 0.352936\nTrain Epoch: 4 [35200/60000 (59%)]\tLoss: 0.153349\nTrain Epoch: 4 [35840/60000 (60%)]\tLoss: 0.208317\nTrain Epoch: 4 [36480/60000 (61%)]\tLoss: 0.164447\nTrain Epoch: 4 [37120/60000 (62%)]\tLoss: 0.227367\nTrain Epoch: 4 [37760/60000 (63%)]\tLoss: 0.241028\nTrain Epoch: 4 [38400/60000 (64%)]\tLoss: 0.307894\nTrain Epoch: 4 [39040/60000 (65%)]\tLoss: 0.461609\nTrain Epoch: 4 [39680/60000 (66%)]\tLoss: 0.381326\nTrain Epoch: 4 [40320/60000 (67%)]\tLoss: 0.135251\nTrain Epoch: 4 [40960/60000 (68%)]\tLoss: 0.518683\nTrain Epoch: 4 [41600/60000 (69%)]\tLoss: 0.210409\nTrain Epoch: 4 [42240/60000 (70%)]\tLoss: 0.187576\nTrain Epoch: 4 [42880/60000 (71%)]\tLoss: 0.115259\nTrain Epoch: 4 [43520/60000 (72%)]\tLoss: 0.259883\nTrain Epoch: 4 [44160/60000 (74%)]\tLoss: 0.177242\nTrain Epoch: 4 [44800/60000 (75%)]\tLoss: 0.345635\nTrain Epoch: 4 [45440/60000 (76%)]\tLoss: 0.213670\nTrain Epoch: 4 [46080/60000 (77%)]\tLoss: 0.193606\nTrain Epoch: 4 [46720/60000 (78%)]\tLoss: 0.173757\nTrain Epoch: 4 [47360/60000 (79%)]\tLoss: 0.215879\nTrain Epoch: 4 [48000/60000 (80%)]\tLoss: 0.171952\nTrain Epoch: 4 [48640/60000 (81%)]\tLoss: 0.119270\nTrain Epoch: 4 [49280/60000 (82%)]\tLoss: 0.324480\nTrain Epoch: 4 [49920/60000 (83%)]\tLoss: 0.104771\nTrain Epoch: 4 [50560/60000 (84%)]\tLoss: 0.163072\nTrain Epoch: 4 [51200/60000 (85%)]\tLoss: 0.160245\nTrain Epoch: 4 [51840/60000 (86%)]\tLoss: 0.249122\nTrain Epoch: 4 [52480/60000 (87%)]\tLoss: 0.282949\nTrain Epoch: 4 [53120/60000 (88%)]\tLoss: 0.152365\nTrain Epoch: 4 [53760/60000 (90%)]\tLoss: 0.102036\nTrain Epoch: 4 [54400/60000 (91%)]\tLoss: 0.162332\nTrain Epoch: 4 [55040/60000 (92%)]\tLoss: 0.182912\nTrain Epoch: 4 [55680/60000 (93%)]\tLoss: 0.468722\nTrain Epoch: 4 [56320/60000 (94%)]\tLoss: 0.421446\nTrain Epoch: 4 [56960/60000 (95%)]\tLoss: 0.254925\nTrain Epoch: 4 [57600/60000 (96%)]\tLoss: 0.345340\nTrain Epoch: 4 [58240/60000 (97%)]\tLoss: 0.293855\nTrain Epoch: 4 [58880/60000 (98%)]\tLoss: 0.200609\nTrain Epoch: 4 [59520/60000 (99%)]\tLoss: 0.045524\n\nTest set: Avg. loss: 0.0696, Accuracy: 9772/10000 (98%)\n\nTrain Epoch: 5 [0/60000 (0%)]\tLoss: 0.270343\nTrain Epoch: 5 [640/60000 (1%)]\tLoss: 0.275511\nTrain Epoch: 5 [1280/60000 (2%)]\tLoss: 0.209185\nTrain Epoch: 5 [1920/60000 (3%)]\tLoss: 0.172124\nTrain Epoch: 5 [2560/60000 (4%)]\tLoss: 0.176122\nTrain Epoch: 5 [3200/60000 (5%)]\tLoss: 0.469673\nTrain Epoch: 5 [3840/60000 (6%)]\tLoss: 0.113855\nTrain Epoch: 5 [4480/60000 (7%)]\tLoss: 0.241289\nTrain Epoch: 5 [5120/60000 (9%)]\tLoss: 0.123443\nTrain Epoch: 5 [5760/60000 (10%)]\tLoss: 0.153661\nTrain Epoch: 5 [6400/60000 (11%)]\tLoss: 0.069777\nTrain Epoch: 5 [7040/60000 (12%)]\tLoss: 0.372212\nTrain Epoch: 5 [7680/60000 (13%)]\tLoss: 0.158761\nTrain Epoch: 5 [8320/60000 (14%)]\tLoss: 0.231457\nTrain Epoch: 5 [8960/60000 (15%)]\tLoss: 0.235761\nTrain Epoch: 5 [9600/60000 (16%)]\tLoss: 0.208866\nTrain Epoch: 5 [10240/60000 (17%)]\tLoss: 0.511828\nTrain Epoch: 5 [10880/60000 (18%)]\tLoss: 0.333603\nTrain Epoch: 5 [11520/60000 (19%)]\tLoss: 0.254337\nTrain Epoch: 5 [12160/60000 (20%)]\tLoss: 0.260536\nTrain Epoch: 5 [12800/60000 (21%)]\tLoss: 0.263866\nTrain Epoch: 5 [13440/60000 (22%)]\tLoss: 0.483610\nTrain Epoch: 5 [14080/60000 (23%)]\tLoss: 0.178215\nTrain Epoch: 5 [14720/60000 (25%)]\tLoss: 0.137731\nTrain Epoch: 5 [15360/60000 (26%)]\tLoss: 0.177714\nTrain Epoch: 5 [16000/60000 (27%)]\tLoss: 0.132543\nTrain Epoch: 5 [16640/60000 (28%)]\tLoss: 0.146177\nTrain Epoch: 5 [17280/60000 (29%)]\tLoss: 0.398970\nTrain Epoch: 5 [17920/60000 (30%)]\tLoss: 0.120811\nTrain Epoch: 5 [18560/60000 (31%)]\tLoss: 0.147756\nTrain Epoch: 5 [19200/60000 (32%)]\tLoss: 0.317457\nTrain Epoch: 5 [19840/60000 (33%)]\tLoss: 0.310727\nTrain Epoch: 5 [20480/60000 (34%)]\tLoss: 0.144468\nTrain Epoch: 5 [21120/60000 (35%)]\tLoss: 0.515887\nTrain Epoch: 5 [21760/60000 (36%)]\tLoss: 0.113731\nTrain Epoch: 5 [22400/60000 (37%)]\tLoss: 0.326223\nTrain Epoch: 5 [23040/60000 (38%)]\tLoss: 0.275539\nTrain Epoch: 5 [23680/60000 (39%)]\tLoss: 0.261113\nTrain Epoch: 5 [24320/60000 (41%)]\tLoss: 0.198070\nTrain Epoch: 5 [24960/60000 (42%)]\tLoss: 0.380463\nTrain Epoch: 5 [25600/60000 (43%)]\tLoss: 0.130256\nTrain Epoch: 5 [26240/60000 (44%)]\tLoss: 0.234225\nTrain Epoch: 5 [26880/60000 (45%)]\tLoss: 0.284392\nTrain Epoch: 5 [27520/60000 (46%)]\tLoss: 0.168175\nTrain Epoch: 5 [28160/60000 (47%)]\tLoss: 0.346845\nTrain Epoch: 5 [28800/60000 (48%)]\tLoss: 0.206521\nTrain Epoch: 5 [29440/60000 (49%)]\tLoss: 0.149305\nTrain Epoch: 5 [30080/60000 (50%)]\tLoss: 0.248684\nTrain Epoch: 5 [30720/60000 (51%)]\tLoss: 0.245173\nTrain Epoch: 5 [31360/60000 (52%)]\tLoss: 0.201854\nTrain Epoch: 5 [32000/60000 (53%)]\tLoss: 0.182244\nTrain Epoch: 5 [32640/60000 (54%)]\tLoss: 0.160925\nTrain Epoch: 5 [33280/60000 (55%)]\tLoss: 0.251155\nTrain Epoch: 5 [33920/60000 (57%)]\tLoss: 0.137573\nTrain Epoch: 5 [34560/60000 (58%)]\tLoss: 0.305431\nTrain Epoch: 5 [35200/60000 (59%)]\tLoss: 0.260936\nTrain Epoch: 5 [35840/60000 (60%)]\tLoss: 0.298855\nTrain Epoch: 5 [36480/60000 (61%)]\tLoss: 0.209435\nTrain Epoch: 5 [37120/60000 (62%)]\tLoss: 0.152100\nTrain Epoch: 5 [37760/60000 (63%)]\tLoss: 0.322987\nTrain Epoch: 5 [38400/60000 (64%)]\tLoss: 0.245070\nTrain Epoch: 5 [39040/60000 (65%)]\tLoss: 0.079185\nTrain Epoch: 5 [39680/60000 (66%)]\tLoss: 0.286104\nTrain Epoch: 5 [40320/60000 (67%)]\tLoss: 0.134519\nTrain Epoch: 5 [40960/60000 (68%)]\tLoss: 0.256614\nTrain Epoch: 5 [41600/60000 (69%)]\tLoss: 0.230492\nTrain Epoch: 5 [42240/60000 (70%)]\tLoss: 0.081532\nTrain Epoch: 5 [42880/60000 (71%)]\tLoss: 0.174270\nTrain Epoch: 5 [43520/60000 (72%)]\tLoss: 0.123896\nTrain Epoch: 5 [44160/60000 (74%)]\tLoss: 0.126517\nTrain Epoch: 5 [44800/60000 (75%)]\tLoss: 0.333949\nTrain Epoch: 5 [45440/60000 (76%)]\tLoss: 0.369903\nTrain Epoch: 5 [46080/60000 (77%)]\tLoss: 0.207948\nTrain Epoch: 5 [46720/60000 (78%)]\tLoss: 0.080965\nTrain Epoch: 5 [47360/60000 (79%)]\tLoss: 0.117344\nTrain Epoch: 5 [48000/60000 (80%)]\tLoss: 0.419863\nTrain Epoch: 5 [48640/60000 (81%)]\tLoss: 0.265613\nTrain Epoch: 5 [49280/60000 (82%)]\tLoss: 0.256468\nTrain Epoch: 5 [49920/60000 (83%)]\tLoss: 0.509733\nTrain Epoch: 5 [50560/60000 (84%)]\tLoss: 0.144000\nTrain Epoch: 5 [51200/60000 (85%)]\tLoss: 0.174094\nTrain Epoch: 5 [51840/60000 (86%)]\tLoss: 0.335760\nTrain Epoch: 5 [52480/60000 (87%)]\tLoss: 0.363208\nTrain Epoch: 5 [53120/60000 (88%)]\tLoss: 0.199396\nTrain Epoch: 5 [53760/60000 (90%)]\tLoss: 0.276358\nTrain Epoch: 5 [54400/60000 (91%)]\tLoss: 0.063482\nTrain Epoch: 5 [55040/60000 (92%)]\tLoss: 0.107777\nTrain Epoch: 5 [55680/60000 (93%)]\tLoss: 0.273694\nTrain Epoch: 5 [56320/60000 (94%)]\tLoss: 0.111036\nTrain Epoch: 5 [56960/60000 (95%)]\tLoss: 0.242194\nTrain Epoch: 5 [57600/60000 (96%)]\tLoss: 0.192879\nTrain Epoch: 5 [58240/60000 (97%)]\tLoss: 0.140068\nTrain Epoch: 5 [58880/60000 (98%)]\tLoss: 0.053538\nTrain Epoch: 5 [59520/60000 (99%)]\tLoss: 0.282342\n\nTest set: Avg. loss: 0.0648, Accuracy: 9794/10000 (98%)\n\nTrain Epoch: 6 [0/60000 (0%)]\tLoss: 0.157271\nTrain Epoch: 6 [640/60000 (1%)]\tLoss: 0.125083\nTrain Epoch: 6 [1280/60000 (2%)]\tLoss: 0.324760\nTrain Epoch: 6 [1920/60000 (3%)]\tLoss: 0.233483\nTrain Epoch: 6 [2560/60000 (4%)]\tLoss: 0.305379\nTrain Epoch: 6 [3200/60000 (5%)]\tLoss: 0.133055\nTrain Epoch: 6 [3840/60000 (6%)]\tLoss: 0.308374\nTrain Epoch: 6 [4480/60000 (7%)]\tLoss: 0.361411\nTrain Epoch: 6 [5120/60000 (9%)]\tLoss: 0.263687\nTrain Epoch: 6 [5760/60000 (10%)]\tLoss: 0.136558\nTrain Epoch: 6 [6400/60000 (11%)]\tLoss: 0.187681\nTrain Epoch: 6 [7040/60000 (12%)]\tLoss: 0.249220\nTrain Epoch: 6 [7680/60000 (13%)]\tLoss: 0.206636\nTrain Epoch: 6 [8320/60000 (14%)]\tLoss: 0.151353\nTrain Epoch: 6 [8960/60000 (15%)]\tLoss: 0.195330\nTrain Epoch: 6 [9600/60000 (16%)]\tLoss: 0.361656\nTrain Epoch: 6 [10240/60000 (17%)]\tLoss: 0.366321\nTrain Epoch: 6 [10880/60000 (18%)]\tLoss: 0.166131\nTrain Epoch: 6 [11520/60000 (19%)]\tLoss: 0.075402\nTrain Epoch: 6 [12160/60000 (20%)]\tLoss: 0.151120\nTrain Epoch: 6 [12800/60000 (21%)]\tLoss: 0.115874\nTrain Epoch: 6 [13440/60000 (22%)]\tLoss: 0.144778\nTrain Epoch: 6 [14080/60000 (23%)]\tLoss: 0.063986\nTrain Epoch: 6 [14720/60000 (25%)]\tLoss: 0.174532\nTrain Epoch: 6 [15360/60000 (26%)]\tLoss: 0.261803\nTrain Epoch: 6 [16000/60000 (27%)]\tLoss: 0.251123\nTrain Epoch: 6 [16640/60000 (28%)]\tLoss: 0.145080\nTrain Epoch: 6 [17280/60000 (29%)]\tLoss: 0.354523\nTrain Epoch: 6 [17920/60000 (30%)]\tLoss: 0.187603\nTrain Epoch: 6 [18560/60000 (31%)]\tLoss: 0.082521\nTrain Epoch: 6 [19200/60000 (32%)]\tLoss: 0.154904\nTrain Epoch: 6 [19840/60000 (33%)]\tLoss: 0.165881\nTrain Epoch: 6 [20480/60000 (34%)]\tLoss: 0.115822\nTrain Epoch: 6 [21120/60000 (35%)]\tLoss: 0.603689\nTrain Epoch: 6 [21760/60000 (36%)]\tLoss: 0.164415\nTrain Epoch: 6 [22400/60000 (37%)]\tLoss: 0.107442\nTrain Epoch: 6 [23040/60000 (38%)]\tLoss: 0.196783\nTrain Epoch: 6 [23680/60000 (39%)]\tLoss: 0.220013\nTrain Epoch: 6 [24320/60000 (41%)]\tLoss: 0.207349\nTrain Epoch: 6 [24960/60000 (42%)]\tLoss: 0.178466\nTrain Epoch: 6 [25600/60000 (43%)]\tLoss: 0.149325\nTrain Epoch: 6 [26240/60000 (44%)]\tLoss: 0.169802\nTrain Epoch: 6 [26880/60000 (45%)]\tLoss: 0.205438\nTrain Epoch: 6 [27520/60000 (46%)]\tLoss: 0.121831\nTrain Epoch: 6 [28160/60000 (47%)]\tLoss: 0.169774\nTrain Epoch: 6 [28800/60000 (48%)]\tLoss: 0.138925\nTrain Epoch: 6 [29440/60000 (49%)]\tLoss: 0.183873\nTrain Epoch: 6 [30080/60000 (50%)]\tLoss: 0.108401\nTrain Epoch: 6 [30720/60000 (51%)]\tLoss: 0.087508\nTrain Epoch: 6 [31360/60000 (52%)]\tLoss: 0.114378\nTrain Epoch: 6 [32000/60000 (53%)]\tLoss: 0.124145\nTrain Epoch: 6 [32640/60000 (54%)]\tLoss: 0.368228\nTrain Epoch: 6 [33280/60000 (55%)]\tLoss: 0.353432\nTrain Epoch: 6 [33920/60000 (57%)]\tLoss: 0.239896\nTrain Epoch: 6 [34560/60000 (58%)]\tLoss: 0.341117\nTrain Epoch: 6 [35200/60000 (59%)]\tLoss: 0.280842\nTrain Epoch: 6 [35840/60000 (60%)]\tLoss: 0.303140\nTrain Epoch: 6 [36480/60000 (61%)]\tLoss: 0.340119\nTrain Epoch: 6 [37120/60000 (62%)]\tLoss: 0.165236\nTrain Epoch: 6 [37760/60000 (63%)]\tLoss: 0.113621\nTrain Epoch: 6 [38400/60000 (64%)]\tLoss: 0.313772\nTrain Epoch: 6 [39040/60000 (65%)]\tLoss: 0.258854\nTrain Epoch: 6 [39680/60000 (66%)]\tLoss: 0.158878\nTrain Epoch: 6 [40320/60000 (67%)]\tLoss: 0.160731\nTrain Epoch: 6 [40960/60000 (68%)]\tLoss: 0.166837\nTrain Epoch: 6 [41600/60000 (69%)]\tLoss: 0.226772\nTrain Epoch: 6 [42240/60000 (70%)]\tLoss: 0.160613\nTrain Epoch: 6 [42880/60000 (71%)]\tLoss: 0.157473\nTrain Epoch: 6 [43520/60000 (72%)]\tLoss: 0.279009\nTrain Epoch: 6 [44160/60000 (74%)]\tLoss: 0.157638\nTrain Epoch: 6 [44800/60000 (75%)]\tLoss: 0.202747\nTrain Epoch: 6 [45440/60000 (76%)]\tLoss: 0.123593\nTrain Epoch: 6 [46080/60000 (77%)]\tLoss: 0.164986\nTrain Epoch: 6 [46720/60000 (78%)]\tLoss: 0.285264\nTrain Epoch: 6 [47360/60000 (79%)]\tLoss: 0.211086\nTrain Epoch: 6 [48000/60000 (80%)]\tLoss: 0.125422\nTrain Epoch: 6 [48640/60000 (81%)]\tLoss: 0.076380\nTrain Epoch: 6 [49280/60000 (82%)]\tLoss: 0.274299\nTrain Epoch: 6 [49920/60000 (83%)]\tLoss: 0.128968\nTrain Epoch: 6 [50560/60000 (84%)]\tLoss: 0.100312\nTrain Epoch: 6 [51200/60000 (85%)]\tLoss: 0.173260\nTrain Epoch: 6 [51840/60000 (86%)]\tLoss: 0.375576\nTrain Epoch: 6 [52480/60000 (87%)]\tLoss: 0.359121\nTrain Epoch: 6 [53120/60000 (88%)]\tLoss: 0.137199\nTrain Epoch: 6 [53760/60000 (90%)]\tLoss: 0.280192\nTrain Epoch: 6 [54400/60000 (91%)]\tLoss: 0.345643\nTrain Epoch: 6 [55040/60000 (92%)]\tLoss: 0.213638\nTrain Epoch: 6 [55680/60000 (93%)]\tLoss: 0.142949\nTrain Epoch: 6 [56320/60000 (94%)]\tLoss: 0.188716\nTrain Epoch: 6 [56960/60000 (95%)]\tLoss: 0.067698\nTrain Epoch: 6 [57600/60000 (96%)]\tLoss: 0.227284\nTrain Epoch: 6 [58240/60000 (97%)]\tLoss: 0.141719\nTrain Epoch: 6 [58880/60000 (98%)]\tLoss: 0.166098\nTrain Epoch: 6 [59520/60000 (99%)]\tLoss: 0.251494\n\nTest set: Avg. loss: 0.0615, Accuracy: 9814/10000 (98%)\n\nTrain Epoch: 7 [0/60000 (0%)]\tLoss: 0.091176\nTrain Epoch: 7 [640/60000 (1%)]\tLoss: 0.269873\nTrain Epoch: 7 [1280/60000 (2%)]\tLoss: 0.132484\nTrain Epoch: 7 [1920/60000 (3%)]\tLoss: 0.181744\nTrain Epoch: 7 [2560/60000 (4%)]\tLoss: 0.119089\nTrain Epoch: 7 [3200/60000 (5%)]\tLoss: 0.172001\nTrain Epoch: 7 [3840/60000 (6%)]\tLoss: 0.288416\nTrain Epoch: 7 [4480/60000 (7%)]\tLoss: 0.282734\nTrain Epoch: 7 [5120/60000 (9%)]\tLoss: 0.274102\nTrain Epoch: 7 [5760/60000 (10%)]\tLoss: 0.224655\nTrain Epoch: 7 [6400/60000 (11%)]\tLoss: 0.227839\nTrain Epoch: 7 [7040/60000 (12%)]\tLoss: 0.202125\nTrain Epoch: 7 [7680/60000 (13%)]\tLoss: 0.176258\nTrain Epoch: 7 [8320/60000 (14%)]\tLoss: 0.198535\nTrain Epoch: 7 [8960/60000 (15%)]\tLoss: 0.119568\nTrain Epoch: 7 [9600/60000 (16%)]\tLoss: 0.204526\nTrain Epoch: 7 [10240/60000 (17%)]\tLoss: 0.259647\nTrain Epoch: 7 [10880/60000 (18%)]\tLoss: 0.216371\nTrain Epoch: 7 [11520/60000 (19%)]\tLoss: 0.098282\nTrain Epoch: 7 [12160/60000 (20%)]\tLoss: 0.156163\nTrain Epoch: 7 [12800/60000 (21%)]\tLoss: 0.194898\nTrain Epoch: 7 [13440/60000 (22%)]\tLoss: 0.172166\nTrain Epoch: 7 [14080/60000 (23%)]\tLoss: 0.231052\nTrain Epoch: 7 [14720/60000 (25%)]\tLoss: 0.135253\nTrain Epoch: 7 [15360/60000 (26%)]\tLoss: 0.144452\nTrain Epoch: 7 [16000/60000 (27%)]\tLoss: 0.162540\nTrain Epoch: 7 [16640/60000 (28%)]\tLoss: 0.136042\nTrain Epoch: 7 [17280/60000 (29%)]\tLoss: 0.236265\nTrain Epoch: 7 [17920/60000 (30%)]\tLoss: 0.208569\nTrain Epoch: 7 [18560/60000 (31%)]\tLoss: 0.158493\nTrain Epoch: 7 [19200/60000 (32%)]\tLoss: 0.161767\nTrain Epoch: 7 [19840/60000 (33%)]\tLoss: 0.066611\nTrain Epoch: 7 [20480/60000 (34%)]\tLoss: 0.322254\nTrain Epoch: 7 [21120/60000 (35%)]\tLoss: 0.233296\nTrain Epoch: 7 [21760/60000 (36%)]\tLoss: 0.086176\nTrain Epoch: 7 [22400/60000 (37%)]\tLoss: 0.125919\nTrain Epoch: 7 [23040/60000 (38%)]\tLoss: 0.148241\nTrain Epoch: 7 [23680/60000 (39%)]\tLoss: 0.108953\nTrain Epoch: 7 [24320/60000 (41%)]\tLoss: 0.223288\nTrain Epoch: 7 [24960/60000 (42%)]\tLoss: 0.243924\nTrain Epoch: 7 [25600/60000 (43%)]\tLoss: 0.224430\nTrain Epoch: 7 [26240/60000 (44%)]\tLoss: 0.230509\nTrain Epoch: 7 [26880/60000 (45%)]\tLoss: 0.326988\nTrain Epoch: 7 [27520/60000 (46%)]\tLoss: 0.229315\nTrain Epoch: 7 [28160/60000 (47%)]\tLoss: 0.315817\nTrain Epoch: 7 [28800/60000 (48%)]\tLoss: 0.137005\nTrain Epoch: 7 [29440/60000 (49%)]\tLoss: 0.116640\nTrain Epoch: 7 [30080/60000 (50%)]\tLoss: 0.167090\nTrain Epoch: 7 [30720/60000 (51%)]\tLoss: 0.173242\nTrain Epoch: 7 [31360/60000 (52%)]\tLoss: 0.191092\nTrain Epoch: 7 [32000/60000 (53%)]\tLoss: 0.134305\nTrain Epoch: 7 [32640/60000 (54%)]\tLoss: 0.138862\nTrain Epoch: 7 [33280/60000 (55%)]\tLoss: 0.125831\nTrain Epoch: 7 [33920/60000 (57%)]\tLoss: 0.129372\nTrain Epoch: 7 [34560/60000 (58%)]\tLoss: 0.120971\nTrain Epoch: 7 [35200/60000 (59%)]\tLoss: 0.268926\nTrain Epoch: 7 [35840/60000 (60%)]\tLoss: 0.170120\nTrain Epoch: 7 [36480/60000 (61%)]\tLoss: 0.455412\nTrain Epoch: 7 [37120/60000 (62%)]\tLoss: 0.182606\nTrain Epoch: 7 [37760/60000 (63%)]\tLoss: 0.085986\nTrain Epoch: 7 [38400/60000 (64%)]\tLoss: 0.229982\nTrain Epoch: 7 [39040/60000 (65%)]\tLoss: 0.165970\nTrain Epoch: 7 [39680/60000 (66%)]\tLoss: 0.125090\nTrain Epoch: 7 [40320/60000 (67%)]\tLoss: 0.149905\nTrain Epoch: 7 [40960/60000 (68%)]\tLoss: 0.382724\nTrain Epoch: 7 [41600/60000 (69%)]\tLoss: 0.155642\nTrain Epoch: 7 [42240/60000 (70%)]\tLoss: 0.059763\nTrain Epoch: 7 [42880/60000 (71%)]\tLoss: 0.305220\nTrain Epoch: 7 [43520/60000 (72%)]\tLoss: 0.209007\nTrain Epoch: 7 [44160/60000 (74%)]\tLoss: 0.309034\nTrain Epoch: 7 [44800/60000 (75%)]\tLoss: 0.049236\nTrain Epoch: 7 [45440/60000 (76%)]\tLoss: 0.305584\nTrain Epoch: 7 [46080/60000 (77%)]\tLoss: 0.187595\nTrain Epoch: 7 [46720/60000 (78%)]\tLoss: 0.117563\nTrain Epoch: 7 [47360/60000 (79%)]\tLoss: 0.147911\nTrain Epoch: 7 [48000/60000 (80%)]\tLoss: 0.233994\nTrain Epoch: 7 [48640/60000 (81%)]\tLoss: 0.198659\nTrain Epoch: 7 [49280/60000 (82%)]\tLoss: 0.302784\nTrain Epoch: 7 [49920/60000 (83%)]\tLoss: 0.204405\nTrain Epoch: 7 [50560/60000 (84%)]\tLoss: 0.053611\nTrain Epoch: 7 [51200/60000 (85%)]\tLoss: 0.635807\nTrain Epoch: 7 [51840/60000 (86%)]\tLoss: 0.101712\nTrain Epoch: 7 [52480/60000 (87%)]\tLoss: 0.097702\nTrain Epoch: 7 [53120/60000 (88%)]\tLoss: 0.257620\nTrain Epoch: 7 [53760/60000 (90%)]\tLoss: 0.121270\nTrain Epoch: 7 [54400/60000 (91%)]\tLoss: 0.191442\nTrain Epoch: 7 [55040/60000 (92%)]\tLoss: 0.127309\nTrain Epoch: 7 [55680/60000 (93%)]\tLoss: 0.148693\nTrain Epoch: 7 [56320/60000 (94%)]\tLoss: 0.073504\nTrain Epoch: 7 [56960/60000 (95%)]\tLoss: 0.184949\nTrain Epoch: 7 [57600/60000 (96%)]\tLoss: 0.072307\nTrain Epoch: 7 [58240/60000 (97%)]\tLoss: 0.296258\nTrain Epoch: 7 [58880/60000 (98%)]\tLoss: 0.415298\nTrain Epoch: 7 [59520/60000 (99%)]\tLoss: 0.309931\n\nTest set: Avg. loss: 0.0576, Accuracy: 9823/10000 (98%)\n\nTrain Epoch: 8 [0/60000 (0%)]\tLoss: 0.411129\nTrain Epoch: 8 [640/60000 (1%)]\tLoss: 0.082472\nTrain Epoch: 8 [1280/60000 (2%)]\tLoss: 0.232263\nTrain Epoch: 8 [1920/60000 (3%)]\tLoss: 0.184606\nTrain Epoch: 8 [2560/60000 (4%)]\tLoss: 0.082728\nTrain Epoch: 8 [3200/60000 (5%)]\tLoss: 0.173117\nTrain Epoch: 8 [3840/60000 (6%)]\tLoss: 0.111649\nTrain Epoch: 8 [4480/60000 (7%)]\tLoss: 0.442360\nTrain Epoch: 8 [5120/60000 (9%)]\tLoss: 0.227383\nTrain Epoch: 8 [5760/60000 (10%)]\tLoss: 0.288936\nTrain Epoch: 8 [6400/60000 (11%)]\tLoss: 0.227669\nTrain Epoch: 8 [7040/60000 (12%)]\tLoss: 0.238741\nTrain Epoch: 8 [7680/60000 (13%)]\tLoss: 0.276109\nTrain Epoch: 8 [8320/60000 (14%)]\tLoss: 0.173926\nTrain Epoch: 8 [8960/60000 (15%)]\tLoss: 0.167442\nTrain Epoch: 8 [9600/60000 (16%)]\tLoss: 0.178728\nTrain Epoch: 8 [10240/60000 (17%)]\tLoss: 0.181267\nTrain Epoch: 8 [10880/60000 (18%)]\tLoss: 0.213851\nTrain Epoch: 8 [11520/60000 (19%)]\tLoss: 0.130871\nTrain Epoch: 8 [12160/60000 (20%)]\tLoss: 0.074143\nTrain Epoch: 8 [12800/60000 (21%)]\tLoss: 0.090848\nTrain Epoch: 8 [13440/60000 (22%)]\tLoss: 0.262355\nTrain Epoch: 8 [14080/60000 (23%)]\tLoss: 0.112236\nTrain Epoch: 8 [14720/60000 (25%)]\tLoss: 0.237863\nTrain Epoch: 8 [15360/60000 (26%)]\tLoss: 0.128822\nTrain Epoch: 8 [16000/60000 (27%)]\tLoss: 0.325940\nTrain Epoch: 8 [16640/60000 (28%)]\tLoss: 0.059681\nTrain Epoch: 8 [17280/60000 (29%)]\tLoss: 0.297807\nTrain Epoch: 8 [17920/60000 (30%)]\tLoss: 0.193296\nTrain Epoch: 8 [18560/60000 (31%)]\tLoss: 0.101481\nTrain Epoch: 8 [19200/60000 (32%)]\tLoss: 0.319415\nTrain Epoch: 8 [19840/60000 (33%)]\tLoss: 0.221697\nTrain Epoch: 8 [20480/60000 (34%)]\tLoss: 0.128780\nTrain Epoch: 8 [21120/60000 (35%)]\tLoss: 0.365089\nTrain Epoch: 8 [21760/60000 (36%)]\tLoss: 0.114066\nTrain Epoch: 8 [22400/60000 (37%)]\tLoss: 0.178602\nTrain Epoch: 8 [23040/60000 (38%)]\tLoss: 0.198497\nTrain Epoch: 8 [23680/60000 (39%)]\tLoss: 0.113458\nTrain Epoch: 8 [24320/60000 (41%)]\tLoss: 0.084631\nTrain Epoch: 8 [24960/60000 (42%)]\tLoss: 0.220370\nTrain Epoch: 8 [25600/60000 (43%)]\tLoss: 0.112375\nTrain Epoch: 8 [26240/60000 (44%)]\tLoss: 0.180620\nTrain Epoch: 8 [26880/60000 (45%)]\tLoss: 0.174218\nTrain Epoch: 8 [27520/60000 (46%)]\tLoss: 0.220530\nTrain Epoch: 8 [28160/60000 (47%)]\tLoss: 0.322495\nTrain Epoch: 8 [28800/60000 (48%)]\tLoss: 0.108935\nTrain Epoch: 8 [29440/60000 (49%)]\tLoss: 0.302106\nTrain Epoch: 8 [30080/60000 (50%)]\tLoss: 0.143926\nTrain Epoch: 8 [30720/60000 (51%)]\tLoss: 0.132183\nTrain Epoch: 8 [31360/60000 (52%)]\tLoss: 0.295584\nTrain Epoch: 8 [32000/60000 (53%)]\tLoss: 0.153446\nTrain Epoch: 8 [32640/60000 (54%)]\tLoss: 0.356207\nTrain Epoch: 8 [33280/60000 (55%)]\tLoss: 0.049660\nTrain Epoch: 8 [33920/60000 (57%)]\tLoss: 0.134523\nTrain Epoch: 8 [34560/60000 (58%)]\tLoss: 0.107794\nTrain Epoch: 8 [35200/60000 (59%)]\tLoss: 0.152601\nTrain Epoch: 8 [35840/60000 (60%)]\tLoss: 0.183556\nTrain Epoch: 8 [36480/60000 (61%)]\tLoss: 0.139419\nTrain Epoch: 8 [37120/60000 (62%)]\tLoss: 0.217243\nTrain Epoch: 8 [37760/60000 (63%)]\tLoss: 0.067120\nTrain Epoch: 8 [38400/60000 (64%)]\tLoss: 0.140370\nTrain Epoch: 8 [39040/60000 (65%)]\tLoss: 0.118206\nTrain Epoch: 8 [39680/60000 (66%)]\tLoss: 0.068067\nTrain Epoch: 8 [40320/60000 (67%)]\tLoss: 0.390102\nTrain Epoch: 8 [40960/60000 (68%)]\tLoss: 0.362602\nTrain Epoch: 8 [41600/60000 (69%)]\tLoss: 0.151053\nTrain Epoch: 8 [42240/60000 (70%)]\tLoss: 0.329660\nTrain Epoch: 8 [42880/60000 (71%)]\tLoss: 0.030132\nTrain Epoch: 8 [43520/60000 (72%)]\tLoss: 0.214005\nTrain Epoch: 8 [44160/60000 (74%)]\tLoss: 0.177053\nTrain Epoch: 8 [44800/60000 (75%)]\tLoss: 0.270380\nTrain Epoch: 8 [45440/60000 (76%)]\tLoss: 0.160427\nTrain Epoch: 8 [46080/60000 (77%)]\tLoss: 0.152326\nTrain Epoch: 8 [46720/60000 (78%)]\tLoss: 0.173051\nTrain Epoch: 8 [47360/60000 (79%)]\tLoss: 0.213168\nTrain Epoch: 8 [48000/60000 (80%)]\tLoss: 0.148429\nTrain Epoch: 8 [48640/60000 (81%)]\tLoss: 0.179701\nTrain Epoch: 8 [49280/60000 (82%)]\tLoss: 0.115524\nTrain Epoch: 8 [49920/60000 (83%)]\tLoss: 0.203157\nTrain Epoch: 8 [50560/60000 (84%)]\tLoss: 0.092355\nTrain Epoch: 8 [51200/60000 (85%)]\tLoss: 0.241119\nTrain Epoch: 8 [51840/60000 (86%)]\tLoss: 0.214614\nTrain Epoch: 8 [52480/60000 (87%)]\tLoss: 0.133498\nTrain Epoch: 8 [53120/60000 (88%)]\tLoss: 0.139286\nTrain Epoch: 8 [53760/60000 (90%)]\tLoss: 0.271059\nTrain Epoch: 8 [54400/60000 (91%)]\tLoss: 0.126945\nTrain Epoch: 8 [55040/60000 (92%)]\tLoss: 0.098850\nTrain Epoch: 8 [55680/60000 (93%)]\tLoss: 0.224279\nTrain Epoch: 8 [56320/60000 (94%)]\tLoss: 0.166734\nTrain Epoch: 8 [56960/60000 (95%)]\tLoss: 0.143847\nTrain Epoch: 8 [57600/60000 (96%)]\tLoss: 0.146182\nTrain Epoch: 8 [58240/60000 (97%)]\tLoss: 0.226856\nTrain Epoch: 8 [58880/60000 (98%)]\tLoss: 0.049229\nTrain Epoch: 8 [59520/60000 (99%)]\tLoss: 0.534476\n\nTest set: Avg. loss: 0.0554, Accuracy: 9817/10000 (98%)\n\nTrain Epoch: 9 [0/60000 (0%)]\tLoss: 0.054686\nTrain Epoch: 9 [640/60000 (1%)]\tLoss: 0.235064\nTrain Epoch: 9 [1280/60000 (2%)]\tLoss: 0.106654\nTrain Epoch: 9 [1920/60000 (3%)]\tLoss: 0.234180\nTrain Epoch: 9 [2560/60000 (4%)]\tLoss: 0.198757\nTrain Epoch: 9 [3200/60000 (5%)]\tLoss: 0.162267\nTrain Epoch: 9 [3840/60000 (6%)]\tLoss: 0.271285\nTrain Epoch: 9 [4480/60000 (7%)]\tLoss: 0.080265\nTrain Epoch: 9 [5120/60000 (9%)]\tLoss: 0.122332\nTrain Epoch: 9 [5760/60000 (10%)]\tLoss: 0.217631\nTrain Epoch: 9 [6400/60000 (11%)]\tLoss: 0.185639\nTrain Epoch: 9 [7040/60000 (12%)]\tLoss: 0.168876\nTrain Epoch: 9 [7680/60000 (13%)]\tLoss: 0.112571\nTrain Epoch: 9 [8320/60000 (14%)]\tLoss: 0.125877\nTrain Epoch: 9 [8960/60000 (15%)]\tLoss: 0.188810\nTrain Epoch: 9 [9600/60000 (16%)]\tLoss: 0.105145\nTrain Epoch: 9 [10240/60000 (17%)]\tLoss: 0.188370\nTrain Epoch: 9 [10880/60000 (18%)]\tLoss: 0.117349\nTrain Epoch: 9 [11520/60000 (19%)]\tLoss: 0.069228\nTrain Epoch: 9 [12160/60000 (20%)]\tLoss: 0.162447\nTrain Epoch: 9 [12800/60000 (21%)]\tLoss: 0.108819\nTrain Epoch: 9 [13440/60000 (22%)]\tLoss: 0.263229\nTrain Epoch: 9 [14080/60000 (23%)]\tLoss: 0.292624\nTrain Epoch: 9 [14720/60000 (25%)]\tLoss: 0.248468\nTrain Epoch: 9 [15360/60000 (26%)]\tLoss: 0.119649\nTrain Epoch: 9 [16000/60000 (27%)]\tLoss: 0.109907\nTrain Epoch: 9 [16640/60000 (28%)]\tLoss: 0.580101\nTrain Epoch: 9 [17280/60000 (29%)]\tLoss: 0.177047\nTrain Epoch: 9 [17920/60000 (30%)]\tLoss: 0.178420\nTrain Epoch: 9 [18560/60000 (31%)]\tLoss: 0.221444\nTrain Epoch: 9 [19200/60000 (32%)]\tLoss: 0.133854\nTrain Epoch: 9 [19840/60000 (33%)]\tLoss: 0.282360\nTrain Epoch: 9 [20480/60000 (34%)]\tLoss: 0.136910\nTrain Epoch: 9 [21120/60000 (35%)]\tLoss: 0.280332\nTrain Epoch: 9 [21760/60000 (36%)]\tLoss: 0.174279\nTrain Epoch: 9 [22400/60000 (37%)]\tLoss: 0.083278\nTrain Epoch: 9 [23040/60000 (38%)]\tLoss: 0.188579\nTrain Epoch: 9 [23680/60000 (39%)]\tLoss: 0.102640\nTrain Epoch: 9 [24320/60000 (41%)]\tLoss: 0.163085\nTrain Epoch: 9 [24960/60000 (42%)]\tLoss: 0.158967\nTrain Epoch: 9 [25600/60000 (43%)]\tLoss: 0.192901\nTrain Epoch: 9 [26240/60000 (44%)]\tLoss: 0.163242\nTrain Epoch: 9 [26880/60000 (45%)]\tLoss: 0.157237\nTrain Epoch: 9 [27520/60000 (46%)]\tLoss: 0.088420\nTrain Epoch: 9 [28160/60000 (47%)]\tLoss: 0.094397\nTrain Epoch: 9 [28800/60000 (48%)]\tLoss: 0.156636\nTrain Epoch: 9 [29440/60000 (49%)]\tLoss: 0.150083\nTrain Epoch: 9 [30080/60000 (50%)]\tLoss: 0.077640\nTrain Epoch: 9 [30720/60000 (51%)]\tLoss: 0.172498\nTrain Epoch: 9 [31360/60000 (52%)]\tLoss: 0.228058\nTrain Epoch: 9 [32000/60000 (53%)]\tLoss: 0.162368\nTrain Epoch: 9 [32640/60000 (54%)]\tLoss: 0.278008\nTrain Epoch: 9 [33280/60000 (55%)]\tLoss: 0.256715\nTrain Epoch: 9 [33920/60000 (57%)]\tLoss: 0.196984\nTrain Epoch: 9 [34560/60000 (58%)]\tLoss: 0.205926\nTrain Epoch: 9 [35200/60000 (59%)]\tLoss: 0.103880\nTrain Epoch: 9 [35840/60000 (60%)]\tLoss: 0.053308\nTrain Epoch: 9 [36480/60000 (61%)]\tLoss: 0.117932\nTrain Epoch: 9 [37120/60000 (62%)]\tLoss: 0.080018\nTrain Epoch: 9 [37760/60000 (63%)]\tLoss: 0.423203\nTrain Epoch: 9 [38400/60000 (64%)]\tLoss: 0.088841\nTrain Epoch: 9 [39040/60000 (65%)]\tLoss: 0.157737\nTrain Epoch: 9 [39680/60000 (66%)]\tLoss: 0.196193\nTrain Epoch: 9 [40320/60000 (67%)]\tLoss: 0.164245\nTrain Epoch: 9 [40960/60000 (68%)]\tLoss: 0.199979\nTrain Epoch: 9 [41600/60000 (69%)]\tLoss: 0.188702\nTrain Epoch: 9 [42240/60000 (70%)]\tLoss: 0.199731\nTrain Epoch: 9 [42880/60000 (71%)]\tLoss: 0.102235\nTrain Epoch: 9 [43520/60000 (72%)]\tLoss: 0.087075\nTrain Epoch: 9 [44160/60000 (74%)]\tLoss: 0.128069\nTrain Epoch: 9 [44800/60000 (75%)]\tLoss: 0.148430\nTrain Epoch: 9 [45440/60000 (76%)]\tLoss: 0.232641\nTrain Epoch: 9 [46080/60000 (77%)]\tLoss: 0.082571\nTrain Epoch: 9 [46720/60000 (78%)]\tLoss: 0.283418\nTrain Epoch: 9 [47360/60000 (79%)]\tLoss: 0.233733\nTrain Epoch: 9 [48000/60000 (80%)]\tLoss: 0.096537\nTrain Epoch: 9 [48640/60000 (81%)]\tLoss: 0.109687\nTrain Epoch: 9 [49280/60000 (82%)]\tLoss: 0.216523\nTrain Epoch: 9 [49920/60000 (83%)]\tLoss: 0.181914\nTrain Epoch: 9 [50560/60000 (84%)]\tLoss: 0.139312\nTrain Epoch: 9 [51200/60000 (85%)]\tLoss: 0.238586\nTrain Epoch: 9 [51840/60000 (86%)]\tLoss: 0.109351\nTrain Epoch: 9 [52480/60000 (87%)]\tLoss: 0.076942\nTrain Epoch: 9 [53120/60000 (88%)]\tLoss: 0.221999\nTrain Epoch: 9 [53760/60000 (90%)]\tLoss: 0.178757\nTrain Epoch: 9 [54400/60000 (91%)]\tLoss: 0.219890\nTrain Epoch: 9 [55040/60000 (92%)]\tLoss: 0.136030\nTrain Epoch: 9 [55680/60000 (93%)]\tLoss: 0.238617\nTrain Epoch: 9 [56320/60000 (94%)]\tLoss: 0.195722\nTrain Epoch: 9 [56960/60000 (95%)]\tLoss: 0.252661\nTrain Epoch: 9 [57600/60000 (96%)]\tLoss: 0.149977\nTrain Epoch: 9 [58240/60000 (97%)]\tLoss: 0.061803\nTrain Epoch: 9 [58880/60000 (98%)]\tLoss: 0.105117\nTrain Epoch: 9 [59520/60000 (99%)]\tLoss: 0.054359\n\nTest set: Avg. loss: 0.0508, Accuracy: 9843/10000 (98%)\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">plt.figure(figsize=(<span class=\"number\">15</span>, <span class=\"number\">12</span>))</span><br><span class=\"line\">plt.plot(train_counter, train_losses, color=<span class=\"string\">&#x27;blue&#x27;</span>)</span><br><span class=\"line\">plt.scatter(test_counter, test_losses, color=<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">plt.legend([<span class=\"string\">&#x27;Train Loss&#x27;</span>, <span class=\"string\">&#x27;Test Loss&#x27;</span>], loc=<span class=\"string\">&#x27;upper right&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;number of training examples seen&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;negative log likelihood loss&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"DL_files/DL_8_0.png\" alt=\"png\"></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://zhuanlan.zhihu.com/p/137571225\">用 PyTorch 实现 MNIST 手写数字识别(非常详细)</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://www.bilibili.com/video/BV1cL411V7Gh?p=6\">PyTorch 深度学习入门与实战 2022 最简明易懂的 PyTorch 代码精讲 最新版本 PyTorch PyTorch 安装</a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://www.jianshu.com/p/45a26d278473\">PyTorch 中的 nn.Conv1d 与 nn.Conv2d</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "人工智能",
                "深度学习",
                "python"
            ]
        },
        {
            "id": "https://blog.weidows.tech/post/lang/python/AI/DL/",
            "url": "https://blog.weidows.tech/post/lang/python/AI/DL/",
            "title": "⚡再啃-Deep-Learning",
            "date_published": "2022-04-20T16:07:12.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2023-04-20 18:31:10\n * @FilePath: \\Blog-private\\source\\_posts\\python\\AI\\DL.md\n * @Description:\n * @!: *********************************************************************\n-->\n<blockquote class=\"pullquote mindmap mindmap-lg\"><ul>\n<li>再啃-Deep-Learning\n<ul>\n<li>深度学习\n<ul>\n<li>一个好的表示学习策略必须具备一定的深度</li>\n<li>特征\n<ul>\n<li>像是宰鱼要分多步,每步使用不同方式/工具</li>\n<li>通常从底层特征开始经过多步非线性转换才能得到好的高层语义表示</li>\n</ul>\n</li>\n<li>特点\n<ul>\n<li>增加特征重用性,指数级增加表示能力</li>\n</ul>\n</li>\n<li><a href=\"https://pan.weidows.tech/d/local/blog/RCdJ0c.png\">表示学习与深度学习关系</a></li>\n<li>关键问题: 贡献度分配\n<ul>\n<li>不同组件/参数对系统输出结果的影响权重</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>神经网路\n<ul>\n<li>人工神经网络\n<ul>\n<li>由大量神经元及它们之间的有向连接构成</li>\n<li>三方面\n<ul>\n<li>神经元/感知器</li>\n<li>网络的拓扑结构\n<ul>\n<li>LeNet</li>\n<li>AlexNet</li>\n<li>VGGNet</li>\n<li>ResNet</li>\n</ul>\n</li>\n<li>学习算法</li>\n</ul>\n</li>\n<li><a href=\"https://pan.weidows.tech/d/local/blog/Rat37q.png\">分类</a>\n<ul>\n<li>单类网络\n<ul>\n<li>前馈网络</li>\n<li>记忆网络</li>\n<li>图网络</li>\n</ul>\n</li>\n<li>复合型网络</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>贡献度分配问题\n<ul>\n<li>不同 component 或 param 对最终系统输出结果的贡献</li>\n<li>利用偏导数求解贡献度</li>\n</ul>\n</li>\n<li>发展史\n<ul>\n<li>模型提出</li>\n<li>冰河期</li>\n<li>反向传播算法引起的复兴</li>\n<li>流行度降低</li>\n<li>深度学习崛起</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>MMDetection\n<ul>\n<li>图像分类\n<ul>\n<li>模型发展\n<ul>\n<li>LeNet-5 (1998)</li>\n<li>AlexNet (2012)</li>\n<li>VGGNet (2014)</li>\n<li>GoogleNet (2014)</li>\n<li>ResNet (2015)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>模型训练\n<ul>\n<li>配置文件\n<ul>\n<li>模型结构\n<ul>\n<li>模型有几层</li>\n<li>每层多少通道数</li>\n</ul>\n</li>\n<li>数据集\n<ul>\n<li>数据集划分\n<ul>\n<li>常用的有 COCO 格式, <code>annotation/test.json -&gt; test/images</code></li>\n</ul>\n</li>\n<li>数据文件路径</li>\n<li>数据增强策略</li>\n</ul>\n</li>\n<li>训练策略\n<ul>\n<li>梯度下降算法</li>\n<li>学习率参数</li>\n<li>batch_size</li>\n<li>训练总轮次</li>\n<li>学习率变化策略</li>\n</ul>\n</li>\n<li>runtime / 运行时\n<ul>\n<li>GPU</li>\n<li>分布式环境配置</li>\n</ul>\n</li>\n<li>一些辅助功能\n<ul>\n<li>打印日志</li>\n<li>checkpoint / 定时保存</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>MMDetection3D</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<blockquote>\n<p>由于 DL 是 ML 的子问题, 所以此篇着重写 <a href=\"../ML\">🥵 硬啃-Machine-Learning</a> 里面涉及甚少的 (解耦) <br>\n有一些 (比如损失函数, 梯度下降) 隶属于 ML &gt; DL ,所以堆在了 ML 里面</p>\n</blockquote>\n<blockquote>\n<ul>\n<li>本篇所用到的代码在这: <br>\n<a href=\"../../code/DL\">👩‍❤️‍💋‍👨Code-4-Deep-Learning</a> <br>\n<a href=\"../../code/MM-Detection\">🐳MM-Detection-Colab</a></li>\n</ul>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"ML-2-DL\">ML-2-DL</h2>\n<ul>\n<li>\n<p>简单解释 DL 到底在做什么?</p>\n<p>传统 ML 就像是在教小学生如何通过一系列<code>固定公式</code>搞出来一个结果,在公式不太复杂/运算量不太大时, 教起来还好</p>\n<p>那怎么教一个小学生高数题呢? 也是可以让他死记硬背公式的,但是效果并不好</p>\n<p>DL 就像是在教他转换思想 (函数,导数,积分…), 遇到题目后,具体套什么公式, 由小学生自己找到</p>\n</li>\n</ul>\n<p>DL 不像 ML 一样泛泛, 对每种任务有针对性的设计</p>\n<hr>\n<div class=\"tabs\" id=\"优点\"><ul class=\"nav-tabs\"><li class=\"tab active\"><button type=\"button\" data-href=\"#优点-1\">优点</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#优点-2\">缺点</button></li></ul><div class=\"tab-contents\"><div class=\"tab-item-content active\" id=\"优点-1\"><p>就像上面提到的, 传统 ML 需要人教给机器特征工程 (固定公式), 模型越复杂, 人的提取方法和特征结果会越差</p>\n<p>DL 对特征的处理方法/结果要优于人类 (比如深层次人类无法察觉的特征关系)</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"优点-2\"><p>DL 模型的能力是 (人类传授的基本功 + 题海战术) 得来的;</p>\n<ol>\n<li>刷题少时反不如套公式</li>\n<li>基本功构建成本高</li>\n<li>可解释性差 (虽然基本功是你教的,但你不知道机器是用的什么歪门邪道的心法)</li>\n</ol><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div></div></div>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"神经网路\">神经网路</h2>\n<p>大多知名的模型都是属于 <code>深度神经网络</code> 的, 比如 CNN, RNN, GAN …</p>\n<h3 id=\"神经元-感知器\">神经元-感知器</h3>\n<ul>\n<li>\n<p>感知器就是一个神经元, 神经网络的组成单元, 可自学习为回归/分类器</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RC0tEP.png\" alt=\"\"></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>w</mi><mn>1</mn><mo>⋅</mo><mi>x</mi><mn>1</mn><mo>+</mo><mi>w</mi><mn>2</mn><mo>⋅</mo><mi>x</mi><mn>2</mn><mo>+</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y = f(w1 \\cdot x1 + w2 \\cdot x2 + b)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>当调整 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo separator=\"true\">,</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">w,b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> 时,可以得到不同的变体逻辑运算(比如与或非);</p>\n<p>给定训练数据集, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo separator=\"true\">,</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">w,b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> 可以通过学习自动调整</p>\n<hr>\n</li>\n<li>\n<p>学习规则核心思想: <code>错误驱动</code></p>\n<ol>\n<li>权值初始化</li>\n<li>输入样本对</li>\n<li>计算输出</li>\n<li>根据感知器学习规则调整权值</li>\n<li>返回到步骤 2. 输入下一对样本,周而复始直到对所有样本,感知器的实际输出与期望输出相等</li>\n</ol>\n<hr>\n</li>\n<li>\n<details>\n  <summary> 例题 </summary>\n<hr>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Raxa9S.png\" alt=\"\"></p>\n<ol>\n<li>初始化向量</li>\n</ol>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mo>⇒</mo><msup><mi>W</mi><mi>T</mi></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W(0) = (0.5,1,-1,0)^T \\rArr W^T(0) = (0.5,1,-1,0)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⇒</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<ol start=\"2\">\n<li>输入样本</li>\n<li>计算输出</li>\n</ol>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>W</mi><mi>T</mi></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><msup><mi>X</mi><mn>1</mn></msup><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>⋅</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mo>=</mo><mn>2.5</mn></mrow><annotation encoding=\"application/x-tex\">W^T(0)X^1 = (0.5,1,-1,0) \\cdot (-1,1,-2,0)^T = 2.5\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.5</span></span></span></span></span></p>\n<ol start=\"4\">\n<li>调整权值,这里使用上面<a href=\"#%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0\">#激活函数</a>的阶跃函数例子</li>\n</ol>\n<p>权向量第一个分量也就是 0.5 为阈值</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><msup><mi>o</mi><mn>1</mn></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">(</mo><msup><mi>W</mi><mi>T</mi></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><msup><mi>X</mi><mn>1</mn></msup><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mn>2.5</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>W</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mi>η</mi><mrow><mo fence=\"true\">[</mo><msup><mi>d</mi><mn>1</mn></msup><mo>−</mo><msup><mi>o</mi><mn>1</mn></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><msup><mi>X</mi><mn>1</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mo>+</mo><mn>0.1</mn><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence=\"true\">(</mo><mrow><mn mathvariant=\"bold\">0.7</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0.8</mn><mo separator=\"true\">,</mo><mo>−</mo><mn mathvariant=\"bold\">0.6</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0</mn><msup><mo stretchy=\"false\">)</mo><mi mathvariant=\"bold\">T</mi></msup></mrow></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>W</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mi>η</mi><mrow><mo fence=\"true\">[</mo><msup><mi>d</mi><mn>2</mn></msup><mo>−</mo><msup><mi>o</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><msup><mi>X</mi><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.7</mn><mo separator=\"true\">,</mo><mn>0.8</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>0.6</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mo>+</mo><mn>0.1</mn><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo>−</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1.5</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>0.5</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence=\"true\">(</mo><mrow><mn mathvariant=\"bold\">0.7</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0.8</mn><mo separator=\"true\">,</mo><mo>−</mo><mn mathvariant=\"bold\">0.6</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0</mn><msup><mo stretchy=\"false\">)</mo><mi mathvariant=\"bold\">T</mi></msup></mrow></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>W</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mi>η</mi><mrow><mo fence=\"true\">[</mo><msup><mi>d</mi><mn>3</mn></msup><mo>−</mo><msup><mi>o</mi><mn>3</mn></msup><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><msup><mi>X</mi><mn>3</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.7</mn><mo separator=\"true\">,</mo><mn>0.8</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>0.6</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mo>+</mo><mn>0.1</mn><mo stretchy=\"false\">[</mo><mn>1</mn><mo>−</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0.5</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence=\"true\">(</mo><mrow><mn mathvariant=\"bold\">0.5</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0.6</mn><mo separator=\"true\">,</mo><mo>−</mo><mn mathvariant=\"bold\">0.4</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0.1</mn><msup><mo stretchy=\"false\">)</mo><mi mathvariant=\"bold\">T</mi></msup></mrow></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n  o^1(0) &amp;= sgn(W^T(0)X^1) \\\\\n  &amp;= sgn(2.5) = 1\n\n    \\\\ \\ \\\\\n\n    W(1) &amp;=W(0) + \\eta \\left[d^{1}-o^{1}(0)\\right] X^{1} \\\\\n  &amp;= (0.5,1,-1,0)^{T} + 0.1 (- 1- 1)(-1,1,-2,0)^{T} \\\\\n  &amp;= \\left(\\mathbf{0.7,0.8,-0.6,0)^{T}}\\right.\n\n    \\\\ \\ \\\\\n\n    W(2) &amp;=W(1) + \\eta \\left[d^{2}-o^{2}(1)\\right] X^{2} \\\\\n  &amp;= (0.7,0.8,-0.6,0)^{T} + 0.1 [- 1-(- 1)](-1,0,1.5,-0.5)^{T} \\\\\n  &amp;= \\left(\\mathbf{0.7,0.8,-0.6,0)^{T}}\\right.\n\n    \\\\ \\ \\\\\n\n    W(3) &amp;=W(2) + \\eta \\left[d^{3}-o^{3}(2)\\right] X^{3} \\\\\n  &amp;= (0.7,0.8,-0.6,0)^{T} + 0.1 [1-(- 1)](-1,-1,1,0.5)^{T} \\\\\n  &amp;= \\left(\\mathbf{0.5,0.6,-0.4,0.1)^{T}}\\right.\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:21.4375em;vertical-align:-10.4687em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.9687em;\"><span style=\"top:-13.0774em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span><span style=\"top:-11.5774em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-10.0774em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:-8.5533em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span><span style=\"top:-7.002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-5.4487em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.9487em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:-2.4246em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.8733em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.68em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:2.18em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:3.7041em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">3</span><span class=\"mclose\">)</span></span></span><span style=\"top:5.2555em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:6.8087em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.4687em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.9687em;\"><span style=\"top:-13.0774em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-11.5774em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord\">2.5</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-8.5533em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-7.002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">0.1</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-5.4487em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathbf\">0.7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0.8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord mathbf\">0.6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8933em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">T</span></span></span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.4246em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-0.8733em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">0.1</span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mclose\">)]</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.5</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:0.68em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathbf\">0.7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0.8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord mathbf\">0.6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8933em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">T</span></span></span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:3.7041em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:5.2555em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">0.1</span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mclose\">)]</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.5</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:6.8087em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathbf\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0.6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord mathbf\">0.4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0.1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8933em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">T</span></span></span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.4687em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<ol start=\"5\">\n<li>返回 2. 直到</li>\n</ol>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>d</mi><mi>P</mi></msup><mo>−</mo><msup><mi>o</mi><mi>P</mi></msup><mo>=</mo><mn>0</mn><mspace width=\"2em\"/><mo stretchy=\"false\">(</mo><mi>p</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d^{P} - o^{P} = 0 \\qquad (p = 1,2,3)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9747em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8913em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">)</span></span></span></span></span></p>\n</details>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"前馈神经网络\">前馈神经网络</h3>\n<p>把若干个感知器叠几层, 形成单向类网状结构, 称为多层前馈神经网络 (Multi-layer Feedforward Neural Networks), <code>前馈</code> 是指前一层输出作为后一层输入</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R0fC7h.png\" alt=\"\"></p>\n<ul>\n<li>\n<p>每个箭头直线代表一个 “向量”:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mi>w</mi><mrow><mi>a</mi><mtext> </mtext><mi>b</mi></mrow><mi>k</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">w ^{k}  _{a \\ b}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1461em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mspace mtight\"><span class=\"mtight\"> </span></span><span class=\"mord mathnormal mtight\">b</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>k: 权重</p>\n<p>a: 前一层第 a 个神经元</p>\n<p>b: 后一层第 b 个神经元</p>\n<hr>\n</li>\n<li>\n<p>同一层感知器之间不相连, 与前后两层全相连, 为<code>全连接神经网络</code> (fully-connected neural network)</p>\n<p>这种网络有硬性缺点:</p>\n<ol>\n<li>丢失数据的空间信息 (比如 3d 图像会展开为向量)</li>\n<li>参数量太多,难训</li>\n<li>层级浅, 大量参数易过拟合</li>\n</ol>\n<p>后面 CNN 对此缺点做了优化</p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"反向传播\">反向传播</h3>\n<ul>\n<li>\n<p>反向传播/误差反向传播 (Backpropagation algorithm), 根据输出层输出值来反向调整隐藏层权重的一种方法</p>\n<ul>\n<li>\n<p>我们常用 <code>梯度下降方法</code> 来更新权重, 梯度下降应用于有明确求导/可求出误差的情况</p>\n</li>\n<li>\n<p>但是对于含有多个隐藏层的神经网络, 隐藏层求不出误差, 只有输出层有</p>\n</li>\n<li>\n<p>反向传播就是一个把输出层误差反向传播到隐藏层的过程</p>\n</li>\n</ul>\n</li>\n<li>\n<p>图解 <sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RNeqlm.png\" alt=\"\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RNexIh.png\" alt=\"\"></p>\n<p>实现原理就是求偏导</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RNeWuu.png\" alt=\"\"></p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"卷积神经网络-CNN\">卷积神经网络-CNN</h3>\n<p>卷积神经网络(Convolutional Neural Network, CNN), 视觉领域难以撼动的老大</p>\n<h4 id=\"what\">what</h4>\n<p>对于一个 .mp3 的音乐 (频域记录, .wav 是时域记录), 某一时间点的音波可以<code>假定认为</code>是多个函数交杂而成的</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>h</mi><mtext>耳机音效</mtext></msub><mrow><mo fence=\"true\">[</mo><msub><mi>f</mi><mtext>人声</mtext></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><msub><mi>g</mi><mtext>乐器</mtext></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><mo>∗</mo><msub><mi>i</mi><mtext>响度</mtext></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y = h_{耳机音效} \\left[ f_{人声}(t) * g_{乐器}(t) \\right] * i_{响度}(t)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">耳机音效</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">人声</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">乐器</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">响度</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>某一时间点的音波,就是这一堆函数的<code>卷积</code>, 简单来说就是在某个维度上 <code>加权 + 叠加</code></p>\n<hr>\n<h4 id=\"结构\">结构</h4>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RytYZQ.png\" alt=\"\"><div class=\"mermaid-wrap\"><pre class=\"mermaid-src\" hidden>\n  graph TB\n  输入层 --&gt;\n  卷积层(卷积层 Convolutional-layer) --&gt;\n  激活层(激活&#x2F;ReLU层 Activation-layer) --&gt;\n  池化层(池化&#x2F;子采样&#x2F;下采样层 Pooling-layer) --&gt;\n  全连接网络(全连接网络 fully-connected-layer) --&gt;\n  输出层\n  </pre></div></p>\n<ol>\n<li>卷积层: 就像是多个科目 (卷积核) 的老师给出试卷, 让&quot;输入&quot;做答</li>\n<li>激活层: 不同科目老师判卷,得出有没有及格,及格的话计多少分</li>\n<li>池化层: 成绩取最大值或者平均值, 减少计算量</li>\n<li>全连接层: 年级排名</li>\n<li>输出层: 是否获奖(二分类) / 排名前百分之几十(多分类)</li>\n</ol>\n<hr>\n<h4 id=\"卷积层\">卷积层</h4>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RNJpTz.png\" alt=\"\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Ry4FoP.png\" alt=\"\"></p>\n<p>可以直观看出, 其作用为 <code>降维</code> 和 <code>提取特征</code></p>\n<hr>\n<h4 id=\"激活层\">激活层</h4>\n<blockquote>\n<p>将输入信号的总和转换为输出信号的函数被称为激活函数</p>\n</blockquote>\n<ul>\n<li>\n<p>如下为一种简单实现: 阶跃函数:</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RaxGG1.png\" alt=\"RaxGG1.png\"></p>\n<p>其阈值是可以改变的:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.36em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mi>x</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mi>x</mi><mo>&lt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">sgn(x) =\n\\begin{cases}\n  1 &amp; if \\ x &gt; 0 \\\\\n  0 &amp; if \\ x = 0 \\\\\n  -1 &amp; if \\ x &lt; 0\n\\end{cases}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:4.32em;vertical-align:-1.91em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-2.2em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-2.192em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.316em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.316em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 316\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V316 H384z M384 0 H504 V316 H384z\"/></svg></span></span><span style=\"top:-3.15em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-4.292em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.316em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.8889em\" height=\"0.316em\" style=\"width:0.8889em\" viewBox=\"0 0 888.89 316\" preserveAspectRatio=\"xMinYMin\"><path d=\"M384 0 H504 V316 H384z M384 0 H504 V316 H384z\"/></svg></span></span><span style=\"top:-4.6em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.41em;\"><span style=\"top:-4.41em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.97em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-1.53em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.91em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.41em;\"><span style=\"top:-4.41em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-2.97em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-1.53em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.91em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n</li>\n<li>\n<p>还有很多其他的激活函数, 用途各异, 详见<sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup></p>\n<p>sigmoid 函数</p>\n<p>tanh 双曲正切函数</p>\n<p>ReLU (Rectified Linear Units, 修正线性单元, CNN 常用)</p>\n<p>…</p>\n</li>\n</ul>\n<hr>\n<h4 id=\"池化层\">池化层</h4>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Ry4PS6.png\" alt=\"\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Ry4apn.png\" alt=\"\"></p>\n<p>一方面, 缩小分辨率降低运算量, 一方面扩大神经元的<code>感受野</code> (特征捕获范围)</p>\n<p>也就使得层次越深, 单位神经元在有损条件下捕获特征/语义信息的范围越大</p>\n<hr>\n<h4 id=\"上采样-反卷积-上池化\">上采样-反卷积-上池化</h4>\n<blockquote>\n<p>上采样指的是：任何可以让图像变成更高分辨率的技术（上池化、反卷积、插值等）<sup id='cite_ref-9'><a href=\"#cite_note-9\">[9]</a></sup></p>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"多种模型特点\">多种模型特点</h2>\n<h3 id=\"MLP\">MLP</h3>\n<p>Multi-Layer Perceptron 多层感知机</p>\n<p>上天下地都行, 但需要人扶着</p>\n<h3 id=\"CNN\">CNN</h3>\n<p>深层次特征挖掘, 尤其适用于图像</p>\n<h3 id=\"Transformer-ViT\">Transformer-ViT</h3>\n<p>适用于多场景, 打榜强手</p>\n<p><code>混联电池组结构</code> + <code>自注意力机制</code> = transformer</p>\n<p>由于 self- attention, 可训练出可解释性的模型</p>\n<ul>\n<li>\n<p>self-attention 公式图解, 推荐视频: <sup id='cite_ref-10'><a href=\"#cite_note-10\">[10]</a></sup></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZNGs8o.png\" alt=\"\"><br>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZNG4ZD.png\" alt=\"\"></p>\n</li>\n</ul>\n<h3 id=\"GAN\">GAN</h3>\n<p>出了名的难训, 需要大量上好的数据</p>\n<h3 id=\"RNN\">RNN</h3>\n<p>Recurrent Neural Networkx 循环神经网络</p>\n<h3 id=\"VAE\">VAE</h3>\n<p>Variational Auto-Encoder 变分自编码器</p>\n<p>自编码器 Auto-Encoder<br>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z0ZSYT.png\" alt=\"\"><br>\n隐藏层就类似有损压缩算法, 也可以认为就是, 视频中介绍到 Google 就拿来压缩图片<br>\nencoder 是拆分信息的, decoder 是重组信息的</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"MMDetection\">MMDetection</h2>\n<blockquote>\n<p>参考课程 <sup id='cite_ref-3'><a href=\"#cite_note-3\">[3]</a></sup> <br>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R7twWM.png\" alt=\"\"></p>\n</blockquote>\n<h3 id=\"图像分类\">图像分类</h3>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Ry4Xmz.png\" alt=\"\"></p>\n<hr>\n<h3 id=\"目标检测\">目标检测</h3>\n<h4 id=\"第一阶段-问题与方案\">第一阶段-问题与方案</h4>\n<h5 id=\"图像分割\">图像分割</h5>\n<p>等大窗口 -&gt; 滑动窗口 -&gt; 多尺度滑窗 -&gt; 图像金字塔</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZBmvYY.png\" alt=\"\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZCV790.png\" alt=\"\"></p>\n<h5 id=\"区域提议\">区域提议</h5>\n<p>但上面设计需要做的分类数太多,难以满足实时性, 可以先用 <code>区域提议 Region Proposal</code> 提取出可能包含物体的区域</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZCYq6P.png\" alt=\"\"></p>\n<h5 id=\"非极大值抑制\">非极大值抑制</h5>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZCYER6.png\" alt=\"\"></p>\n<hr>\n<h4 id=\"第二阶段-优化算法\">第二阶段-优化算法</h4>\n<h5 id=\"共享特征与-RoI-Pooling\">共享特征与-RoI-Pooling</h5>\n<p>对于每个提议框 -&gt; CNN 前传, 有大量重叠提议框(重复的卷积运算), 所以改进为: <code>全图单次 CNN 前传 -&gt; 全图特征图 -&gt; 根据提议框裁剪预测</code></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z1PBTb.png\" alt=\"\"></p>\n<h5 id=\"RPN-区域提议网络\">RPN-区域提议网络</h5>\n<p>Region Proposal Network</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z1PLwn.png\" alt=\"\"></p>\n<h5 id=\"FPN-特征金字塔网络\">FPN-特征金字塔网络</h5>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z1a3Gh.png\" alt=\"\"></p>\n<hr>\n<h4 id=\"Faster-RCNN\">Faster-RCNN</h4>\n<p><code>Faster - Region proposal - CNN</code> 一个很经典的例子, 应用上面的优化算法网络 <sup id='cite_ref-5'><a href=\"#cite_note-5\">[5]</a></sup></p>\n<blockquote>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z1Pnqz.png\" alt=\"\"> <br>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z1aeNq.png\" alt=\"\"> <br>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZLwNpK.png\" alt=\"\"></p>\n</blockquote>\n<hr>\n<h4 id=\"目标检测划分\">目标检测划分</h4>\n<p>可以通过下面三种形式划分 <sup id='cite_ref-6'><a href=\"#cite_note-6\">[6]</a></sup></p>\n<blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li>目标检测划分\n<ul>\n<li>stage\n<ul>\n<li>one-stage (单阶段)\n<ul>\n<li>RetinaNet</li>\n<li>YOLO</li>\n<li>FCOS</li>\n<li>RepPoints</li>\n</ul>\n</li>\n<li>two-stage (双阶段)\n<ul>\n<li>FasterRCNN</li>\n<li>CascadeRCNN</li>\n<li>LibraRCNN</li>\n<li>TridentNet</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>anchor (锚框)\n<ul>\n<li>anchor-based\n<ul>\n<li>FasterRCNN</li>\n<li>YOLO</li>\n</ul>\n</li>\n<li>anchor-free\n<ul>\n<li>FCOS</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>transformer\n<ul>\n<li>DETR</li>\n<li>Deformable DETR</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<div class=\"tabs\" id=\"双阶段\"><ul class=\"nav-tabs\"><li class=\"tab active\"><button type=\"button\" data-href=\"#双阶段-1\">单阶段</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#双阶段-2\">双阶段</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#双阶段-3\">无锚框算法</button></li></ul><div class=\"tab-contents\"><div class=\"tab-item-content active\" id=\"双阶段-1\"><p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZeIeWv.png\" alt=\"\"></p>\n<p>单阶段最常用的就是 YOLO (You Only Look Once), 每代都会有设计更新和优化,如下为 v3 设计</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZeImDX.png\" alt=\"\"></p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"双阶段-2\"><p>上面介绍的都是双阶段算法,与单阶段区别主要在于<code>是否有区域提议阶段</code>, 单阶段算法只通过不同尺寸的锚框(检测头)进行物体预测</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Z1aqjr.png\" alt=\"\"></p>\n<p>具体来看,与上面网络结合:</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZeDKUA.png\" alt=\"\"></p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"双阶段-3\"><p>另一类分支, 有锚框的话会有大量超参使模型复杂度上升, 无锚框的话性能又会下降</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div></div></div>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"模型构建流程\">模型构建流程</h3>\n<p>现阶段 AI 领域把很多算法模块化了, 提出的新算法大多也是对某一功能模块的改进, 构建一个大型模型可以像是装高达一样挑选合适的算法/网络模块进行组合.</p>\n<p>mmdet 就是蛮复杂的, 抽象成了多个功能模块 <sup id='cite_ref-6'><a href=\"#cite_note-6\">[6]</a></sup>, 每个功能模块又有多个实现算法.</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZLwyeM.png\" alt=\"\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZL05TP.png\" alt=\"\"></p>\n<div class=\"tabs\" id=\"backbone\"><ul class=\"nav-tabs\"><li class=\"tab active\"><button type=\"button\" data-href=\"#backbone-1\">backbone</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#backbone-2\">neck</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#backbone-3\">enhance</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#backbone-4\">head</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#backbone-5\">BBox</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#backbone-6\">tricks</button></li></ul><div class=\"tab-contents\"><div class=\"tab-item-content active\" id=\"backbone-1\"><p>backbone (主干网络) 经常会在预训练模型选取时看到, 作用为<code>特征提取</code>, 常见的比如 50 层 ResNet -&gt; R-50</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"backbone-2\"><p>neck 是对 backbone 提取的特征进行融合/增强, 然后传给 head. 常见的 neck 为 FPN (特征金字塔网络)</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"backbone-3\"><blockquote>\n<p>enhance 是即插即用、能够对特征进行增强的模块</p>\n</blockquote><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"backbone-4\"><p>Head 检测头模块是对模型性能影响最显著的地方, 有框坐标回归和目标分类两个分支</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"backbone-5\"><p>Bonding Box 是检测头模块的一个分支, 它的作用是对检测结果进行回归, 得到框坐标<br>\n功能模块有 BBox 分配 (进行正负样本定义或者正负样本分配),采样,编解码,后处理, 以及对应的 loss</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"backbone-6\"><p>tricks 就是训练/测试的技巧/配置, 大部分的调参工作就是在调整这部分, 比如 batch, Lr, 数据增强等…</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div></div></div>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"模型训练\">模型训练</h3>\n<p>MMDetection 基本结构: <code>依赖 + [模型] + 数据集 + 配置文件 -&gt; Trainable</code></p>\n<h4 id=\"dataset-COCO\">dataset-COCO</h4>\n<p>数据集分很多格式, 常见的比如 COCO:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">dataset_type = <span class=\"string\">&#x27;CocoDataset&#x27;</span></span><br><span class=\"line\">data_root = <span class=\"string\">&#x27;data/coco/&#x27;</span></span><br><span class=\"line\">data = <span class=\"built_in\">dict</span>(</span><br><span class=\"line\">  samples_per_gpu=<span class=\"number\">2</span>,</span><br><span class=\"line\">  workers_per_gpu=<span class=\"number\">2</span>,</span><br><span class=\"line\">  train=<span class=\"built_in\">dict</span>(</span><br><span class=\"line\">    <span class=\"built_in\">type</span>=dataset_type,</span><br><span class=\"line\">    ann_file=data_root + <span class=\"string\">&#x27;annotations/instances_train2017.json&#x27;</span>,</span><br><span class=\"line\">    img_prefix=data_root + <span class=\"string\">&#x27;train2017/&#x27;</span>,</span><br><span class=\"line\">    pipeline=train_pipeline),</span><br><span class=\"line\">  val=<span class=\"built_in\">dict</span>(</span><br><span class=\"line\">    <span class=\"built_in\">type</span>=dataset_type,</span><br><span class=\"line\">    ann_file=data_root + <span class=\"string\">&#x27;annotations/instances_val2017.json&#x27;</span>,</span><br><span class=\"line\">    img_prefix=data_root + <span class=\"string\">&#x27;val2017/&#x27;</span>,</span><br><span class=\"line\">    pipeline=test_pipeline),</span><br><span class=\"line\">  test=<span class=\"built_in\">dict</span>(</span><br><span class=\"line\">    <span class=\"built_in\">type</span>=dataset_type,</span><br><span class=\"line\">    ann_file=data_root + <span class=\"string\">&#x27;annotations/instances_val2017.json&#x27;</span>,</span><br><span class=\"line\">    img_prefix=data_root + <span class=\"string\">&#x27;val2017/&#x27;</span>,</span><br><span class=\"line\">    pipeline=test_pipeline)</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<h4 id=\"pipeline\">pipeline</h4>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Zezw9E.png\" alt=\"\"></p>\n<h4 id=\"Lr-Scheduler\">Lr-Scheduler</h4>\n<p>Learning Rate Scheduler 学习率策略, 常见模型中标注的 <code>1x 2x</code></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Ze7rmt.png\" alt=\"\"></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"性能衡量\">性能衡量</h3>\n<blockquote>\n<p>目标检测中衡量识别精度的指标是 mAP（mean average precision）。多个类别物体检测中，每一个类别都可以根据 recall(查全率) 和 precision(查准率) 绘制一条曲线(P-R 曲线)，AP 就是该曲线下的面积，mAP 是多个类别 AP 的平均值 <sup id='cite_ref-8'><a href=\"#cite_note-8\">[8]</a></sup> <br>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZnHZTz.png\" alt=\"\"></p>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"MMDetection3D\">MMDetection3D</h2>\n<p>入门一个技术, 需要大致概览一下, 正巧 MM-Lab 应时发布了教程 <sup id='cite_ref-4'><a href=\"#cite_note-4\">[4]</a></sup></p>\n<p>MMDetection3D 依赖于 MMDetection 和 MMSegmentation, 适用于检测和分割 3D 场景下的物体</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZLvvN9.png\" alt=\"\"></p>\n<h3 id=\"坐标系\">坐标系</h3>\n<ul>\n<li>\n<p>深度坐标系 Depth 主要被用于通过深度相机采集的数据集, 大多是室内场景点云检测.</p>\n</li>\n<li>\n<p>激光雷达坐标系 LiDAR, 适用于室外场景点云检测</p>\n</li>\n<li>\n<p>相机坐标系 Camera, 该坐标系在室内室外场景的点云检测均有使用, 代表彩色相机的常用坐标系, 一般用于数据格式的转换. 在多模态或者单目 3D 的检测器中, 相机坐标系是三维点云与二维图像之间的桥梁. <sup id='cite_ref-7'><a href=\"#cite_note-7\">[7]</a></sup></p>\n</li>\n</ul>\n<p>三种坐标系构造不同, 但基准点都是物体底部中心点, 不同坐标系可以转换</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://mp.weixin.qq.com/s/Um8wAtdxPcVN8ACiVtSgFg\">42 个激活函数的全面总结</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://discover304.top/2021/11/30/2021q4/107-1-dl-back/\">【深度学习】基础 叁：反向传播算法</a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://www.bilibili.com/video/BV1ou411k7fD\">4 小时入门深度学习+实操 MMDetection 第一课</a></p>\n<p><a name='cite_note-4' href='#cite_ref-4'>[4]</a>: <a href=\"https://zhuanlan.zhihu.com/p/478307528\">带你玩转 3D 检测和分割 一：MMDetection3D 整体框架介绍</a></p>\n<p><a name='cite_note-5' href='#cite_ref-5'>[5]</a>: <a href=\"https://zhuanlan.zhihu.com/p/31426458\">一文读懂 Faster RCNN</a></p>\n<p><a name='cite_note-6' href='#cite_ref-6'>[6]</a>: <a href=\"https://zhuanlan.zhihu.com/p/337375549\">轻松掌握 MMDetection 整体构建流程(一)</a></p>\n<p><a name='cite_note-7' href='#cite_ref-7'>[7]</a>: <a href=\"https://zhuanlan.zhihu.com/p/491614921\">带你玩转 3D 检测和分割 （二）：核心组件分析之坐标系和 Box</a></p>\n<p><a name='cite_note-8' href='#cite_ref-8'>[8]</a>: <a href=\"https://www.zhihu.com/question/53405779\">目标检测中的 mAP 是什么含义？</a></p>\n<p><a name='cite_note-9' href='#cite_ref-9'>[9]</a>: <a href=\"https://blog.csdn.net/Turbo_Come/article/details/104602765/?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-1--blog-125624971.pc_relevant_default&amp;spm=1001.2101.3001.4242.2&amp;utm_relevant_index=4\">上采用、反卷积、上池化区别</a></p>\n<p><a name='cite_note-10' href='#cite_ref-10'>[10]</a>: <a href=\"https://www.bilibili.com/video/BV1BW4y1U7gm\">【论文必读之 Transformer】被捧上天的玩意儿，就这？！</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "doing",
                "人工智能",
                "深度学习",
                "MMDetection"
            ]
        },
        {
            "id": "https://blog.weidows.tech/post/lang/python/AI/ML/",
            "url": "https://blog.weidows.tech/post/lang/python/AI/ML/",
            "title": "🥵硬啃-Machine-Learning",
            "date_published": "2022-04-20T12:21:09.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2022-09-17 17:11:52\n * @FilePath: \\Blog-private\\source\\_posts\\python\\AI\\ML.md\n * @Description:\n * @!: *********************************************************************\n-->\n<blockquote class=\"pullquote mindmap mindmap-lg\"><ul>\n<li>机器学习\n<ul>\n<li><a href=\"#%E4%BD%95%E4%B8%BA%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0\">何为机器学习</a></li>\n<li><a href=\"#%E5%AD%A6%E4%B9%A0%E6%96%B9%E5%BC%8F\">学习方式</a>\n<ul>\n<li>深度学习</li>\n<li>监督\n<ul>\n<li>监督学习</li>\n<li>无监督学习</li>\n</ul>\n</li>\n<li>强化学习</li>\n</ul>\n</li>\n<li>一般流程\n<ul>\n<li>1.原始数据</li>\n<li><a href=\"#%E6%95%B0%E6%8D%AE%E9%A2%84%E5%A4%84%E7%90%86\">2.数据预处理</a>\n<ul>\n<li>问题\n<ul>\n<li>完整性</li>\n<li>噪声</li>\n<li>是否匹配</li>\n<li>重复</li>\n<li>连续/离散</li>\n<li>样本分布是否平衡</li>\n</ul>\n</li>\n<li>方法\n<ul>\n<li>标准化/均值移除</li>\n<li>范围缩放</li>\n<li>归一化</li>\n<li>二值化</li>\n<li>独热编码</li>\n<li>标签编码</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>3.特征处理\n<ul>\n<li>特征提取\n<ul>\n<li>原始特征的线性组合获取新特征</li>\n</ul>\n</li>\n<li>特征转换\n<ul>\n<li>升维</li>\n<li>降维</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>4.训练模型</li>\n<li>5.预测</li>\n<li>6.参数调整</li>\n<li>7.模型评估与优化\n<ul>\n<li><a href=\"#%E8%AF%84%E4%BC%B0%E6%96%B9%E6%B3%95\">评估方法</a></li>\n<li>优化方法</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E5%9F%BA%E6%9C%AC%E9%97%AE%E9%A2%98\">基本问题</a>\n<ul>\n<li>回归问题</li>\n<li>分类问题</li>\n<li>聚类问题</li>\n<li>降维问题</li>\n<li>强化问题</li>\n</ul>\n</li>\n<li>三要素\n<ul>\n<li>模型\n<ul>\n<li>线性方法</li>\n<li>非线性方法/广义线性方法</li>\n</ul>\n</li>\n<li><a href=\"#%E8%B6%85%E5%8F%82%E7%9A%84%E5%AD%A6%E4%B9%A0-%E6%9B%B4%E6%96%B0\">超参的学习-更新</a>\n<ul>\n<li>损失函数</li>\n<li>期望风险\n<ul>\n<li>期望风险未知,通过经验风险近似</li>\n<li>机器学习问题 -&gt; 经验风险最小化问题</li>\n</ul>\n</li>\n<li>过-欠拟合及处理</li>\n<li>参数学习\n<ul>\n<li>经验风险最小化(最小二乘法)</li>\n<li>结构风险最小化(岭回归)</li>\n<li>最大似然估计</li>\n<li>最大后验估计</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95\">优化算法</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"代码\">代码</h2>\n<blockquote>\n<p>本篇所用到的代码在这: <a href=\"../../code/ML\">👀Code-4-Machine-Learning</a></p>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"何为机器学习\">何为机器学习</h2>\n<ul>\n<li>\n<p>随机取市场上一些芒果样本为训练数据,教给机器怎么判断好坏</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>品质</mtext><mo>=</mo><mi>f</mi><mi>u</mi><mi>n</mi><mi>c</mi><mo stretchy=\"false\">(</mo><mo stretchy=\"false\">[</mo><mtext>特征</mtext><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">品质 = func([特征])\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord cjk_fallback\">品质</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mord mathnormal\">u</span><span class=\"mord mathnormal\">n</span><span class=\"mord mathnormal\">c</span><span class=\"mopen\">([</span><span class=\"mord cjk_fallback\">特征</span><span class=\"mclose\">])</span></span></span></span></span></p>\n<p><code>输入为特征</code>: [颜色, 大小, 形状, 产地, 品牌]</p>\n<p><code>输出为品质</code>: [好, 坏]</p>\n<hr>\n</li>\n</ul>\n<p>训练模型时, 输入输出都告诉它, 让它自动学会建立 <code>特征&lt;-&gt;品质</code> 之间的关系</p>\n<p>下次买芒果时可以根据要购买芒果的特征,使用此模型预测芒果的品质</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"学习方式\">学习方式</h2>\n<h3 id=\"区分有-无监督学习\">区分有-无监督学习</h3>\n<p>三方面区别: <sup id='cite_ref-3'><a href=\"#cite_note-3\">[3]</a></sup>, 也有混合形式的半监督学习</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"></th>\n<th style=\"text-align:center\">监督学习(supervised)</th>\n<th style=\"text-align:center\">无监督学习(self-supervised)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">训练数据</td>\n<td style=\"text-align:center\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mtext>样本</mtext></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mtext>标签</mtext></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_{样本}, y_{标签})</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">样本</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">标签</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></td>\n<td style=\"text-align:center\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msub><mi>x</mi><mtext>样本</mtext></msub></mrow><annotation encoding=\"application/x-tex\">x_{样本}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.5806em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">样本</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">学习目标</td>\n<td style=\"text-align:center\">映射关系 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>⇒</mo><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">x \\rArr y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⇒</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span></td>\n<td style=\"text-align:center\">x 的内在结构</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">适用场景</td>\n<td style=\"text-align:center\">分割/检测/回归(标签连续)/分类(离散)</td>\n<td style=\"text-align:center\">聚类、特征学习或密度估计</td>\n</tr>\n</tbody>\n</table>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"强化学习-RL\">强化学习-RL</h3>\n<ul>\n<li>\n<p>Reinforcement Learning:</p>\n<p>我们不清楚如何标记样本/无法说明什么样本数据特征是更好的,但是可以指明什么是好的终点</p>\n<p>比如围棋,没啥可标记的数据, 也很难说明哪一步更好,只能指明<code>快点赢</code>为最终结果</p>\n<p>对不同决策结果进行赏罚,使结果趋近期望结果</p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"数据预处理\">数据预处理</h2>\n<h3 id=\"均值移除\">均值移除</h3>\n<p>把一组数据的<code>均值和标准差</code>由 <code>x, y -&gt; 0, 1</code></p>\n<p>例如有一组数据 sample = [a,b,c]</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>均值</mtext><mi>m</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><mi>a</mi><mo>+</mo><mi>b</mi><mo>+</mo><mi>c</mi></mrow><mn>3</mn></mfrac><mo>=</mo><mi>x</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>标准差</mtext><mi>s</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msqrt><mfrac><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>−</mo><mi>m</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=\"false\">(</mo><mi>b</mi><mo>−</mo><mi>m</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=\"false\">(</mo><mi>c</mi><mo>−</mo><mi>m</mi><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><mn>3</mn></mfrac></msqrt><mo>=</mo><mi>y</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>令</mtext><mi>s</mi><mi>t</mi><mi>d</mi><mi mathvariant=\"normal\">_</mi><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><mi>e</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">[</mo><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>b</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>c</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">[</mo><mfrac><mrow><mi>a</mi><mo>−</mo><mi>m</mi></mrow><mi>s</mi></mfrac><mo separator=\"true\">,</mo><mfrac><mrow><mi>b</mi><mo>−</mo><mi>m</mi></mrow><mi>s</mi></mfrac><mo separator=\"true\">,</mo><mfrac><mrow><mi>c</mi><mo>−</mo><mi>m</mi></mrow><mi>s</mi></mfrac><mo stretchy=\"false\">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>数据标准化后</mtext><msup><mi>m</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>+</mo><msup><mi>b</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>+</mo><msup><mi>c</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow><mn>3</mn></mfrac><mo>=</mo><mfrac><mrow><mo stretchy=\"false\">(</mo><mi>a</mi><mo>−</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mo stretchy=\"false\">(</mo><mi>b</mi><mo>−</mo><mi>m</mi><mo stretchy=\"false\">)</mo><mo>+</mo><mo stretchy=\"false\">(</mo><mi>c</mi><mo>−</mo><mi>m</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mn>3</mn><mi>s</mi></mrow></mfrac><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msup><mi>s</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msqrt><mfrac><mrow><mo stretchy=\"false\">(</mo><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>−</mo><msup><mi>m</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=\"false\">(</mo><msup><mi>b</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>−</mo><msup><mi>m</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=\"false\">(</mo><msup><mi>c</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>−</mo><msup><mi>m</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><mn>3</mn></mfrac></msqrt><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n  均值 m\n  &amp;= \\frac{a+b+c}{3} = x\n\n  \\\\ \\ \\\\\n\n  标准差 s\n  &amp;= \\sqrt{\\frac{(a-m)^2 + (b-m)^2 + (c-m)^2}{3}} = y\n\n  \\\\ \\ \\\\\n\n  令std\\_sample\n  &amp;= [a&#x27;,b&#x27;,c&#x27;]\n  \\\\ &amp;= [ \\frac{a - m}{s} , \\frac{b - m}{s} , \\frac{c - m}{s} ]\n\n  \\\\ \\ \\\\\n\n  数据标准化后 m&#x27;\n  &amp;= \\frac{a&#x27; + b&#x27; + c&#x27; }{3} = \\frac{(a-m) + (b -m) + (c - m) }{3s} = 0\n\n  \\\\ \\ \\\\\n\n  s&#x27;\n  &amp;= \\sqrt{\\frac{(a&#x27;-m&#x27;)^2 + (b&#x27;-m&#x27;)^2 + (c&#x27;-m&#x27;)^2}{3}} = 1\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:20.1098em;vertical-align:-9.8049em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.3049em;\"><span style=\"top:-12.6378em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">均值</span><span class=\"mord mathnormal\">m</span></span></span><span style=\"top:-10.8118em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:-8.4474em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">标准差</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-6.5718em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:-5.0718em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">令</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">t</span><span class=\"mord mathnormal\">d</span><span class=\"mord\" style=\"margin-right:0.02778em;\">_</span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">am</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord mathnormal\">e</span></span></span><span style=\"top:-3.0404em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.2144em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:0.8745em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">数据标准化后</span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:2.7005em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:5.0649em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:9.8049em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.3049em;\"><span style=\"top:-12.6378em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-8.4474em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7044em;\"><span class=\"svg-align\" style=\"top:-4.4em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.6644em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:2.48em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"2.48em\" viewBox=\"0 0 400000 2592\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M424,2478\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl0 -0c4,-6.7,10,-10,18,-10 H400000\nv40H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M1001 80\nh400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7356em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-5.0718em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span><span style=\"top:-3.0404em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">m</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">]</span></span></span><span style=\"top:0.8745em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4289em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"mord mathnormal\">s</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">m</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:5.0649em;\"><span class=\"pstrut\" style=\"height:3.7044em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7044em;\"><span class=\"svg-align\" style=\"top:-4.4em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6779em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6779em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6779em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6779em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6779em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">m</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6779em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-3.6644em;\"><span class=\"pstrut\" style=\"height:4.4em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:2.48em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"2.48em\" viewBox=\"0 0 400000 2592\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M424,2478\nc-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514\nc0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20\ns-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121\ns209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081\nl0 -0c4,-6.7,10,-10,18,-10 H400000\nv40H1014.6\ns-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185\nc-2,6,-10,9,-24,9\nc-8,0,-12,-0.7,-12,-2z M1001 80\nh400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7356em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:9.8049em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"范围缩放\">范围缩放</h3>\n<p>对于 sample = [a,b,c] , min=a, max=c</p>\n<ol>\n<li>\n<p>兜底,让 min=0</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><msup><mi>e</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mo stretchy=\"false\">[</mo><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>b</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo separator=\"true\">,</mo><msup><mi>c</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">]</mo><mo>=</mo><mo stretchy=\"false\">[</mo><mi>a</mi><mo>−</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>b</mi><mo>−</mo><mi>a</mi><mo separator=\"true\">,</mo><mi>c</mi><mo>−</mo><mi>a</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">sample&#x27; = [a&#x27; , b&#x27; , c&#x27; ] = [a-a, b-a, c-a]\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9963em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">am</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0519em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mclose\">]</span></span></span></span></span></p>\n</li>\n<li>\n<p>缩放,把范围控制在 [0,1]</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>s</mi><mi>a</mi><mi>m</mi><mi>p</mi><mi>l</mi><msup><mi>e</mi><mrow><mo mathvariant=\"normal\">′</mo><mo mathvariant=\"normal\">′</mo></mrow></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">[</mo><mfrac><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><msup><mi>c</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mfrac><mo separator=\"true\">,</mo><mfrac><msup><mi>b</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><msup><mi>c</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mfrac><mo separator=\"true\">,</mo><mfrac><msup><mi>c</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><msup><mi>c</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mfrac><mo stretchy=\"false\">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">[</mo><mfrac><mrow><mi>a</mi><mo>−</mo><mi>a</mi></mrow><mrow><mi>c</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mo separator=\"true\">,</mo><mfrac><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow><mrow><mi>c</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mo separator=\"true\">,</mo><mfrac><mrow><mi>c</mi><mo>−</mo><mi>a</mi></mrow><mrow><mi>c</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mo stretchy=\"false\">]</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mfrac><mrow><mi>b</mi><mo>−</mo><mi>a</mi></mrow><mrow><mi>c</mi><mo>−</mo><mi>a</mi></mrow></mfrac><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">]</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\nsample&#x27;&#x27; &amp;= [\\frac{a&#x27;}{c&#x27;}, \\frac{b&#x27;}{c&#x27;}, \\frac{c&#x27;}{c&#x27;} ]\n\\\\ &amp;= [\\frac{a-a}{c-a}, \\frac{b-a}{c-a}, \\frac{c-a}{c-a} ]\n\\\\ &amp;= [0, \\frac{b-a}{c-a}, 1 ]\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:7.2964em;vertical-align:-3.3982em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.8982em;\"><span style=\"top:-5.8982em;\"><span class=\"pstrut\" style=\"height:3.4289em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\">am</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">pl</span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′′</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.5408em;\"><span class=\"pstrut\" style=\"height:3.4289em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.1em;\"><span class=\"pstrut\" style=\"height:3.4289em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.3982em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.8982em;\"><span style=\"top:-5.8982em;\"><span class=\"pstrut\" style=\"height:3.4289em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4289em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6779em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4289em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6779em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.4289em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6779em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7519em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">]</span></span></span><span style=\"top:-3.5408em;\"><span class=\"pstrut\" style=\"height:3.4289em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mclose\">]</span></span></span><span style=\"top:-1.1em;\"><span class=\"pstrut\" style=\"height:3.4289em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">c</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">a</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">]</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.3982em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n</ol>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"归一化\">归一化</h3>\n<p>转化后的数据在 [0,1] , 反应某数据在当前行所占比重</p>\n<p>例:对于 sample 某 row 中的值 a</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>a</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo>=</mo><mfrac><mi>a</mi><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant=\"normal\">∣</mi><mi>r</mi><mi>o</mi><mi>w</mi><mo stretchy=\"false\">[</mo><mi>i</mi><mo stretchy=\"false\">]</mo><mi mathvariant=\"normal\">∣</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">a&#x27; = \\frac{a}{\\sum_{i=1}^n |row[i]|}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8019em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.1016em;vertical-align:-0.994em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1076em;\"><span style=\"top:-2.3057em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mop\"><span class=\"mop op-symbol small-op\" style=\"position:relative;top:0em;\">∑</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8043em;\"><span style=\"top:-2.4003em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.2029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2997em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">ro</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">i</span><span class=\"mclose\">]</span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.994em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"二值化\">二值化</h3>\n<p>设置阈值,大于阈值的设为 1,小于阈值的设为 0</p>\n<p>没啥可说的…不举例了</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"OneHot-独热编码\">OneHot-独热编码</h3>\n<p>独热编码是稀疏矩阵的一种应用 <sup id='cite_ref-8'><a href=\"#cite_note-8\">[8]</a></sup></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext>男</mtext></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext>足球</mtext></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext>女</mtext></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext>篮球</mtext></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>20</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext>男</mtext></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext>桌球</mtext></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>30</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext>女</mtext></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mtext>网球</mtext></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n  男 &amp; 足球 &amp; 10\\\\\n  女 &amp; 篮球 &amp; 20\\\\\n  男 &amp; 桌球 &amp; 30\\\\\n  女 &amp; 网球 &amp; 10\\\\\n\\end{bmatrix}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.8em;vertical-align:-2.15em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.65em;\"><span class=\"pstrut\" style=\"height:6.8em;\"></span><span style=\"width:0.667em;height:4.800em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"4.800em\" viewBox=\"0 0 667 4800\"><path d=\"M403 1759 V84 H666 V0 H319 V1759 v1200 v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v1200 v1759 h84z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">男</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">女</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">男</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">女</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">足球</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">篮球</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">桌球</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">网球</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">20</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">30</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.65em;\"><span class=\"pstrut\" style=\"height:6.8em;\"></span><span style=\"width:0.667em;height:4.800em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"4.800em\" viewBox=\"0 0 667 4800\"><path d=\"M347 1759 V0 H0 V84 H263 V1759 v1200 v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v1200 v1759 h84z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li>\n<p>对于离散数据的分类任务, 我们常需要做<code>特征数字化</code>: <sup id='cite_ref-4'><a href=\"#cite_note-4\">[4]</a></sup></p>\n<p>对于某一列数据中有 n 种类型, 就用 n 位编码表示,不同类型使用不同激活位,如下:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo fence=\"true\">[</mo><mtable rowspacing=\"0.16em\" columnalign=\"center center center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1000</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>100</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>01</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0100</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>010</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>10</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0010</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>001</mn></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>01</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0001</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>100</mn></mstyle></mtd></mtr></mtable><mo fence=\"true\">]</mo></mrow><annotation encoding=\"application/x-tex\">\\begin{bmatrix}\n  10 &amp; 1000 &amp; 100\\\\\n  01 &amp; 0100 &amp; 010\\\\\n  10 &amp; 0010 &amp; 001\\\\\n  01 &amp; 0001 &amp; 100\\\\\n\\end{bmatrix}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.8em;vertical-align:-2.15em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.65em;\"><span class=\"pstrut\" style=\"height:6.8em;\"></span><span style=\"width:0.667em;height:4.800em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"4.800em\" viewBox=\"0 0 667 4800\"><path d=\"M403 1759 V84 H666 V0 H319 V1759 v1200 v1759 h347 v-84\nH403z M403 1759 V0 H319 V1759 v1200 v1759 h84z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">01</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">10</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">01</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1000</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0100</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0010</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">0001</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"arraycolsep\" style=\"width:0.5em;\"></span><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.81em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">100</span></span></span><span style=\"top:-3.61em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">010</span></span></span><span style=\"top:-2.41em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">001</span></span></span><span style=\"top:-1.21em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">100</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.65em;\"><span style=\"top:-4.65em;\"><span class=\"pstrut\" style=\"height:6.8em;\"></span><span style=\"width:0.667em;height:4.800em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.667em\" height=\"4.800em\" viewBox=\"0 0 667 4800\"><path d=\"M347 1759 V0 H0 V84 H263 V1759 v1200 v1759 H0 v84 H347z\nM347 1759 V0 H263 V1759 v1200 v1759 h84z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.15em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n<li>\n<p>关于为什么这么做? 直接[0,0,0], [0,1,2] 这种表示不行吗?</p>\n<p>上面 row1 和 row3 都是男, 问题在于我们无法单纯通过 1 和 3 这俩数字来判断他俩是否是同一类型的</p>\n<p>对于编码后的,想找’男’这个类型,只需要查找第一位是’1’的数据</p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"标签编码\">标签编码</h3>\n<p>可以理解为上面独热编码的子步骤,一言以蔽之:</p>\n<p>[红,黄,蓝,黄] -&gt; [1,2,3,2]</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"评估方法\">评估方法</h2>\n<ul>\n<li>\n<p>平均绝对误差</p>\n</li>\n<li>\n<p>均方误差</p>\n</li>\n<li>\n<p>中位数绝对误差</p>\n</li>\n<li>\n<p>R2 决定系数</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>令</mtext><msub><mi>y</mi><mi>i</mi></msub><mtext>表示真实值</mtext><mo separator=\"true\">,</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><mtext>表示预测值</mtext><mo separator=\"true\">,</mo><mover accent=\"true\"><mi>y</mi><mo stretchy=\"true\">‾</mo></mover><mtext>为平均值</mtext><mspace linebreak=\"newline\"></mspace><mtext> </mtext><mspace linebreak=\"newline\"></mspace><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>回归平方和</mtext><mi>S</mi><mi>S</mi><mi>R</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><mo>−</mo><mover accent=\"true\"><mi>y</mi><mo stretchy=\"true\">‾</mo></mover><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>残差平方和</mtext><mi>S</mi><mi>S</mi><mi>E</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>总离差平方和</mtext><mi>S</mi><mi>S</mi><mi>T</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>S</mi><mi>S</mi><mi>R</mi><mo>+</mo><mi>S</mi><mi>S</mi><mi>E</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><mover accent=\"true\"><mi>y</mi><mo stretchy=\"true\">‾</mo></mover><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>R</mi><mn>2</mn><mtext>决定系数</mtext><mo>:</mo><msup><mi>R</mi><mn>2</mn></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mfrac><mrow><mi>S</mi><mi>S</mi><mi>E</mi></mrow><mrow><mi>S</mi><mi>S</mi><mi>T</mi></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable></mrow><annotation encoding=\"application/x-tex\">令 y_i 表示真实值, \\hat y_i 表示预测值, \\overline y 为平均值\n\n\\\\ \\ \\\\\n\n\\begin{aligned}\n  回归平方和 SSR\n  &amp;= \\sum_{i=1}^n (\\hat y_i - \\overline y)^2 \\\\\n\n  残差平方和 SSE\n  &amp;= \\sum_{i=1}^n (y_i - \\hat y_i)^2 \\\\\n\n  总离差平方和 SST\n  &amp;= SSR + SSE \\\\\n  &amp;= \\sum_{i=1}^n (y_i - \\overline y)^2\n\n  \\\\ \\ \\\\\n\n  R2决定系数: R^2\n  &amp;= 1 - \\frac{SSE}{SST}\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord cjk_fallback\">令</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">表示真实值</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord cjk_fallback\">表示预测值</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord overline\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6306em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.5506em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"overline-line\" style=\"border-bottom-width:0.04em;\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mord cjk_fallback\">为平均值</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0em;\"></span><span class=\"mspace\"> </span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:15.0335em;vertical-align:-7.2668em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:7.7668em;\"><span style=\"top:-9.7668em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">回归平方和</span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">SSR</span></span></span><span style=\"top:-6.5377em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">残差平方和</span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">SSE</span></span></span><span style=\"top:-4.12em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">总离差平方和</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">SST</span></span></span><span style=\"top:-1.8086em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.609em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:2.6294em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"mord\">2</span><span class=\"mord cjk_fallback\">决定系数</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">R</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:7.2668em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:7.7668em;\"><span style=\"top:-9.7668em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord overline\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6306em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.5506em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"overline-line\" style=\"border-bottom-width:0.04em;\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-6.5377em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-4.12em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.00773em;\">SSR</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">SSE</span></span></span><span style=\"top:-1.8086em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord overline\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6306em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.5506em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"overline-line\" style=\"border-bottom-width:0.04em;\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:2.6294em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">SST</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">SSE</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:7.2668em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"基本问题\">基本问题</h2>\n<ul>\n<li>\n<p>回归-分类问题</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RsMidr.png\" alt=\"\"></p>\n<p>回归: 输出连续, 例如预测房价股价</p>\n<p>分类: 输出离散, 例如产品质量好坏检测,手写体识别</p>\n</li>\n<li>\n<p>聚类: 把输入数据相似度高的堆一起</p>\n<p>例如把各种水果照片聚类出来,分出品种</p>\n<p>对于购物网站, 可以根据用户对商品的喜好度, 搞出<code>推荐算法</code></p>\n</li>\n<li>\n<p>降维问题</p>\n</li>\n</ul>\n<blockquote>\n<p>借个图 <sup id='cite_ref-6'><a href=\"#cite_note-6\">[6]</a></sup> &gt; <img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RlX7Tb.png\" alt=\"\"></p>\n</blockquote>\n<hr>\n<h3 id=\"回归问题\">回归问题</h3>\n<h4 id=\"线性回归\">线性回归</h4>\n<p>对于输入的属性 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>3</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>x</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">x=(x_1,x_2,x_3...x_n)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span>,输出 y 为:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left right\" columnspacing=\"0em 1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi>y</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>w</mi><mi>n</mi></msub><msub><mi>x</mi><mi>n</mi></msub><mo>+</mo><mi>b</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo stretchy=\"false\">(</mo><mtext>多项式形式</mtext><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mo stretchy=\"false\">(</mo><mtext>向量形式</mtext><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n  y\n  &amp;= w_1 x_1 + w_2 x_2 + ... w_n x_n + b &amp; (多项式形式) \\\\\n  &amp;= w^T x + b &amp; (向量形式)\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.0513em;vertical-align:-1.2757em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7757em;\"><span style=\"top:-3.9357em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-2.3843em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2757em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7757em;\"><span style=\"top:-3.9357em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-2.3843em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2757em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.7757em;\"><span style=\"top:-3.9357em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">多项式形式</span><span class=\"mclose\">)</span></span></span><span style=\"top:-2.3843em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">向量形式</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2757em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>其中 权重 w 与 b 是通过学习后模型确定的</p>\n<p>学习: 寻找最小的损失函数 loss -&gt; 最优线性模型</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"多项式回归\">多项式回归</h4>\n<p>从几何角度理解就是把直线变成了曲线</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi>y</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>w</mi><mn>0</mn></msub><mo>+</mo><msub><mi>w</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>w</mi><mi>n</mi></msub><msup><mi>x</mi><mi>n</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><msup><mi>x</mi><mi>i</mi></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n  y\n  &amp;= w_0 + w_1 x + w_2 x^2 + ... w_n x^n \\\\\n  &amp;= \\sum_{i=1}^{n} w_i x^i\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.7532em;vertical-align:-2.1266em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6266em;\"><span style=\"top:-5.4139em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-3.1025em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.1266em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6266em;\"><span style=\"top:-5.4139em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.1025em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8747em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.1266em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"Lasso-岭回归\">Lasso-岭回归</h4>\n<p>Lasso 和 岭 这两种都是在线性回归基础上对损失函数正则化的回归算法, 降低了偏差大的样本权重, <code>防止过拟合</code></p>\n<ul>\n<li>\n<p>Lasso (Least absolute shrinkage and selection operator, 最小绝对值收敛和选择算法/套索算法), 使用 L1 正则</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"script\">L</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"normal\">∣</mi><mi>w</mi><mi mathvariant=\"normal\">∣</mi><msub><mi mathvariant=\"normal\">∣</mi><mn>1</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L} = \\frac{1}{2} \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2\n+ \\lambda ||w||_1\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\">∣∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<hr>\n</li>\n<li>\n<p>岭回归 (Ridge regression), 用 L2 正则</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"script\">L</mi><mo>=</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi>λ</mi><mi mathvariant=\"normal\">∣</mi><mi mathvariant=\"normal\">∣</mi><mi>w</mi><mi mathvariant=\"normal\">∣</mi><msub><mi mathvariant=\"normal\">∣</mi><mn>2</mn></msub></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L} = \\frac{1}{2} \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2\n+ \\lambda ||w||_2\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">2</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">λ</span><span class=\"mord\">∣∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"决策树-随机森林\">决策树-随机森林</h3>\n<p>decision tree, 决策树可用于 classification + regression; 学习决策树需要用到<a href=\"../../../experience/basic/%E9%80%9A%E4%BF%A1%E6%8A%80%E6%9C%AF#%E4%BF%A1%E6%81%AF%E7%86%B5-%E5%A6%82%E4%BD%95%E5%BA%A6%E9%87%8F%E4%BF%A1%E6%81%AF\">信息论知识</a> 参考课程: <sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup></p>\n<h4 id=\"简化概念\">简化概念</h4>\n<ul>\n<li>\n<p>CART 决策树选择算法</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RtsbJ9.png\" alt=\"\"></p>\n</li>\n<li>\n<p>随机森林</p>\n<p>不同的特征选择方式产生不同的决策树,组在一起就是随机森林</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RtsWMP.png\" alt=\"\"></p>\n</li>\n</ul>\n<hr>\n<h4 id=\"分类\">分类</h4>\n<ul>\n<li>\n<p>我们想对一组 iris 数据做花种分类</p>\n<p>有 setosa,versicolor,virginica 三类</p>\n<p>鉴于 2d 展示图易观察,我们只取前两列 (花萼长度,宽度) 作为输入,最后一列作为输出,训练模型</p>\n<figure class=\"highlight apache\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">4</span>.<span class=\"number\">8</span>,<span class=\"number\">3</span>.<span class=\"number\">0</span>,<span class=\"number\">1</span>.<span class=\"number\">4</span>,<span class=\"number\">0</span>.<span class=\"number\">3</span>,Iris-setosa</span><br><span class=\"line\"><span class=\"attribute\">5</span>.<span class=\"number\">1</span>,<span class=\"number\">3</span>.<span class=\"number\">8</span>,<span class=\"number\">1</span>.<span class=\"number\">6</span>,<span class=\"number\">0</span>.<span class=\"number\">2</span>,Iris-setosa</span><br><span class=\"line\"><span class=\"attribute\">4</span>.<span class=\"number\">6</span>,<span class=\"number\">3</span>.<span class=\"number\">2</span>,<span class=\"number\">1</span>.<span class=\"number\">4</span>,<span class=\"number\">0</span>.<span class=\"number\">2</span>,Iris-setosa</span><br><span class=\"line\"><span class=\"attribute\">5</span>.<span class=\"number\">0</span>,<span class=\"number\">3</span>.<span class=\"number\">3</span>,<span class=\"number\">1</span>.<span class=\"number\">4</span>,<span class=\"number\">0</span>.<span class=\"number\">2</span>,Iris-setosa</span><br><span class=\"line\"><span class=\"attribute\">7</span>.<span class=\"number\">0</span>,<span class=\"number\">3</span>.<span class=\"number\">2</span>,<span class=\"number\">4</span>.<span class=\"number\">7</span>,<span class=\"number\">1</span>.<span class=\"number\">4</span>,Iris-versicolor</span><br><span class=\"line\"><span class=\"attribute\">6</span>.<span class=\"number\">4</span>,<span class=\"number\">3</span>.<span class=\"number\">2</span>,<span class=\"number\">4</span>.<span class=\"number\">5</span>,<span class=\"number\">1</span>.<span class=\"number\">5</span>,Iris-versicolor</span><br><span class=\"line\"><span class=\"attribute\">6</span>.<span class=\"number\">2</span>,<span class=\"number\">2</span>.<span class=\"number\">9</span>,<span class=\"number\">4</span>.<span class=\"number\">3</span>,<span class=\"number\">1</span>.<span class=\"number\">3</span>,Iris-versicolor</span><br><span class=\"line\"><span class=\"attribute\">5</span>.<span class=\"number\">1</span>,<span class=\"number\">2</span>.<span class=\"number\">5</span>,<span class=\"number\">3</span>.<span class=\"number\">0</span>,<span class=\"number\">1</span>.<span class=\"number\">1</span>,Iris-versicolor</span><br><span class=\"line\"><span class=\"attribute\">5</span>.<span class=\"number\">7</span>,<span class=\"number\">2</span>.<span class=\"number\">8</span>,<span class=\"number\">4</span>.<span class=\"number\">1</span>,<span class=\"number\">1</span>.<span class=\"number\">3</span>,Iris-versicolor</span><br><span class=\"line\"><span class=\"attribute\">5</span>.<span class=\"number\">8</span>,<span class=\"number\">2</span>.<span class=\"number\">7</span>,<span class=\"number\">5</span>.<span class=\"number\">1</span>,<span class=\"number\">1</span>.<span class=\"number\">9</span>,Iris-virginica</span><br><span class=\"line\"><span class=\"attribute\">7</span>.<span class=\"number\">1</span>,<span class=\"number\">3</span>.<span class=\"number\">0</span>,<span class=\"number\">5</span>.<span class=\"number\">9</span>,<span class=\"number\">2</span>.<span class=\"number\">1</span>,Iris-virginica</span><br><span class=\"line\"><span class=\"attribute\">6</span>.<span class=\"number\">3</span>,<span class=\"number\">2</span>.<span class=\"number\">9</span>,<span class=\"number\">5</span>.<span class=\"number\">6</span>,<span class=\"number\">1</span>.<span class=\"number\">8</span>,Iris-virginica</span><br><span class=\"line\"><span class=\"attribute\">6</span>.<span class=\"number\">5</span>,<span class=\"number\">3</span>.<span class=\"number\">0</span>,<span class=\"number\">5</span>.<span class=\"number\">8</span>,<span class=\"number\">2</span>.<span class=\"number\">2</span>,Iris-virginica</span><br></pre></td></tr></table></figure>\n<p>下图为训练数据(点) 和 测试数据(星) 的分布</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R4evt0.png\" alt=\"\"></p>\n<p>模型的决策树如下 (颜色表示类别, 颜色深度表示确定程度)</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R4edC5.png\" alt=\"\"></p>\n<hr>\n</li>\n<li>\n<p>下面来分析一下决策树如何分类的:</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R4eQqc.png\" alt=\"\"></p>\n<p>根节点选取了 105 个输入, 其中最多的是 virginica 37 个, class=virginica</p>\n<p>暂且不看每个节点的熵 entropy 是怎么计算的,看一下比较:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>H</mi><mtext>差</mtext></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><msub><mo stretchy=\"false\">)</mo><mtext>根节点熵</mtext></msub><mo>−</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Y</mi><msub><mo stretchy=\"false\">)</mo><mtext>子节点条件熵和</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>1.58</mn><msub><mn>2</mn><mtext>根节点熵</mtext></msub><mo>−</mo><msub><mrow><mo fence=\"true\">(</mo><mfrac><mrow><mn>33</mn><mo>+</mo><mn>4</mn><mo>+</mo><mn>1</mn></mrow><mn>105</mn></mfrac><mo>⋅</mo><mn>0.657</mn><mo>+</mo><mfrac><mrow><mn>3</mn><mo>+</mo><mn>28</mn><mo>+</mo><mn>36</mn></mrow><mn>105</mn></mfrac><mo>⋅</mo><mn>1.208</mn><mo fence=\"true\">)</mo></mrow><mtext>子节点条件熵和</mtext></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>0.573</mn></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n  H_差\n  &amp;= H(X)_{根节点熵} - H(X|Y)_{子节点条件熵和} \\\\\n  &amp;= 1.582_{根节点熵} - \\left( \\frac{33+4+1}{105} \\cdot 0.657 + \\frac{3+28+36}{105} \\cdot 1.208 \\right)_{子节点条件熵和} \\\\\n  &amp;= 0.573\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:5.7497em;vertical-align:-2.6249em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.1249em;\"><span style=\"top:-5.7349em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0813em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord cjk_fallback mtight\">差</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.6249em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"></span></span><span style=\"top:-1.4851em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6249em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.1249em;\"><span style=\"top:-5.7349em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">根节点熵</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">子节点条件熵和</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.6249em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1.58</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">根节点熵</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">(</span></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">105</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">33</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">0.657</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">105</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">3</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">28</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">36</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1.208</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size3\">)</span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:-0.5214em;\"><span style=\"top:-1.7003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">子节点条件熵和</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9997em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-1.4851em;\"><span class=\"pstrut\" style=\"height:3.45em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0.573</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6249em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>决策树就是通过一层层的 <code>条件 Y</code> (如 sepal lenth &lt;= 5.45) 来减小熵,增大确定性来解决分类确定度问题</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R4tSlC.png\" alt=\"\"></p>\n<p>最后的叶子节点的熵会趋近于 0 (非常确定) 和 1 (非常不确定) 的两点分布</p>\n</li>\n</ul>\n<hr>\n<h4 id=\"信息增益\">信息增益</h4>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>杜撰一个概念</mtext><mo>:</mo><mtext>信息增益</mtext><mi>g</mi><mi>a</mi><mi>i</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo separator=\"true\">,</mo><mi>Y</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mo stretchy=\"false\">)</mo><mo>−</mo><mi>H</mi><mo stretchy=\"false\">(</mo><mi>X</mi><mi mathvariant=\"normal\">∣</mi><mi>Y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">杜撰一个概念: 信息增益 gain(X,Y) = H(X) - H(X|Y)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord cjk_fallback\">杜撰一个概念</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord cjk_fallback\">信息增益</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">ain</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.08125em;\">H</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">Y</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<ul>\n<li>\n<p>通过上面分类的例子可知, <code>gain(X,Y)</code> 就是熵下降/确定度增加的关键</p>\n<p>回过头来,条件 Y (如 sepal lenth &lt;= 5.45) 是怎么选取的?</p>\n<p>遍历特征组和取值区间,找到 max( gain(X,Y) ),即为熵下降最多的条件;</p>\n<p>(当然也需要考虑到类似贪心-DP 的区别, 全是贪心的话会让模型单一化, 所以很多时候需要<code>随机筛掉一部分条件</code>来使得条件<code>较优</code>而不是<code>最优</code>)</p>\n</li>\n</ul>\n<hr>\n<h4 id=\"深度与过拟合\">深度与过拟合</h4>\n<p>深度增加虽然能降低训练集错误率,但泛化能力会减弱-&gt;过拟合</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R4453D.png\" alt=\"\"></p>\n<hr>\n<h4 id=\"随机森林\">随机森林</h4>\n<ul>\n<li>\n<p>自动聚合-BootStrap</p>\n<p>对训练数据集进行多次有放回的随机采样 (有的样本可能从未采样,有的可能采样多次) -&gt; 随机森林 [DT1, DT2… DTn]</p>\n</li>\n<li>\n<p>如何 roll 出来数据集中部分随机数据? (比如取 80%)</p>\n<ol>\n<li>\n<p>for i in dataset</p>\n</li>\n<li>\n<p>if Math.random() &lt; 0.8: random_set.append(i)</p>\n</li>\n</ol>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"分类问题\">分类问题</h3>\n<p>从思想和实现角度看, 有下面很多种分类</p>\n<ul>\n<li>线性模型 (Linear Models)\n<ul>\n<li>逻辑回归 (Logistic Regression)</li>\n</ul>\n</li>\n<li>朴素贝叶斯 (Naive Bayes)</li>\n<li>决策树 (Decision Trees)</li>\n<li>支持向量机 (Support Vector Machines)</li>\n<li>随机梯度下降 (Stochastic Gradient Descent)</li>\n<li>最近邻 (Nearest Neighbors)</li>\n<li>高斯过程 (Gaussian Processes)</li>\n<li>集成方法/投票分类器 (Ensemble methods / voting classifier)</li>\n<li>多类别多输出 / 多类别多标签分类 (Multiclass and multioutput algorithms / multiclass and multilabel classification)</li>\n</ul>\n<hr>\n<h4 id=\"逻辑回归\">逻辑回归</h4>\n<p>虽然叫回归,但其实是<code>二分类模型</code>,是在线性回归输出基础上使用 Sigmoid/逻辑函数,将线性回归输出 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mo>−</mo><mi mathvariant=\"normal\">∞</mi><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">∞</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(-\\infty,\\infty)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">∞</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∞</span><span class=\"mclose\">)</span></span></span></span> 映射到 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(0,1)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>线性回归</mtext><mi>y</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msup><mi>w</mi><mi>T</mi></msup><mi>x</mi><mo>+</mo><mi>b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msub><mi>x</mi><mn>2</mn></msub><mo>+</mo><msub><mi>w</mi><mn>3</mn></msub><msub><mi>x</mi><mn>3</mn></msub><mo>+</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo>+</mo><mi>b</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>逻辑回归</mtext><msup><mi>y</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>S</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>o</mi><mi>i</mi><mi>d</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>y</mi></mrow></msup></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n  线性回归 y\n  &amp;= w^Tx + b \\\\\n  &amp;= w_1x_1 + w_2x_2 + w_3x_3 + ... +  b\n\n  \\\\ \\ \\\\\n  逻辑回归 y&#x27;\n  &amp;= Sigmoid(y) \\\\\n  &amp;= \\frac{1}{1 + e^{-y}}\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:8.4421em;vertical-align:-3.9711em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.4711em;\"><span style=\"top:-6.9012em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">线性回归</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span><span style=\"top:-5.4012em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.9012em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:-2.4012em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">逻辑回归</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-0.4197em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.9711em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.4711em;\"><span style=\"top:-6.9012em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-5.4012em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">...</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">b</span></span></span><span style=\"top:-2.4012em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05764em;\">S</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">m</span><span class=\"mord mathnormal\">o</span><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\">d</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.4197em;\"><span class=\"pstrut\" style=\"height:3.3214em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">e</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6973em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">−</span><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03588em;\">y</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7693em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.9711em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>逻辑回归也是可以做多分类的, 原理就是多个二分类叠加起来</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"支持向量机-SVM\">支持向量机-SVM</h4>\n<h5 id=\"target\">target</h5>\n<p>SVM 目标就是找到如下红色实线 (与线两边样本点距离最大的线)</p>\n<p>两条虚线上的点叫做 <code>support vector / 支持向量</code>, 通过支持向量构造出的分类器就是 <code>支持向量机 SVM</code></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RSmQRP.png\" alt=\"\"></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>如有直线</mtext><mn>2</mn><msub><mi>x</mi><mn>1</mn></msub><mo>+</mo><mn>5</mn><msub><mi>x</mi><mn>2</mn></msub><mo>−</mo><mn>10</mn><mo>=</mo><mn>0</mn><mtext>可转换为向量形式</mtext><mspace linebreak=\"newline\"></mspace><mover accent=\"true\"><mi>w</mi><mo>⃗</mo></mover><mo>=</mo><mo stretchy=\"false\">(</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>5</mn><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace><mover accent=\"true\"><mi>x</mi><mo>⃗</mo></mover><mo>=</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mspace linebreak=\"newline\"></mspace><mover accent=\"true\"><mi>w</mi><mo>⃗</mo></mover><mo>⋅</mo><mover accent=\"true\"><mi>x</mi><mo>⃗</mo></mover><mo>+</mo><mi>b</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding=\"application/x-tex\">如有直线 2x_1 + 5x_2 - 10 = 0 可转换为向量形式 \\\\\n\\vec{w} = (2,5) \\\\\n\\vec{x} = (x_1,x_2) \\\\\n\\vec{w} \\cdot \\vec{x} + b = 0\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8333em;vertical-align:-0.15em;\"></span><span class=\"mord cjk_fallback\">如有直线</span><span class=\"mord\">2</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7944em;vertical-align:-0.15em;\"></span><span class=\"mord\">5</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">10</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">0</span><span class=\"mord cjk_fallback\">可转换为向量形式</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.714em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1522em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">5</span><span class=\"mclose\">)</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.714em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2077em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.714em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1522em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7973em;vertical-align:-0.0833em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">x</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2077em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0</span></span></span></span></span></p>\n<hr>\n<h5 id=\"线性可分-不可分\">线性可分-不可分</h5>\n<p>如上面的图示, 样本可被直线/超平面分开 (线性可分), 支持向量所在两虚线之间没有其他向量,即为 <code>线性可分 SVM</code></p>\n<p>如果两虚线间存在样本, 即为 <code>线性 SVM</code>; 如果样本无法被直线/超平面分开 (线性不可分), 即为 <code>非线性 SVM</code></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Riakiv.png\" alt=\"\"></p>\n<p>对于线性不可分问题,可通过 <code>核函数</code> 进行特征变换来 <code>升维</code></p>\n<hr>\n<h5 id=\"核函数\">核函数</h5>\n<p>常用的有为 1 和 3, 多项式核函数用处较少</p>\n<ol>\n<li>\n<p>线性核函数 Linear</p>\n<p>不做升维,直接找直线/超平面; 类似美国地图,分割直来直去的</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RiXoc0.png\" alt=\"\"></p>\n</li>\n<li>\n<p>多项式核函数 poly (Polynomial Kernel)</p>\n<p>通过增加高次项升维, 此函数复杂度升的很快</p>\n</li>\n<li>\n<p>径向基核函数-高斯核函数 rbf (Radial Basis Function Kernel)</p>\n<p>相对于多项式核函数,大多数情况下参数更少性能更高; 直线分不了的无脑冲 rbf</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RiXFVm.png\" alt=\"\"></p>\n</li>\n</ol>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"朴素贝叶斯\">朴素贝叶斯</h4>\n<p>Naive Bayes classification,理论基础是大学必修课-概率论知识</p>\n<ul>\n<li>\n<p>&quot;朴素&quot;指的是 A,B 为独立事件, 有贝叶斯公式:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>A</mi><mi mathvariant=\"normal\">∣</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>A</mi><mo stretchy=\"false\">)</mo><mi>P</mi><mo stretchy=\"false\">(</mo><mi>B</mi><mi mathvariant=\"normal\">∣</mi><mi>A</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>B</mi><mo stretchy=\"false\">)</mo></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">P(A|B) = \\frac{P(A)P(B|A)}{P(B)}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p><code>先验概率</code> P(A) : 已知或可推断出事件 A 发生的概率</p>\n<p><code>后验概率</code> P(A|B) : 已知 B 发生条件下,A 发生的概率</p>\n<hr>\n</li>\n<li>\n<p>对于样本特征 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>w</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>w</mi><mn>3</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>w</mi><mi>n</mi></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[w_1, w_2, w_3 ... w_n]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span> 得出每个特征的概率 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><msub><mi>W</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>W</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>W</mi><mn>3</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>W</mi><mi>n</mi></msub><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[W_1, W_2, W_3 ... W_n]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span></span></span>, 判断所属分类 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>B</mi><mo separator=\"true\">,</mo><mi>C</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">[A, B, C ...]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord\">...</span><span class=\"mclose\">]</span></span></span></span> 的概率:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>A</mi><mi mathvariant=\"normal\">∣</mi><msub><mi>W</mi><mn>1</mn></msub><msub><mi>W</mi><mn>2</mn></msub><msub><mi>W</mi><mn>3</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>W</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>A</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mn>1</mn></msub><mi mathvariant=\"normal\">∣</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi><mi>A</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mi>n</mi></msub><mi mathvariant=\"normal\">∣</mi><mi>A</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mn>1</mn></msub><msub><mi>W</mi><mn>2</mn></msub><msub><mi>W</mi><mn>3</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>W</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mspace linebreak=\"newline\"></mspace><mi>P</mi><mo stretchy=\"false\">(</mo><mi>B</mi><mi mathvariant=\"normal\">∣</mi><msub><mi>W</mi><mn>1</mn></msub><msub><mi>W</mi><mn>2</mn></msub><msub><mi>W</mi><mn>3</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>W</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>B</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mn>1</mn></msub><mi mathvariant=\"normal\">∣</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi><mi>B</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mi>n</mi></msub><mi mathvariant=\"normal\">∣</mi><mi>B</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mn>1</mn></msub><msub><mi>W</mi><mn>2</mn></msub><msub><mi>W</mi><mn>3</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>W</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mspace linebreak=\"newline\"></mspace><mi>P</mi><mo stretchy=\"false\">(</mo><mi>C</mi><mi mathvariant=\"normal\">∣</mi><msub><mi>W</mi><mn>1</mn></msub><msub><mi>W</mi><mn>2</mn></msub><msub><mi>W</mi><mn>3</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>W</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><mi>C</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mn>1</mn></msub><mi mathvariant=\"normal\">∣</mi><mi>C</mi><mo stretchy=\"false\">)</mo><mo>⋅</mo><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi><mi>C</mi><mo stretchy=\"false\">)</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mi>n</mi></msub><mi mathvariant=\"normal\">∣</mi><mi>C</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi>P</mi><mo stretchy=\"false\">(</mo><msub><mi>W</mi><mn>1</mn></msub><msub><mi>W</mi><mn>2</mn></msub><msub><mi>W</mi><mn>3</mn></msub><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>W</mi><mi>n</mi></msub><mo stretchy=\"false\">)</mo></mrow></mfrac><mspace linebreak=\"newline\"></mspace><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi></mrow><annotation encoding=\"application/x-tex\">P(A | W_1 W_2 W_3 ... W_n)\n= \\frac{P(A) \\cdot P(W_1|A) \\cdot P(W_2|A) ... P(W_n|A)  }{P(W_1 W_2 W_3 ... W_n)} \\\\\n\nP(B | W_1 W_2 W_3 ... W_n)\n= \\frac{P(B) \\cdot P(W_1|B) \\cdot P(W_2|B) ... P(W_n|B)  }{P(W_1 W_2 W_3 ... W_n)} \\\\\n\nP(C | W_1 W_2 W_3 ... W_n)\n= \\frac{P(C) \\cdot P(W_1|C) \\cdot P(W_2|C) ... P(W_n|C)  }{P(W_1 W_2 W_3 ... W_n)} \\\\\n\n......\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span><span class=\"mord\">...</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\">A</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span><span class=\"mord\">...</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.363em;vertical-align:-0.936em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mclose\">)</span><span class=\"mord\">...</span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">P</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mord mathnormal\" style=\"margin-right:0.07153em;\">C</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.936em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.1056em;\"></span><span class=\"mord\">......</span></span></span></span></span></p>\n<hr>\n</li>\n<li>\n<p>特点</p>\n<p>必要的前提条件是特征间互不相关 (相互独立), 很多情况下难以满足,无法对特征关联性强的样本进行分类</p>\n<p>逻辑简单,性能起伏小且稳定,特征独立性越强分类效果越好</p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"聚类问题-cluster\">聚类问题-cluster</h3>\n<p>就像是人群根据 hobby 扎堆, 输入的数据根据某些特征的相似度分出多个&quot;簇&quot;</p>\n<p>聚类问题属于无监督学习 (无需指明训练样本所属类别)</p>\n<hr>\n<h4 id=\"样本-相似度度量\">样本-相似度度量</h4>\n<p>对于两点 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>n</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><msub><mi>n</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x_1,y_1,...n_1),(x_2,y_2,...n_2)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span></p>\n<h5 id=\"欧氏距离\">欧氏距离</h5>\n<p>无视路径阻碍的空间绝对 distance</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi>d</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence=\"true\">∣</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>n</mi><mn>1</mn></msub><mo stretchy=\"false\">)</mo><mo separator=\"true\">,</mo><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><msub><mi>y</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>n</mi><mn>2</mn></msub><mo stretchy=\"false\">)</mo><mo fence=\"true\">∣</mo></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msqrt><mrow><mo stretchy=\"false\">(</mo><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>y</mi><mn>2</mn></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup><mo>+</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo>+</mo><mo stretchy=\"false\">(</mo><msub><mi>n</mi><mn>1</mn></msub><mo>−</mo><msub><mi>n</mi><mn>2</mn></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></msqrt></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>x</mi></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>i</mi><mn>1</mn></msub><mo>−</mo><msub><mi>i</mi><mn>2</mn></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow></msqrt></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n  d\n  &amp;= \\left| (x_1, y_1, ..., n_1), (x_2, y_2, ..., n_2) \\right| \\\\\n  &amp;= \\sqrt{(x_1 - x_2)^2 + (y_1 - y_2)^2 + ... + (n_1 - n_2)^2} \\\\\n  &amp;= \\sqrt{\\sum_{i=x}^n (i_1 - i_2)^2}\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:6.6007em;vertical-align:-3.0503em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.5503em;\"><span style=\"top:-6.5895em;\"><span class=\"pstrut\" style=\"height:3.8791em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-4.9456em;\"><span class=\"pstrut\" style=\"height:3.8791em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.4065em;\"><span class=\"pstrut\" style=\"height:3.8791em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.0503em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.5503em;\"><span style=\"top:-6.5895em;\"><span class=\"pstrut\" style=\"height:3.8791em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">∣</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\">∣</span></span></span></span><span style=\"top:-4.9456em;\"><span class=\"pstrut\" style=\"height:3.8791em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9839em;\"><span class=\"svg-align\" style=\"top:-3.2em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"mord\" style=\"padding-left:1em;\"><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">...</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-2.9439em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span class=\"hide-tail\" style=\"min-width:1.02em;height:1.28em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"1.28em\" viewBox=\"0 0 400000 1296\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M263,681c0.7,0,18,39.7,52,119\nc34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120\nc340,-704.7,510.7,-1060.3,512,-1067\nl0 -0\nc4.7,-7.3,11,-11,19,-11\nH40000v40H1012.3\ns-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232\nc-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1\ns-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26\nc-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z\nM1001 80h400000v40h-400000z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2561em;\"><span></span></span></span></span></span></span></span><span style=\"top:-2.4065em;\"><span class=\"pstrut\" style=\"height:3.8791em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8791em;\"><span class=\"svg-align\" style=\"top:-5.1168em;\"><span class=\"pstrut\" style=\"height:5.1168em;\"></span><span class=\"mord\" style=\"padding-left:1.056em;\"><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.8391em;\"><span class=\"pstrut\" style=\"height:5.1168em;\"></span><span class=\"hide-tail\" style=\"min-width:0.742em;height:3.1968em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"3.1968em\" viewBox=\"0 0 400000 3196\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M702 80H40000040\nH742v3062l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\n219 661 l218 661zM702 80H400000v40H742z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.0503em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h5 id=\"曼哈顿距离\">曼哈顿距离</h5>\n<p>计量阻碍,可以理解为寻路问题,同一曼哈顿距离可有多种路径解法</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi>d</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi mathvariant=\"normal\">∣</mi><msub><mi>x</mi><mn>1</mn></msub><mo>−</mo><msub><mi>x</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi><mo>+</mo><mi mathvariant=\"normal\">∣</mi><msub><mi>y</mi><mn>1</mn></msub><mo>−</mo><msub><mi>y</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi><mo>+</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo>+</mo><mi mathvariant=\"normal\">∣</mi><msub><mi>n</mi><mn>1</mn></msub><mo>−</mo><msub><mi>n</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mi>x</mi></mrow><mi>n</mi></munderover><mi mathvariant=\"normal\">∣</mi><msub><mi>i</mi><mn>1</mn></msub><mo>−</mo><msub><mi>i</mi><mn>2</mn></msub><mi mathvariant=\"normal\">∣</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n  d\n  &amp;= |x_1 - x_2| + |y_1 - y_2| + ... + |n_1 - n_2| \\\\\n  &amp;= \\sum_{i=x}^n | i_1 - i_2 |\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:4.7291em;vertical-align:-2.1145em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6145em;\"><span style=\"top:-5.4259em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span></span></span><span style=\"top:-3.1145em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.1145em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.6145em;\"><span style=\"top:-5.4259em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">...</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.1145em;\"><span class=\"pstrut\" style=\"height:3.6514em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mathnormal mtight\">x</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.1145em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<h5 id=\"余弦相似度\">余弦相似度</h5>\n<p>cosine similarity, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mtext>在</mtext><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mi>π</mi><mo stretchy=\"false\">]</mo></mrow><annotation encoding=\"application/x-tex\">cos 在 [0, \\pi]</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mord cjk_fallback\">在</span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">π</span><span class=\"mclose\">]</span></span></span></span> 上为减函数, 在 [45°, 135°] 区间下降快</p>\n<p>余弦相似度对向量敏感度: 方向 &gt; 长度</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mover accent=\"true\"><mi>a</mi><mo>⃗</mo></mover><mo>⋅</mo><mover accent=\"true\"><mi>b</mi><mo>⃗</mo></mover></mrow><mrow><mi mathvariant=\"normal\">∣</mi><mover accent=\"true\"><mi>a</mi><mo>⃗</mo></mover><mi mathvariant=\"normal\">∣</mi><mo>⋅</mo><mi mathvariant=\"normal\">∣</mi><mover accent=\"true\"><mi>b</mi><mo>⃗</mo></mover><mi mathvariant=\"normal\">∣</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">cos(\\theta) = \\frac{\\vec a \\cdot \\vec b}{|\\vec a| \\cdot |\\vec b|}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">cos</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.7719em;vertical-align:-1.1174em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6544em;\"><span style=\"top:-2.1326em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">a</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span><span class=\"mord\">∣</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">∣</span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9774em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">b</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.714em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">a</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord accent\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.9774em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\">b</span></span><span style=\"top:-3.2634em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.2355em;\"><span class=\"overlay\" style=\"height:0.714em;width:0.471em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.471em\" height=\"0.714em\" style=\"width:0.471em\" viewBox=\"0 0 471 714\" preserveAspectRatio=\"xMinYMin\"><path d=\"M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5\n3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11\n10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63\n-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1\n-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59\nH213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359\nc-16-25.333-24-45-24-59z\"/></svg></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.1174em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<h5 id=\"以上对比\">以上对比</h5>\n<p>如下欧氏距离(绿色直线) 与哈曼顿距离(褐色折现) 与余弦相似度(红色向量) 对比</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RnsRZm.png\" alt=\"\"></p>\n<h5 id=\"闵可夫斯基距离\">闵可夫斯基距离</h5>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mi>d</mi></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msup><mrow><mo fence=\"true\">(</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant=\"normal\">∣</mi><msub><mi>i</mi><mn>1</mn></msub><mo>−</mo><msub><mi>i</mi><mn>2</mn></msub><msup><mi mathvariant=\"normal\">∣</mi><mi>p</mi></msup><mo fence=\"true\">)</mo></mrow><mfrac><mn>1</mn><mi>p</mi></mfrac></msup></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n  d\n  &amp;= \\left( \\sum_{i=1}^n |i_1 - i_2|^p \\right)^{\\frac{1}{p}}\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.6716em;vertical-align:-1.5858em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0858em;\"><span style=\"top:-4.0858em;\"><span class=\"pstrut\" style=\"height:4.0939em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5858em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0858em;\"><span style=\"top:-4.0858em;\"><span class=\"pstrut\" style=\"height:4.0939em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">(</span></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7144em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size4\">)</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.0939em;\"><span style=\"top:-4.5029em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\"><span class=\"mopen nulldelimiter sizing reset-size3 size6\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8443em;\"><span style=\"top:-2.656em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span style=\"top:-3.2255em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line mtight\" style=\"border-bottom-width:0.049em;\"></span></span><span style=\"top:-3.384em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size3 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.4829em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter sizing reset-size3 size6\"></span></span></span></span></span></span></span></span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.5858em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<ul>\n<li>\n<p>改变 p 的值,可以转化为其他距离:</p>\n<p>p=1 : 哈曼顿距离</p>\n<p>p=2 : 欧氏距离</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>⇒</mo><mi mathvariant=\"normal\">∞</mi></mrow><annotation encoding=\"application/x-tex\">p \\rArr \\infty</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⇒</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord\">∞</span></span></span></span> : 切比雪夫距离</p>\n</li>\n</ul>\n<h5 id=\"交并比-IOU-杰卡德相似系数\">交并比-IOU-杰卡德相似系数</h5>\n<p>Jaccard 相似系数/交并比可用于目标检测中 <code>目标位置-预测位置</code> 的相似度分析</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>A</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>a</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>a</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>a</mi><mi>n</mi></msub><mo stretchy=\"false\">]</mo><mspace width=\"2em\"/><mi>B</mi><mo>=</mo><mo stretchy=\"false\">[</mo><msub><mi>b</mi><mn>1</mn></msub><mo separator=\"true\">,</mo><msub><mi>b</mi><mn>2</mn></msub><mo separator=\"true\">,</mo><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mo separator=\"true\">,</mo><msub><mi>b</mi><mi>n</mi></msub><mo stretchy=\"false\">]</mo><mspace linebreak=\"newline\"></mspace><mtext> </mtext><mspace linebreak=\"newline\"></mspace><mi>J</mi><mo stretchy=\"false\">(</mo><mi>A</mi><mo separator=\"true\">,</mo><mi>B</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mi>A</mi><mo>∩</mo><mi>B</mi></mrow><mrow><mi>A</mi><mo>∪</mo><mi>B</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">A = [a_1, a_2, ..., a_n] \\qquad B = [b_1, b_2, ..., b_n]\n\\\\ \\ \\\\\nJ(A,B) = \\frac{A \\cap B}{A \\cup B}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">a</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">...</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">b</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\">]</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0em;\"></span><span class=\"mspace\"> </span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">A</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0463em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3603em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∪</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">A</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∩</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05017em;\">B</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Rnm1a9.png\" alt=\"\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZCYX1g.png\" alt=\"\"></p>\n<p>上面假定的是 A,B 中样本权重相同, 实际聚类中需要考量样本的权重</p>\n<h5 id=\"相对熵\">相对熵</h5>\n<blockquote>\n<p>参见 <a href=\"../../../../experience/basic/%E9%80%9A%E4%BF%A1%E6%8A%80%E6%9C%AF#%E7%9B%B8%E5%AF%B9%E7%86%B5\">👽 通信-信息论-开坑自埋</a></p>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"聚类算法划分\">聚类算法划分</h4>\n<h5 id=\"原型-K-Means\">原型-K-Means</h5>\n<p>prototype-based clustering, 用原型表示聚类结构, 然后通过对原型的更新来完善聚类算法</p>\n<ul>\n<li>\n<p>常用 <code>K-均值 / K-Means 算法</code>: 若干样本聚类为 k 个簇, k 为指定参数</p>\n<ol>\n<li>\n<p>随机挑选 k 个样本, 计算其他所有样本与此 k 个样本的欧氏距离,离谁近就归为哪一簇</p>\n</li>\n<li>\n<p>对每一个簇, 计算其中所有样本的均值中心, 并将这 k 个均值中心作为 1. 中的样本再次重复</p>\n</li>\n<li>\n<p>直到均值中心不再变化/变化小于阈值</p>\n</li>\n</ol>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RntO7D.png\" alt=\"\"></p>\n</li>\n<li>\n<p>K-Means 对 <code>距离很远的异常点</code> 和 <code>初始样本点的选择</code> 是敏感的</p>\n<p>遇到影响大的异常点时可以换为 <code>K-中位数/ K-Mediods 算法</code></p>\n<p>当初始样本点选择不当时,会使聚类结果不好,如下图</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Rn4BGm.png\" alt=\"\"></p>\n<hr>\n</li>\n<li>\n<p>改良 -&gt; K-Means++</p>\n<p>初始样本点的选取: 要选择的样本点与已选择样本点距离越远越好</p>\n<p>方案: 每选择样本点后计算 <code>未选择样本</code> 与 <code>已选择样本组</code> 的距离, 使未选择样本下一次的选择概率与距离成正比</p>\n</li>\n<li>\n<p>数据分布对 K-Means 的影响:</p>\n<p>数据分布不平衡几乎没影响</p>\n<p>但是数据<code>几何畸变</code>对聚类影响很大; K-Means 对符合高斯/正态分布的样本 (大致是圈的样子) 的聚类效果最好, 对带状样本聚类效果差</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Rn44kv.png\" alt=\"\"></p>\n<p>无论如何调参, K-Means 都不适用于如下情况:</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Rnn4H1.png\" alt=\"\"></p>\n</li>\n<li>\n<p>Mini-Batch K-Means:</p>\n<p>对所有样本求均值计算量还是蛮大的, Mini-Batch 思想大致是抽取一部分样本求均值来近似总均值</p>\n</li>\n<li>\n<p>特点:</p>\n<p>简单快速, 可解决大批量聚类,对于符合高斯分布的数据聚类效果较优</p>\n<p>需要预先给出聚类簇数量 k; 对于异常点和初始样本选取敏感; 对非高斯分布样本聚类效果差</p>\n</li>\n</ul>\n<hr>\n<h5 id=\"层次-AGNES\">层次-AGNES</h5>\n<p>hierarchical clustering, 通过分层 -&gt; 树形聚类结构 -&gt; 聚类结果</p>\n<ul>\n<li>\n<p>可采用 <code>自顶向下DIANA / 自底向上AGNES</code> 的划分方式</p>\n<p>AGNES (AGglomerative NESting)最初将每个对象作为一个簇,然后这些簇一步步地合并。两个簇间的距离由这两个不同簇中距离最近的数据点对的相似度来确定；聚类的合并过程反复进行直到所有的对象最终满足簇数目。</p>\n<p>DIANA (DIvisive ANAlysis)算法是上述过程的反过程,属于分裂的层次聚类,首先将所有的对象初始化到一个簇中,然后根据一些原则(比如最大的欧式距离),将该簇分类。直到到达用户指定的簇数目或者两个簇之间的距离超过了某个阈值。</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RnH3bu.png\" alt=\"\"></p>\n<p>常用 <code>凝聚层次AGNES算法</code>.</p>\n</li>\n<li>\n<p>AGNES 簇间距离不同定义/合并策略</p>\n<ul>\n<li>\n<p>最小距离 prime</p>\n<p>两个集合中最近的两个样本的距离</p>\n<p>容易形成链状结构</p>\n</li>\n<li>\n<p>最大距离 complete</p>\n<p>两个集合中最远的两个样本的距离</p>\n<p>若存在异常值则不稳定</p>\n</li>\n<li>\n<p>平均距离 average</p>\n<p>两个集合中样本间两两距离的平均值</p>\n</li>\n<li>\n<p>方差 Ward</p>\n<p>使得簇内距离平方和最小,簇间平方和最大</p>\n</li>\n</ul>\n<hr>\n<p>如下为以上四类对于含噪点样本的聚类效果,最小距离聚类效果最好</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RnHSln.png\" alt=\"\"></p>\n</li>\n</ul>\n<hr>\n<h5 id=\"密度-DBSCAN\">密度-DBSCAN</h5>\n<p>density-based clustering, 通过样本分布密度来考察样本间的可连接性, 逐步拓展连接成最终聚类结果</p>\n<ul>\n<li>\n<p>几种密度聚类实现算法:</p>\n<p>噪声密度 DBSCAN 聚类算法</p>\n<p>密度最大值聚类</p>\n<p>AP (Affinity Propagation)</p>\n<p>谱聚类</p>\n</li>\n<li>\n<p>常用 <code>噪声密度 / DBSCAN 算法</code></p>\n<p>允许噪声的基于密度的空间聚类 DBSCAN (Density-Based Spatial Clustering of Applications with Noise)</p>\n<p>只要样本点的密度大于某阈值,则将该样本添加到最近的簇中。这类算法能克服基于距离的算法只能发现 <code>高斯分布/类圆形(凸)</code> 的聚类缺点,可发现任意形状的聚类,且对噪声数据不敏感。但计算密度单元的计算复杂度大,需要建立空间索引来降低计算量</p>\n<p>使用方面, DBSCAN 不仅可以避免噪声影响,也可以专门找噪声/剔除噪声</p>\n<hr>\n</li>\n<li>\n<p>概念</p>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">学名</th>\n<th style=\"text-align:left\">概念</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">\\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span>-邻域</td>\n<td style=\"text-align:left\">样本点在<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">\\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span> 半径内的区域</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">核心对象</td>\n<td style=\"text-align:left\">对于给定的阈值 m, 如果某样本点<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">\\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span>-邻域中其他样本点数量 n&gt;=m,那么此样本点就是核心对象</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">直接密度可达</td>\n<td style=\"text-align:left\">对于核心对象 q, p 在其圈内, 那么 p 从 q 出发是直接密度可达的</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">密度相连</td>\n<td style=\"text-align:left\">一串密度可达对象的串联</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">簇</td>\n<td style=\"text-align:left\">最大的密度相连对象集合</td>\n</tr>\n</tbody>\n</table>\n</li>\n<li>\n<p>半径<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>ε</mi></mrow><annotation encoding=\"application/x-tex\">\\varepsilon</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">ε</span></span></span></span> 与 阈值 m 的影响 (调参侠石锤)</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RnTRWm.png\" alt=\"\"></p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"模型-衡量指标\">模型-衡量指标</h4>\n<h5 id=\"均一性-homogeneity\">均一性-homogeneity</h5>\n<p>一个簇中只包含一个类别的样本</p>\n<h5 id=\"完整性-completeness\">完整性-completeness</h5>\n<p>同类别样本被归类到相同簇中</p>\n<h5 id=\"V-measure\">V-measure</h5>\n<p>均一性与完整性的加权平均</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>V</mi><mo stretchy=\"false\">(</mo><mi>β</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mfrac><mrow><mo stretchy=\"false\">(</mo><mn>1</mn><mo>+</mo><mi>β</mi><mo stretchy=\"false\">)</mo><mi>h</mi><mi>c</mi></mrow><mrow><mi>β</mi><mi>h</mi><mo>+</mo><mi>c</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">V(\\beta) = \\frac{(1+\\beta)hc}{\\beta h +c}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.22222em;\">V</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.3074em;vertical-align:-0.8804em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mord mathnormal\">h</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\">c</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.05278em;\">β</span><span class=\"mclose\">)</span><span class=\"mord mathnormal\">h</span><span class=\"mord mathnormal\">c</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8804em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n<h5 id=\"ARI-AMI\">ARI-AMI</h5>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RnnlxC.png\" alt=\"\"></p>\n<h5 id=\"轮廓系数-Silhouette\">轮廓系数-Silhouette</h5>\n<p>a: 当前样本与簇内样本距离均值</p>\n<p>b: min(当前样本与其他簇样本距离均值)</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RnndCY.png\" alt=\"\"></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"降维问题\">降维问题</h3>\n<p>比如在 3 维空间 xyz 内有一条线段, 我们只想知道线段的 x 信息, 可以把线段映射到 x-axis 上 (损失 yz-axis 上的信息)</p>\n<p>降维作用: 降低时间-空间复杂度,使数据易于分析展示 (维度越高的图人类越难理解) <sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h4 id=\"缺失值比率\">缺失值比率</h4>\n<p>Missing Value Ratio, 去掉缺失值大于某一阈值的特征列</p>\n<hr>\n<h4 id=\"低方差过滤\">低方差过滤</h4>\n<p>Low Variance Filter, 对于某些列, 所有值的方差很小/样本没啥区别, 可以不用其做特征</p>\n<hr>\n<h4 id=\"随机森林-2\">随机森林</h4>\n<p>Random Forest, 随机森林可以自动计算各个特征的重要性, 便于寻找最优+最小的特征子集</p>\n<hr>\n<h4 id=\"反向特征消除\">反向特征消除</h4>\n<p>Backward Feature Elimination, 用数据集中 n 个样本训练模型, 每次删除一个样本, 找出对模型影响最小的样本删除</p>\n<hr>\n<h4 id=\"前向特征选择\">前向特征选择</h4>\n<p>Forward Feature Selection,前向特征选择其实就是反向特征消除的相反过程,即找到能改善模型性能的最佳特征,而不是删除弱影响特征.它背后的思路如下所述：</p>\n<ol>\n<li>选择一个特征,用每个特征训练模型 n 次,得到 n 个模型.</li>\n<li>选择模型性能最佳的变量作为初始变量.</li>\n<li>每次添加一个变量继续训练,重复上一过程,最后保留性能提升最大的变量.</li>\n<li>一直添加,一直筛选,直到模型性能不再有明显提高.</li>\n</ol>\n<hr>\n<h4 id=\"因子分析\">因子分析</h4>\n<p>Factor Analysis, 因子分析是一种常见的统计方法,它能从多个变量中提取共性因子,并得到最优解.</p>\n<p>在因子分析中,我们将变量按其相关性分组,即特定组内所有变量的相关性较高,组间变量的相关性较低.我们把每个组称为一个因子,它是多个变量的组合.和原始数据集的变量相比,这些因子在数量上更少,但携带的信息基本一致.</p>\n<hr>\n<h4 id=\"主成分分析-PCA\">主成分分析-PCA</h4>\n<p>通过正交变换将原始的 n 维数据集变换到一个新的被称做主成分的数据集中,即从现有的大量变量中提取一组新的变量.下面是关于 PCA 的一些要点：</p>\n<ol>\n<li>主成分是原始变量的线性组合.</li>\n<li>第一个主成分具有最大的方差值.</li>\n<li>第二主成分试图解释数据集中的剩余方差,并且与第一主成分不相关 (正交).</li>\n<li>第三主成分试图解释前两个主成分等没有解释的方差.</li>\n</ol>\n<p>映射不包含任何数据内部的分类信息, 因此一般 PCA 降维后数据表示更有效但或许分类更加困难</p>\n<hr>\n<h4 id=\"LDA\">LDA</h4>\n<p>Linear Discriminant Analysis / Fisher Linear Discriminant 是一种有监督的 supervised 线性降维算法</p>\n<p>LDA 充分利用数据的标签信息, 一般 LDA 降维后可以直接分类</p>\n<p>假设原始数据集表示为 X,(m*n 矩阵,m 是维度,n 是 sample 的数量), 目标是找到映射向量 a, 使得 a‘X 后的数据点能够保持以下两种性质：</p>\n<ol>\n<li>\n<p>同类的数据点尽可能的接近 (within class)</p>\n</li>\n<li>\n<p>不同类的数据点尽可能的分开 (between class)</p>\n</li>\n</ol>\n<hr>\n<h4 id=\"局部线性嵌入-LLE\">局部线性嵌入-LLE</h4>\n<p>非线性降维, 可使数据降维后较好的保持 <code>流形结构</code> ,适用于 flow-learninh</p>\n<hr>\n<h4 id=\"拉普拉斯特征映射-LE\">拉普拉斯特征映射-LE</h4>\n<p>Laplacian-Eigenmaps, 也是一种常用的流形降维算法, 思想也近似 LLE</p>\n<!-- TODO 暂时搁置\nhttps://zhuanlan.zhihu.com/p/100002630 -->\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"超参的学习-更新\">超参的学习-更新</h2>\n<h3 id=\"损失函数-loss\">损失函数-loss</h3>\n<p>loss function, 也叫代价函数 cost function</p>\n<p>用于衡量样本给出的 <code>真实值</code> <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span> 与 模型输出的 <code>预测值</code>y 之间的差异</p>\n<blockquote>\n<p>损失函数将 <code>寻找最优参数</code> 问题转换为了 <code>寻找损失函数最小值</code> 问题</p>\n</blockquote>\n<hr>\n<h4 id=\"均方差损失函数-MSE\">均方差损失函数-MSE</h4>\n<p>mean squared error, 常用于回归问题, 对于真实值<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover></mrow><annotation encoding=\"application/x-tex\">\\hat{y}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span></span></span></span> 和预测值 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>,其均方差</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi mathvariant=\"script\">L</mi><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo stretchy=\"false\">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mi>i</mi></msub><msup><mo stretchy=\"false\">)</mo><mn>2</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\mathcal{L} = \\frac{1}{n} \\sum_{i=1}^{n} (y_i - \\hat{y}_i)^2\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord mathcal\">L</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>均方差在几何意义上对应欧几里得距离 (欧氏距离)</p>\n<ul>\n<li>\n<p>基于 min(均方差 loss) 寻找最优模型的方法叫 <code>最小二乘法</code></p>\n<p>在线性回归中应用的解释为: 寻找一条距所有真实值样本点 几何距离之和 最小的直线</p>\n<p>如何求 min(均方差 loss) ? -&gt; 一种方法是求导,令导函数 = 0 求解</p>\n</li>\n</ul>\n<hr>\n<h4 id=\"交叉熵损失函数\">交叉熵损失函数</h4>\n<ul>\n<li>\n<p>分类问题常用交叉熵作为损失函数</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi mathvariant=\"script\">L</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold-italic\">y</mi><mo separator=\"true\">,</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold-italic\">x</mi><mo separator=\"true\">;</mo><mi>θ</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><msup><mi mathvariant=\"bold-italic\">y</mi><mi mathvariant=\"normal\">⊤</mi></msup><mi>log</mi><mo>⁡</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold-italic\">x</mi><mo separator=\"true\">;</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow><mi>c</mi><mo>=</mo><mn>1</mn></mrow><mi>C</mi></munderover><msub><mi>y</mi><mi>c</mi></msub><mi>log</mi><mo>⁡</mo><msub><mi>f</mi><mi>c</mi></msub><mo stretchy=\"false\">(</mo><mi mathvariant=\"bold-italic\">x</mi><mo separator=\"true\">;</mo><mi>θ</mi><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mtext>二分类</mtext><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo>:</mo><mi mathvariant=\"script\">L</mi><mo stretchy=\"false\">(</mo><mi>y</mi><mo separator=\"true\">,</mo><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo>−</mo><mrow><mo fence=\"true\">[</mo><mi>y</mi><mi>log</mi><mo>⁡</mo><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mo>+</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy=\"false\">)</mo><mi>log</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>1</mn><mo>−</mo><mover accent=\"true\"><mi>y</mi><mo>^</mo></mover><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n  \\mathcal{L}(\\boldsymbol{y}, f(\\boldsymbol{x} ; \\theta))\n  &amp;=-\\boldsymbol{y}^{\\top} \\log f(\\boldsymbol{x} ; \\theta) \\\\\n  &amp;=-\\sum_{c=1}^{C} y_{c} \\log f_{c}(\\boldsymbol{x} ; \\theta)\n\n  \\\\ \\ \\\\\n\n  二分类loss: \\mathcal{L}(y, \\hat{y})\n  &amp;= - \\left[ y \\log \\hat y + (1  - y) \\log (1 - \\hat y) \\right]\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:7.9546em;vertical-align:-3.7273em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2273em;\"><span style=\"top:-7.1565em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord mathcal\">L</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03704em;\">y</span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\">x</span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">))</span></span></span><span style=\"top:-4.6682em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"></span></span><span style=\"top:-2.2611em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:-0.7611em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord cjk_fallback\">二分类</span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathcal\">L</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7273em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:4.2273em;\"><span style=\"top:-7.1565em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">−</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\" style=\"margin-right:0.03704em;\">y</span></span></span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">⊤</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\">x</span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span><span style=\"top:-4.6682em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8829em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.07153em;\">C</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2671em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1514em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">c</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\"><span class=\"mord boldsymbol\">x</span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.7611em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord accent\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6944em;\"><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span><span style=\"top:-3em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"accent-body\" style=\"left:-0.1944em;\"><span class=\"mord\">^</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.1944em;\"><span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.7273em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n<li>\n<p>比如下图的二分类模型 <sup id='cite_ref-9'><a href=\"#cite_note-9\">[9]</a></sup></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/ZzsJYR.png\" alt=\"\"></p>\n</li>\n<li>\n<p>例题</p>\n<p>对于期末考试三种结果,假设 one-hot 标签编码:</p>\n<p>优秀 [1,0,0]<br>\n合格 [0,1,0]<br>\n不合格 [0,0,1]</p>\n<p>假设优秀,合格,不合格概率分别为:</p>\n<p>甲 [0.2,0.5,0.3]<br>\n乙 [0.2,0.2,0.6]</p>\n<p>实际二位都不合格</p>\n<hr>\n<p>分别求交叉熵:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mtext>甲</mtext><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mrow><mo fence=\"true\">[</mo><mn>0</mn><mo>⋅</mo><mi>ln</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0.2</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>0</mn><mo>⋅</mo><mi>ln</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0.5</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn><mo>⋅</mo><mi>ln</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0.3</mn><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><mo>=</mo><mn>1.2</mn><mspace linebreak=\"newline\"></mspace><mtext> </mtext><mspace linebreak=\"newline\"></mspace><mi>l</mi><mi>o</mi><mi>s</mi><mi>s</mi><mo stretchy=\"false\">(</mo><mtext>乙</mtext><mo stretchy=\"false\">)</mo><mo>=</mo><mo>−</mo><mrow><mo fence=\"true\">[</mo><mn>0</mn><mo>⋅</mo><mi>ln</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0.2</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>0</mn><mo>⋅</mo><mi>ln</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0.2</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mn>1</mn><mo>⋅</mo><mi>ln</mi><mo>⁡</mo><mo stretchy=\"false\">(</mo><mn>0.6</mn><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><mo>=</mo><mn>0.51</mn></mrow><annotation encoding=\"application/x-tex\">loss(甲) = -\\left[0 \\cdot \\ln(0.2) + 0 \\cdot \\ln(0.5) + 1 \\cdot \\ln(0.3)\\right] = 1.2\n\\\\ \\ \\\\\nloss(乙) = -\\left[0 \\cdot \\ln(0.2) + 0 \\cdot \\ln(0.2) + 1 \\cdot \\ln(0.6)\\right] = 0.51\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">甲</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\">0.2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\">0.5</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\">0.3</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.2</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0em;\"></span><span class=\"mspace\"> </span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.01968em;\">l</span><span class=\"mord mathnormal\">oss</span><span class=\"mopen\">(</span><span class=\"mord cjk_fallback\">乙</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">−</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\">0.2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\">0.2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mop\">ln</span><span class=\"mopen\">(</span><span class=\"mord\">0.6</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.51</span></span></span></span></span></p>\n<p>预测值越接近真实标签,损失函数越小</p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"过-欠拟合及处理\">过-欠拟合及处理</h3>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RtRLGQ.png\" alt=\"\"></p>\n<p>一种是啥都没背过; 一种是背过了但只会死记硬背,不会其他的</p>\n<ul>\n<li>\n<p>可以用泛化误差来衡量拟合程度 <sup id='cite_ref-5'><a href=\"#cite_note-5\">[5]</a></sup></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RtRSAt.png\" alt=\"\"></p>\n<hr>\n</li>\n</ul>\n<blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li>处理\n<ul>\n<li>过拟合\n<ul>\n<li>训练数据++, 数据增广</li>\n<li>早停</li>\n<li>降维</li>\n<li>正则化</li>\n<li>集成学习方法</li>\n</ul>\n</li>\n<li>欠拟合\n<ul>\n<li>添加新特征</li>\n<li>增加模型复杂度</li>\n<li>减小正则化系数</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"早停\">早停</h3>\n<p>Early Stopping <sup id='cite_ref-7'><a href=\"#cite_note-7\">[7]</a></sup></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Ry4m8h.png\" alt=\"\"></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"优化算法\">优化算法</h2>\n<h3 id=\"梯度下降法\">梯度下降法</h3>\n<p>在使用最小二乘法计算 min(均方差 loss) 时,有可能会遇到逆矩阵不存在或者计算量巨大的情况</p>\n<p>这时就可以用梯度下降法求 loss 极小值,进而找最小值</p>\n<ul>\n<li>\n<p>分类</p>\n<ul>\n<li>批量梯度下降法 BGD</li>\n<li>随机剃度下降法 SGD</li>\n<li>小批量随机梯度下降法 MBSGD</li>\n</ul>\n</li>\n</ul>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R7AFVm.png\" alt=\"\"></p>\n<ul>\n<li>\n<p>步骤: 对于 梯度<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi></mrow><annotation encoding=\"application/x-tex\">w</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span></span> 和其对应的 loss</p>\n<ol>\n<li>\n<p>loss 是否足够小/迭代次数是否达到? -&gt; 如果不够,就更新参数,继续迭代</p>\n</li>\n<li>\n<p>梯度下降</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msub><mi>w</mi><mrow><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>w</mi><mi>t</mi></msub><mo>−</mo><mi>α</mi><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"script\">R</mi><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo></mrow><mrow><mi mathvariant=\"normal\">∂</mi><msub><mi>w</mi><mi>t</mi></msub></mrow></mfrac></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msub><mi>w</mi><mi>t</mi></msub><mo>−</mo><mi>α</mi><mfrac><mn>1</mn><mi>N</mi></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><mfrac><mrow><mi mathvariant=\"normal\">∂</mi><mi mathvariant=\"script\">L</mi><mrow><mo fence=\"true\">(</mo><msub><mi>w</mi><mi>t</mi></msub><mo separator=\"true\">;</mo><msup><mi>x</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo separator=\"true\">,</mo><msup><mi>y</mi><mrow><mo stretchy=\"false\">(</mo><mi>i</mi><mo stretchy=\"false\">)</mo></mrow></msup><mo fence=\"true\">)</mo></mrow></mrow><mrow><mi mathvariant=\"normal\">∂</mi><mi>w</mi></mrow></mfrac></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\nw_{t+1}\n&amp;=w_{t}-\\alpha \\frac{\\partial \\mathcal{R}(w)}{\\partial w_{t}} \\\\\n&amp;=w_{t}-\\alpha \\frac{1}{N} \\sum_{i=1}^{N} \\frac{\\partial \\mathcal{L}\\left(w_{t} ; x^{(i)}, y^{(i)}\\right)}{\\partial w}\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:5.969em;vertical-align:-2.7345em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.2345em;\"><span style=\"top:-5.6358em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span><span class=\"mbin mtight\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2083em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-2.6715em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.7345em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:3.2345em;\"><span style=\"top:-5.6358em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.427em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathcal\">R</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mclose\">)</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.836em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.6715em;\"><span class=\"pstrut\" style=\"height:3.8283em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3214em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10903em;\">N</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8283em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.10903em;\">N</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.628em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.74em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\" style=\"margin-right:0.05556em;\">∂</span><span class=\"mord mathcal\">L</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.2806em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">t</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mpunct\">;</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.888em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mopen mtight\">(</span><span class=\"mord mathnormal mtight\">i</span><span class=\"mclose mtight\">)</span></span></span></span></span></span></span></span></span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">)</span></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.7345em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n</li>\n<li>\n<p>循环 1.</p>\n</li>\n</ol>\n<hr>\n</li>\n<li>\n<details>\n  <summary> 例题 </summary>\n<hr>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>假设函数</mtext><mo>:</mo><mi>J</mi><mo stretchy=\"false\">(</mo><mi>w</mi><mo stretchy=\"false\">)</mo><mo>=</mo><msup><mi>w</mi><mn>2</mn></msup><mspace width=\"1em\"/><mtext>假设起点</mtext><mo>:</mo><msup><mi>w</mi><mn>0</mn></msup><mo>=</mo><mn>1</mn><mspace width=\"1em\"/><mtext>学习率为</mtext><mo>:</mo><mi>α</mi><mo>=</mo><mn>0.4</mn><mspace linebreak=\"newline\"></mspace><mtext>根据梯度下降公式迭代寻优</mtext></mrow><annotation encoding=\"application/x-tex\">假设函数: J(w)=w^2 \\quad\n假设起点: w^0=1 \\quad\n学习率为: \\alpha = 0.4 \\\\\n根据梯度下降公式迭代寻优\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord cjk_fallback\">假设函数</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord cjk_fallback\">假设起点</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8641em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:1em;\"></span><span class=\"mord cjk_fallback\">学习率为</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">:</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">0.4</span></span><span class=\"mspace newline\"></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6833em;\"></span><span class=\"mord cjk_fallback\">根据梯度下降公式迭代寻优</span></span></span></span></span></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msup><mi>w</mi><mn>0</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msup><mi>w</mi><mn>1</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msup><mi>w</mi><mn>0</mn></msup><mo>−</mo><mi>α</mi><mo>⋅</mo><msup><mi>J</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><msup><mi>w</mi><mn>0</mn></msup><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mn>0.4</mn><mo>⋅</mo><mn>2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>0.2</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msup><mi>w</mi><mn>2</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><msup><mi>w</mi><mn>1</mn></msup><mo>−</mo><mi>α</mi><mo>⋅</mo><msup><mi>J</mi><mo mathvariant=\"normal\" lspace=\"0em\" rspace=\"0em\">′</mo></msup><mo stretchy=\"false\">(</mo><msup><mi>w</mi><mn>1</mn></msup><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>0.04</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msup><mi>w</mi><mn>3</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>0.008</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><msup><mi>w</mi><mn>4</mn></msup></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mn>0.0016</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi><mi mathvariant=\"normal\">.</mi></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\nw^0\n  &amp;= 1 \\\\\nw^1\n  &amp;= w^0 - \\alpha \\cdot J&#x27;(w^0) \\\\\n  &amp;= 1 - 0.4 \\cdot 2 \\\\\n  &amp;= 0.2 \\\\\nw^2\n  &amp;= w^1 - \\alpha \\cdot J&#x27;(w^1) \\\\\n  &amp;= 0.04 \\\\\nw^3\n  &amp;= 0.008 \\\\\nw^4\n  &amp;= 0.0016 \\\\\n...\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:13.6205em;vertical-align:-6.5603em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:7.0603em;\"><span style=\"top:-9.1962em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span><span style=\"top:-7.6721em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span><span style=\"top:-6.1721em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-4.6721em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.1479em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-1.6479em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-0.1238em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span><span style=\"top:1.4003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span></span></span><span style=\"top:2.9003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\">...</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:6.5603em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:7.0603em;\"><span style=\"top:-9.1962em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-7.6721em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-6.1721em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">0.4</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">2</span></span></span><span style=\"top:-4.6721em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0.2</span></span></span><span style=\"top:-3.1479em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.0037em;\">α</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.09618em;\">J</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8019em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">′</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-1.6479em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0.04</span></span></span><span style=\"top:-0.1238em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0.008</span></span></span><span style=\"top:1.4003em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0.0016</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:5.0603em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Rsusaq.png\" alt=\"\"></p>\n</details>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"学习率\">学习率</h3>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Ry4edA.png\" alt=\"\"></p>\n<ul>\n<li>\n<p>学习率退火</p>\n<p>如果学习率不变,对于初期来说学习率偏低, 收敛慢 loss 下降慢</p>\n<p>对于后期来说又偏大,导致难以收敛, loss 止步不降</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Ry4EX0.png\" alt=\"\"></p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"正则化\">正则化</h3>\n<p>保留所有特征 x,减少参数 w 大小 (给高次项或者所有项加上系数<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>θ</mi></mrow><annotation encoding=\"application/x-tex\">\\theta</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span></span></span></span>来压制)</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>w</mi><mn>1</mn></msub><mi>x</mi><mo>+</mo><msub><mi>w</mi><mn>2</mn></msub><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>θ</mi><msup><mi>x</mi><mn>3</mn></msup><mo>+</mo><mi>θ</mi><msub><mi>w</mi><mn>4</mn></msub><msup><mi>x</mi><mn>4</mn></msup><mspace width=\"2em\"/><mn>0</mn><mo>&lt;</mo><mi>θ</mi><mo>&lt;</mo><mo>=</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">y = w_1 x + w_2 x^2 + \\theta x^3 + \\theta w_4 x^4 \\qquad 0 &lt; \\theta &lt;= 1\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7333em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0141em;vertical-align:-0.15em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0141em;vertical-align:-0.15em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3011em;\"><span style=\"top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">4</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.0391em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">θ</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span></span></p>\n<ul>\n<li>\n<p>实际操作就是在目标函数(如损失函数)后加上一个范数:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msub><mrow><mo fence=\"true\">∥</mo><mtable rowspacing=\"0.16em\" columnalign=\"center\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mi>x</mi></mstyle></mtd></mtr></mtable><mo fence=\"true\">∥</mo></mrow><mi>p</mi></msub><mo>=</mo><mroot><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant=\"normal\">∣</mi><msub><mi>x</mi><mi>i</mi></msub><msup><mi mathvariant=\"normal\">∣</mi><mi>p</mi></msup></mrow><mi>p</mi></mroot></mrow><annotation encoding=\"application/x-tex\">\\begin{Vmatrix} x \\end{Vmatrix}_p\n= \\sqrt[p]{\\sum_{i=1}^{n} |x_i|^p}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.3858em;vertical-align:-0.5358em;\"></span><span class=\"minner\"><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-2.85em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span style=\"width:0.556em;height:1.200em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.556em\" height=\"1.200em\" viewBox=\"0 0 556 1200\"><path d=\"M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43z\nM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-c\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-3.01em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">x</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span></span><span class=\"mclose\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.85em;\"><span style=\"top:-2.85em;\"><span class=\"pstrut\" style=\"height:3.2em;\"></span><span style=\"width:0.556em;height:1.200em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"0.556em\" height=\"1.200em\" viewBox=\"0 0 556 1200\"><path d=\"M145 15 v585 v0 v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M188 15 H145 v585 v0 v585 h43z\nM367 15 v585 v0 v585 c2.667,10,9.667,15,21,15\nc10,0,16.667,-5,20,-15 v-585 v0 v-585 c-2.667,-10,-9.667,-15,-21,-15\nc-10,0,-16.667,5,-20,15z M410 15 H367 v585 v0 v585 h43z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.35em;\"><span></span></span></span></span></span></span></span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:-0.0983em;\"><span style=\"top:-2.3003em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5358em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:3.1568em;vertical-align:-1.2777em;\"></span><span class=\"mord sqrt\"><span class=\"root\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5762em;\"><span style=\"top:-2.8609em;\"><span class=\"pstrut\" style=\"height:2.5em;\"></span><span class=\"sizing reset-size6 size1 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8791em;\"><span class=\"svg-align\" style=\"top:-5.1168em;\"><span class=\"pstrut\" style=\"height:5.1168em;\"></span><span class=\"mord\" style=\"padding-left:1.056em;\"><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.5904em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">p</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.8391em;\"><span class=\"pstrut\" style=\"height:5.1168em;\"></span><span class=\"hide-tail\" style=\"min-width:0.742em;height:3.1968em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"3.1968em\" viewBox=\"0 0 400000 3196\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M702 80H40000040\nH742v3062l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\n219 661 l218 661zM702 80H400000v40H742z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span></span></span></span></span></p>\n<p>p = 0 时为 <code>L0 范数</code>, 为非零元素个数, 很难优化求解</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant=\"normal\">∣</mi><msub><mi>x</mi><mi>i</mi></msub><msup><mi mathvariant=\"normal\">∣</mi><mn>0</mn></msup></mrow><annotation encoding=\"application/x-tex\">\\sum_{i=1}^{n} |x_i|^0\n\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">0</span></span></span></span></span></span></span></span></span></span></span></span></p>\n<p>p = 1 时为 <code>L1 范数 (曼哈顿范数)</code>,所有系数绝对值之和, 用于特征选择</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant=\"normal\">∣</mi><msub><mi>x</mi><mi>i</mi></msub><mi mathvariant=\"normal\">∣</mi></mrow><annotation encoding=\"application/x-tex\">\\sum_{i=1}^{n} |x_i|\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:2.9291em;vertical-align:-1.2777em;\"></span><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\">∣</span></span></span></span></span></p>\n<p>p = 2 时为 <code>L2 范数 (欧几里得范数)</code>,所有系数平方和的开方, 可以防止过拟合提升模型的泛化能力</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msqrt><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi mathvariant=\"normal\">∣</mi><msub><mi>x</mi><mi>i</mi></msub><msup><mi mathvariant=\"normal\">∣</mi><mn>2</mn></msup></mrow></msqrt></mrow><annotation encoding=\"application/x-tex\">\\sqrt{\\sum_{i=1}^{n} |x_i|^2}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:3.1568em;vertical-align:-1.2777em;\"></span><span class=\"mord sqrt\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.8791em;\"><span class=\"svg-align\" style=\"top:-5.1168em;\"><span class=\"pstrut\" style=\"height:5.1168em;\"></span><span class=\"mord\" style=\"padding-left:1.056em;\"><span class=\"mop op-limits\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.6514em;\"><span style=\"top:-1.8723em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">i</span><span class=\"mrel mtight\">=</span><span class=\"mord mtight\">1</span></span></span></span><span style=\"top:-3.05em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span><span class=\"mop op-symbol large-op\">∑</span></span></span><span style=\"top:-4.3em;margin-left:0em;\"><span class=\"pstrut\" style=\"height:3.05em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">∣</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3117em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">i</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mord\">∣</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.7401em;\"><span style=\"top:-2.989em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span><span style=\"top:-3.8391em;\"><span class=\"pstrut\" style=\"height:5.1168em;\"></span><span class=\"hide-tail\" style=\"min-width:0.742em;height:3.1968em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width=\"400em\" height=\"3.1968em\" viewBox=\"0 0 400000 3196\" preserveAspectRatio=\"xMinYMin slice\"><path d=\"M702 80H40000040\nH742v3062l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\n219 661 l218 661zM702 80H400000v40H742z\"/></svg></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.2777em;\"><span></span></span></span></span></span></span></span></span></span></p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"权重初始化\">权重初始化</h3>\n<p>就像是 KMeans 一样, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo separator=\"true\">,</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">w,b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> 的初始化对训练的性能和结果也会有很大影响</p>\n<ul>\n<li>\n<p>一种方法是随机初始化</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Ry4J2m.png\" alt=\"\"></p>\n</li>\n<li>\n<p>另一种就是参考已经训练好的优秀模型的调参</p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"图像增广-DataAugmentation\">图像增广-DataAugmentation</h3>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Ry4toc.png\" alt=\"\"></p>\n<ol>\n<li>防止过拟合</li>\n<li>增强模型泛化能力</li>\n</ol>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://www.bilibili.com/video/BV16L411w7oQ?p=6\">【上海交大】【腾讯】强强联合 机器学习+深度学习</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://zhuanlan.zhihu.com/p/43225794\">12 种降维方法终极指南 (含 Python 代码)</a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://zhuanlan.zhihu.com/p/146600360\">05-生成网络总结 (VAE, GAN)</a></p>\n<p><a name='cite_note-4' href='#cite_ref-4'>[4]</a>: <a href=\"https://blog.csdn.net/qq_38651469/article/details/121100275\">独热编码 (One-Hot)及其代码</a></p>\n<p><a name='cite_note-5' href='#cite_ref-5'>[5]</a>: <a href=\"https://zhuanlan.zhihu.com/p/72038532\">欠拟合、过拟合及如何防止过拟合</a></p>\n<p><a name='cite_note-6' href='#cite_ref-6'>[6]</a>: <a href=\"https://scikit-learn.org/stable/tutorial/machine_learning_map/\">https://scikit-learn.org/stable/tutorial/machine_learning_map/</a></p>\n<p><a name='cite_note-7' href='#cite_ref-7'>[7]</a>: <a href=\"https://www.bilibili.com/video/BV1ou411k7fD?p=6\">4 小时入门深度学习+实操 MMDetection 第一课</a></p>\n<p><a name='cite_note-8' href='#cite_ref-8'>[8]</a>: <a href=\"https://zhuanlan.zhihu.com/p/34534763\">一篇关于机器学习中的稀疏矩阵的介绍</a></p>\n<p><a name='cite_note-9' href='#cite_ref-9'>[9]</a>: <a href=\"https://www.bilibili.com/video/BV15V411W7VB/?t=1499.6\">“交叉熵”如何做损失函数？打包理解“信息量”、“比特”、“熵”、“KL 散度”、“交叉熵”</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "doing",
                "人工智能",
                "信息论",
                "math",
                "python",
                "机器学习"
            ]
        },
        {
            "id": "https://blog.weidows.tech/post/lang/python/code/ML/",
            "url": "https://blog.weidows.tech/post/lang/python/code/ML/",
            "title": "👀Code-4-Machine-Learning",
            "date_published": "2022-04-11T07:07:22.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2023-04-20 18:34:18\n * @FilePath: \\Blog-private\\source\\_posts\\python\\code\\ML.md\n * @Description:\n * @!: *********************************************************************\n-->\n<h2 id=\"序\">序</h2>\n<p>此文为其他文章的代码部分:</p>\n<blockquote>\n<p><a href=\"../../AI/ML\">🥵硬啃-Machine-Learning</a></p>\n</blockquote>\n<p>也提供了 notebook 形式: <a href=\"https://github.com/Weidows-projects/public-post/blob/main/notebook/ML/_ML.ipynb\">代码地址</a></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"数据预处理方法\">数据预处理方法</h2>\n<h3 id=\"标准化-均值移除\">标准化-均值移除</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 数据预处理之：均值移除示例</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 样本数据</span></span><br><span class=\"line\">raw_samples = np.array([</span><br><span class=\"line\">    [<span class=\"number\">3.0</span>, -<span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>],\\</span><br><span class=\"line\">    [<span class=\"number\">0.0</span>, <span class=\"number\">4.0</span>, <span class=\"number\">3.0</span>], \\</span><br><span class=\"line\">    [<span class=\"number\">1.0</span>, -<span class=\"number\">4.0</span>, <span class=\"number\">2.0</span>]]\\</span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 求每列的平均值 axis=0为列, =1为行 不填就计算所有值</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(raw_samples.mean(axis=<span class=\"number\">0</span>))</span><br><span class=\"line\"><span class=\"comment\"># 求每列标准差</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(raw_samples.std(axis=<span class=\"number\">0</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">std_samples = raw_samples.copy()  <span class=\"comment\"># 复制样本数据</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> col <span class=\"keyword\">in</span> std_samples.T:  <span class=\"comment\"># .T为转置,遍历每列</span></span><br><span class=\"line\">    col_mean = col.mean()  <span class=\"comment\"># 计算平均数</span></span><br><span class=\"line\">    col_std = col.std()  <span class=\"comment\"># 求标准差</span></span><br><span class=\"line\">    col -= col_mean  <span class=\"comment\"># 减平均值</span></span><br><span class=\"line\">    col /= col_std  <span class=\"comment\"># 除标准差</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 均值无限趋近0,但可能不是0</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(std_samples.mean(axis=<span class=\"number\">0</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(std_samples.std(axis=<span class=\"number\">0</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># scale 标准移除,与上面功能相同</span></span><br><span class=\"line\">std_samples = sp.scale(raw_samples)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(std_samples.mean(axis=<span class=\"number\">0</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(std_samples.std(axis=<span class=\"number\">0</span>))</span><br></pre></td></tr></table></figure>\n<pre><code>[ 1.33333333 -0.33333333  2.33333333]\n[1.24721913 3.29983165 0.47140452]\n[ 5.55111512e-17  0.00000000e+00 -2.96059473e-16]\n[1. 1. 1.]\n[ 5.55111512e-17  0.00000000e+00 -2.96059473e-16]\n[1. 1. 1.]\n</code></pre>\n<h3 id=\"范围缩放\">范围缩放</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 数据预处理之：范围缩放</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 样本数据</span></span><br><span class=\"line\">raw_samples = np.array([</span><br><span class=\"line\">    [<span class=\"number\">1.0</span>, <span class=\"number\">2.0</span>, <span class=\"number\">3.0</span>],\\</span><br><span class=\"line\">    [<span class=\"number\">4.0</span>, <span class=\"number\">5.0</span>, <span class=\"number\">6.0</span>],\\</span><br><span class=\"line\">    [<span class=\"number\">7.0</span>, <span class=\"number\">8.0</span>, <span class=\"number\">9.0</span>]]).astype(<span class=\"string\">&quot;float64&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">mms_samples = raw_samples.copy()  <span class=\"comment\"># 复制样本数据</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> col <span class=\"keyword\">in</span> mms_samples.T:</span><br><span class=\"line\">    col_min = col.<span class=\"built_in\">min</span>()</span><br><span class=\"line\">    col_max = col.<span class=\"built_in\">max</span>()</span><br><span class=\"line\">    col -= col_min</span><br><span class=\"line\">    col /= (col_max - col_min)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(mms_samples)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 根据给定范围创建一个范围缩放器对象</span></span><br><span class=\"line\"><span class=\"comment\"># 使用范围缩放器实现特征值范围缩放</span></span><br><span class=\"line\">mms_samples = sp.MinMaxScaler(feature_range=(<span class=\"number\">0</span>, <span class=\"number\">1</span>))\\</span><br><span class=\"line\">  .fit_transform(raw_samples)  <span class=\"comment\"># 缩放</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(mms_samples)</span><br></pre></td></tr></table></figure>\n<pre><code>[[0.  0.  0. ]\n [0.5 0.5 0.5]\n [1.  1.  1. ]]\n[[0.  0.  0. ]\n [0.5 0.5 0.5]\n [1.  1.  1. ]]\n</code></pre>\n<h3 id=\"归一化\">归一化</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 样本数据</span></span><br><span class=\"line\">raw_samples = np.array([</span><br><span class=\"line\">    [<span class=\"number\">10.0</span>, <span class=\"number\">20.0</span>, <span class=\"number\">5.0</span>],\\</span><br><span class=\"line\">    [<span class=\"number\">8.0</span>, <span class=\"number\">10.0</span>, <span class=\"number\">1.0</span>]])</span><br><span class=\"line\"></span><br><span class=\"line\">nor_samples = raw_samples.copy()</span><br><span class=\"line\"><span class=\"keyword\">for</span> row <span class=\"keyword\">in</span> nor_samples:</span><br><span class=\"line\">    row /= <span class=\"built_in\">abs</span>(row).<span class=\"built_in\">sum</span>()  <span class=\"comment\"># 先对行求绝对值，再求和，再除以绝对值之和</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(nor_samples)  <span class=\"comment\"># 打印结果</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># norm=l1  /=绝对值之和</span></span><br><span class=\"line\"><span class=\"comment\"># norm=l2  /=平方之和</span></span><br><span class=\"line\">nor_samples = sp.normalize(raw_samples.copy(), norm=<span class=\"string\">&#x27;l1&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(nor_samples)  <span class=\"comment\"># 打印结果</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>[[0.28571429 0.57142857 0.14285714]\n [0.42105263 0.52631579 0.05263158]]\n[[0.28571429 0.57142857 0.14285714]\n [0.42105263 0.52631579 0.05263158]]\n</code></pre>\n<h3 id=\"二值化\">二值化</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 二值化</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\">raw_samples = np.array([[<span class=\"number\">65.5</span>, <span class=\"number\">89.0</span>, <span class=\"number\">73.0</span>],\\</span><br><span class=\"line\">                        [<span class=\"number\">55.0</span>, <span class=\"number\">99.0</span>, <span class=\"number\">98.5</span>],\\</span><br><span class=\"line\">                        [<span class=\"number\">45.0</span>, <span class=\"number\">22.5</span>, <span class=\"number\">60.0</span>]])</span><br><span class=\"line\"></span><br><span class=\"line\">bin_samples = raw_samples.copy()  <span class=\"comment\"># 复制数组</span></span><br><span class=\"line\"><span class=\"comment\"># 生成掩码数组</span></span><br><span class=\"line\">mask1 = bin_samples &lt; <span class=\"number\">60</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(mask1)</span><br><span class=\"line\">mask2 = bin_samples &gt;= <span class=\"number\">60</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 通过掩码进行二值化处理 (只转换True的位置)</span></span><br><span class=\"line\">bin_samples[mask1] = <span class=\"number\">0</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(bin_samples)</span><br><span class=\"line\">bin_samples[mask2] = <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(bin_samples)  <span class=\"comment\"># 打印结果</span></span><br><span class=\"line\"></span><br><span class=\"line\">bin_transformer = sp.Binarizer(threshold=<span class=\"number\">60</span> - <span class=\"number\">1</span>)  <span class=\"comment\"># 创建二值化对象(注意边界值)</span></span><br><span class=\"line\">bin_samples = bin_transformer.transform(raw_samples.copy())  <span class=\"comment\"># 二值化预处理</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(bin_samples)</span><br></pre></td></tr></table></figure>\n<pre><code>[[False False False]\n [ True False False]\n [ True  True False]]\n[[65.5 89.  73. ]\n [ 0.  99.  98.5]\n [ 0.   0.  60. ]]\n[[1. 1. 1.]\n [0. 1. 1.]\n [0. 0. 1.]]\n[[1. 1. 1.]\n [0. 1. 1.]\n [0. 0. 1.]]\n</code></pre>\n<h3 id=\"独热编码示例\">独热编码示例</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\">raw_samples = np.array([[<span class=\"number\">1</span>, <span class=\"number\">3</span>, <span class=\"number\">2</span>],\\</span><br><span class=\"line\">                        [<span class=\"number\">7</span>, <span class=\"number\">5</span>, <span class=\"number\">4</span>],\\</span><br><span class=\"line\">                        [<span class=\"number\">1</span>, <span class=\"number\">8</span>, <span class=\"number\">6</span>],\\</span><br><span class=\"line\">                        [<span class=\"number\">7</span>, <span class=\"number\">3</span>, <span class=\"number\">9</span>]])</span><br><span class=\"line\"></span><br><span class=\"line\">one_hot_encoder = sp.OneHotEncoder(</span><br><span class=\"line\">    sparse=<span class=\"literal\">False</span>,  <span class=\"comment\"># 是否采用稀疏格式</span></span><br><span class=\"line\">    dtype=<span class=\"string\">&quot;int32&quot;</span>,</span><br><span class=\"line\">    categories=<span class=\"string\">&quot;auto&quot;</span>)  <span class=\"comment\"># 自动编码</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 执行独热编码</span></span><br><span class=\"line\">oh_samples = one_hot_encoder.fit_transform(raw_samples.copy())</span><br><span class=\"line\"><span class=\"built_in\">print</span>(oh_samples)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(one_hot_encoder.inverse_transform(oh_samples))  <span class=\"comment\"># 解码</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>[[1 0 1 0 0 1 0 0 0]\n [0 1 0 1 0 0 1 0 0]\n [1 0 0 0 1 0 0 1 0]\n [0 1 1 0 0 0 0 0 1]]\n[[1 3 2]\n [7 5 4]\n [1 8 6]\n [7 3 9]]\n</code></pre>\n<h3 id=\"标签编码\">标签编码</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\">raw_samples = np.array([<span class=\"string\">&#x27;audi&#x27;</span>, <span class=\"string\">&#x27;ford&#x27;</span>, <span class=\"string\">&#x27;audi&#x27;</span>, <span class=\"string\">&#x27;bmw&#x27;</span>, <span class=\"string\">&#x27;ford&#x27;</span>, <span class=\"string\">&#x27;bmw&#x27;</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">lb_encoder = sp.LabelEncoder()  <span class=\"comment\"># 定义标签编码对象</span></span><br><span class=\"line\">lb_samples = lb_encoder.fit_transform(raw_samples.copy())  <span class=\"comment\"># 执行标签编码</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(lb_samples)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(lb_encoder.inverse_transform(lb_samples))  <span class=\"comment\"># 逆向转换</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>[0 2 0 1 2 1]\n['audi' 'ford' 'audi' 'bmw' 'ford' 'bmw']\n</code></pre>\n<h2 id=\"基本问题\">基本问题</h2>\n<h3 id=\"回归问题\">回归问题</h3>\n<h4 id=\"线性回归\">线性回归</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> mp</span><br><span class=\"line\"><span class=\"keyword\">from</span> mpl_toolkits.mplot3d <span class=\"keyword\">import</span> axes3d</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.preprocessing <span class=\"keyword\">as</span> sp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 训练数据集</span></span><br><span class=\"line\">train_x = np.array([<span class=\"number\">0.5</span>, <span class=\"number\">0.6</span>, <span class=\"number\">0.8</span>, <span class=\"number\">1.1</span>, <span class=\"number\">1.4</span>])  <span class=\"comment\"># 输入集</span></span><br><span class=\"line\">train_y = np.array([<span class=\"number\">5.0</span>, <span class=\"number\">5.5</span>, <span class=\"number\">6.0</span>, <span class=\"number\">6.8</span>, <span class=\"number\">7.0</span>])  <span class=\"comment\"># 输出集</span></span><br><span class=\"line\"></span><br><span class=\"line\">n_epochs = <span class=\"number\">30</span>  <span class=\"comment\"># 迭代次数</span></span><br><span class=\"line\">l_rate = <span class=\"number\">0.01</span>  <span class=\"comment\"># 学习率</span></span><br><span class=\"line\">epochs = []  <span class=\"comment\"># 记录迭代次数</span></span><br><span class=\"line\">losses = []  <span class=\"comment\"># 记录损失值</span></span><br><span class=\"line\"></span><br><span class=\"line\">w0, w1 = [<span class=\"number\">1</span>], [<span class=\"number\">1</span>]  <span class=\"comment\"># 模型初始值</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, n_epochs + <span class=\"number\">1</span>):</span><br><span class=\"line\">    epochs.append(i)  <span class=\"comment\"># 记录第几次迭代</span></span><br><span class=\"line\"></span><br><span class=\"line\">    y = w0[-<span class=\"number\">1</span>] + w1[-<span class=\"number\">1</span>] * train_x  <span class=\"comment\"># 取出最新的w0,w1计算线性方程输出</span></span><br><span class=\"line\">    <span class=\"comment\"># 损失函数(均方差)</span></span><br><span class=\"line\">    loss = (((train_y - y)**<span class=\"number\">2</span>).<span class=\"built_in\">sum</span>()) / <span class=\"number\">2</span></span><br><span class=\"line\">    losses.append(loss)  <span class=\"comment\"># 记录每次迭代的损失值</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;%d: w0=%f, w1=%f, loss=%f&quot;</span> % (i, w0[-<span class=\"number\">1</span>], w1[-<span class=\"number\">1</span>], loss))</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 计算w0,w1的偏导数</span></span><br><span class=\"line\">    d0 = -(train_y - y).<span class=\"built_in\">sum</span>()</span><br><span class=\"line\">    d1 = -(train_x * (train_y - y)).<span class=\"built_in\">sum</span>()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 更新w0,w1</span></span><br><span class=\"line\">    w0.append(w0[-<span class=\"number\">1</span>] - (d0 * l_rate))</span><br><span class=\"line\">    w1.append(w1[-<span class=\"number\">1</span>] - (d1 * l_rate))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">###################### 训练过程可视化 ######################</span></span><br><span class=\"line\"><span class=\"comment\">## 损失函数收敛过程</span></span><br><span class=\"line\">w0 = np.array(w0[:-<span class=\"number\">1</span>])</span><br><span class=\"line\">w1 = np.array(w1[:-<span class=\"number\">1</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">mp.figure(<span class=\"string\">&quot;Losses&quot;</span>, facecolor=<span class=\"string\">&quot;lightgray&quot;</span>)  <span class=\"comment\"># 创建一个窗体</span></span><br><span class=\"line\">mp.title(<span class=\"string\">&quot;epoch&quot;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&quot;loss&quot;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.grid(linestyle=<span class=\"string\">&quot;:&quot;</span>)  <span class=\"comment\"># 网格线：虚线</span></span><br><span class=\"line\">mp.plot(epochs, losses, c=<span class=\"string\">&quot;blue&quot;</span>, label=<span class=\"string\">&quot;loss&quot;</span>)</span><br><span class=\"line\">mp.legend()  <span class=\"comment\"># 图例</span></span><br><span class=\"line\">mp.tight_layout()  <span class=\"comment\"># 紧凑格式</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">## 显示模型直线</span></span><br><span class=\"line\">pred_y = w0[-<span class=\"number\">1</span>] + w1[-<span class=\"number\">1</span>] * train_x  <span class=\"comment\"># 根据x预测y</span></span><br><span class=\"line\">mp.figure(<span class=\"string\">&quot;Linear Regression&quot;</span>, facecolor=<span class=\"string\">&quot;lightgray&quot;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&quot;Linear Regression&quot;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.xlabel(<span class=\"string\">&quot;x&quot;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&quot;y&quot;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.grid(linestyle=<span class=\"string\">&quot;:&quot;</span>)</span><br><span class=\"line\">mp.scatter(train_x, train_y, c=<span class=\"string\">&quot;blue&quot;</span>, label=<span class=\"string\">&quot;Traing&quot;</span>)  <span class=\"comment\"># 绘制样本散点图</span></span><br><span class=\"line\">mp.plot(train_x, pred_y, c=<span class=\"string\">&quot;red&quot;</span>, label=<span class=\"string\">&quot;Regression&quot;</span>)</span><br><span class=\"line\">mp.legend()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 显示梯度下降过程(复制粘贴即可，不需要编写)</span></span><br><span class=\"line\"><span class=\"comment\"># 计算损失函数曲面上的点 loss = f(w0, w1)</span></span><br><span class=\"line\">arr1 = np.linspace(<span class=\"number\">0</span>, <span class=\"number\">10</span>, <span class=\"number\">500</span>)  <span class=\"comment\"># 0~9间产生500个元素的均匀列表</span></span><br><span class=\"line\">arr2 = np.linspace(<span class=\"number\">0</span>, <span class=\"number\">3.5</span>, <span class=\"number\">500</span>)  <span class=\"comment\"># 0~3.5间产生500个元素的均匀列表</span></span><br><span class=\"line\"></span><br><span class=\"line\">grid_w0, grid_w1 = np.meshgrid(arr1, arr2)  <span class=\"comment\"># 产生二维矩阵</span></span><br><span class=\"line\"></span><br><span class=\"line\">flat_w0, flat_w1 = grid_w0.ravel(), grid_w1.ravel()  <span class=\"comment\"># 二维矩阵扁平化</span></span><br><span class=\"line\">loss_metrix = train_y.reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>)  <span class=\"comment\"># 生成误差矩阵（-1,1）表示自动计算维度</span></span><br><span class=\"line\">outer = np.outer(train_x, flat_w1)  <span class=\"comment\"># 求外积（train_x和flat_w1元素两两相乘的新矩阵）</span></span><br><span class=\"line\"><span class=\"comment\"># 计算损失：((w0 + w1*x - y)**2)/2</span></span><br><span class=\"line\">flat_loss = (((flat_w0 + outer - loss_metrix)**<span class=\"number\">2</span>).<span class=\"built_in\">sum</span>(axis=<span class=\"number\">0</span>)) / <span class=\"number\">2</span></span><br><span class=\"line\">grid_loss = flat_loss.reshape(grid_w0.shape)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.figure(<span class=\"string\">&#x27;Loss Function&#x27;</span>)</span><br><span class=\"line\">ax = mp.axes(projection=<span class=\"string\">&#x27;3d&#x27;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&#x27;Loss Function&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">ax.set_xlabel(<span class=\"string\">&#x27;w0&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">ax.set_ylabel(<span class=\"string\">&#x27;w1&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">ax.set_zlabel(<span class=\"string\">&#x27;loss&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">ax.plot_surface(grid_w0,</span><br><span class=\"line\">                grid_w1,</span><br><span class=\"line\">                grid_loss,</span><br><span class=\"line\">                rstride=<span class=\"number\">10</span>,</span><br><span class=\"line\">                cstride=<span class=\"number\">10</span>,</span><br><span class=\"line\">                cmap=<span class=\"string\">&#x27;jet&#x27;</span>)</span><br><span class=\"line\">ax.plot(w0, w1, losses, <span class=\"string\">&#x27;o-&#x27;</span>, c=<span class=\"string\">&#x27;orangered&#x27;</span>, label=<span class=\"string\">&#x27;BGD&#x27;</span>, zorder=<span class=\"number\">5</span>)</span><br><span class=\"line\">mp.legend(loc=<span class=\"string\">&#x27;lower left&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>1: w0=1.000000, w1=1.000000, loss=44.175000\n2: w0=1.209000, w1=1.190600, loss=36.538828\n3: w0=1.399164, w1=1.363579, loss=30.231687\n4: w0=1.572208, w1=1.520546, loss=25.022227\n5: w0=1.729693, w1=1.662961, loss=20.719373\n6: w0=1.873039, w1=1.792151, loss=17.165309\n7: w0=2.003532, w1=1.909325, loss=14.229691\n8: w0=2.122345, w1=2.015577, loss=11.804865\n9: w0=2.230542, w1=2.111905, loss=9.801916\n10: w0=2.329091, w1=2.199215, loss=8.147408\n11: w0=2.418871, w1=2.278330, loss=6.780688\n12: w0=2.500681, w1=2.349997, loss=5.651660\n13: w0=2.575247, w1=2.414898, loss=4.718950\n14: w0=2.643230, w1=2.473648, loss=3.948384\n15: w0=2.705228, w1=2.526811, loss=3.311740\n16: w0=2.761786, w1=2.574896, loss=2.785706\n17: w0=2.813402, w1=2.618367, loss=2.351029\n18: w0=2.860524, w1=2.657645, loss=1.991807\n19: w0=2.903561, w1=2.693114, loss=1.694907\n20: w0=2.942886, w1=2.725122, loss=1.449482\n21: w0=2.978836, w1=2.753985, loss=1.246572\n22: w0=3.011719, w1=2.779990, loss=1.078777\n23: w0=3.041814, w1=2.803399, loss=0.939987\n24: w0=3.069373, w1=2.824449, loss=0.825153\n25: w0=3.094629, w1=2.843355, loss=0.730107\n26: w0=3.117790, w1=2.860315, loss=0.651405\n27: w0=3.139046, w1=2.875507, loss=0.586204\n28: w0=3.158572, w1=2.889091, loss=0.532154\n29: w0=3.176523, w1=2.901216, loss=0.487315\n30: w0=3.193044, w1=2.912016, loss=0.450086\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_13_1.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_13_2.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_13_3.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 利用LinearRegression实现线性回归</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.linear_model <span class=\"keyword\">as</span> lm  <span class=\"comment\"># 线性模型# 线性模型</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.metrics <span class=\"keyword\">as</span> sm  <span class=\"comment\"># 模型性能评价模块</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> mp</span><br><span class=\"line\"></span><br><span class=\"line\">train_x = np.array([[<span class=\"number\">0.5</span>], [<span class=\"number\">0.6</span>], [<span class=\"number\">0.8</span>], [<span class=\"number\">1.1</span>], [<span class=\"number\">1.4</span>]])  <span class=\"comment\"># 输入集</span></span><br><span class=\"line\">train_y = np.array([<span class=\"number\">5.0</span>, <span class=\"number\">5.5</span>, <span class=\"number\">6.0</span>, <span class=\"number\">6.8</span>, <span class=\"number\">7.0</span>])  <span class=\"comment\"># 输出集</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建线性回归器</span></span><br><span class=\"line\">line_model = lm.LinearRegression()</span><br><span class=\"line\"><span class=\"comment\"># 用已知输入、输出数据集训练回归器</span></span><br><span class=\"line\">line_model.fit(train_x, train_y)</span><br><span class=\"line\"><span class=\"comment\"># 根据训练模型预测输出</span></span><br><span class=\"line\">pred_y = line_model.predict(train_x)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;coef_:&quot;</span>, line_model.coef_)  <span class=\"comment\"># 系数</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;intercept_:&quot;</span>, line_model.intercept_)  <span class=\"comment\"># 截距</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 可视化回归曲线</span></span><br><span class=\"line\">mp.figure(<span class=\"string\">&#x27;Linear Regression&#x27;</span>, facecolor=<span class=\"string\">&#x27;lightgray&#x27;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&#x27;Linear Regression&#x27;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.xlabel(<span class=\"string\">&#x27;x&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&#x27;y&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.tick_params(labelsize=<span class=\"number\">10</span>)</span><br><span class=\"line\">mp.grid(linestyle=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制样本点</span></span><br><span class=\"line\">mp.scatter(train_x, train_y, c=<span class=\"string\">&#x27;blue&#x27;</span>, alpha=<span class=\"number\">0.8</span>, s=<span class=\"number\">60</span>, label=<span class=\"string\">&#x27;Sample&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 绘制拟合直线</span></span><br><span class=\"line\">mp.plot(</span><br><span class=\"line\">    train_x,  <span class=\"comment\"># x坐标数据</span></span><br><span class=\"line\">    pred_y,  <span class=\"comment\"># y坐标数据</span></span><br><span class=\"line\">    c=<span class=\"string\">&#x27;orangered&#x27;</span>,</span><br><span class=\"line\">    label=<span class=\"string\">&#x27;Regression Line&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.legend()  <span class=\"comment\"># 左上角的图例</span></span><br><span class=\"line\">mp.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>coef_: [2.2189781]\nintercept_: 4.107299270072994\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_14_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> datasets, linear_model, model_selection</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># science kit learn 自带的糖尿病数据</span></span><br><span class=\"line\">X, y = datasets.load_diabetes(return_X_y=<span class=\"literal\">True</span>)</span><br><span class=\"line\"><span class=\"comment\"># 442 * 10 大小的二维数组</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(X.shape)</span><br><span class=\"line\"><span class=\"comment\"># No.1 * 10</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(X[<span class=\"number\">0</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 只取第二维的第三列作为特征输入 (也就是0.06169621这一列)</span></span><br><span class=\"line\">X = X[:, np.newaxis, <span class=\"number\">2</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># train : test = 2 : 1</span></span><br><span class=\"line\">X_train, X_test, y_train, y_test = model_selection.train_test_split(</span><br><span class=\"line\">    X, y, test_size=<span class=\"number\">0.33</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">model = linear_model.LinearRegression()</span><br><span class=\"line\">model.fit(X_train, y_train)</span><br><span class=\"line\"></span><br><span class=\"line\">y_pred = model.predict(X_test)</span><br><span class=\"line\"></span><br><span class=\"line\">plt.scatter(X_test, y_test, color=<span class=\"string\">&#x27;black&#x27;</span>)</span><br><span class=\"line\">plt.plot(X_test, y_pred, color=<span class=\"string\">&#x27;blue&#x27;</span>, linewidth=<span class=\"number\">3</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<pre><code>(442, 10)\n[ 0.03807591  0.05068012  0.06169621  0.02187235 -0.0442235  -0.03482076\n -0.04340085 -0.00259226  0.01990842 -0.01764613]\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_15_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> datetime <span class=\"keyword\">import</span> datetime</span><br><span class=\"line\"></span><br><span class=\"line\">pumpkins = pd.read_csv(<span class=\"string\">&#x27;./_data_set/US-pumpkins.csv&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">pumpkins = pumpkins[pumpkins[<span class=\"string\">&#x27;Package&#x27;</span>].<span class=\"built_in\">str</span>.contains(<span class=\"string\">&#x27;bushel&#x27;</span>,</span><br><span class=\"line\">                                                     <span class=\"keyword\">case</span>=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                                     regex=<span class=\"literal\">True</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># pumpkins.head()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># pumpkins.isnull().sum()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># A set of new columns for a new dataframe. Filter out nonmatching columns</span></span><br><span class=\"line\">pumpkins = pumpkins.drop([</span><br><span class=\"line\">    c <span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> pumpkins.columns <span class=\"keyword\">if</span> c <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> [</span><br><span class=\"line\">        <span class=\"string\">&#x27;Package&#x27;</span>, <span class=\"string\">&#x27;Variety&#x27;</span>, <span class=\"string\">&#x27;City Name&#x27;</span>, <span class=\"string\">&#x27;Month&#x27;</span>, <span class=\"string\">&#x27;Low Price&#x27;</span>, <span class=\"string\">&#x27;High Price&#x27;</span>,</span><br><span class=\"line\">        <span class=\"string\">&#x27;Date&#x27;</span></span><br><span class=\"line\">    ]</span><br><span class=\"line\">],</span><br><span class=\"line\">                         axis=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Get an average between low and high price for the base pumpkin price</span></span><br><span class=\"line\">price = (pumpkins[<span class=\"string\">&#x27;Low Price&#x27;</span>] + pumpkins[<span class=\"string\">&#x27;High Price&#x27;</span>]) / <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Create a new dataframe with this basic data</span></span><br><span class=\"line\">new_pumpkins = pd.DataFrame(&#123;</span><br><span class=\"line\">    <span class=\"comment\"># Convert the date to its month only</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;Month&#x27;</span>:</span><br><span class=\"line\">    pd.DatetimeIndex(pumpkins[<span class=\"string\">&#x27;Date&#x27;</span>]).month,</span><br><span class=\"line\">    <span class=\"string\">&#x27;DayOfYear&#x27;</span>:</span><br><span class=\"line\">    pd.to_datetime(pumpkins[<span class=\"string\">&#x27;Date&#x27;</span>]).apply(</span><br><span class=\"line\">        <span class=\"keyword\">lambda</span> dt: (dt - datetime(dt.year, <span class=\"number\">1</span>, <span class=\"number\">1</span>)).days),</span><br><span class=\"line\">    <span class=\"string\">&#x27;Variety&#x27;</span>:</span><br><span class=\"line\">    pumpkins[<span class=\"string\">&#x27;Variety&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;City&#x27;</span>:</span><br><span class=\"line\">    pumpkins[<span class=\"string\">&#x27;City Name&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Package&#x27;</span>:</span><br><span class=\"line\">    pumpkins[<span class=\"string\">&#x27;Package&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Low Price&#x27;</span>:</span><br><span class=\"line\">    pumpkins[<span class=\"string\">&#x27;Low Price&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;High Price&#x27;</span>:</span><br><span class=\"line\">    pumpkins[<span class=\"string\">&#x27;High Price&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Price&#x27;</span>:</span><br><span class=\"line\">    price</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Convert the price if the Package contains fractional bushel values</span></span><br><span class=\"line\"><span class=\"comment\"># loc 遍历Package列中包含 &#x27;1 1/9&#x27; 的行, 对每行的 Price 列进行操作</span></span><br><span class=\"line\">new_pumpkins.loc[new_pumpkins[<span class=\"string\">&#x27;Package&#x27;</span>].<span class=\"built_in\">str</span>.contains(<span class=\"string\">&#x27;1 1/9&#x27;</span>),</span><br><span class=\"line\">                 <span class=\"string\">&#x27;Price&#x27;</span>] = price / (<span class=\"number\">1</span> + <span class=\"number\">1</span> / <span class=\"number\">9</span>)</span><br><span class=\"line\">new_pumpkins.loc[new_pumpkins[<span class=\"string\">&#x27;Package&#x27;</span>].<span class=\"built_in\">str</span>.contains(<span class=\"string\">&#x27;1/2&#x27;</span>),</span><br><span class=\"line\">                 <span class=\"string\">&#x27;Price&#x27;</span>] = price / (<span class=\"number\">1</span> / <span class=\"number\">2</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 散点图</span></span><br><span class=\"line\">plt.scatter(new_pumpkins.Price, new_pumpkins.Month)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Price&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Month&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 柱状图</span></span><br><span class=\"line\">new_pumpkins.groupby([<span class=\"string\">&#x27;Month&#x27;</span>])[<span class=\"string\">&#x27;Price&#x27;</span>].mean().plot(kind=<span class=\"string\">&#x27;bar&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Month&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">ax = <span class=\"literal\">None</span></span><br><span class=\"line\">colors = [<span class=\"string\">&#x27;red&#x27;</span>, <span class=\"string\">&#x27;blue&#x27;</span>, <span class=\"string\">&#x27;green&#x27;</span>, <span class=\"string\">&#x27;yellow&#x27;</span>]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, var <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(new_pumpkins[<span class=\"string\">&#x27;Variety&#x27;</span>].unique()):</span><br><span class=\"line\">    ax = new_pumpkins[new_pumpkins[<span class=\"string\">&#x27;Variety&#x27;</span>] == var].plot.scatter(<span class=\"string\">&#x27;DayOfYear&#x27;</span>,</span><br><span class=\"line\">                                                                   <span class=\"string\">&#x27;Price&#x27;</span>,</span><br><span class=\"line\">                                                                   ax=ax,</span><br><span class=\"line\">                                                                   c=colors[i],</span><br><span class=\"line\">                                                                   label=var)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_16_0.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_16_1.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_16_2.png\" alt=\"png\"></p>\n<h4 id=\"多项式回归\">多项式回归</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> datetime <span class=\"keyword\">import</span> datetime</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> r2_score, mean_squared_error, mean_absolute_error</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.preprocessing <span class=\"keyword\">import</span> PolynomialFeatures</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.pipeline <span class=\"keyword\">import</span> make_pipeline</span><br><span class=\"line\"></span><br><span class=\"line\">pumpkins = pd.read_csv(<span class=\"string\">&#x27;./_data_set/US-pumpkins.csv&#x27;</span>)</span><br><span class=\"line\">pumpkins = pumpkins[pumpkins[<span class=\"string\">&#x27;Package&#x27;</span>].<span class=\"built_in\">str</span>.contains(<span class=\"string\">&#x27;bushel&#x27;</span>,</span><br><span class=\"line\">                                                     <span class=\"keyword\">case</span>=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                                     regex=<span class=\"literal\">True</span>)]</span><br><span class=\"line\">pumpkins = pumpkins.drop([</span><br><span class=\"line\">    c <span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> pumpkins.columns <span class=\"keyword\">if</span> c <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> [</span><br><span class=\"line\">        <span class=\"string\">&#x27;Package&#x27;</span>, <span class=\"string\">&#x27;Variety&#x27;</span>, <span class=\"string\">&#x27;City Name&#x27;</span>, <span class=\"string\">&#x27;Month&#x27;</span>, <span class=\"string\">&#x27;Low Price&#x27;</span>, <span class=\"string\">&#x27;High Price&#x27;</span>,</span><br><span class=\"line\">        <span class=\"string\">&#x27;Date&#x27;</span></span><br><span class=\"line\">    ]</span><br><span class=\"line\">],</span><br><span class=\"line\">                         axis=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">price = (pumpkins[<span class=\"string\">&#x27;Low Price&#x27;</span>] + pumpkins[<span class=\"string\">&#x27;High Price&#x27;</span>]) / <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">new_pumpkins = pd.DataFrame(&#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;Month&#x27;</span>:</span><br><span class=\"line\">    pd.DatetimeIndex(pumpkins[<span class=\"string\">&#x27;Date&#x27;</span>]).month,</span><br><span class=\"line\">    <span class=\"string\">&#x27;DayOfYear&#x27;</span>:</span><br><span class=\"line\">    pd.to_datetime(pumpkins[<span class=\"string\">&#x27;Date&#x27;</span>]).apply(</span><br><span class=\"line\">        <span class=\"keyword\">lambda</span> dt: (dt - datetime(dt.year, <span class=\"number\">1</span>, <span class=\"number\">1</span>)).days),</span><br><span class=\"line\">    <span class=\"string\">&#x27;Variety&#x27;</span>:</span><br><span class=\"line\">    pumpkins[<span class=\"string\">&#x27;Variety&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;City&#x27;</span>:</span><br><span class=\"line\">    pumpkins[<span class=\"string\">&#x27;City Name&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Package&#x27;</span>:</span><br><span class=\"line\">    pumpkins[<span class=\"string\">&#x27;Package&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Low Price&#x27;</span>:</span><br><span class=\"line\">    pumpkins[<span class=\"string\">&#x27;Low Price&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;High Price&#x27;</span>:</span><br><span class=\"line\">    pumpkins[<span class=\"string\">&#x27;High Price&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Price&#x27;</span>:</span><br><span class=\"line\">    price</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">new_pumpkins.loc[new_pumpkins[<span class=\"string\">&#x27;Package&#x27;</span>].<span class=\"built_in\">str</span>.contains(<span class=\"string\">&#x27;1 1/9&#x27;</span>),</span><br><span class=\"line\">                 <span class=\"string\">&#x27;Price&#x27;</span>] = price / <span class=\"number\">1.1</span></span><br><span class=\"line\">new_pumpkins.loc[new_pumpkins[<span class=\"string\">&#x27;Package&#x27;</span>].<span class=\"built_in\">str</span>.contains(<span class=\"string\">&#x27;1/2&#x27;</span>),</span><br><span class=\"line\">                 <span class=\"string\">&#x27;Price&#x27;</span>] = price * <span class=\"number\">2</span></span><br><span class=\"line\"></span><br><span class=\"line\">pie_pumpkins = new_pumpkins[new_pumpkins[<span class=\"string\">&#x27;Variety&#x27;</span>] == <span class=\"string\">&#x27;PIE TYPE&#x27;</span>]</span><br><span class=\"line\"></span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(</span><br><span class=\"line\">    pie_pumpkins[<span class=\"string\">&#x27;DayOfYear&#x27;</span>].to_numpy().reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>),</span><br><span class=\"line\">    pie_pumpkins[<span class=\"string\">&#x27;Price&#x27;</span>],</span><br><span class=\"line\">    test_size=<span class=\"number\">0.2</span>,</span><br><span class=\"line\">    random_state=<span class=\"number\">0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">pipeline = make_pipeline(PolynomialFeatures(<span class=\"number\">2</span>), LinearRegression())</span><br><span class=\"line\"></span><br><span class=\"line\">pipeline.fit(X_train, y_train)</span><br><span class=\"line\"></span><br><span class=\"line\">pred = pipeline.predict(X_test)</span><br><span class=\"line\"></span><br><span class=\"line\">mse = np.sqrt(mean_squared_error(y_test, pred))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;Mean error: <span class=\"subst\">&#123;mse:<span class=\"number\">3.3</span>&#125;</span> (<span class=\"subst\">&#123;mse/np.mean(pred)*<span class=\"number\">100</span>:<span class=\"number\">3.3</span>&#125;</span>%)&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">score = pipeline.score(X_train, y_train)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Model determination: &#x27;</span>, score)</span><br><span class=\"line\"></span><br><span class=\"line\">plt.scatter(X_test, y_test)</span><br><span class=\"line\">plt.plot(<span class=\"built_in\">sorted</span>(X_test), pipeline.predict(<span class=\"built_in\">sorted</span>(X_test)))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>Mean error: 2.73 (17.0%)\nModel determination:  0.07639977655280084\n\n\n\n\n\n[&lt;matplotlib.lines.Line2D at 0x19b75ee76d0&gt;]\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_18_2.png\" alt=\"png\"></p>\n<h3 id=\"决策树-随机森林\">决策树-随机森林</h3>\n<h4 id=\"决策树分类\">决策树分类</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> tree</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> DecisionTreeClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.preprocessing <span class=\"keyword\">import</span> LabelEncoder</span><br><span class=\"line\"><span class=\"keyword\">import</span> pydotplus</span><br><span class=\"line\"></span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;simHei&#x27;</span>]</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">iris_feature_E = <span class=\"string\">&#x27;sepal length&#x27;</span>, <span class=\"string\">&#x27;sepal width&#x27;</span>, <span class=\"string\">&#x27;petal length&#x27;</span>, <span class=\"string\">&#x27;petal width&#x27;</span></span><br><span class=\"line\">iris_feature = <span class=\"string\">&#x27;花萼长度&#x27;</span>, <span class=\"string\">&#x27;花萼宽度&#x27;</span>, <span class=\"string\">&#x27;花瓣长度&#x27;</span>, <span class=\"string\">&#x27;花瓣宽度&#x27;</span></span><br><span class=\"line\">iris_class = <span class=\"string\">&#x27;Iris-setosa&#x27;</span>, <span class=\"string\">&#x27;Iris-versicolor&#x27;</span>, <span class=\"string\">&#x27;Iris-virginica&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">path = <span class=\"string\">&#x27;./_data_set/iris_classification/iris.data&#x27;</span>  <span class=\"comment\"># 数据文件路径</span></span><br><span class=\"line\">data = pd.read_csv(path, header=<span class=\"literal\">None</span>)</span><br><span class=\"line\">x = data[<span class=\"built_in\">list</span>(<span class=\"built_in\">range</span>(<span class=\"number\">4</span>))]</span><br><span class=\"line\"><span class=\"comment\"># y = pd.Categorical(data[4]).codes</span></span><br><span class=\"line\">y = LabelEncoder().fit_transform(data[<span class=\"number\">4</span>])</span><br><span class=\"line\"><span class=\"comment\"># 为了可视化，仅使用前两列特征</span></span><br><span class=\"line\">x = x[[<span class=\"number\">0</span>, <span class=\"number\">1</span>]]</span><br><span class=\"line\"><span class=\"comment\"># x = x.iloc[:, :2]</span></span><br><span class=\"line\">x_train, x_test, y_train, y_test = train_test_split(x,</span><br><span class=\"line\">                                                    y,</span><br><span class=\"line\">                                                    test_size=<span class=\"number\">0.3</span>,</span><br><span class=\"line\">                                                    random_state=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 决策树参数估计</span></span><br><span class=\"line\"><span class=\"comment\"># min_samples_split = 10：如果该结点包含的样本数目大于10，则(有可能)对其分支</span></span><br><span class=\"line\"><span class=\"comment\"># min_samples_leaf = 10：若将某结点分支后，得到的每个子结点样本数目都大于10，则完成分支；否则，不进行分支</span></span><br><span class=\"line\">model = DecisionTreeClassifier(criterion=<span class=\"string\">&#x27;entropy&#x27;</span>)</span><br><span class=\"line\">model.fit(x_train, y_train)</span><br><span class=\"line\">y_train_pred = model.predict(x_train)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;训练集正确率：&#x27;</span>, accuracy_score(y_train, y_train_pred))</span><br><span class=\"line\">y_test_hat = model.predict(x_test)  <span class=\"comment\"># 测试数据</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;测试集正确率：&#x27;</span>, accuracy_score(y_test, y_test_hat))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 保存</span></span><br><span class=\"line\"><span class=\"comment\"># dot -Tpng my.dot -o my.png</span></span><br><span class=\"line\"><span class=\"comment\"># 1、输出</span></span><br><span class=\"line\"><span class=\"comment\"># with open(&#x27;iris.dot&#x27;, &#x27;w&#x27;) as f:</span></span><br><span class=\"line\"><span class=\"comment\">#     tree.export_graphviz(model, out_file=f, feature_names=iris_feature_E[0:2], class_names=iris_class,</span></span><br><span class=\"line\"><span class=\"comment\">#                          filled=True, rounded=True, special_characters=True)</span></span><br><span class=\"line\">tree.export_graphviz(model,</span><br><span class=\"line\">                     out_file=<span class=\"string\">&#x27;./_data_set/iris_classification/iris.dot&#x27;</span>,</span><br><span class=\"line\">                     feature_names=iris_feature_E[<span class=\"number\">0</span>:<span class=\"number\">2</span>],</span><br><span class=\"line\">                     class_names=iris_class,</span><br><span class=\"line\">                     filled=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                     rounded=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                     special_characters=<span class=\"literal\">True</span>)</span><br><span class=\"line\"><span class=\"comment\"># 2、给定文件名</span></span><br><span class=\"line\"><span class=\"comment\"># tree.export_graphviz(model, out_file=&#x27;iris.dot&#x27;)</span></span><br><span class=\"line\"><span class=\"comment\"># tree.export_graphviz(model, out_file=&#x27;iris.dot&#x27;)</span></span><br><span class=\"line\"><span class=\"comment\"># 3、输出为pdf格式</span></span><br><span class=\"line\">dot_data = tree.export_graphviz(model,</span><br><span class=\"line\">                                out_file=<span class=\"literal\">None</span>,</span><br><span class=\"line\">                                feature_names=iris_feature_E[<span class=\"number\">0</span>:<span class=\"number\">2</span>],</span><br><span class=\"line\">                                class_names=iris_class,</span><br><span class=\"line\">                                filled=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                rounded=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                                special_characters=<span class=\"literal\">True</span>)</span><br><span class=\"line\">graph = pydotplus.graph_from_dot_data(dot_data)</span><br><span class=\"line\">graph.write_pdf(<span class=\"string\">&#x27;./_data_set/iris_classification/iris.pdf&#x27;</span>)</span><br><span class=\"line\">f = <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;./_data_set/iris_classification/iris.png&#x27;</span>, <span class=\"string\">&#x27;wb&#x27;</span>)</span><br><span class=\"line\">f.write(graph.create_png())</span><br><span class=\"line\">f.close()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 画图</span></span><br><span class=\"line\">N, M = <span class=\"number\">50</span>, <span class=\"number\">50</span>  <span class=\"comment\"># 横纵各采样多少个值</span></span><br><span class=\"line\">x1_min, x2_min = x.<span class=\"built_in\">min</span>()</span><br><span class=\"line\">x1_max, x2_max = x.<span class=\"built_in\">max</span>()</span><br><span class=\"line\">t1 = np.linspace(x1_min, x1_max, N)</span><br><span class=\"line\">t2 = np.linspace(x2_min, x2_max, M)</span><br><span class=\"line\">x1, x2 = np.meshgrid(t1, t2)  <span class=\"comment\"># 生成网格采样点</span></span><br><span class=\"line\">x_show = np.stack((x1.flat, x2.flat), axis=<span class=\"number\">1</span>)  <span class=\"comment\"># 测试点</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(x_show.shape)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;x_show = \\n&#x27;</span>, x_show)</span><br><span class=\"line\"></span><br><span class=\"line\">cm_light = mpl.colors.ListedColormap([<span class=\"string\">&#x27;#A0FFA0&#x27;</span>, <span class=\"string\">&#x27;#FFA0A0&#x27;</span>, <span class=\"string\">&#x27;#A0A0FF&#x27;</span>])</span><br><span class=\"line\">cm_dark = mpl.colors.ListedColormap([<span class=\"string\">&#x27;g&#x27;</span>, <span class=\"string\">&#x27;r&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>])</span><br><span class=\"line\">y_show_hat = model.predict(x_show)  <span class=\"comment\"># 预测值</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_show_hat.shape)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_show_hat)</span><br><span class=\"line\">y_show_hat = y_show_hat.reshape(x1.shape)  <span class=\"comment\"># 使之与输入的形状相同</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_show_hat)</span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.pcolormesh(x1, x2, y_show_hat, cmap=cm_light, shading=<span class=\"string\">&#x27;auto&#x27;</span>)  <span class=\"comment\"># 预测值的显示</span></span><br><span class=\"line\">plt.scatter(x_test[<span class=\"number\">0</span>],</span><br><span class=\"line\">            x_test[<span class=\"number\">1</span>],</span><br><span class=\"line\">            c=y_test.ravel(),</span><br><span class=\"line\">            edgecolors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">            s=<span class=\"number\">100</span>,</span><br><span class=\"line\">            zorder=<span class=\"number\">10</span>,</span><br><span class=\"line\">            cmap=cm_dark,</span><br><span class=\"line\">            marker=<span class=\"string\">&#x27;*&#x27;</span>)  <span class=\"comment\"># 测试数据</span></span><br><span class=\"line\">plt.scatter(x[<span class=\"number\">0</span>], x[<span class=\"number\">1</span>], c=y.ravel(), edgecolors=<span class=\"string\">&#x27;k&#x27;</span>, s=<span class=\"number\">20</span>,</span><br><span class=\"line\">            cmap=cm_dark)  <span class=\"comment\"># 全部数据</span></span><br><span class=\"line\">plt.xlabel(iris_feature[<span class=\"number\">0</span>], fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.ylabel(iris_feature[<span class=\"number\">1</span>], fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.xlim(x1_min, x1_max)</span><br><span class=\"line\">plt.ylim(x2_min, x2_max)</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>, color=<span class=\"string\">&#x27;#606060&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;鸢尾花数据的决策树分类&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 训练集上的预测结果</span></span><br><span class=\"line\">y_test = y_test.reshape(-<span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_test_hat)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_test)</span><br><span class=\"line\">result = (y_test_hat == y_test)  <span class=\"comment\"># True则预测正确，False则预测错误</span></span><br><span class=\"line\">acc = np.mean(result)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;准确度: %.2f%%&#x27;</span> % (<span class=\"number\">100</span> * acc))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 过拟合：错误率</span></span><br><span class=\"line\">depth = np.arange(<span class=\"number\">1</span>, <span class=\"number\">15</span>)</span><br><span class=\"line\">err_train_list = []</span><br><span class=\"line\">err_test_list = []</span><br><span class=\"line\">clf = DecisionTreeClassifier(criterion=<span class=\"string\">&#x27;entropy&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> d <span class=\"keyword\">in</span> depth:</span><br><span class=\"line\">    clf.set_params(max_depth=d)</span><br><span class=\"line\">    clf.fit(x_train, y_train)</span><br><span class=\"line\">    y_train_pred = clf.predict(x_train)</span><br><span class=\"line\">    err_train = <span class=\"number\">1</span> - accuracy_score(y_train, y_train_pred)</span><br><span class=\"line\">    err_train_list.append(err_train)</span><br><span class=\"line\">    y_test_pred = clf.predict(x_test)</span><br><span class=\"line\">    err_test = <span class=\"number\">1</span> - accuracy_score(y_test, y_test_pred)</span><br><span class=\"line\">    err_test_list.append(err_test)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(d, <span class=\"string\">&#x27; 测试集错误率: %.2f%%&#x27;</span> % (<span class=\"number\">100</span> * err_test))</span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.plot(depth,</span><br><span class=\"line\">         err_test_list,</span><br><span class=\"line\">         <span class=\"string\">&#x27;ro-&#x27;</span>,</span><br><span class=\"line\">         markeredgecolor=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">         lw=<span class=\"number\">2</span>,</span><br><span class=\"line\">         label=<span class=\"string\">&#x27;测试集错误率&#x27;</span>)</span><br><span class=\"line\">plt.plot(depth,</span><br><span class=\"line\">         err_train_list,</span><br><span class=\"line\">         <span class=\"string\">&#x27;go-&#x27;</span>,</span><br><span class=\"line\">         markeredgecolor=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">         lw=<span class=\"number\">2</span>,</span><br><span class=\"line\">         label=<span class=\"string\">&#x27;训练集错误率&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;决策树深度&#x27;</span>, fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;错误率&#x27;</span>, fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.legend(loc=<span class=\"string\">&#x27;lower left&#x27;</span>, fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;决策树深度与过拟合&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>, color=<span class=\"string\">&#x27;#606060&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<pre><code>训练集正确率： 0.9523809523809523\n测试集正确率： 0.6222222222222222\n(2500, 2)\nx_show =\n [[4.3        2.        ]\n [4.37346939 2.        ]\n [4.44693878 2.        ]\n ...\n [7.75306122 4.4       ]\n [7.82653061 4.4       ]\n [7.9        4.4       ]]\n(2500,)\n[0 0 0 ... 2 2 2]\n[[0 0 0 ... 1 1 1]\n [0 0 0 ... 1 1 1]\n [0 0 0 ... 1 1 1]\n ...\n [0 0 0 ... 2 2 2]\n [0 0 0 ... 2 2 2]\n [0 0 0 ... 2 2 2]]\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_20_1.png\" alt=\"png\"></p>\n<pre><code>[0 1 2 0 2 2 1 0 0 2 2 0 1 2 1 0 2 1 0 0 1 0 2 0 2 1 0 0 1 1 2 2 2 2 1 0 1\n 0 2 1 2 0 1 1 1]\n[0 1 1 0 2 1 2 0 0 2 1 0 2 1 1 0 1 1 0 0 1 1 1 0 2 1 0 0 1 2 1 2 1 2 2 0 1\n 0 1 2 2 0 2 2 1]\n准确度: 62.22%\n1  测试集错误率: 44.44%\n2  测试集错误率: 40.00%\n3  测试集错误率: 20.00%\n4  测试集错误率: 24.44%\n5  测试集错误率: 24.44%\n6  测试集错误率: 28.89%\n7  测试集错误率: 37.78%\n8  测试集错误率: 40.00%\n9  测试集错误率: 37.78%\n10  测试集错误率: 40.00%\n11  测试集错误率: 37.78%\n12  测试集错误率: 37.78%\n13  测试集错误率: 40.00%\n14  测试集错误率: 37.78%\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_20_3.png\" alt=\"png\"></p>\n<h4 id=\"随机森林\">随机森林</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.tree <span class=\"keyword\">import</span> DecisionTreeClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"></span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">iris_feature = <span class=\"string\">u&#x27;花萼长度&#x27;</span>, <span class=\"string\">u&#x27;花萼宽度&#x27;</span>, <span class=\"string\">u&#x27;花瓣长度&#x27;</span>, <span class=\"string\">u&#x27;花瓣宽度&#x27;</span></span><br><span class=\"line\">path = <span class=\"string\">&#x27;./_data_set/iris_classification/iris.data&#x27;</span>  <span class=\"comment\"># 数据文件路径</span></span><br><span class=\"line\">data = pd.read_csv(path, header=<span class=\"literal\">None</span>)</span><br><span class=\"line\">x_prime = data[<span class=\"built_in\">list</span>(<span class=\"built_in\">range</span>(<span class=\"number\">4</span>))]</span><br><span class=\"line\">y = pd.Categorical(data[<span class=\"number\">4</span>]).codes</span><br><span class=\"line\">x_prime_train, x_prime_test, y_train, y_test = train_test_split(x_prime,</span><br><span class=\"line\">                                                                y,</span><br><span class=\"line\">                                                                train_size=<span class=\"number\">0.7</span>,</span><br><span class=\"line\">                                                                random_state=<span class=\"number\">0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">feature_pairs = [[<span class=\"number\">0</span>, <span class=\"number\">1</span>], [<span class=\"number\">0</span>, <span class=\"number\">2</span>], [<span class=\"number\">0</span>, <span class=\"number\">3</span>], [<span class=\"number\">1</span>, <span class=\"number\">2</span>], [<span class=\"number\">1</span>, <span class=\"number\">3</span>], [<span class=\"number\">2</span>, <span class=\"number\">3</span>]]</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">8</span>, <span class=\"number\">6</span>), facecolor=<span class=\"string\">&#x27;#FFFFFF&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, pair <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(feature_pairs):</span><br><span class=\"line\">    <span class=\"comment\"># 准备数据</span></span><br><span class=\"line\">    x_train = x_prime_train[pair]</span><br><span class=\"line\">    x_test = x_prime_test[pair]</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 决策树学习</span></span><br><span class=\"line\">    model = DecisionTreeClassifier(criterion=<span class=\"string\">&#x27;entropy&#x27;</span>, min_samples_leaf=<span class=\"number\">3</span>)</span><br><span class=\"line\">    model.fit(x_train, y_train)</span><br><span class=\"line\"></span><br><span class=\"line\">    N, M = <span class=\"number\">500</span>, <span class=\"number\">500</span>  <span class=\"comment\"># 横纵各采样多少个值</span></span><br><span class=\"line\">    x1_min, x2_min = x_train.<span class=\"built_in\">min</span>()</span><br><span class=\"line\">    x1_max, x2_max = x_train.<span class=\"built_in\">max</span>()</span><br><span class=\"line\">    t1 = np.linspace(x1_min, x1_max, N)</span><br><span class=\"line\">    t2 = np.linspace(x2_min, x2_max, M)</span><br><span class=\"line\">    x1, x2 = np.meshgrid(t1, t2)  <span class=\"comment\"># 生成网格采样点</span></span><br><span class=\"line\">    x_show = np.stack((x1.flat, x2.flat), axis=<span class=\"number\">1</span>)  <span class=\"comment\"># 测试点</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 训练集上的预测结果</span></span><br><span class=\"line\">    y_train_pred = model.predict(x_train)</span><br><span class=\"line\">    acc_train = accuracy_score(y_train, y_train_pred)</span><br><span class=\"line\">    y_test_pred = model.predict(x_test)</span><br><span class=\"line\">    acc_test = accuracy_score(y_test, y_test_pred)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;特征：&#x27;</span>, iris_feature[pair[<span class=\"number\">0</span>]], <span class=\"string\">&#x27; + &#x27;</span>, iris_feature[pair[<span class=\"number\">1</span>]])</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\t训练集准确率: %.4f%%&#x27;</span> % (<span class=\"number\">100</span> * acc_train))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\t测试集准确率: %.4f%%\\n&#x27;</span> % (<span class=\"number\">100</span> * acc_test))</span><br><span class=\"line\"></span><br><span class=\"line\">    cm_light = mpl.colors.ListedColormap([<span class=\"string\">&#x27;#A0FFA0&#x27;</span>, <span class=\"string\">&#x27;#FFA0A0&#x27;</span>, <span class=\"string\">&#x27;#A0A0FF&#x27;</span>])</span><br><span class=\"line\">    cm_dark = mpl.colors.ListedColormap([<span class=\"string\">&#x27;g&#x27;</span>, <span class=\"string\">&#x27;r&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>])</span><br><span class=\"line\">    y_hat = model.predict(x_show)</span><br><span class=\"line\">    y_hat = y_hat.reshape(x1.shape)</span><br><span class=\"line\">    plt.subplot(<span class=\"number\">2</span>, <span class=\"number\">3</span>, i + <span class=\"number\">1</span>)</span><br><span class=\"line\">    plt.contour(x1,</span><br><span class=\"line\">                x2,</span><br><span class=\"line\">                y_hat,</span><br><span class=\"line\">                colors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">                levels=[<span class=\"number\">0</span>, <span class=\"number\">1</span>],</span><br><span class=\"line\">                antialiased=<span class=\"literal\">True</span>,</span><br><span class=\"line\">                linewidths=<span class=\"number\">1</span>)</span><br><span class=\"line\">    plt.pcolormesh(x1, x2, y_hat, cmap=cm_light, shading=<span class=\"string\">&#x27;auto&#x27;</span>)  <span class=\"comment\"># 预测值</span></span><br><span class=\"line\">    plt.scatter(x_train[pair[<span class=\"number\">0</span>]],</span><br><span class=\"line\">                x_train[pair[<span class=\"number\">1</span>]],</span><br><span class=\"line\">                c=y_train,</span><br><span class=\"line\">                s=<span class=\"number\">20</span>,</span><br><span class=\"line\">                edgecolors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">                cmap=cm_dark,</span><br><span class=\"line\">                label=<span class=\"string\">u&#x27;训练集&#x27;</span>)</span><br><span class=\"line\">    plt.scatter(x_test[pair[<span class=\"number\">0</span>]],</span><br><span class=\"line\">                x_test[pair[<span class=\"number\">1</span>]],</span><br><span class=\"line\">                c=y_test,</span><br><span class=\"line\">                s=<span class=\"number\">80</span>,</span><br><span class=\"line\">                marker=<span class=\"string\">&#x27;*&#x27;</span>,</span><br><span class=\"line\">                edgecolors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">                cmap=cm_dark,</span><br><span class=\"line\">                label=<span class=\"string\">u&#x27;测试集&#x27;</span>)</span><br><span class=\"line\">    plt.xlabel(iris_feature[pair[<span class=\"number\">0</span>]], fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">    plt.ylabel(iris_feature[pair[<span class=\"number\">1</span>]], fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">    <span class=\"comment\"># plt.legend(loc=&#x27;upper right&#x27;, fancybox=True, framealpha=0.3)</span></span><br><span class=\"line\">    plt.xlim(x1_min, x1_max)</span><br><span class=\"line\">    plt.ylim(x2_min, x2_max)</span><br><span class=\"line\">    plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>, color=<span class=\"string\">&#x27;#606060&#x27;</span>)</span><br><span class=\"line\">plt.suptitle(<span class=\"string\">u&#x27;决策树对鸢尾花数据两特征组合的分类结果&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">plt.tight_layout(<span class=\"number\">1</span>, rect=(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0.94</span>))  <span class=\"comment\"># (left, bottom, right, top)</span></span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>特征： 花萼长度  +  花萼宽度\n\t训练集准确率: 85.7143%\n\t测试集准确率: 71.1111%\n\n特征： 花萼长度  +  花瓣长度\n\t训练集准确率: 96.1905%\n\t测试集准确率: 91.1111%\n\n特征： 花萼长度  +  花瓣宽度\n\t训练集准确率: 96.1905%\n\t测试集准确率: 86.6667%\n\n特征： 花萼宽度  +  花瓣长度\n\t训练集准确率: 97.1429%\n\t测试集准确率: 95.5556%\n\n特征： 花萼宽度  +  花瓣宽度\n\t训练集准确率: 96.1905%\n\t测试集准确率: 84.4444%\n\n特征： 花瓣长度  +  花瓣宽度\n\t训练集准确率: 98.0952%\n\t测试集准确率: 97.7778%\n\n\n\nC:\\Users\\utsuk\\AppData\\Local\\Temp\\ipykernel_25000\\2108356862.py:83: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.\n  plt.tight_layout(1, rect=(0, 0, 1, 0.94))  # (left, bottom, right, top)\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_22_2.png\" alt=\"png\"></p>\n<h4 id=\"决策树-随机森林回归\">决策树-随机森林回归</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> RandomForestRegressor</span><br><span class=\"line\"></span><br><span class=\"line\">N = <span class=\"number\">100</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># [-3,3)</span></span><br><span class=\"line\">x = np.random.rand(N) * <span class=\"number\">6</span> - <span class=\"number\">3</span></span><br><span class=\"line\">x.sort()</span><br><span class=\"line\">y = np.sin(x) + np.random.randn(N) * <span class=\"number\">0.05</span></span><br><span class=\"line\">x = x.reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(x)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># model = DecisionTreeRegressor(criterion=&#x27;mse&#x27;, max_depth=10)</span></span><br><span class=\"line\">model = RandomForestRegressor(n_estimators=<span class=\"number\">20</span>, criterion=<span class=\"string\">&#x27;mse&#x27;</span>, max_depth=<span class=\"number\">10</span>)</span><br><span class=\"line\">model.fit(x, y)</span><br><span class=\"line\">x_test = np.linspace(-<span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">50</span>).reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\">y_hat = model.predict(x_test)</span><br><span class=\"line\"></span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.plot(x, y, <span class=\"string\">&#x27;r*&#x27;</span>, markersize=<span class=\"number\">10</span>, markeredgecolor=<span class=\"string\">&#x27;k&#x27;</span>, label=<span class=\"string\">&#x27;实际值&#x27;</span>)</span><br><span class=\"line\">plt.plot(x_test, y_hat, <span class=\"string\">&#x27;g-&#x27;</span>, linewidth=<span class=\"number\">2</span>, label=<span class=\"string\">&#x27;预测值&#x27;</span>)</span><br><span class=\"line\">plt.legend(loc=<span class=\"string\">&#x27;upper left&#x27;</span>, fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;X&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Y&#x27;</span>)</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>, color=<span class=\"string\">&#x27;#606060&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;决策树-随机森林回归&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">plt.tight_layout(<span class=\"number\">2</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 比较决策树的深度影响</span></span><br><span class=\"line\">depth = [<span class=\"number\">2</span>, <span class=\"number\">4</span>, <span class=\"number\">6</span>, <span class=\"number\">8</span>, <span class=\"number\">10</span>]</span><br><span class=\"line\">clr = <span class=\"string\">&#x27;rgbmy&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># model = DecisionTreeRegressor(criterion=&#x27;mse&#x27;)</span></span><br><span class=\"line\">model = RandomForestRegressor(n_estimators=<span class=\"number\">20</span>, criterion=<span class=\"string\">&#x27;mse&#x27;</span>)</span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.plot(x, y, <span class=\"string\">&#x27;ro&#x27;</span>, ms=<span class=\"number\">5</span>, mec=<span class=\"string\">&#x27;k&#x27;</span>, label=<span class=\"string\">&#x27;实际值&#x27;</span>)</span><br><span class=\"line\">x_test = np.linspace(-<span class=\"number\">3</span>, <span class=\"number\">3</span>, <span class=\"number\">50</span>).reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> d, c <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(depth, clr):</span><br><span class=\"line\">    model.set_params(max_depth=d)</span><br><span class=\"line\">    model.fit(x, y)</span><br><span class=\"line\">    y_hat = model.predict(x_test)</span><br><span class=\"line\">    plt.plot(x_test,</span><br><span class=\"line\">             y_hat,</span><br><span class=\"line\">             <span class=\"string\">&#x27;-&#x27;</span>,</span><br><span class=\"line\">             color=c,</span><br><span class=\"line\">             linewidth=<span class=\"number\">2</span>,</span><br><span class=\"line\">             markeredgecolor=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">             label=<span class=\"string\">&#x27;Depth=%d&#x27;</span> % d)</span><br><span class=\"line\">plt.legend(loc=<span class=\"string\">&#x27;upper left&#x27;</span>, fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;X&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Y&#x27;</span>)</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>, color=<span class=\"string\">&#x27;#606060&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;决策树-随机森林回归&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">plt.tight_layout(<span class=\"number\">2</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<pre><code>[[-2.95013857]\n [-2.91406777]\n [-2.90709403]\n [-2.90375999]\n [-2.87745415]\n [-2.86685497]\n [-2.84070033]\n [-2.81375697]\n [-2.77943784]\n [-2.77745775]\n [-2.66347611]\n [-2.65986762]\n [-2.64217075]\n [-2.63778267]\n [-2.63639243]\n [-2.60165162]\n [-2.48896096]\n [-2.43041085]\n [-2.39941506]\n [-2.38779079]\n [-2.37856289]\n [-2.32809632]\n [-2.29426051]\n [-2.25524085]\n [-2.23914776]\n [-2.16578847]\n [-2.0055294 ]\n [-1.9885004 ]\n [-1.73199798]\n [-1.61893958]\n [-1.58908223]\n [-1.54966302]\n [-1.49074428]\n [-1.46530843]\n [-1.40362808]\n [-1.3935955 ]\n [-1.3928819 ]\n [-1.37684247]\n [-1.3377295 ]\n [-1.33035029]\n [-1.24577529]\n [-1.15561278]\n [-1.12976361]\n [-0.92771942]\n [-0.91536325]\n [-0.83851709]\n [-0.54828961]\n [-0.54587447]\n [-0.54456521]\n [-0.51610774]\n [-0.38078143]\n [-0.27298529]\n [-0.20898971]\n [-0.20866835]\n [ 0.01703485]\n [ 0.03203468]\n [ 0.06107388]\n [ 0.07358949]\n [ 0.07361575]\n [ 0.10676155]\n [ 0.15818226]\n [ 0.20123638]\n [ 0.3410772 ]\n [ 0.45680655]\n [ 0.52384169]\n [ 0.65741898]\n [ 0.68306354]\n [ 0.82845395]\n [ 0.83952908]\n [ 0.99278446]\n [ 1.04865533]\n [ 1.16809926]\n [ 1.21294563]\n [ 1.44659934]\n [ 1.47606149]\n [ 1.48031876]\n [ 1.54476213]\n [ 1.54542061]\n [ 1.60452852]\n [ 1.85706958]\n [ 1.9814776 ]\n [ 2.07801869]\n [ 2.08420295]\n [ 2.08974078]\n [ 2.09458999]\n [ 2.21547939]\n [ 2.2354401 ]\n [ 2.2824592 ]\n [ 2.39313024]\n [ 2.4822308 ]\n [ 2.5275393 ]\n [ 2.56392915]\n [ 2.63696096]\n [ 2.65318554]\n [ 2.66286196]\n [ 2.67531127]\n [ 2.69337798]\n [ 2.78329004]\n [ 2.83409465]\n [ 2.94897411]]\n[-0.16517944 -0.2651016  -0.26383212 -0.2408083  -0.21137157 -0.30729908\n -0.24489794 -0.42738593 -0.39536257 -0.34762803 -0.55252409 -0.40629331\n -0.47658554 -0.47459876 -0.50897455 -0.58933727 -0.57144697 -0.61564276\n -0.76543047 -0.64009055 -0.79612233 -0.77625958 -0.82824783 -0.74228023\n -0.6882561  -0.85479709 -0.9210133  -0.88824326 -0.94228155 -1.04205908\n -1.01456756 -1.0150173  -1.01319155 -0.93942161 -1.0101109  -1.00949492\n -1.00669835 -1.02762794 -0.90526463 -1.04873446 -0.98356087 -0.96345712\n -0.90790305 -0.78617335 -0.8215092  -0.7756252  -0.62805774 -0.61416394\n -0.55438357 -0.54877048 -0.24409899 -0.24654351 -0.22139215 -0.31816396\n -0.00948097  0.03731195  0.07871564  0.06089414  0.091661    0.10130855\n  0.05916354  0.284293    0.32301758  0.47390064  0.43774825  0.59439442\n  0.62285701  0.78479681  0.7888438   0.91498224  0.91654605  0.84583033\n  0.90598404  0.99494553  1.05048367  0.97256267  1.04768316  1.09246729\n  0.92367061  0.97097779  0.98148804  0.86766162  0.87249721  0.81545132\n  0.80772307  0.75639662  0.73792794  0.75909448  0.71239606  0.63892773\n  0.6373865   0.53978973  0.47836416  0.47544309  0.4156747   0.46233128\n  0.43384357  0.32001956  0.2980857   0.16211947]\n\n\nC:\\Users\\utsuk\\AppData\\Local\\Temp\\ipykernel_25000\\2984870596.py:33: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.\n  plt.tight_layout(2)\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_24_2.png\" alt=\"png\"></p>\n<pre><code>C:\\Users\\utsuk\\AppData\\Local\\Temp\\ipykernel_25000\\2984870596.py:60: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.\n  plt.tight_layout(2)\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_24_4.png\" alt=\"png\"></p>\n<h3 id=\"分类问题\">分类问题</h3>\n<h4 id=\"逻辑回归\">逻辑回归</h4>\n<h5 id=\"二分类\">二分类</h5>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.linear_model <span class=\"keyword\">as</span> lm</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> mp</span><br><span class=\"line\"></span><br><span class=\"line\">x = np.array([[<span class=\"number\">3</span>, <span class=\"number\">1</span>], [<span class=\"number\">2</span>, <span class=\"number\">5</span>], [<span class=\"number\">1</span>, <span class=\"number\">8</span>], [<span class=\"number\">6</span>, <span class=\"number\">4</span>],\\</span><br><span class=\"line\">              [<span class=\"number\">5</span>, <span class=\"number\">2</span>], [<span class=\"number\">3</span>, <span class=\"number\">5</span>], [<span class=\"number\">4</span>, <span class=\"number\">7</span>], [<span class=\"number\">4</span>, -<span class=\"number\">1</span>]])</span><br><span class=\"line\">y = np.array([<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">0</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建逻辑分类器对象</span></span><br><span class=\"line\"><span class=\"comment\"># C参数：正则强度，越大拟合效果越小，通过调整该参数防止过拟合</span></span><br><span class=\"line\"><span class=\"comment\"># solver参数：逻辑函数中指数的函数关系（liblinear表示线性关系）</span></span><br><span class=\"line\">model = lm.LogisticRegression()</span><br><span class=\"line\">model.fit(x, y)  <span class=\"comment\"># 训练</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 预测</span></span><br><span class=\"line\">test_x = np.array([[<span class=\"number\">3</span>, <span class=\"number\">9</span>], [<span class=\"number\">6</span>, <span class=\"number\">1</span>]])</span><br><span class=\"line\">test_y = model.predict(test_x)  <span class=\"comment\"># 预测</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(test_y)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 计算显示坐标的边界</span></span><br><span class=\"line\"><span class=\"comment\"># x[:, 0].min()   x 中所有数组的第一位</span></span><br><span class=\"line\">left = x[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span></span><br><span class=\"line\">right = x[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">buttom = x[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span></span><br><span class=\"line\">top = x[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 产生网格化矩阵</span></span><br><span class=\"line\">grid_x, grid_y = np.meshgrid(np.arange(left, right, <span class=\"number\">0.01</span>),</span><br><span class=\"line\">                             np.arange(buttom, top, <span class=\"number\">0.01</span>))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;grid_x.shape:&quot;</span>, grid_x.shape)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;grid_y.shape:&quot;</span>, grid_y.shape)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 将x,y坐标合并成两列</span></span><br><span class=\"line\">mesh_x = np.column_stack((grid_x.ravel(), grid_y.ravel()))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;mesh_x.shape:&quot;</span>, mesh_x.shape)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 根据每个点的xy坐标进行预测，并还原成二维形状</span></span><br><span class=\"line\">mesh_z = model.predict(mesh_x)</span><br><span class=\"line\">mesh_z = mesh_z.reshape(grid_x.shape)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.figure(<span class=\"string\">&#x27;Logistic Regression&#x27;</span>, facecolor=<span class=\"string\">&#x27;lightgray&#x27;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&#x27;Logistic Regression&#x27;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.xlabel(<span class=\"string\">&#x27;x&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&#x27;y&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.tick_params(labelsize=<span class=\"number\">10</span>)</span><br><span class=\"line\">mp.pcolormesh(grid_x, grid_y, mesh_z, cmap=<span class=\"string\">&#x27;gray&#x27;</span>, shading=<span class=\"string\">&#x27;auto&#x27;</span>)</span><br><span class=\"line\">mp.scatter(</span><br><span class=\"line\">    x[:, <span class=\"number\">0</span>],  <span class=\"comment\"># 样本x坐标</span></span><br><span class=\"line\">    x[:, <span class=\"number\">1</span>],  <span class=\"comment\"># 样本y坐标</span></span><br><span class=\"line\">    c=y,</span><br><span class=\"line\">    cmap=<span class=\"string\">&#x27;brg&#x27;</span>,</span><br><span class=\"line\">    s=<span class=\"number\">80</span>)</span><br><span class=\"line\">mp.scatter(test_x[:, <span class=\"number\">0</span>], test_x[:, <span class=\"number\">1</span>], c=<span class=\"string\">&quot;red&quot;</span>, marker=<span class=\"string\">&#x27;s&#x27;</span>, s=<span class=\"number\">80</span>)</span><br><span class=\"line\">mp.show()</span><br></pre></td></tr></table></figure>\n<pre><code>[1 0]\ngrid_x.shape: (1100, 700)\ngrid_y.shape: (1100, 700)\nmesh_x.shape: (770000, 2)\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_27_1.png\" alt=\"png\"></p>\n<h5 id=\"多分类\">多分类</h5>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.linear_model <span class=\"keyword\">as</span> lm</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> mp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输入</span></span><br><span class=\"line\">x = np.array([[<span class=\"number\">4</span>, <span class=\"number\">7</span>], [<span class=\"number\">3.5</span>, <span class=\"number\">8</span>], [<span class=\"number\">3.1</span>, <span class=\"number\">6.2</span>], [<span class=\"number\">0.5</span>, <span class=\"number\">1</span>], [<span class=\"number\">1</span>, <span class=\"number\">2</span>], [<span class=\"number\">1.2</span>, <span class=\"number\">1.9</span>],</span><br><span class=\"line\">              [<span class=\"number\">6</span>, <span class=\"number\">2</span>], [<span class=\"number\">5.7</span>, <span class=\"number\">1.5</span>], [<span class=\"number\">5.4</span>, <span class=\"number\">2.2</span>]])</span><br><span class=\"line\"><span class=\"comment\"># 输出（多个类别）</span></span><br><span class=\"line\">y = np.array([<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">2</span>, <span class=\"number\">2</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建逻辑分类器对象</span></span><br><span class=\"line\">model = lm.LogisticRegression(C=<span class=\"number\">200</span>)  <span class=\"comment\"># 调整该值为1看效果</span></span><br><span class=\"line\">model.fit(x, y)  <span class=\"comment\"># 训练</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 坐标轴范围</span></span><br><span class=\"line\">left = x[:, <span class=\"number\">0</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span></span><br><span class=\"line\">right = x[:, <span class=\"number\">0</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">h = <span class=\"number\">0.005</span></span><br><span class=\"line\"></span><br><span class=\"line\">buttom = x[:, <span class=\"number\">1</span>].<span class=\"built_in\">min</span>() - <span class=\"number\">1</span></span><br><span class=\"line\">top = x[:, <span class=\"number\">1</span>].<span class=\"built_in\">max</span>() + <span class=\"number\">1</span></span><br><span class=\"line\">v = <span class=\"number\">0.005</span></span><br><span class=\"line\"></span><br><span class=\"line\">grid_x, grid_y = np.meshgrid(np.arange(left, right, h),</span><br><span class=\"line\">                             np.arange(buttom, top, v))</span><br><span class=\"line\"></span><br><span class=\"line\">mesh_x = np.column_stack((grid_x.ravel(), grid_y.ravel()))</span><br><span class=\"line\">mesh_z = model.predict(mesh_x)</span><br><span class=\"line\">mesh_z = mesh_z.reshape(grid_x.shape)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 可视化</span></span><br><span class=\"line\">mp.figure(<span class=\"string\">&#x27;Logistic Classification&#x27;</span>, facecolor=<span class=\"string\">&#x27;lightgray&#x27;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&#x27;Logistic Classification&#x27;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.xlabel(<span class=\"string\">&#x27;x&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&#x27;y&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.tick_params(labelsize=<span class=\"number\">10</span>)</span><br><span class=\"line\">mp.pcolormesh(grid_x, grid_y, mesh_z, cmap=<span class=\"string\">&#x27;gray&#x27;</span>, shading=<span class=\"string\">&#x27;auto&#x27;</span>)</span><br><span class=\"line\">mp.scatter(x[:, <span class=\"number\">0</span>], x[:, <span class=\"number\">1</span>], c=y, cmap=<span class=\"string\">&#x27;brg&#x27;</span>, s=<span class=\"number\">80</span>)</span><br><span class=\"line\">mp.show()</span><br></pre></td></tr></table></figure>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_29_0.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> datetime <span class=\"keyword\">import</span> datetime</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LinearRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> r2_score, mean_squared_error, mean_absolute_error</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.preprocessing <span class=\"keyword\">import</span> PolynomialFeatures, LabelEncoder</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.pipeline <span class=\"keyword\">import</span> make_pipeline</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"></span><br><span class=\"line\">pumpkins = pd.read_csv(<span class=\"string\">&#x27;./_data_set/US-pumpkins.csv&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># pumpkins = pumpkins[pumpkins[&#x27;Package&#x27;].str.contains(&#x27;bushel&#x27;,</span></span><br><span class=\"line\"><span class=\"comment\">#                                                      case=True,</span></span><br><span class=\"line\"><span class=\"comment\">#                                                      regex=True)]</span></span><br><span class=\"line\"></span><br><span class=\"line\">new_pumpkins = pumpkins.drop([</span><br><span class=\"line\">    c <span class=\"keyword\">for</span> c <span class=\"keyword\">in</span> pumpkins.columns <span class=\"keyword\">if</span> c <span class=\"keyword\">not</span> <span class=\"keyword\">in</span></span><br><span class=\"line\">    [<span class=\"string\">&#x27;Color&#x27;</span>, <span class=\"string\">&#x27;Origin&#x27;</span>, <span class=\"string\">&#x27;Item Size&#x27;</span>, <span class=\"string\">&#x27;Variety&#x27;</span>, <span class=\"string\">&#x27;City Name&#x27;</span>, <span class=\"string\">&#x27;Package&#x27;</span>]</span><br><span class=\"line\">],</span><br><span class=\"line\">                             axis=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">new_pumpkins.dropna(inplace=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">new_pumpkins = new_pumpkins.apply(LabelEncoder().fit_transform)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 颜色数据与其他列的关系</span></span><br><span class=\"line\">sns.PairGrid(new_pumpkins).<span class=\"built_in\">map</span>(sns.scatterplot)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 分类散点图</span></span><br><span class=\"line\"><span class=\"comment\"># sns.swarmplot(x=&quot;Color&quot;, y=&quot;Item Size&quot;, data=new_pumpkins)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 小提琴图</span></span><br><span class=\"line\">sns.catplot(x=<span class=\"string\">&quot;Color&quot;</span>, y=<span class=\"string\">&quot;Item Size&quot;</span>, kind=<span class=\"string\">&quot;violin&quot;</span>, data=new_pumpkins)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>&lt;seaborn.axisgrid.FacetGrid at 0x19b7ed39fd0&gt;\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_30_1.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_30_2.png\" alt=\"png\"></p>\n<h4 id=\"支持向量机-SVM\">支持向量机-SVM</h4>\n<h5 id=\"核函数\">核函数</h5>\n<ol>\n<li>\n<p>线性</p>\n</li>\n<li>\n<p>径向基-高斯</p>\n</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> svm</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> GridSearchCV</span><br><span class=\"line\"><span class=\"keyword\">from</span> time <span class=\"keyword\">import</span> time</span><br><span class=\"line\"></span><br><span class=\"line\">iris_feature = <span class=\"string\">&#x27;花萼长度&#x27;</span>, <span class=\"string\">&#x27;花萼宽度&#x27;</span>, <span class=\"string\">&#x27;花瓣长度&#x27;</span>, <span class=\"string\">&#x27;花瓣宽度&#x27;</span></span><br><span class=\"line\">path = <span class=\"string\">&#x27;./_data_set/iris_classification/iris.data&#x27;</span>  <span class=\"comment\"># 数据文件路径</span></span><br><span class=\"line\">data = pd.read_csv(path, header=<span class=\"literal\">None</span>)</span><br><span class=\"line\">x, y = data[[<span class=\"number\">0</span>, <span class=\"number\">1</span>]], pd.Categorical(data[<span class=\"number\">4</span>]).codes</span><br><span class=\"line\">x_train, x_test, y_train, y_test = train_test_split(x,</span><br><span class=\"line\">                                                    y,</span><br><span class=\"line\">                                                    random_state=<span class=\"number\">1</span>,</span><br><span class=\"line\">                                                    test_size=<span class=\"number\">0.4</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 分类器</span></span><br><span class=\"line\"><span class=\"comment\"># svm_clf = svm.SVC(C=10, gamma=1, kernel=&#x27;rbf&#x27;, decision_function_shape=&#x27;ovo&#x27;)</span></span><br><span class=\"line\"><span class=\"comment\"># svm_clf = svm.SVC(C=3, kernel=&#x27;poly&#x27;, degree=3)</span></span><br><span class=\"line\">svm_clf = svm.SVC(C=<span class=\"number\">3</span>, kernel=<span class=\"string\">&#x27;linear&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;GridSearchCV begin...&#x27;</span>)</span><br><span class=\"line\">t = time()</span><br><span class=\"line\">clf = svm_clf</span><br><span class=\"line\"><span class=\"comment\"># clf = GridSearchCV(svm_clf, param_grid=&#123;&#x27;gamma&#x27;:np.logspace(-2, 2, 10), &#x27;C&#x27;:np.logspace(-2, 2, 10)&#125;, cv=3)</span></span><br><span class=\"line\">clf.fit(x_train, y_train.ravel())</span><br><span class=\"line\">t_end = time()</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;耗时：%d秒&#x27;</span> % (t_end - t))</span><br><span class=\"line\"><span class=\"comment\"># print(&#x27;最优参数：&#x27;, clf.best_params_)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 准确率</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(clf.score(x_train, y_train))  <span class=\"comment\"># 精度</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;训练集准确率：&#x27;</span>, accuracy_score(y_train, clf.predict(x_train)))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(clf.score(x_test, y_test))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;测试集准确率：&#x27;</span>, accuracy_score(y_test, clf.predict(x_test)))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># decision_function</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(x_train[:<span class=\"number\">5</span>])</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;decision_function:\\n&#x27;</span>, clf.decision_function(x_train))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;\\npredict:\\n&#x27;</span>, clf.predict(x_train))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 画图</span></span><br><span class=\"line\">x1_min, x2_min = x.<span class=\"built_in\">min</span>()</span><br><span class=\"line\">x1_max, x2_max = x.<span class=\"built_in\">max</span>()</span><br><span class=\"line\">x1, x2 = np.mgrid[x1_min:x1_max:<span class=\"number\">300j</span>, x2_min:x2_max:<span class=\"number\">300j</span>]  <span class=\"comment\"># 生成网格采样点</span></span><br><span class=\"line\">grid_test = np.stack((x1.flat, x2.flat), axis=<span class=\"number\">1</span>)  <span class=\"comment\"># 测试点</span></span><br><span class=\"line\">grid_hat = clf.predict(grid_test)  <span class=\"comment\"># 预测分类值</span></span><br><span class=\"line\">grid_hat = grid_hat.reshape(x1.shape)  <span class=\"comment\"># 使之与输入的形状相同</span></span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">cm_light = mpl.colors.ListedColormap([<span class=\"string\">&#x27;#A0FFA0&#x27;</span>, <span class=\"string\">&#x27;#FFA0A0&#x27;</span>, <span class=\"string\">&#x27;#A0A0FF&#x27;</span>])</span><br><span class=\"line\">cm_dark = mpl.colors.ListedColormap([<span class=\"string\">&#x27;g&#x27;</span>, <span class=\"string\">&#x27;r&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>])</span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.pcolormesh(x1, x2, grid_hat, cmap=cm_light, shading=<span class=\"string\">&#x27;auto&#x27;</span>)</span><br><span class=\"line\">plt.scatter(x[<span class=\"number\">0</span>], x[<span class=\"number\">1</span>], c=y, edgecolors=<span class=\"string\">&#x27;k&#x27;</span>, s=<span class=\"number\">50</span>, cmap=cm_dark)  <span class=\"comment\"># 样本</span></span><br><span class=\"line\">plt.scatter(x_test[<span class=\"number\">0</span>], x_test[<span class=\"number\">1</span>], s=<span class=\"number\">120</span>, facecolors=<span class=\"string\">&#x27;none&#x27;</span>,</span><br><span class=\"line\">            zorder=<span class=\"number\">10</span>)  <span class=\"comment\"># 圈中测试集样本</span></span><br><span class=\"line\">plt.xlabel(iris_feature[<span class=\"number\">0</span>], fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.ylabel(iris_feature[<span class=\"number\">1</span>], fontsize=<span class=\"number\">13</span>)</span><br><span class=\"line\">plt.xlim(x1_min, x1_max)</span><br><span class=\"line\">plt.ylim(x2_min, x2_max)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;鸢尾花SVM二特征分类&#x27;</span>, fontsize=<span class=\"number\">16</span>)</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\">plt.tight_layout(pad=<span class=\"number\">1.5</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<pre><code>GridSearchCV begin...\n耗时：0秒\n0.7888888888888889\n训练集准确率： 0.7888888888888889\n0.7833333333333333\n测试集准确率： 0.7833333333333333\n       0    1\n11   4.8  3.4\n113  5.7  2.5\n123  6.3  2.7\n12   4.8  3.0\n2    4.7  3.2\ndecision_function:\n [[ 2.27077043  0.77466667 -0.23050192]\n [-0.26084184  2.25751125  1.0560141 ]\n [-0.28293421  2.25843306  1.22796515]\n [ 2.24308998  0.92588576 -0.2355186 ]\n [ 2.26643883  0.80879936 -0.24170145]\n [-0.28069428  1.23581332  2.24817619]\n [ 2.28018898  0.76457517 -0.24714914]\n [-0.25832462  1.21350955  2.20811726]\n [-0.27289547  1.20094518  2.249947  ]\n [-0.28479994  1.2318958   2.26058535]\n [-0.23449614  2.22389578  1.08207816]\n [-0.27824598  1.19362022  2.2618816 ]\n [-0.24940836  1.20624284  2.19142888]\n [ 2.2732283  -0.2577432   0.82271427]\n [-0.2872948   2.27977562  1.1680301 ]\n [-0.28016055  1.24346593  2.23969255]\n [-0.28069428  1.23581332  2.24817619]\n [-0.17539161  2.25364746  0.77515212]\n [-0.25325305  1.14281388  2.23566431]\n [-0.2421088   2.25159667  0.90072452]\n [ 2.24374936 -0.23761503  0.93581753]\n [ 2.24150985  0.87804111 -0.2241573 ]\n [ 2.28041834 -0.27382086  0.86293615]\n [-0.27824598  1.19362022  2.2618816 ]\n [ 2.27361996  0.84008337 -0.26180365]\n [-0.26919985  2.24943754  1.18347413]\n [-0.28629221  2.26101768  1.23745359]\n [-0.23808639  1.19803786  2.16960812]\n [ 2.24670891 -0.21840299  0.83780678]\n [ 2.23817757  0.82105098 -0.19112107]\n [-0.2549617   2.24213564  1.1247623 ]\n [ 2.24150985  0.87804111 -0.2241573 ]\n [-0.30409023  1.27536123  2.28319903]\n [-0.27073104  1.23503534  2.2197061 ]\n [-0.30441277  1.26883084  2.28803158]\n [-0.28752494  1.24411663  2.25991942]\n [-0.29292012  2.28000741  1.22212062]\n [-0.23176304  1.04104242  2.22722296]\n [-0.28694643  1.15125962  2.28088265]\n [-0.19956441  2.19653578  1.01742803]\n [ 2.26878977 -0.27918692  1.16597018]\n [-0.2549617   2.24213564  1.1247623 ]\n [ 2.18519501  1.23494087 -0.26146238]\n [-0.2512831   2.2597216   0.89408741]\n [-0.29066599  1.240849    2.26933123]\n [ 2.25729439 -0.2129225   0.79411601]\n [-0.29441953  1.26382422  2.26345809]\n [ 2.26377705 -0.22976306  0.79617407]\n [ 2.27077043  0.77466667 -0.23050192]\n [-0.2445374   1.07681969  2.23683943]\n [-0.21840757  2.21786592  1.00447438]\n [-0.28524498  1.22203776  2.26581127]\n [ 2.24947915  0.81045802 -0.20787766]\n [ 2.2684482  -0.24915018  0.81973595]\n [-0.20907334  1.12013512  2.17603067]\n [ 2.26728139  0.82893904 -0.24984081]\n [-0.2549617   2.24213564  1.1247623 ]\n [ 2.25207771  0.85867453 -0.23431088]\n [-0.28069428  1.23581332  2.24817619]\n [ 1.05055292  2.22662497 -0.23240122]\n [ 2.2722284   0.7997718  -0.24896247]\n [-0.26723747  1.19201787  2.24286157]\n [ 2.27827649  0.82682975 -0.26630655]\n [-0.17333043  2.16553945  1.02939988]\n [ 2.26890439  0.89311197 -0.26243597]\n [-0.2512831   2.2597216   0.89408741]\n [-0.23341849  2.27309387  0.7709214 ]\n [ 2.25617562 -0.22437834  0.81410784]\n [ 2.22986475  0.96247553 -0.22562355]\n [ 0.93771503  2.24006469 -0.23365567]\n [ 2.28631446 -0.25590025  0.75474384]\n [-0.23808639  1.19803786  2.16960812]\n [-0.2646401   1.23019768  2.20613126]\n [ 2.25729439 -0.2129225   0.79411601]\n [-0.28479994  1.2318958   2.26058535]\n [-0.22087216  2.20491832  1.08971052]\n [-0.29260626  2.28238001  1.20719635]\n [-0.29101034  1.23272406  2.27341138]\n [-0.2549617   2.24213564  1.1247623 ]\n [ 2.19974418 -0.17699012  0.91119813]\n [ 2.21209755  1.01040036 -0.21350121]\n [-0.27849238  2.26059076  1.19977637]\n [-0.26997469  2.24280567  1.20408124]\n [-0.29874557  1.25977449  2.27874043]\n [-0.25377271  2.24886239  1.06528288]\n [-0.27961589  2.2500049   1.22933155]\n [-0.27219081  1.21466357  2.24182934]\n [-0.2884762   2.2710352   1.22512174]\n [-0.28479994  1.2318958   2.26058535]\n [ 2.24150985  0.87804111 -0.2241573 ]]\n\npredict:\n [0 1 1 0 0 2 0 2 2 2 1 2 2 0 1 2 2 1 2 1 0 0 0 2 0 1 1 2 0 0 1 0 2 2 2 2 1\n 2 2 1 0 1 0 1 2 0 2 0 0 2 1 2 0 0 2 0 1 0 2 1 0 2 0 1 0 1 1 0 0 1 0 2 2 0\n 2 1 1 2 1 0 0 1 1 2 1 1 2 1 2 0]\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_32_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> svm</span><br><span class=\"line\"><span class=\"keyword\">from</span> scipy <span class=\"keyword\">import</span> stats</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">extend</span>(<span class=\"params\">a, b, r=<span class=\"number\">0.01</span></span>):</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a * (<span class=\"number\">1</span> + r) - b * r, -a * r + b * (<span class=\"number\">1</span> + r)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">np.random.seed(<span class=\"number\">0</span>)</span><br><span class=\"line\">N = <span class=\"number\">200</span></span><br><span class=\"line\">x = np.empty((<span class=\"number\">4</span> * N, <span class=\"number\">2</span>))</span><br><span class=\"line\">means = [(-<span class=\"number\">1</span>, <span class=\"number\">1</span>), (<span class=\"number\">1</span>, <span class=\"number\">1</span>), (<span class=\"number\">1</span>, -<span class=\"number\">1</span>), (-<span class=\"number\">1</span>, -<span class=\"number\">1</span>)]</span><br><span class=\"line\">sigmas = [</span><br><span class=\"line\">    np.eye(<span class=\"number\">2</span>), <span class=\"number\">2</span> * np.eye(<span class=\"number\">2</span>),</span><br><span class=\"line\">    np.diag((<span class=\"number\">1</span>, <span class=\"number\">2</span>)),</span><br><span class=\"line\">    np.array(((<span class=\"number\">3</span>, <span class=\"number\">2</span>), (<span class=\"number\">2</span>, <span class=\"number\">3</span>)))</span><br><span class=\"line\">]</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">4</span>):</span><br><span class=\"line\">    mn = stats.multivariate_normal(means[i], sigmas[i] * <span class=\"number\">0.07</span>)</span><br><span class=\"line\">    x[i * N:(i + <span class=\"number\">1</span>) * N, :] = mn.rvs(N)</span><br><span class=\"line\">a = np.array((<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>)).reshape((-<span class=\"number\">1</span>, <span class=\"number\">1</span>))</span><br><span class=\"line\">y = np.tile(a, N).flatten()</span><br><span class=\"line\">clf = svm.SVC(C=<span class=\"number\">1</span>, kernel=<span class=\"string\">&#x27;rbf&#x27;</span>, gamma=<span class=\"number\">1</span>, decision_function_shape=<span class=\"string\">&#x27;ovo&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># clf = svm.SVC(C=1, kernel=&#x27;linear&#x27;, decision_function_shape=&#x27;ovr&#x27;)</span></span><br><span class=\"line\">clf.fit(x, y)</span><br><span class=\"line\">y_hat = clf.predict(x)</span><br><span class=\"line\">acc = accuracy_score(y, y_hat)</span><br><span class=\"line\">np.set_printoptions(suppress=<span class=\"literal\">True</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;预测正确的样本个数：%d，正确率：%.2f%%&#x27;</span> % (<span class=\"built_in\">round</span>(acc * <span class=\"number\">4</span> * N), <span class=\"number\">100</span> * acc))</span><br><span class=\"line\"><span class=\"comment\"># decision_function</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(clf.decision_function(x))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_hat)</span><br><span class=\"line\"></span><br><span class=\"line\">x1_min, x2_min = np.<span class=\"built_in\">min</span>(x, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">x1_max, x2_max = np.<span class=\"built_in\">max</span>(x, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">x1_min, x1_max = extend(x1_min, x1_max)</span><br><span class=\"line\">x2_min, x2_max = extend(x2_min, x2_max)</span><br><span class=\"line\">x1, x2 = np.mgrid[x1_min:x1_max:<span class=\"number\">500j</span>, x2_min:x2_max:<span class=\"number\">500j</span>]</span><br><span class=\"line\">x_test = np.stack((x1.flat, x2.flat), axis=<span class=\"number\">1</span>)</span><br><span class=\"line\">y_test = clf.predict(x_test)</span><br><span class=\"line\">y_test = y_test.reshape(x1.shape)</span><br><span class=\"line\">cm_light = mpl.colors.ListedColormap(</span><br><span class=\"line\">    [<span class=\"string\">&#x27;#FF8080&#x27;</span>, <span class=\"string\">&#x27;#80FF80&#x27;</span>, <span class=\"string\">&#x27;#8080FF&#x27;</span>, <span class=\"string\">&#x27;#F0F080&#x27;</span>])</span><br><span class=\"line\">cm_dark = mpl.colors.ListedColormap([<span class=\"string\">&#x27;r&#x27;</span>, <span class=\"string\">&#x27;g&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"string\">&#x27;y&#x27;</span>])</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\">plt.figure(facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">plt.pcolormesh(x1, x2, y_test, cmap=cm_light, shading=<span class=\"string\">&#x27;auto&#x27;</span>)</span><br><span class=\"line\">plt.contour(x1, x2, y_test, levels=(<span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>), colors=<span class=\"string\">&#x27;k&#x27;</span>, linestyles=<span class=\"string\">&#x27;--&#x27;</span>)</span><br><span class=\"line\">plt.scatter(x[:, <span class=\"number\">0</span>],</span><br><span class=\"line\">            x[:, <span class=\"number\">1</span>],</span><br><span class=\"line\">            s=<span class=\"number\">20</span>,</span><br><span class=\"line\">            c=y,</span><br><span class=\"line\">            cmap=cm_dark,</span><br><span class=\"line\">            edgecolors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">            alpha=<span class=\"number\">0.7</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;$X_1$&#x27;</span>, fontsize=<span class=\"number\">11</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;$X_2$&#x27;</span>, fontsize=<span class=\"number\">11</span>)</span><br><span class=\"line\">plt.xlim((x1_min, x1_max))</span><br><span class=\"line\">plt.ylim((x2_min, x2_max))</span><br><span class=\"line\">plt.grid(b=<span class=\"literal\">True</span>)</span><br><span class=\"line\">plt.tight_layout(pad=<span class=\"number\">2.5</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;SVM多分类方法：One/One or One/Other&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>预测正确的样本个数：793，正确率：99.12%\n[[ 1.30403817  1.18371967  1.61069453  0.53379555  0.10282667 -0.6639782 ]\n [ 1.20484592  1.00041165  1.13023042  0.32840742  0.16888308 -0.33559223]\n [ 1.28448754  1.15305262  1.24310512  0.59725054 -0.31474389 -0.97622623]\n ...\n [-0.23584035 -0.08224918 -1.09483656  0.1554822  -1.12200744 -1.12840424]\n [ 0.2447751   0.34444513 -1.55255237  0.17064062 -1.24348982 -1.41973039]\n [-0.03070327 -0.15566364 -1.9254549  -0.09600454 -1.23897289 -1.44257329]]\n[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0\n 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 1\n 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n 1 1 1 1 1 1 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1\n 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2\n 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n 2 2 2 2 2 2 2 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n 2 2 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2\n 2 2 2 2 2 2 2 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 1 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3\n 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3]\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_33_1.png\" alt=\"png\"></p>\n<h4 id=\"朴素贝叶斯\">朴素贝叶斯</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">NBClassify</span>(<span class=\"title class_ inherited__\">object</span>):</span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">__init__</span>(<span class=\"params\">self, fillNa=<span class=\"number\">1</span></span>):</span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.fillNa = <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"keyword\">pass</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">train</span>(<span class=\"params\">self, trainSet</span>):</span><br><span class=\"line\">        <span class=\"comment\"># 计算每种类别的概率</span></span><br><span class=\"line\">        <span class=\"comment\"># 保存所有tag的所有种类，及它们出现的频次</span></span><br><span class=\"line\">        dictTag = &#123;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> subTuple <span class=\"keyword\">in</span> trainSet:</span><br><span class=\"line\">            dictTag[<span class=\"built_in\">str</span>(</span><br><span class=\"line\">                subTuple[<span class=\"number\">1</span>])] = <span class=\"number\">1</span> <span class=\"keyword\">if</span> <span class=\"built_in\">str</span>(subTuple[<span class=\"number\">1</span>]) <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> dictTag.keys(</span><br><span class=\"line\">                ) <span class=\"keyword\">else</span> dictTag[<span class=\"built_in\">str</span>(subTuple[<span class=\"number\">1</span>])] + <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"comment\"># 保存每个tag本身的概率</span></span><br><span class=\"line\">        tagProbablity = &#123;&#125;</span><br><span class=\"line\">        totalFreq = <span class=\"built_in\">sum</span>([value <span class=\"keyword\">for</span> value <span class=\"keyword\">in</span> dictTag.values()])</span><br><span class=\"line\">        <span class=\"keyword\">for</span> key, value <span class=\"keyword\">in</span> dictTag.items():</span><br><span class=\"line\">            tagProbablity[key] = value / totalFreq</span><br><span class=\"line\">        <span class=\"comment\"># print(tagProbablity)</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.tagProbablity = tagProbablity</span><br><span class=\"line\">        <span class=\"comment\">##############################################################################</span></span><br><span class=\"line\">        <span class=\"comment\"># 计算特征的条件概率</span></span><br><span class=\"line\">        <span class=\"comment\"># 保存特征属性基本信息&#123;特征1:&#123;值1:出现5次, 值2:出现1次&#125;, 特征2:&#123;值1:出现1次, 值2:出现5次&#125;&#125;</span></span><br><span class=\"line\">        dictFeaturesBase = &#123;&#125;</span><br><span class=\"line\">        <span class=\"keyword\">for</span> subTuple <span class=\"keyword\">in</span> trainSet:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> key, value <span class=\"keyword\">in</span> subTuple[<span class=\"number\">0</span>].items():</span><br><span class=\"line\">                <span class=\"keyword\">if</span> key <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> dictFeaturesBase.keys():</span><br><span class=\"line\">                    dictFeaturesBase[key] = &#123;value: <span class=\"number\">1</span>&#125;</span><br><span class=\"line\">                <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> value <span class=\"keyword\">not</span> <span class=\"keyword\">in</span> dictFeaturesBase[key].keys():</span><br><span class=\"line\">                        dictFeaturesBase[key][value] = <span class=\"number\">1</span></span><br><span class=\"line\">                    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                        dictFeaturesBase[key][value] += <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"comment\"># dictFeaturesBase = &#123;</span></span><br><span class=\"line\">        <span class=\"comment\"># &#x27;职业&#x27;: &#123;&#x27;农夫&#x27;: 1, &#x27;教师&#x27;: 2, &#x27;建筑工人&#x27;: 2, &#x27;护士&#x27;: 1&#125;,</span></span><br><span class=\"line\">        <span class=\"comment\"># &#x27;症状&#x27;: &#123;&#x27;打喷嚏&#x27;: 3, &#x27;头痛&#x27;: 3&#125;</span></span><br><span class=\"line\">        <span class=\"comment\"># &#125;</span></span><br><span class=\"line\">        dictFeatures = &#123;&#125;.fromkeys([key <span class=\"keyword\">for</span> key <span class=\"keyword\">in</span> dictTag])</span><br><span class=\"line\">        <span class=\"keyword\">for</span> key <span class=\"keyword\">in</span> dictFeatures.keys():</span><br><span class=\"line\">            dictFeatures[key] = &#123;&#125;.fromkeys([key <span class=\"keyword\">for</span> key <span class=\"keyword\">in</span> dictFeaturesBase])</span><br><span class=\"line\">        <span class=\"keyword\">for</span> key, value <span class=\"keyword\">in</span> dictFeatures.items():</span><br><span class=\"line\">            <span class=\"keyword\">for</span> subkey <span class=\"keyword\">in</span> value.keys():</span><br><span class=\"line\">                value[subkey] = &#123;&#125;.fromkeys(</span><br><span class=\"line\">                    [x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> dictFeaturesBase[subkey].keys()])</span><br><span class=\"line\">        <span class=\"comment\"># dictFeatures = &#123;</span></span><br><span class=\"line\">        <span class=\"comment\">#  &#x27;感冒 &#x27;: &#123;&#x27;症状&#x27;: &#123;&#x27;打喷嚏&#x27;: None, &#x27;头痛&#x27;: None&#125;, &#x27;职业&#x27;: &#123;&#x27;护士&#x27;: None, &#x27;农夫&#x27;: None, &#x27;建筑工人&#x27;: None, &#x27;教师&#x27;: None&#125;&#125;,</span></span><br><span class=\"line\">        <span class=\"comment\">#  &#x27;脑震荡&#x27;: &#123;&#x27;症状&#x27;: &#123;&#x27;打喷嚏&#x27;: None, &#x27;头痛&#x27;: None&#125;, &#x27;职业&#x27;: &#123;&#x27;护士&#x27;: None, &#x27;农夫&#x27;: None, &#x27;建筑工人&#x27;: None, &#x27;教师&#x27;: None&#125;&#125;,</span></span><br><span class=\"line\">        <span class=\"comment\">#  &#x27;过敏 &#x27;: &#123;&#x27;症状&#x27;: &#123;&#x27;打喷嚏&#x27;: None, &#x27;头痛&#x27;: None&#125;, &#x27;职业&#x27;: &#123;&#x27;护士&#x27;: None, &#x27;农夫&#x27;: None, &#x27;建筑工人&#x27;: None, &#x27;教师&#x27;: None&#125;&#125;</span></span><br><span class=\"line\">        <span class=\"comment\">#  &#125;</span></span><br><span class=\"line\">        <span class=\"comment\"># initialise dictFeatures</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> subTuple <span class=\"keyword\">in</span> trainSet:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> key, value <span class=\"keyword\">in</span> subTuple[<span class=\"number\">0</span>].items():</span><br><span class=\"line\">                dictFeatures[subTuple[<span class=\"number\">1</span>]][key][value] = <span class=\"number\">1</span> <span class=\"keyword\">if</span> dictFeatures[</span><br><span class=\"line\">                    subTuple[<span class=\"number\">1</span>]][key][value] == <span class=\"literal\">None</span> <span class=\"keyword\">else</span> dictFeatures[</span><br><span class=\"line\">                        subTuple[<span class=\"number\">1</span>]][key][value] + <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"comment\"># print(dictFeatures)</span></span><br><span class=\"line\">        <span class=\"comment\"># 将驯良样本中没有的项目，由None改为一个非常小的数值，表示其概率极小而并非是零</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> tag, featuresDict <span class=\"keyword\">in</span> dictFeatures.items():</span><br><span class=\"line\">            <span class=\"keyword\">for</span> featureName, fetureValueDict <span class=\"keyword\">in</span> featuresDict.items():</span><br><span class=\"line\">                <span class=\"keyword\">for</span> featureKey, featureValues <span class=\"keyword\">in</span> fetureValueDict.items():</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> featureValues == <span class=\"literal\">None</span>:</span><br><span class=\"line\">                        fetureValueDict[featureKey] = <span class=\"number\">1</span></span><br><span class=\"line\">        <span class=\"comment\"># 由特征频率计算特征的条件概率P(feature|tag)</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> tag, featuresDict <span class=\"keyword\">in</span> dictFeatures.items():</span><br><span class=\"line\">            <span class=\"keyword\">for</span> featureName, fetureValueDict <span class=\"keyword\">in</span> featuresDict.items():</span><br><span class=\"line\">                totalCount = <span class=\"built_in\">sum</span>(</span><br><span class=\"line\">                    [x <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> fetureValueDict.values() <span class=\"keyword\">if</span> x != <span class=\"literal\">None</span>])</span><br><span class=\"line\">                <span class=\"keyword\">for</span> featureKey, featureValues <span class=\"keyword\">in</span> fetureValueDict.items():</span><br><span class=\"line\">                    fetureValueDict[</span><br><span class=\"line\">                        featureKey] = featureValues / totalCount <span class=\"keyword\">if</span> featureValues != <span class=\"literal\">None</span> <span class=\"keyword\">else</span> <span class=\"literal\">None</span></span><br><span class=\"line\">        <span class=\"variable language_\">self</span>.featuresProbablity = dictFeatures</span><br><span class=\"line\">        <span class=\"comment\">##############################################################################</span></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">classify</span>(<span class=\"params\">self, featureDict</span>):</span><br><span class=\"line\">        resultDict = &#123;&#125;</span><br><span class=\"line\">        <span class=\"comment\"># 计算每个tag的条件概率</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> key, value <span class=\"keyword\">in</span> <span class=\"variable language_\">self</span>.tagProbablity.items():</span><br><span class=\"line\">            iNumList = []</span><br><span class=\"line\">            <span class=\"keyword\">for</span> f, v <span class=\"keyword\">in</span> featureDict.items():</span><br><span class=\"line\">                <span class=\"keyword\">if</span> <span class=\"variable language_\">self</span>.featuresProbablity[key][f][v]:</span><br><span class=\"line\">                    iNumList.append(<span class=\"variable language_\">self</span>.featuresProbablity[key][f][v])</span><br><span class=\"line\">            conditionPr = <span class=\"number\">1</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> iNum <span class=\"keyword\">in</span> iNumList:</span><br><span class=\"line\">                conditionPr *= iNum</span><br><span class=\"line\">            resultDict[key] = value * conditionPr</span><br><span class=\"line\">        <span class=\"comment\"># 对比每个tag的条件概率的大小</span></span><br><span class=\"line\">        resultList = <span class=\"built_in\">sorted</span>(resultDict.items(),</span><br><span class=\"line\">                            key=<span class=\"keyword\">lambda</span> x: x[<span class=\"number\">1</span>],</span><br><span class=\"line\">                            reverse=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        <span class=\"keyword\">return</span> resultList[<span class=\"number\">0</span>][<span class=\"number\">0</span>]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    trainSet = [</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;症状&quot;</span>: <span class=\"string\">&quot;打喷嚏&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;职业&quot;</span>: <span class=\"string\">&quot;护士&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;感冒 &quot;</span>),</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;症状&quot;</span>: <span class=\"string\">&quot;打喷嚏&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;职业&quot;</span>: <span class=\"string\">&quot;农夫&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;过敏 &quot;</span>),</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;症状&quot;</span>: <span class=\"string\">&quot;头痛&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;职业&quot;</span>: <span class=\"string\">&quot;建筑工人&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;脑震荡&quot;</span>),</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;症状&quot;</span>: <span class=\"string\">&quot;头痛&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;职业&quot;</span>: <span class=\"string\">&quot;建筑工人&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;感冒 &quot;</span>),</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;症状&quot;</span>: <span class=\"string\">&quot;打喷嚏&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;职业&quot;</span>: <span class=\"string\">&quot;教师&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;感冒 &quot;</span>),</span><br><span class=\"line\">        (&#123;</span><br><span class=\"line\">            <span class=\"string\">&quot;症状&quot;</span>: <span class=\"string\">&quot;头痛&quot;</span>,</span><br><span class=\"line\">            <span class=\"string\">&quot;职业&quot;</span>: <span class=\"string\">&quot;教师&quot;</span></span><br><span class=\"line\">        &#125;, <span class=\"string\">&quot;脑震荡&quot;</span>),</span><br><span class=\"line\">    ]</span><br><span class=\"line\">    monitor = NBClassify()</span><br><span class=\"line\">    <span class=\"comment\"># trainSet is something like that [(featureDict, tag), ]</span></span><br><span class=\"line\">    monitor.train(trainSet)</span><br><span class=\"line\">    <span class=\"comment\"># 打喷嚏的建筑工人</span></span><br><span class=\"line\">    <span class=\"comment\"># 请问他患上感冒的概率有多大？</span></span><br><span class=\"line\">    result = monitor.classify(&#123;<span class=\"string\">&quot;症状&quot;</span>: <span class=\"string\">&quot;打喷嚏&quot;</span>, <span class=\"string\">&quot;职业&quot;</span>: <span class=\"string\">&quot;建筑工人&quot;</span>&#125;)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(result)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>感冒\n</code></pre>\n<h4 id=\"多元问题-菜肴分类\">多元问题-菜肴分类</h4>\n<h5 id=\"数据加载与清洗\">数据加载与清洗</h5>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> imblearn.over_sampling <span class=\"keyword\">import</span> SMOTE</span><br><span class=\"line\"></span><br><span class=\"line\">df = pd.read_csv(<span class=\"string\">&#x27;./_data_set/cuisines_classification/cuisines.csv&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">df.head()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># df.info()</span></span><br></pre></td></tr></table></figure>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<pre><code>.dataframe tbody tr th &#123;\n    vertical-align: top;\n&#125;\n\n.dataframe thead th &#123;\n    text-align: right;\n&#125;\n</code></pre>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>cuisine</th>\n      <th>almond</th>\n      <th>angelica</th>\n      <th>anise</th>\n      <th>anise_seed</th>\n      <th>apple</th>\n      <th>apple_brandy</th>\n      <th>apricot</th>\n      <th>armagnac</th>\n      <th>...</th>\n      <th>whiskey</th>\n      <th>white_bread</th>\n      <th>white_wine</th>\n      <th>whole_grain_wheat_flour</th>\n      <th>wine</th>\n      <th>wood</th>\n      <th>yam</th>\n      <th>yeast</th>\n      <th>yogurt</th>\n      <th>zucchini</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>65</td>\n      <td>indian</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>66</td>\n      <td>indian</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>67</td>\n      <td>indian</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>68</td>\n      <td>indian</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>69</td>\n      <td>indian</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 385 columns</p>\n</div>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 菜肴成分分析</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">create_ingredient_df</span>(<span class=\"params\">df</span>):</span><br><span class=\"line\">    ingredient_df = df.T.drop([<span class=\"string\">&#x27;cuisine&#x27;</span>,</span><br><span class=\"line\">                               <span class=\"string\">&#x27;Unnamed: 0&#x27;</span>]).<span class=\"built_in\">sum</span>(axis=<span class=\"number\">1</span>).to_frame(<span class=\"string\">&#x27;value&#x27;</span>)</span><br><span class=\"line\">    ingredient_df = ingredient_df[(ingredient_df.T != <span class=\"number\">0</span>).<span class=\"built_in\">any</span>()]</span><br><span class=\"line\">    ingredient_df = ingredient_df.sort_values(by=<span class=\"string\">&#x27;value&#x27;</span>,</span><br><span class=\"line\">                                              ascending=<span class=\"literal\">False</span>,</span><br><span class=\"line\">                                              inplace=<span class=\"literal\">False</span>)</span><br><span class=\"line\">    <span class=\"keyword\">return</span> ingredient_df</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 分析原料使用率前十</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> [<span class=\"string\">&quot;thai&quot;</span>, <span class=\"string\">&quot;japanese&quot;</span>, <span class=\"string\">&quot;chinese&quot;</span>, <span class=\"string\">&quot;indian&quot;</span>, <span class=\"string\">&quot;korean&quot;</span>]:</span><br><span class=\"line\">    ingredient_df = create_ingredient_df(df[(df.cuisine == i)])</span><br><span class=\"line\">    ingredient_df.head(<span class=\"number\">10</span>).plot.barh().set_title(i)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删掉并不重要的特征</span></span><br><span class=\"line\">feature_df = df.drop([<span class=\"string\">&#x27;cuisine&#x27;</span>, <span class=\"string\">&#x27;Unnamed: 0&#x27;</span>, <span class=\"string\">&#x27;rice&#x27;</span>, <span class=\"string\">&#x27;garlic&#x27;</span>, <span class=\"string\">&#x27;ginger&#x27;</span>],</span><br><span class=\"line\">                     axis=<span class=\"number\">1</span>)</span><br><span class=\"line\">labels_df = df.cuisine</span><br></pre></td></tr></table></figure>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_38_0.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_38_1.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_38_2.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_38_3.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_38_4.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 菜肴样本不均,平衡数据集</span></span><br><span class=\"line\">transformed_feature_df, transformed_label_df = SMOTE().fit_resample(</span><br><span class=\"line\">    feature_df, labels_df)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 烂方法展示</span></span><br><span class=\"line\"><span class=\"comment\"># for i in [&quot;thai&quot;, &quot;japanese&quot;, &quot;chinese&quot;, &quot;indian&quot;, &quot;korean&quot;]:</span></span><br><span class=\"line\"><span class=\"comment\">#     print(i, df.loc[df[&#x27;cuisine&#x27;] == i].shape)</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># nicer one</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(</span><br><span class=\"line\">    <span class=\"string\">f&#x27;===================== old label count: ===================== \\n<span class=\"subst\">&#123;labels_df.value_counts()&#125;</span>\\</span></span><br><span class=\"line\"><span class=\"string\">    \\n===================== new label count: ===================== \\n<span class=\"subst\">&#123;transformed_label_df.value_counts()&#125;</span>&#x27;</span></span><br><span class=\"line\">)</span><br><span class=\"line\"></span><br><span class=\"line\">transformed_df = pd.concat([transformed_label_df, transformed_feature_df],</span><br><span class=\"line\">                           axis=<span class=\"number\">1</span>,</span><br><span class=\"line\">                           join=<span class=\"string\">&#x27;outer&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># transformed_df.head()</span></span><br><span class=\"line\">transformed_df.info()</span><br><span class=\"line\">transformed_df.to_csv(<span class=\"string\">&quot;./_data_set/cuisines_classification/cleaned_cuisines.csv&quot;</span>)</span><br></pre></td></tr></table></figure>\n<pre><code>===================== old label count: =====================\nkorean      799\nindian      598\nchinese     442\njapanese    320\nthai        289\nName: cuisine, dtype: int64\n===================== new label count: =====================\nindian      799\nthai        799\nchinese     799\njapanese    799\nkorean      799\nName: cuisine, dtype: int64\n&lt;class 'pandas.core.frame.DataFrame'&gt;\nRangeIndex: 3995 entries, 0 to 3994\nColumns: 381 entries, cuisine to zucchini\ndtypes: int64(380), object(1)\nmemory usage: 11.6+ MB\n</code></pre>\n<h5 id=\"分类-1\">分类-1</h5>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LogisticRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split, cross_val_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score, precision_score, confusion_matrix, classification_report, precision_recall_curve</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.svm <span class=\"keyword\">import</span> SVC</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\">cuisines_df = pd.read_csv(</span><br><span class=\"line\">    <span class=\"string\">&quot;./_data_set/cuisines_classification/cleaned_cuisines.csv&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">cuisines_df.head()</span><br></pre></td></tr></table></figure>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<pre><code>.dataframe tbody tr th &#123;\n    vertical-align: top;\n&#125;\n\n.dataframe thead th &#123;\n    text-align: right;\n&#125;\n</code></pre>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Unnamed: 0</th>\n      <th>cuisine</th>\n      <th>almond</th>\n      <th>angelica</th>\n      <th>anise</th>\n      <th>anise_seed</th>\n      <th>apple</th>\n      <th>apple_brandy</th>\n      <th>apricot</th>\n      <th>armagnac</th>\n      <th>...</th>\n      <th>whiskey</th>\n      <th>white_bread</th>\n      <th>white_wine</th>\n      <th>whole_grain_wheat_flour</th>\n      <th>wine</th>\n      <th>wood</th>\n      <th>yam</th>\n      <th>yeast</th>\n      <th>yogurt</th>\n      <th>zucchini</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>0</td>\n      <td>indian</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1</td>\n      <td>indian</td>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>2</td>\n      <td>indian</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>3</td>\n      <td>indian</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>4</td>\n      <td>indian</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>...</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>0</td>\n      <td>1</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 382 columns</p>\n</div>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">cuisines_label_df = cuisines_df[<span class=\"string\">&#x27;cuisine&#x27;</span>]</span><br><span class=\"line\">cuisines_feature_df = cuisines_df.drop([<span class=\"string\">&#x27;Unnamed: 0&#x27;</span>, <span class=\"string\">&#x27;cuisine&#x27;</span>], axis=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(cuisines_feature_df,</span><br><span class=\"line\">                                                    cuisines_label_df,</span><br><span class=\"line\">                                                    test_size=<span class=\"number\">0.3</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">1137      korean</span></span><br><span class=\"line\"><span class=\"string\">428         thai</span></span><br><span class=\"line\"><span class=\"string\">191       indian</span></span><br><span class=\"line\"><span class=\"string\">1336      korean</span></span><br><span class=\"line\"><span class=\"string\">3947        thai</span></span><br><span class=\"line\"><span class=\"string\">          ...</span></span><br><span class=\"line\"><span class=\"string\">3335    japanese</span></span><br><span class=\"line\"><span class=\"string\">3539        thai</span></span><br><span class=\"line\"><span class=\"string\">436         thai</span></span><br><span class=\"line\"><span class=\"string\">1875      indian</span></span><br><span class=\"line\"><span class=\"string\">3079    japanese</span></span><br><span class=\"line\"><span class=\"string\">Name: cuisine, Length: 2796, dtype: object</span></span><br><span class=\"line\"><span class=\"string\">[&#x27;korean&#x27; &#x27;thai&#x27; &#x27;indian&#x27; ... &#x27;thai&#x27; &#x27;indian&#x27; &#x27;japanese&#x27;]</span></span><br><span class=\"line\"><span class=\"string\"> &quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"comment\"># print(y_train)</span></span><br><span class=\"line\"><span class=\"comment\"># print(np.ravel(y_train))</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># lbfgs = LogisticRegression(solver=&#x27;lbfgs&#x27;)</span></span><br><span class=\"line\">model = LogisticRegression(multi_class=<span class=\"string\">&#x27;ovr&#x27;</span>,</span><br><span class=\"line\">                           solver=<span class=\"string\">&#x27;liblinear&#x27;</span>).fit(X_train, np.ravel(y_train))</span><br><span class=\"line\"></span><br><span class=\"line\">accuracy = model.score(X_test, y_test)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># print(&quot;Accuracy is &#123;&#125;&quot;.format(accuracy))</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&quot;Accuracy is <span class=\"subst\">&#123;accuracy&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>\n<pre><code>Accuracy is 0.7906588824020017\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># [选择性 test] 针对某一行测试</span></span><br><span class=\"line\"></span><br><span class=\"line\">line_num = <span class=\"number\">50</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;ingredients: <span class=\"subst\">&#123;X_test.iloc[line_num][X_test.iloc[line_num]!=<span class=\"number\">0</span>].keys()&#125;</span>&#x27;</span>)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">f&#x27;cuisine: <span class=\"subst\">&#123;y_test.iloc[line_num]&#125;</span>&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">test = X_test.iloc[line_num].values.reshape(-<span class=\"number\">1</span>, <span class=\"number\">1</span>).T</span><br><span class=\"line\">proba = model.predict_proba(test)</span><br><span class=\"line\">classes = model.classes_</span><br><span class=\"line\">resultdf = pd.DataFrame(data=proba, columns=classes)</span><br><span class=\"line\"></span><br><span class=\"line\">topPrediction = resultdf.T.sort_values(by=[<span class=\"number\">0</span>], ascending=[<span class=\"literal\">False</span>])</span><br><span class=\"line\">topPrediction.head()</span><br></pre></td></tr></table></figure>\n<pre><code>ingredients: Index(['butter', 'cayenne', 'cheese', 'cinnamon', 'coriander', 'onion',\n       'tomato', 'turmeric'],\n      dtype='object')\ncuisine: indian\n\n\nD:\\Scoop\\apps\\anaconda3\\current\\lib\\site-packages\\sklearn\\base.py:450: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names\n  warnings.warn(\n</code></pre>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<pre><code>.dataframe tbody tr th &#123;\n    vertical-align: top;\n&#125;\n\n.dataframe thead th &#123;\n    text-align: right;\n&#125;\n</code></pre>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>0</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>indian</th>\n      <td>0.962110</td>\n    </tr>\n    <tr>\n      <th>thai</th>\n      <td>0.021403</td>\n    </tr>\n    <tr>\n      <th>korean</th>\n      <td>0.011124</td>\n    </tr>\n    <tr>\n      <th>japanese</th>\n      <td>0.003710</td>\n    </tr>\n    <tr>\n      <th>chinese</th>\n      <td>0.001653</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">y_pred = model.predict(X_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(classification_report(y_test, y_pred))</span><br></pre></td></tr></table></figure>\n<pre><code>              precision    recall  f1-score   support\n\n     chinese       0.76      0.68      0.72       242\n      indian       0.91      0.93      0.92       239\n    japanese       0.72      0.76      0.74       222\n      korean       0.84      0.80      0.82       264\n        thai       0.77      0.84      0.80       232\n\n    accuracy                           0.80      1199\n   macro avg       0.80      0.80      0.80      1199\nweighted avg       0.80      0.80      0.80      1199\n</code></pre>\n<h5 id=\"分类-2\">分类-2</h5>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.neighbors <span class=\"keyword\">import</span> KNeighborsClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LogisticRegression</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.svm <span class=\"keyword\">import</span> SVC</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.ensemble <span class=\"keyword\">import</span> RandomForestClassifier, AdaBoostClassifier</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split, cross_val_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score, precision_score, confusion_matrix, classification_report, precision_recall_curve</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"></span><br><span class=\"line\">cuisines_df = pd.read_csv(</span><br><span class=\"line\">    <span class=\"string\">&quot;./_data_set/cuisines_classification/cleaned_cuisines.csv&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">cuisines_label_df = cuisines_df[<span class=\"string\">&#x27;cuisine&#x27;</span>]</span><br><span class=\"line\">cuisines_feature_df = cuisines_df.drop([<span class=\"string\">&#x27;Unnamed: 0&#x27;</span>, <span class=\"string\">&#x27;cuisine&#x27;</span>], axis=<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(cuisines_feature_df,</span><br><span class=\"line\">                                                    cuisines_label_df,</span><br><span class=\"line\">                                                    test_size=<span class=\"number\">0.3</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 正则化系数</span></span><br><span class=\"line\">C = <span class=\"number\">10</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建不同的分类器</span></span><br><span class=\"line\">classifiers = &#123;</span><br><span class=\"line\">    <span class=\"comment\"># 线性 SVC 分类器</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;Linear SVC&#x27;</span>: SVC(kernel=<span class=\"string\">&#x27;linear&#x27;</span>, C=C, probability=<span class=\"literal\">True</span>, random_state=<span class=\"number\">0</span>),</span><br><span class=\"line\">    <span class=\"comment\"># K-近邻分类器</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;KNN classifier&#x27;</span>: KNeighborsClassifier(C),</span><br><span class=\"line\">    <span class=\"comment\"># Support Vector 分类器</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;SVC&#x27;</span>: SVC(),</span><br><span class=\"line\">    <span class=\"comment\"># 集成分类器, 随机森林 与 ADA</span></span><br><span class=\"line\">    <span class=\"string\">&#x27;RFST&#x27;</span>: RandomForestClassifier(n_estimators=<span class=\"number\">100</span>),</span><br><span class=\"line\">    <span class=\"string\">&#x27;ADA&#x27;</span>: AdaBoostClassifier(n_estimators=<span class=\"number\">100</span>)</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> index, (name, classifier) <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(classifiers.items()):</span><br><span class=\"line\">    classifier.fit(X_train, np.ravel(y_train))</span><br><span class=\"line\"></span><br><span class=\"line\">    y_pred = classifier.predict(X_test)</span><br><span class=\"line\">    accuracy = accuracy_score(y_test, y_pred)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;Accuracy (train) for %s: %0.1f%%&quot;</span> % (name, accuracy * <span class=\"number\">100</span>))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(classification_report(y_test, y_pred))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>Accuracy (train) for Linear SVC: 80.2%\n              precision    recall  f1-score   support\n\n     chinese       0.73      0.76      0.74       250\n      indian       0.86      0.89      0.88       235\n    japanese       0.78      0.78      0.78       245\n      korean       0.88      0.74      0.80       227\n        thai       0.78      0.84      0.81       242\n\n    accuracy                           0.80      1199\n   macro avg       0.81      0.80      0.80      1199\nweighted avg       0.81      0.80      0.80      1199\n\nAccuracy (train) for KNN classifier: 73.6%\n              precision    recall  f1-score   support\n\n     chinese       0.71      0.73      0.72       250\n      indian       0.80      0.86      0.83       235\n    japanese       0.67      0.80      0.73       245\n      korean       0.91      0.51      0.65       227\n        thai       0.69      0.77      0.73       242\n\n    accuracy                           0.74      1199\n   macro avg       0.76      0.73      0.73      1199\nweighted avg       0.75      0.74      0.73      1199\n\nAccuracy (train) for SVC: 82.8%\n              precision    recall  f1-score   support\n\n     chinese       0.77      0.81      0.79       250\n      indian       0.88      0.93      0.90       235\n    japanese       0.82      0.76      0.79       245\n      korean       0.90      0.77      0.83       227\n        thai       0.79      0.88      0.83       242\n\n    accuracy                           0.83      1199\n   macro avg       0.83      0.83      0.83      1199\nweighted avg       0.83      0.83      0.83      1199\n\nAccuracy (train) for RFST: 84.5%\n              precision    recall  f1-score   support\n\n     chinese       0.82      0.81      0.82       250\n      indian       0.85      0.93      0.89       235\n    japanese       0.86      0.81      0.83       245\n      korean       0.90      0.83      0.86       227\n        thai       0.81      0.85      0.83       242\n\n    accuracy                           0.84      1199\n   macro avg       0.85      0.85      0.85      1199\nweighted avg       0.85      0.84      0.84      1199\n\nAccuracy (train) for ADA: 69.3%\n              precision    recall  f1-score   support\n\n     chinese       0.64      0.42      0.51       250\n      indian       0.81      0.85      0.83       235\n    japanese       0.65      0.61      0.63       245\n      korean       0.62      0.82      0.71       227\n        thai       0.73      0.79      0.76       242\n\n    accuracy                           0.69      1199\n   macro avg       0.69      0.70      0.69      1199\nweighted avg       0.69      0.69      0.68      1199\n</code></pre>\n<h3 id=\"聚类问题\">聚类问题</h3>\n<h4 id=\"聚类入门-数据分布\">聚类入门-数据分布</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"></span><br><span class=\"line\">df = pd.read_csv(<span class=\"string\">&quot;./_data_set/Clustering/nigerian-songs.csv&quot;</span>)</span><br><span class=\"line\"><span class=\"comment\"># df.head()</span></span><br><span class=\"line\">df.info()</span><br><span class=\"line\"><span class=\"comment\"># object 类型除外</span></span><br><span class=\"line\">df.describe()</span><br></pre></td></tr></table></figure>\n<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;\nRangeIndex: 530 entries, 0 to 529\nData columns (total 16 columns):\n #   Column            Non-Null Count  Dtype\n---  ------            --------------  -----\n 0   name              530 non-null    object\n 1   album             530 non-null    object\n 2   artist            530 non-null    object\n 3   artist_top_genre  530 non-null    object\n 4   release_date      530 non-null    int64\n 5   length            530 non-null    int64\n 6   popularity        530 non-null    int64\n 7   danceability      530 non-null    float64\n 8   acousticness      530 non-null    float64\n 9   energy            530 non-null    float64\n 10  instrumentalness  530 non-null    float64\n 11  liveness          530 non-null    float64\n 12  loudness          530 non-null    float64\n 13  speechiness       530 non-null    float64\n 14  tempo             530 non-null    float64\n 15  time_signature    530 non-null    int64\ndtypes: float64(8), int64(4), object(4)\nmemory usage: 66.4+ KB\n</code></pre>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<pre><code>.dataframe tbody tr th &#123;\n    vertical-align: top;\n&#125;\n\n.dataframe thead th &#123;\n    text-align: right;\n&#125;\n</code></pre>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>release_date</th>\n      <th>length</th>\n      <th>popularity</th>\n      <th>danceability</th>\n      <th>acousticness</th>\n      <th>energy</th>\n      <th>instrumentalness</th>\n      <th>liveness</th>\n      <th>loudness</th>\n      <th>speechiness</th>\n      <th>tempo</th>\n      <th>time_signature</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>530.000000</td>\n      <td>530.000000</td>\n      <td>530.000000</td>\n      <td>530.000000</td>\n      <td>530.000000</td>\n      <td>530.000000</td>\n      <td>530.000000</td>\n      <td>530.000000</td>\n      <td>530.000000</td>\n      <td>530.000000</td>\n      <td>530.000000</td>\n      <td>530.000000</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>2015.390566</td>\n      <td>222298.169811</td>\n      <td>17.507547</td>\n      <td>0.741619</td>\n      <td>0.265412</td>\n      <td>0.760623</td>\n      <td>0.016305</td>\n      <td>0.147308</td>\n      <td>-4.953011</td>\n      <td>0.130748</td>\n      <td>116.487864</td>\n      <td>3.986792</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>3.131688</td>\n      <td>39696.822259</td>\n      <td>18.992212</td>\n      <td>0.117522</td>\n      <td>0.208342</td>\n      <td>0.148533</td>\n      <td>0.090321</td>\n      <td>0.123588</td>\n      <td>2.464186</td>\n      <td>0.092939</td>\n      <td>23.518601</td>\n      <td>0.333701</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>1998.000000</td>\n      <td>89488.000000</td>\n      <td>0.000000</td>\n      <td>0.255000</td>\n      <td>0.000665</td>\n      <td>0.111000</td>\n      <td>0.000000</td>\n      <td>0.028300</td>\n      <td>-19.362000</td>\n      <td>0.027800</td>\n      <td>61.695000</td>\n      <td>3.000000</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>2014.000000</td>\n      <td>199305.000000</td>\n      <td>0.000000</td>\n      <td>0.681000</td>\n      <td>0.089525</td>\n      <td>0.669000</td>\n      <td>0.000000</td>\n      <td>0.075650</td>\n      <td>-6.298750</td>\n      <td>0.059100</td>\n      <td>102.961250</td>\n      <td>4.000000</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>2016.000000</td>\n      <td>218509.000000</td>\n      <td>13.000000</td>\n      <td>0.761000</td>\n      <td>0.220500</td>\n      <td>0.784500</td>\n      <td>0.000004</td>\n      <td>0.103500</td>\n      <td>-4.558500</td>\n      <td>0.097950</td>\n      <td>112.714500</td>\n      <td>4.000000</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>2017.000000</td>\n      <td>242098.500000</td>\n      <td>31.000000</td>\n      <td>0.829500</td>\n      <td>0.403000</td>\n      <td>0.875750</td>\n      <td>0.000234</td>\n      <td>0.164000</td>\n      <td>-3.331000</td>\n      <td>0.177000</td>\n      <td>125.039250</td>\n      <td>4.000000</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>2020.000000</td>\n      <td>511738.000000</td>\n      <td>73.000000</td>\n      <td>0.966000</td>\n      <td>0.954000</td>\n      <td>0.995000</td>\n      <td>0.910000</td>\n      <td>0.811000</td>\n      <td>0.582000</td>\n      <td>0.514000</td>\n      <td>206.007000</td>\n      <td>5.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">draw</span>(<span class=\"params\">df</span>):</span><br><span class=\"line\">    top = df[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>].value_counts()</span><br><span class=\"line\">    plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">7</span>))</span><br><span class=\"line\">    sns.barplot(x=top[:<span class=\"number\">5</span>].index, y=top[:<span class=\"number\">5</span>].values)</span><br><span class=\"line\">    plt.xticks(rotation=<span class=\"number\">45</span>)</span><br><span class=\"line\">    plt.title(<span class=\"string\">&#x27;Top genres&#x27;</span>, color=<span class=\"string\">&#x27;blue&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">draw(df)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 过滤掉 Missing</span></span><br><span class=\"line\">new_df = df[df[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>] != <span class=\"string\">&#x27;Missing&#x27;</span>]</span><br><span class=\"line\">draw(new_df)</span><br><span class=\"line\"></span><br><span class=\"line\">featured_df = new_df[((new_df[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>] == <span class=\"string\">&#x27;afro dancehall&#x27;</span>)</span><br><span class=\"line\">                      | (new_df[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>] == <span class=\"string\">&#x27;afropop&#x27;</span>)</span><br><span class=\"line\">                      | (new_df[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>] == <span class=\"string\">&#x27;nigerian pop&#x27;</span>))</span><br><span class=\"line\">                     &amp; (new_df[<span class=\"string\">&#x27;popularity&#x27;</span>] &gt; <span class=\"number\">0</span>)]</span><br><span class=\"line\">draw(featured_df)</span><br><span class=\"line\"></span><br><span class=\"line\">corrmat = featured_df.corr()</span><br><span class=\"line\">f, ax = plt.subplots(figsize=(<span class=\"number\">12</span>, <span class=\"number\">9</span>))</span><br><span class=\"line\">sns.heatmap(corrmat, vmax=<span class=\"number\">.8</span>, square=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n<pre><code>&lt;AxesSubplot:&gt;\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_50_1.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_50_2.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_50_3.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_50_4.png\" alt=\"png\"></p>\n<h4 id=\"K-Means-与衡量指标\">K-Means-与衡量指标</h4>\n<h5 id=\"入门-音乐分类\">入门-音乐分类</h5>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 这种格式可以运行</span></span><br><span class=\"line\">!pip install seaborn</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> seaborn <span class=\"keyword\">as</span> sns</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">df = pd.read_csv(<span class=\"string\">&quot;./_data_set/Clustering/nigerian-songs.csv&quot;</span>)</span><br><span class=\"line\">df.head()</span><br></pre></td></tr></table></figure>\n<pre><code>Looking in indexes: http://mirrors.aliyun.com/pypi/simple/\nRequirement already satisfied: seaborn in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (0.11.2)\nRequirement already satisfied: scipy&gt;=1.0 in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (from seaborn) (1.7.1)\nRequirement already satisfied: numpy&gt;=1.15 in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (from seaborn) (1.20.3)\nRequirement already satisfied: pandas&gt;=0.23 in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (from seaborn) (1.4.2)\nRequirement already satisfied: matplotlib&gt;=2.2 in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (from seaborn) (3.4.3)\nRequirement already satisfied: python-dateutil&gt;=2.7 in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (2.8.2)\nRequirement already satisfied: cycler&gt;=0.10 in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (0.11.0)\nRequirement already satisfied: pyparsing&gt;=2.2.1 in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (3.0.4)\nRequirement already satisfied: kiwisolver&gt;=1.0.1 in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (1.3.2)\nRequirement already satisfied: pillow&gt;=6.2.0 in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (from matplotlib&gt;=2.2-&gt;seaborn) (9.0.1)\nRequirement already satisfied: pytz&gt;=2020.1 in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (from pandas&gt;=0.23-&gt;seaborn) (2021.3)\nRequirement already satisfied: six&gt;=1.5 in d:\\scoop\\apps\\anaconda3\\2021.11\\lib\\site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib&gt;=2.2-&gt;seaborn) (1.16.0)\n</code></pre>\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n<pre><code>.dataframe tbody tr th &#123;\n    vertical-align: top;\n&#125;\n\n.dataframe thead th &#123;\n    text-align: right;\n&#125;\n</code></pre>\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>album</th>\n      <th>artist</th>\n      <th>artist_top_genre</th>\n      <th>release_date</th>\n      <th>length</th>\n      <th>popularity</th>\n      <th>danceability</th>\n      <th>acousticness</th>\n      <th>energy</th>\n      <th>instrumentalness</th>\n      <th>liveness</th>\n      <th>loudness</th>\n      <th>speechiness</th>\n      <th>tempo</th>\n      <th>time_signature</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Sparky</td>\n      <td>Mandy &amp; The Jungle</td>\n      <td>Cruel Santino</td>\n      <td>alternative r&amp;b</td>\n      <td>2019</td>\n      <td>144000</td>\n      <td>48</td>\n      <td>0.666</td>\n      <td>0.8510</td>\n      <td>0.420</td>\n      <td>0.534000</td>\n      <td>0.1100</td>\n      <td>-6.699</td>\n      <td>0.0829</td>\n      <td>133.015</td>\n      <td>5</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>shuga rush</td>\n      <td>EVERYTHING YOU HEARD IS TRUE</td>\n      <td>Odunsi (The Engine)</td>\n      <td>afropop</td>\n      <td>2020</td>\n      <td>89488</td>\n      <td>30</td>\n      <td>0.710</td>\n      <td>0.0822</td>\n      <td>0.683</td>\n      <td>0.000169</td>\n      <td>0.1010</td>\n      <td>-5.640</td>\n      <td>0.3600</td>\n      <td>129.993</td>\n      <td>3</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>LITT!</td>\n      <td>LITT!</td>\n      <td>AYLØ</td>\n      <td>indie r&amp;b</td>\n      <td>2018</td>\n      <td>207758</td>\n      <td>40</td>\n      <td>0.836</td>\n      <td>0.2720</td>\n      <td>0.564</td>\n      <td>0.000537</td>\n      <td>0.1100</td>\n      <td>-7.127</td>\n      <td>0.0424</td>\n      <td>130.005</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Confident / Feeling Cool</td>\n      <td>Enjoy Your Life</td>\n      <td>Lady Donli</td>\n      <td>nigerian pop</td>\n      <td>2019</td>\n      <td>175135</td>\n      <td>14</td>\n      <td>0.894</td>\n      <td>0.7980</td>\n      <td>0.611</td>\n      <td>0.000187</td>\n      <td>0.0964</td>\n      <td>-4.961</td>\n      <td>0.1130</td>\n      <td>111.087</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>wanted you</td>\n      <td>rare.</td>\n      <td>Odunsi (The Engine)</td>\n      <td>afropop</td>\n      <td>2018</td>\n      <td>152049</td>\n      <td>25</td>\n      <td>0.702</td>\n      <td>0.1160</td>\n      <td>0.833</td>\n      <td>0.910000</td>\n      <td>0.3480</td>\n      <td>-6.044</td>\n      <td>0.0447</td>\n      <td>105.115</td>\n      <td>4</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">fetured_df = df[((df[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>] == <span class=\"string\">&#x27;afro dancehall&#x27;</span>)</span><br><span class=\"line\">                 | (df[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>] == <span class=\"string\">&#x27;afropop&#x27;</span>)</span><br><span class=\"line\">                 | (df[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>] == <span class=\"string\">&#x27;nigerian pop&#x27;</span>))</span><br><span class=\"line\">                &amp; (df[<span class=\"string\">&#x27;popularity&#x27;</span>] &gt; <span class=\"number\">0</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\">top = fetured_df[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>].value_counts()</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">7</span>))</span><br><span class=\"line\">sns.barplot(x=top.index, y=top.values)</span><br><span class=\"line\">plt.xticks(rotation=<span class=\"number\">45</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Top genres&#x27;</span>, color=<span class=\"string\">&#x27;blue&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 箱线图, 可以直观看出数据的分布</span></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">20</span>, <span class=\"number\">20</span>), dpi=<span class=\"number\">200</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"string\">&quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 1)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;popularity&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 2)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;acousticness&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 3)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;energy&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 4)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;instrumentalness&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 5)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;liveness&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 6)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;loudness&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 7)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;speechiness&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 8)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;tempo&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 9)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;time_signature&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 10)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;danceability&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 11)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;length&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">  plt.subplot(4, 3, 12)</span></span><br><span class=\"line\"><span class=\"string\">  sns.boxplot(x=&#x27;release_date&#x27;, data=df)</span></span><br><span class=\"line\"><span class=\"string\"> &quot;&quot;&quot;</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> i, v <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>([</span><br><span class=\"line\">        <span class=\"string\">&quot;popularity&quot;</span>, <span class=\"string\">&quot;acousticness&quot;</span>, <span class=\"string\">&quot;energy&quot;</span>, <span class=\"string\">&quot;instrumentalness&quot;</span>, <span class=\"string\">&quot;liveness&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;loudness&quot;</span>, <span class=\"string\">&quot;speechiness&quot;</span>, <span class=\"string\">&quot;tempo&quot;</span>, <span class=\"string\">&quot;time_signature&quot;</span>, <span class=\"string\">&quot;danceability&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;length&quot;</span>, <span class=\"string\">&quot;release_date&quot;</span></span><br><span class=\"line\">]):</span><br><span class=\"line\">    plt.subplot(<span class=\"number\">4</span>, <span class=\"number\">3</span>, i + <span class=\"number\">1</span>)</span><br><span class=\"line\">    sns.boxplot(x=v, data=df)</span><br><span class=\"line\">    <span class=\"comment\"># plt.title(v)</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_53_0.png\" alt=\"png\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_53_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> sklearn.preprocessing <span class=\"keyword\">import</span> LabelEncoder</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.cluster <span class=\"keyword\">import</span> KMeans</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn <span class=\"keyword\">import</span> metrics</span><br><span class=\"line\"></span><br><span class=\"line\">le = LabelEncoder()</span><br><span class=\"line\"></span><br><span class=\"line\">X = df.loc[:, (<span class=\"string\">&#x27;artist_top_genre&#x27;</span>, <span class=\"string\">&#x27;popularity&#x27;</span>, <span class=\"string\">&#x27;danceability&#x27;</span>,</span><br><span class=\"line\">               <span class=\"string\">&#x27;acousticness&#x27;</span>, <span class=\"string\">&#x27;loudness&#x27;</span>, <span class=\"string\">&#x27;energy&#x27;</span>)]</span><br><span class=\"line\">X[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>] = le.fit_transform(X[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>])</span><br><span class=\"line\">y = le.transform(df[<span class=\"string\">&#x27;artist_top_genre&#x27;</span>])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 聚为3类</span></span><br><span class=\"line\">nclusters = <span class=\"number\">3</span></span><br><span class=\"line\">seed = <span class=\"number\">0</span></span><br><span class=\"line\"></span><br><span class=\"line\">km = KMeans(n_clusters=nclusters, random_state=seed).fit(X)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Predict the cluster for each data point</span></span><br><span class=\"line\">y_cluster_kmeans = km.predict(X)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(y_cluster_kmeans)</span><br><span class=\"line\"></span><br><span class=\"line\">score = metrics.silhouette_score(X, y_cluster_kmeans)</span><br><span class=\"line\"><span class=\"comment\"># score 从 [-1,1], 越大表示聚类效果越好</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(score)</span><br></pre></td></tr></table></figure>\n<pre><code>[2 0 2 0 0 0 0 0 0 0 0 0 2 0 0 0 0 0 2 0 0 0 0 0 2 0 0 1 0 0 2 1 1 2 2 2 0\n 2 0 1 2 2 2 0 1 1 2 1 0 0 0 0 1 1 1 1 1 2 0 2 1 0 2 0 1 2 1 2 1 1 1 1 2 1\n 0 2 2 0 0 0 1 0 0 1 1 1 1 0 0 1 1 1 2 1 0 0 1 1 1 0 0 1 0 1 2 0 1 1 2 0 1\n 1 1 1 1 1 1 0 1 0 1 0 1 0 2 1 2 0 1 1 1 0 0 1 1 0 2 0 1 1 0 0 0 1 1 0 1 0\n 2 0 1 1 0 0 0 1 0 1 1 0 1 0 1 0 0 1 1 1 0 0 0 1 1 1 0 0 1 0 2 1 1 1 1 1 0\n 1 1 1 1 0 2 0 0 0 0 0 0 1 1 2 1 1 1 1 1 2 1 1 0 0 1 1 1 1 1 0 0 1 0 1 0 0\n 1 2 1 1 1 1 0 1 1 1 1 0 1 1 1 0 1 0 1 2 1 1 1 1 1 1 0 1 0 1 0 1 0 1 1 1 1\n 2 0 0 1 1 0 0 0 1 0 0 1 1 1 2 1 1 2 0 0 1 0 1 1 0 1 1 1 0 2 1 1 2 2 2 0 2\n 2 2 2 2 2 2 2 1 2 2 1 2 1 2 1 2 2 2 0 1 0 1 1 0 1 2 1 1 2 1 0 2 2 0 0 0 1\n 0 1 0 1 1 1 1 2 1 1 2 2 1 0 2 0 2 1 1 2 2 2 0 0 2 2 1 1 0 0 0 1 1 1 1 1 1\n 1 1 1 1 2 1 1 0 1 1 1 1 0 1 1 1 1 0 0 1 0 1 1 1 1 1 1 1 1 1 0 1 1 0 1 1 1\n 1 1 1 2 1 1 1 1 1 1 1 1 1 1 1 2 1 2 2 1 0 0 0 1 2 1 1 2 1 0 0 0 2 2 2 0 2\n 2 2 0 2 2 0 1 0 1 2 0 1 1 1 1 1 1 0 1 1 0 0 1 0 1 0 1 1 1 1 1 1 1 1 1 0 1\n 0 1 1 1 1 1 1 0 1 1 1 2 0 0 1 1 1 1 2 1 0 2 1 1 1 0 1 1 2 1 0 0 0 0 0 1 1\n 1 1 1 0 0 1 1 1 1 1 1 1]\n0.5918299843029218\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 手肘方法: 拐点附近就是较好的聚类划分</span></span><br><span class=\"line\">wcss = []</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">1</span>, <span class=\"number\">11</span>):</span><br><span class=\"line\">    kmeans = KMeans(n_clusters=i, init=<span class=\"string\">&#x27;k-means++&#x27;</span>, random_state=<span class=\"number\">42</span>).fit(X)</span><br><span class=\"line\">    wcss.append(kmeans.inertia_)</span><br><span class=\"line\"></span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">5</span>))</span><br><span class=\"line\">sns.lineplot(<span class=\"built_in\">range</span>(<span class=\"number\">1</span>, <span class=\"number\">11</span>), wcss, marker=<span class=\"string\">&#x27;o&#x27;</span>, color=<span class=\"string\">&#x27;red&#x27;</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Elbow&#x27;</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Number of clusters&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;WCSS&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<pre><code>D:\\Scoop\\apps\\anaconda3\\current\\lib\\site-packages\\sklearn\\cluster\\_kmeans.py:1036: UserWarning: KMeans is known to have a memory leak on Windows with MKL, when there are less chunks than available threads. You can avoid it by setting the environment variable OMP_NUM_THREADS=3.\n  warnings.warn(\nD:\\Scoop\\apps\\anaconda3\\current\\lib\\site-packages\\seaborn\\_decorators.py:36: FutureWarning: Pass the following variables as keyword args: x, y. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n  warnings.warn(\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_55_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 初始值的随机选取会影响每次的结果</span></span><br><span class=\"line\">kmeans = KMeans(n_clusters=<span class=\"number\">3</span>).fit(X)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 0 | 1 | 2</span></span><br><span class=\"line\">labels = kmeans.predict(X)</span><br><span class=\"line\">plt.scatter(df[<span class=\"string\">&#x27;popularity&#x27;</span>], df[<span class=\"string\">&#x27;danceability&#x27;</span>], c=labels)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;popularity&#x27;</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;danceability&#x27;</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 真实值 与 与预测值集合的交集 元素个数</span></span><br><span class=\"line\">correct_labels = <span class=\"built_in\">sum</span>(y == kmeans.labels_)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;%d/%d samples were correctly labeled.&quot;</span> %</span><br><span class=\"line\">      (correct_labels, y.size))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Accuracy score: &#123;0:0.2f&#125;&#x27;</span>.<span class=\"built_in\">format</span>(correct_labels / <span class=\"built_in\">float</span>(y.size)))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_56_0.png\" alt=\"png\"></p>\n<pre><code>93/530 samples were correctly labeled.\nAccuracy score: 0.18\n</code></pre>\n<h5 id=\"sample-2\">sample-2</h5>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.colors</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.datasets <span class=\"keyword\">as</span> ds</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> homogeneity_score, completeness_score, v_measure_score, adjusted_mutual_info_score,\\</span><br><span class=\"line\">    adjusted_rand_score, silhouette_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.cluster <span class=\"keyword\">import</span> KMeans</span><br><span class=\"line\"><span class=\"keyword\">from</span> mpl_toolkits.mplot3d <span class=\"keyword\">import</span> Axes3D</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">expand</span>(<span class=\"params\">a, b</span>):</span><br><span class=\"line\">    d = (b - a) * <span class=\"number\">0.1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> a - d, b + d</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">N = <span class=\"number\">400</span></span><br><span class=\"line\">centers = <span class=\"number\">4</span></span><br><span class=\"line\">data, y = ds.make_blobs(N, n_features=<span class=\"number\">2</span>, centers=centers, random_state=<span class=\"number\">2</span>)</span><br><span class=\"line\">data2, y2 = ds.make_blobs(N,</span><br><span class=\"line\">                          n_features=<span class=\"number\">2</span>,</span><br><span class=\"line\">                          centers=centers,</span><br><span class=\"line\">                          cluster_std=(<span class=\"number\">1</span>, <span class=\"number\">2.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">2</span>),</span><br><span class=\"line\">                          random_state=<span class=\"number\">2</span>)</span><br><span class=\"line\">data3 = np.vstack(</span><br><span class=\"line\">    (data[y == <span class=\"number\">0</span>][:], data[y == <span class=\"number\">1</span>][:<span class=\"number\">50</span>], data[y == <span class=\"number\">2</span>][:<span class=\"number\">20</span>], data[y == <span class=\"number\">3</span>][:<span class=\"number\">5</span>]))</span><br><span class=\"line\">y3 = np.array([<span class=\"number\">0</span>] * <span class=\"number\">100</span> + [<span class=\"number\">1</span>] * <span class=\"number\">50</span> + [<span class=\"number\">2</span>] * <span class=\"number\">20</span> + [<span class=\"number\">3</span>] * <span class=\"number\">5</span>)</span><br><span class=\"line\">m = np.array(((<span class=\"number\">1</span>, <span class=\"number\">1</span>), (<span class=\"number\">1</span>, <span class=\"number\">3</span>)))</span><br><span class=\"line\">data_r = data.dot(m)</span><br><span class=\"line\"></span><br><span class=\"line\">matplotlib.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">matplotlib.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\">cm = matplotlib.colors.ListedColormap(<span class=\"built_in\">list</span>(<span class=\"string\">&#x27;rgbm&#x27;</span>))</span><br><span class=\"line\">data_list = data, data, data_r, data_r, data2, data2, data3, data3</span><br><span class=\"line\">y_list = y, y, y, y, y2, y2, y3, y3</span><br><span class=\"line\">titles = <span class=\"string\">&#x27;原始数据&#x27;</span>, <span class=\"string\">&#x27;KMeans++聚类&#x27;</span>, <span class=\"string\">&#x27;旋转后数据&#x27;</span>, <span class=\"string\">&#x27;旋转后KMeans++聚类&#x27;</span>,\\</span><br><span class=\"line\">          <span class=\"string\">&#x27;方差不相等数据&#x27;</span>, <span class=\"string\">&#x27;方差不相等KMeans++聚类&#x27;</span>, <span class=\"string\">&#x27;数量不相等数据&#x27;</span>, <span class=\"string\">&#x27;数量不相等KMeans++聚类&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">model = KMeans(n_clusters=<span class=\"number\">4</span>, init=<span class=\"string\">&#x27;k-means++&#x27;</span>, n_init=<span class=\"number\">5</span>)</span><br><span class=\"line\">fig = plt.figure(figsize=(<span class=\"number\">8</span>, <span class=\"number\">9</span>), facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i, (x, y, title) <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(<span class=\"built_in\">zip</span>(data_list, y_list, titles), start=<span class=\"number\">1</span>):</span><br><span class=\"line\">    <span class=\"comment\"># plt.subplot(4, 2, i)</span></span><br><span class=\"line\">    ax = fig.add_subplot(<span class=\"number\">4</span>, <span class=\"number\">2</span>, i)</span><br><span class=\"line\">    plt.title(title)</span><br><span class=\"line\">    <span class=\"keyword\">if</span> i % <span class=\"number\">2</span> == <span class=\"number\">1</span>:</span><br><span class=\"line\">        y_pred = y</span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        y_pred = model.fit_predict(x)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(i)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Homogeneity:&#x27;</span>, homogeneity_score(y, y_pred))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;completeness:&#x27;</span>, completeness_score(y, y_pred))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;V measure:&#x27;</span>, v_measure_score(y, y_pred))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;AMI:&#x27;</span>, adjusted_mutual_info_score(y, y_pred))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;ARI:&#x27;</span>, adjusted_rand_score(y, y_pred))</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Silhouette:&#x27;</span>, silhouette_score(x, y_pred), <span class=\"string\">&#x27;\\n&#x27;</span>)</span><br><span class=\"line\">    ax.scatter(x[:, <span class=\"number\">0</span>], x[:, <span class=\"number\">1</span>], s=<span class=\"number\">10</span>, c=y_pred, cmap=cm, edgecolors=<span class=\"string\">&#x27;none&#x27;</span>)</span><br><span class=\"line\">    ax.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\">plt.tight_layout(<span class=\"number\">2</span>, rect=(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0.95</span>))</span><br><span class=\"line\">plt.suptitle(<span class=\"string\">&#x27;数据分布对KMeans聚类的影响&#x27;</span>, fontsize=<span class=\"number\">18</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>1\nHomogeneity: 1.0\ncompleteness: 1.0\nV measure: 1.0\nAMI: 1.0\nARI: 1.0\nSilhouette: 0.616436816839852\n\n2\nHomogeneity: 0.9898828240244267\ncompleteness: 0.9899006758819153\nV measure: 0.9898917498726852\nAMI: 0.9898081557479033\nARI: 0.9933165272203728\nSilhouette: 0.6189656317733315\n\n3\nHomogeneity: 1.0\ncompleteness: 1.0\nV measure: 1.0\nAMI: 1.0\nARI: 1.0\nSilhouette: 0.5275987244664399\n\n4\nHomogeneity: 0.7296158940840607\ncompleteness: 0.7315285272632114\nV measure: 0.7305709588584066\nAMI: 0.7283397010755561\nARI: 0.6783811042853299\nSilhouette: 0.5366236044449266\n\n5\nHomogeneity: 1.0\ncompleteness: 1.0\nV measure: 1.0\nAMI: 1.0\nARI: 1.0\nSilhouette: 0.4790725752982868\n\n6\nHomogeneity: 0.7449364376693913\ncompleteness: 0.7755445167472191\nV measure: 0.7599323988656883\nAMI: 0.757903292819801\nARI: 0.7113213508090338\nSilhouette: 0.5737260449304202\n\n7\nHomogeneity: 1.0\ncompleteness: 1.0\nV measure: 1.0\nAMI: 1.0\nARI: 1.0\nSilhouette: 0.5975066093204152\n\n8\nHomogeneity: 0.9776347312784609\ncompleteness: 0.9728632742060752\nV measure: 0.975243166591057\nAMI: 0.9745709993295113\nARI: 0.9906840043816505\nSilhouette: 0.6013877858619149\n\n\n\nC:\\Users\\utsuk\\AppData\\Local\\Temp\\ipykernel_28356\\867049078.py:57: MatplotlibDeprecationWarning: Passing the pad parameter of tight_layout() positionally is deprecated since Matplotlib 3.3; the parameter will become keyword-only two minor releases later.\n  plt.tight_layout(2, rect=(0, 0, 1, 0.95))\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_58_2.png\" alt=\"png\"></p>\n<h4 id=\"层次聚类\">层次聚类</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib <span class=\"keyword\">as</span> mpl</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.cluster <span class=\"keyword\">import</span> AgglomerativeClustering</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.neighbors <span class=\"keyword\">import</span> kneighbors_graph</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.datasets <span class=\"keyword\">as</span> ds</span><br><span class=\"line\"><span class=\"keyword\">import</span> warnings</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">expand</span>(<span class=\"params\">a, b, r</span>):</span><br><span class=\"line\">    d = (b - a) * r</span><br><span class=\"line\">    <span class=\"keyword\">return</span> a - d, b + d</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    warnings.filterwarnings(action=<span class=\"string\">&#x27;ignore&#x27;</span>, category=UserWarning)</span><br><span class=\"line\">    np.set_printoptions(suppress=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    np.random.seed(<span class=\"number\">0</span>)</span><br><span class=\"line\">    n_clusters = <span class=\"number\">4</span></span><br><span class=\"line\">    N = <span class=\"number\">400</span></span><br><span class=\"line\">    data1, y1 = ds.make_blobs(n_samples=N,</span><br><span class=\"line\">                              n_features=<span class=\"number\">2</span>,</span><br><span class=\"line\">                              centers=((-<span class=\"number\">1</span>, <span class=\"number\">1</span>), (<span class=\"number\">1</span>, <span class=\"number\">1</span>), (<span class=\"number\">1</span>, -<span class=\"number\">1</span>), (-<span class=\"number\">1</span>, -<span class=\"number\">1</span>)),</span><br><span class=\"line\">                              cluster_std=(<span class=\"number\">0.1</span>, <span class=\"number\">0.2</span>, <span class=\"number\">0.3</span>, <span class=\"number\">0.4</span>),</span><br><span class=\"line\">                              random_state=<span class=\"number\">0</span>)</span><br><span class=\"line\">    data1 = np.array(data1)</span><br><span class=\"line\">    n_noise = <span class=\"built_in\">int</span>(<span class=\"number\">0.1</span> * N)</span><br><span class=\"line\">    r = np.random.rand(n_noise, <span class=\"number\">2</span>)</span><br><span class=\"line\">    data_min1, data_min2 = np.<span class=\"built_in\">min</span>(data1, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    data_max1, data_max2 = np.<span class=\"built_in\">max</span>(data1, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    r[:, <span class=\"number\">0</span>] = r[:, <span class=\"number\">0</span>] * (data_max1 - data_min1) + data_min1</span><br><span class=\"line\">    r[:, <span class=\"number\">1</span>] = r[:, <span class=\"number\">1</span>] * (data_max2 - data_min2) + data_min2</span><br><span class=\"line\">    data1_noise = np.concatenate((data1, r), axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    y1_noise = np.concatenate((y1, [<span class=\"number\">4</span>] * n_noise))</span><br><span class=\"line\"></span><br><span class=\"line\">    data2, y2 = ds.make_moons(n_samples=N, noise=<span class=\"number\">.05</span>)</span><br><span class=\"line\">    data2 = np.array(data2)</span><br><span class=\"line\">    n_noise = <span class=\"built_in\">int</span>(<span class=\"number\">0.1</span> * N)</span><br><span class=\"line\">    r = np.random.rand(n_noise, <span class=\"number\">2</span>)</span><br><span class=\"line\">    data_min1, data_min2 = np.<span class=\"built_in\">min</span>(data2, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    data_max1, data_max2 = np.<span class=\"built_in\">max</span>(data2, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    r[:, <span class=\"number\">0</span>] = r[:, <span class=\"number\">0</span>] * (data_max1 - data_min1) + data_min1</span><br><span class=\"line\">    r[:, <span class=\"number\">1</span>] = r[:, <span class=\"number\">1</span>] * (data_max2 - data_min2) + data_min2</span><br><span class=\"line\">    data2_noise = np.concatenate((data2, r), axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">    y2_noise = np.concatenate((y2, [<span class=\"number\">3</span>] * n_noise))</span><br><span class=\"line\"></span><br><span class=\"line\">    mpl.rcParams[<span class=\"string\">&#x27;font.sans-serif&#x27;</span>] = [<span class=\"string\">&#x27;SimHei&#x27;</span>]</span><br><span class=\"line\">    mpl.rcParams[<span class=\"string\">&#x27;axes.unicode_minus&#x27;</span>] = <span class=\"literal\">False</span></span><br><span class=\"line\"></span><br><span class=\"line\">    cm = mpl.colors.ListedColormap([<span class=\"string\">&#x27;r&#x27;</span>, <span class=\"string\">&#x27;g&#x27;</span>, <span class=\"string\">&#x27;b&#x27;</span>, <span class=\"string\">&#x27;m&#x27;</span>, <span class=\"string\">&#x27;c&#x27;</span>])</span><br><span class=\"line\">    plt.figure(figsize=(<span class=\"number\">10</span>, <span class=\"number\">8</span>), facecolor=<span class=\"string\">&#x27;w&#x27;</span>)</span><br><span class=\"line\">    plt.cla()</span><br><span class=\"line\">    linkages = (<span class=\"string\">&quot;ward&quot;</span>, <span class=\"string\">&quot;complete&quot;</span>, <span class=\"string\">&quot;average&quot;</span>)</span><br><span class=\"line\">    <span class=\"keyword\">for</span> index, (n_clusters, data, y) <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(</span><br><span class=\"line\">        ((<span class=\"number\">4</span>, data1, y1), (<span class=\"number\">4</span>, data1_noise, y1_noise), (<span class=\"number\">2</span>, data2, y2),</span><br><span class=\"line\">         (<span class=\"number\">2</span>, data2_noise, y2_noise))):</span><br><span class=\"line\">        plt.subplot(<span class=\"number\">4</span>, <span class=\"number\">4</span>, <span class=\"number\">4</span> * index + <span class=\"number\">1</span>)</span><br><span class=\"line\">        plt.scatter(data[:, <span class=\"number\">0</span>], data[:, <span class=\"number\">1</span>], c=y, s=<span class=\"number\">12</span>, edgecolors=<span class=\"string\">&#x27;k&#x27;</span>, cmap=cm)</span><br><span class=\"line\">        plt.title(<span class=\"string\">&#x27;Prime&#x27;</span>, fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">        plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\">        data_min1, data_min2 = np.<span class=\"built_in\">min</span>(data, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        data_max1, data_max2 = np.<span class=\"built_in\">max</span>(data, axis=<span class=\"number\">0</span>)</span><br><span class=\"line\">        plt.xlim(expand(data_min1, data_max1, <span class=\"number\">0.05</span>))</span><br><span class=\"line\">        plt.ylim(expand(data_min2, data_max2, <span class=\"number\">0.05</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">        connectivity = kneighbors_graph(data,</span><br><span class=\"line\">                                        n_neighbors=<span class=\"number\">7</span>,</span><br><span class=\"line\">                                        mode=<span class=\"string\">&#x27;distance&#x27;</span>,</span><br><span class=\"line\">                                        metric=<span class=\"string\">&#x27;minkowski&#x27;</span>,</span><br><span class=\"line\">                                        p=<span class=\"number\">2</span>,</span><br><span class=\"line\">                                        include_self=<span class=\"literal\">True</span>)</span><br><span class=\"line\">        connectivity = <span class=\"number\">0.5</span> * (connectivity + connectivity.T)</span><br><span class=\"line\">        <span class=\"keyword\">for</span> i, linkage <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(linkages):</span><br><span class=\"line\">            ac = AgglomerativeClustering(n_clusters=n_clusters,</span><br><span class=\"line\">                                         affinity=<span class=\"string\">&#x27;euclidean&#x27;</span>,</span><br><span class=\"line\">                                         connectivity=connectivity,</span><br><span class=\"line\">                                         linkage=linkage)</span><br><span class=\"line\">            ac.fit(data)</span><br><span class=\"line\">            y = ac.labels_</span><br><span class=\"line\">            plt.subplot(<span class=\"number\">4</span>, <span class=\"number\">4</span>, i + <span class=\"number\">2</span> + <span class=\"number\">4</span> * index)</span><br><span class=\"line\">            plt.scatter(data[:, <span class=\"number\">0</span>],</span><br><span class=\"line\">                        data[:, <span class=\"number\">1</span>],</span><br><span class=\"line\">                        c=y,</span><br><span class=\"line\">                        s=<span class=\"number\">12</span>,</span><br><span class=\"line\">                        edgecolors=<span class=\"string\">&#x27;k&#x27;</span>,</span><br><span class=\"line\">                        cmap=cm)</span><br><span class=\"line\">            plt.title(linkage, fontsize=<span class=\"number\">12</span>)</span><br><span class=\"line\">            plt.grid(b=<span class=\"literal\">True</span>, ls=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\">            plt.xlim(expand(data_min1, data_max1, <span class=\"number\">0.05</span>))</span><br><span class=\"line\">            plt.ylim(expand(data_min2, data_max2, <span class=\"number\">0.05</span>))</span><br><span class=\"line\">    plt.suptitle(<span class=\"string\">&#x27;层次聚类的不同合并策略&#x27;</span>, fontsize=<span class=\"number\">15</span>)</span><br><span class=\"line\">    plt.tight_layout(<span class=\"number\">0.5</span>, rect=(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">1</span>, <span class=\"number\">0.95</span>))</span><br><span class=\"line\">    plt.show()</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_60_0.png\" alt=\"png\"></p>\n<h3 id=\"降维问题\">降维问题</h3>\n<h4 id=\"缺失值比率\">缺失值比率</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># import required libraries</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># read the data</span></span><br><span class=\"line\">train = pd.read_csv(<span class=\"string\">&quot;./_data_set/降维问题/train_v9rqX0R.csv&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># checking the percentage of missing values in each variable</span></span><br><span class=\"line\"><span class=\"comment\"># 数据完整率 = (空数 / 所有数) * 100</span></span><br><span class=\"line\">a = train.isnull().<span class=\"built_in\">sum</span>() / <span class=\"built_in\">len</span>(train) * <span class=\"number\">100</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># saving column names in a variable</span></span><br><span class=\"line\">variable = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"number\">12</span>):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> a[i] &lt;= <span class=\"number\">20</span>:  <span class=\"comment\">#setting the threshold as 20%</span></span><br><span class=\"line\">        variable.append(train.columns[i])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 缺失率大于阈值的列</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(variable)</span><br></pre></td></tr></table></figure>\n<pre><code>['Item_Identifier', 'Item_Weight', 'Item_Fat_Content', 'Item_Visibility', 'Item_Type', 'Item_MRP', 'Outlet_Identifier', 'Outlet_Establishment_Year', 'Outlet_Location_Type', 'Outlet_Type', 'Item_Outlet_Sales']\n</code></pre>\n<h4 id=\"低方差过滤\">低方差过滤</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># import required libraries</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># read the data</span></span><br><span class=\"line\">train = pd.read_csv(<span class=\"string\">&quot;./_data_set/降维问题/train_v9rqX0R.csv&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 填充空项</span></span><br><span class=\"line\">train[<span class=\"string\">&#x27;Item_Weight&#x27;</span>].fillna(train[<span class=\"string\">&#x27;Item_Weight&#x27;</span>].median(), inplace=<span class=\"literal\">True</span>)</span><br><span class=\"line\">train[<span class=\"string\">&#x27;Outlet_Size&#x27;</span>].fillna(train[<span class=\"string\">&#x27;Outlet_Size&#x27;</span>].mode()[<span class=\"number\">0</span>], inplace=<span class=\"literal\">True</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 填充后的缺失率</span></span><br><span class=\"line\"><span class=\"built_in\">print</span>(train.isnull().<span class=\"built_in\">sum</span>() / <span class=\"built_in\">len</span>(train) * <span class=\"number\">100</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">numeric = train[[</span><br><span class=\"line\">    <span class=\"string\">&#x27;Item_Weight&#x27;</span>, <span class=\"string\">&#x27;Item_Visibility&#x27;</span>, <span class=\"string\">&#x27;Item_MRP&#x27;</span>, <span class=\"string\">&#x27;Outlet_Establishment_Year&#x27;</span></span><br><span class=\"line\">]]</span><br><span class=\"line\">var = numeric.var()</span><br><span class=\"line\">numeric = numeric.columns</span><br><span class=\"line\">variable = []</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">0</span>, <span class=\"built_in\">len</span>(var)):</span><br><span class=\"line\">    <span class=\"keyword\">if</span> var[i] &gt;= <span class=\"number\">10</span>:  <span class=\"comment\">#setting the threshold as 10%</span></span><br><span class=\"line\">        variable.append(numeric[i])</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(variable)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>Item_Identifier              0.0\nItem_Weight                  0.0\nItem_Fat_Content             0.0\nItem_Visibility              0.0\nItem_Type                    0.0\nItem_MRP                     0.0\nOutlet_Identifier            0.0\nOutlet_Establishment_Year    0.0\nOutlet_Size                  0.0\nOutlet_Location_Type         0.0\nOutlet_Type                  0.0\nItem_Outlet_Sales            0.0\ndtype: float64\n['Item_Weight', 'Item_MRP', 'Outlet_Establishment_Year']\n</code></pre>\n<h2 id=\"代码相关\">代码相关</h2>\n<h3 id=\"存储-读取模型\">存储-读取模型</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.linear_model <span class=\"keyword\">as</span> lm  <span class=\"comment\"># 线性模型</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> sklearn.metrics <span class=\"keyword\">as</span> sm  <span class=\"comment\"># 模型性能评价模块</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> mp</span><br><span class=\"line\"><span class=\"keyword\">import</span> pickle</span><br><span class=\"line\"></span><br><span class=\"line\">x = np.array([[<span class=\"number\">0.5</span>], [<span class=\"number\">0.6</span>], [<span class=\"number\">0.8</span>], [<span class=\"number\">1.1</span>], [<span class=\"number\">1.4</span>]])  <span class=\"comment\"># 输入集</span></span><br><span class=\"line\">y = np.array([<span class=\"number\">5.0</span>, <span class=\"number\">5.5</span>, <span class=\"number\">6.0</span>, <span class=\"number\">6.8</span>, <span class=\"number\">7.0</span>])  <span class=\"comment\"># 输出集</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 创建线性回归器</span></span><br><span class=\"line\">model = lm.LinearRegression()</span><br><span class=\"line\"><span class=\"comment\"># 用已知输入、输出数据集训练回归器</span></span><br><span class=\"line\">model.fit(x, y)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;训练完成.&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 保存训练后的模型</span></span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;linear_model.pkl&#x27;</span>, <span class=\"string\">&#x27;wb&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    pickle.dump(model, f)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;保存模型完成.&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">######################### 加载模型 #########################</span></span><br><span class=\"line\"><span class=\"comment\"># 上面通过训练数据x,y 训练好了 x -&gt; y 的线性回归模型</span></span><br><span class=\"line\"><span class=\"comment\"># 下面加载模型, 再给出测试数据 x, 查看模型预测结果直线与原始数据 (x,y) 的拟合度</span></span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&#x27;linear_model.pkl&#x27;</span>, <span class=\"string\">&#x27;rb&#x27;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    model = pickle.load(f)</span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;加载模型完成.&quot;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 根据加载的模型预测输出</span></span><br><span class=\"line\">pred_y = model.predict(x)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 可视化回归曲线</span></span><br><span class=\"line\">mp.figure(<span class=\"string\">&#x27;Linear Regression&#x27;</span>, facecolor=<span class=\"string\">&#x27;lightgray&#x27;</span>)</span><br><span class=\"line\">mp.title(<span class=\"string\">&#x27;Linear Regression&#x27;</span>, fontsize=<span class=\"number\">20</span>)</span><br><span class=\"line\">mp.xlabel(<span class=\"string\">&#x27;x&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.ylabel(<span class=\"string\">&#x27;y&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">mp.tick_params(labelsize=<span class=\"number\">10</span>)</span><br><span class=\"line\">mp.grid(linestyle=<span class=\"string\">&#x27;:&#x27;</span>)</span><br><span class=\"line\">mp.scatter(x, y, c=<span class=\"string\">&#x27;blue&#x27;</span>, alpha=<span class=\"number\">0.8</span>, s=<span class=\"number\">60</span>, label=<span class=\"string\">&#x27;Sample Points&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.plot(x, pred_y, c=<span class=\"string\">&#x27;orangered&#x27;</span>, label=<span class=\"string\">&#x27;Regression&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">mp.legend()</span><br><span class=\"line\">mp.show()</span><br></pre></td></tr></table></figure>\n<pre><code>训练完成.\n保存模型完成.\n加载模型完成.\n</code></pre>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_66_1.png\" alt=\"png\"></p>\n<h3 id=\"Web-app\">Web-app</h3>\n<h4 id=\"一\">一</h4>\n<p>train 一个逻辑回归模型并用 pickle 打包</p>\n<p>然后load</p>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.preprocessing <span class=\"keyword\">import</span> LabelEncoder</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score, classification_report</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.linear_model <span class=\"keyword\">import</span> LogisticRegression</span><br><span class=\"line\"><span class=\"keyword\">import</span> pickle</span><br><span class=\"line\"></span><br><span class=\"line\">ufos = pd.read_csv(<span class=\"string\">&#x27;./_data_set/web-app/1/ufos.csv&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># ufos.head()</span></span><br><span class=\"line\"></span><br><span class=\"line\">ufos = pd.DataFrame(&#123;</span><br><span class=\"line\">    <span class=\"string\">&#x27;Seconds&#x27;</span>: ufos[<span class=\"string\">&#x27;duration (seconds)&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Country&#x27;</span>: ufos[<span class=\"string\">&#x27;country&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Latitude&#x27;</span>: ufos[<span class=\"string\">&#x27;latitude&#x27;</span>],</span><br><span class=\"line\">    <span class=\"string\">&#x27;Longitude&#x27;</span>: ufos[<span class=\"string\">&#x27;longitude&#x27;</span>]</span><br><span class=\"line\">&#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">ufos.Country.unique()</span><br><span class=\"line\"></span><br><span class=\"line\">ufos.dropna(inplace=<span class=\"literal\">True</span>)</span><br><span class=\"line\">ufos = ufos[(ufos[<span class=\"string\">&#x27;Seconds&#x27;</span>] &gt;= <span class=\"number\">1</span>) &amp; (ufos[<span class=\"string\">&#x27;Seconds&#x27;</span>] &lt;= <span class=\"number\">60</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ufos.info()</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># [&#x27;us&#x27;, nan, &#x27;gb&#x27;, &#x27;ca&#x27;, &#x27;au&#x27;, &#x27;de&#x27;] -&gt; 0-5</span></span><br><span class=\"line\">ufos[<span class=\"string\">&#x27;Country&#x27;</span>] = LabelEncoder().fit_transform(ufos[<span class=\"string\">&#x27;Country&#x27;</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">ufos.head()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ======================== 准备完成 ==============================</span></span><br><span class=\"line\"></span><br><span class=\"line\">x = ufos[[<span class=\"string\">&#x27;Seconds&#x27;</span>, <span class=\"string\">&#x27;Latitude&#x27;</span>, <span class=\"string\">&#x27;Longitude&#x27;</span>]]</span><br><span class=\"line\">y = ufos[<span class=\"string\">&#x27;Country&#x27;</span>]</span><br><span class=\"line\"><span class=\"comment\"># [&#x27;Seconds&#x27;, &#x27;Latitude&#x27;, &#x27;Longitude&#x27;]  ==&gt;  &#x27;Country&#x27;</span></span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(x,</span><br><span class=\"line\">                                                    y,</span><br><span class=\"line\">                                                    test_size=<span class=\"number\">0.2</span>,</span><br><span class=\"line\">                                                    random_state=<span class=\"number\">0</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># default max_iter=100 会超限</span></span><br><span class=\"line\">model = LogisticRegression(max_iter=<span class=\"number\">1000</span>).fit(X_train, y_train)</span><br><span class=\"line\">y_pred = model.predict(X_test)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(classification_report(y_test, y_pred))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Predicted labels: &#x27;</span>, y_pred)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&#x27;Accuracy: &#x27;</span>, accuracy_score(y_test, y_pred))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># ======================== 打包 model ==============================</span></span><br><span class=\"line\"></span><br><span class=\"line\">model_name = <span class=\"string\">&#x27;./_data_set/web-app/1/ufo-model.pkl&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">pickle.dump(model, <span class=\"built_in\">open</span>(model_name, <span class=\"string\">&#x27;wb&#x27;</span>))</span><br></pre></td></tr></table></figure>\n<pre><code>              precision    recall  f1-score   support\n\n           0       1.00      1.00      1.00        41\n           1       0.85      0.47      0.60       250\n           2       1.00      1.00      1.00         8\n           3       1.00      1.00      1.00       131\n           4       0.97      1.00      0.98      4743\n\n    accuracy                           0.97      5173\n   macro avg       0.96      0.89      0.92      5173\nweighted avg       0.97      0.97      0.97      5173\n\nPredicted labels:  [4 4 4 ... 3 4 4]\nAccuracy:  0.9702300405953992\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\">model_load = pickle.load(<span class=\"built_in\">open</span>(model_name, <span class=\"string\">&#x27;rb&#x27;</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(model_load.predict([[<span class=\"number\">50</span>, <span class=\"number\">44</span>, -<span class=\"number\">12</span>]]))</span><br></pre></td></tr></table></figure>\n<pre><code>[3]\n\n\nD:\\Scoop\\apps\\anaconda3\\current\\lib\\site-packages\\sklearn\\base.py:450: UserWarning: X does not have valid feature names, but LogisticRegression was fitted with feature names\n  warnings.warn(\n</code></pre>\n<h4 id=\"二\">二</h4>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> pandas <span class=\"keyword\">as</span> pd</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> train_test_split</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.svm <span class=\"keyword\">import</span> SVC</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.model_selection <span class=\"keyword\">import</span> cross_val_score</span><br><span class=\"line\"><span class=\"keyword\">from</span> sklearn.metrics <span class=\"keyword\">import</span> accuracy_score, precision_score, confusion_matrix, classification_report</span><br><span class=\"line\"></span><br><span class=\"line\">data = pd.read_csv(<span class=\"string\">&#x27;./_data_set/cuisines_classification/cleaned_cuisines.csv&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 删除前两列无用的列</span></span><br><span class=\"line\">X = data.iloc[:, <span class=\"number\">2</span>:]</span><br><span class=\"line\">y = data[[<span class=\"string\">&#x27;cuisine&#x27;</span>]]</span><br><span class=\"line\"></span><br><span class=\"line\">X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=<span class=\"number\">0.3</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">model = SVC(kernel=<span class=\"string\">&#x27;linear&#x27;</span>, C=<span class=\"number\">10</span>, probability=<span class=\"literal\">True</span>, random_state=<span class=\"number\">0</span>)</span><br><span class=\"line\"><span class=\"comment\"># model.fit(X_train, np.revel(y_train))</span></span><br><span class=\"line\">model.fit(X_train, y_train.values.ravel())</span><br><span class=\"line\">y_pred = model.predict(X_test)</span><br><span class=\"line\"><span class=\"built_in\">print</span>(classification_report(y_test, y_pred))</span><br></pre></td></tr></table></figure>\n<pre><code>              precision    recall  f1-score   support\n\n     chinese       0.73      0.68      0.70       242\n      indian       0.89      0.88      0.88       246\n    japanese       0.80      0.79      0.79       262\n      korean       0.82      0.75      0.78       229\n        thai       0.75      0.88      0.81       220\n\n    accuracy                           0.79      1199\n   macro avg       0.79      0.80      0.79      1199\nweighted avg       0.80      0.79      0.79      1199\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> skl2onnx <span class=\"keyword\">import</span> convert_sklearn</span><br><span class=\"line\"><span class=\"keyword\">from</span> skl2onnx.common.data_types <span class=\"keyword\">import</span> FloatTensorType</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 张量为 380</span></span><br><span class=\"line\">initial_type = [(<span class=\"string\">&#x27;float_input&#x27;</span>, FloatTensorType([<span class=\"literal\">None</span>, <span class=\"number\">380</span>]))]</span><br><span class=\"line\">options = &#123;<span class=\"built_in\">id</span>(model): &#123;<span class=\"string\">&#x27;nocl&#x27;</span>: <span class=\"literal\">True</span>, <span class=\"string\">&#x27;zipmap&#x27;</span>: <span class=\"literal\">False</span>&#125;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">onx = convert_sklearn(model, initial_types=initial_type, options=options)</span><br><span class=\"line\"><span class=\"keyword\">with</span> <span class=\"built_in\">open</span>(<span class=\"string\">&quot;./_data_set/web-app/2/model.onnx&quot;</span>, <span class=\"string\">&quot;wb&quot;</span>) <span class=\"keyword\">as</span> f:</span><br><span class=\"line\">    f.write(onx.SerializeToString())</span><br></pre></td></tr></table></figure>\n<h2 id=\"信息论\">信息论</h2>\n<h3 id=\"两点分布信息熵\">两点分布信息熵</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 因为 ln0 无定义, 用此值模拟趋近 0</span></span><br><span class=\"line\">eps = <span class=\"number\">1e-5</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># probability</span></span><br><span class=\"line\">p = np.linspace(eps, <span class=\"number\">1</span> - eps, <span class=\"number\">100</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Information entropy</span></span><br><span class=\"line\">h = -(<span class=\"number\">1</span> - p) * np.log2(<span class=\"number\">1</span> - p) - p * np.log2(p)</span><br><span class=\"line\"></span><br><span class=\"line\">plt.plot(p, h, label=<span class=\"string\">&#x27;Information entropy&#x27;</span>, color=<span class=\"string\">&#x27;red&#x27;</span>, lw=<span class=\"number\">3</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;Probability&#x27;</span>, fontsize=<span class=\"number\">16</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;Entropy&#x27;</span>, fontsize=<span class=\"number\">16</span>)</span><br><span class=\"line\">plt.legend(loc=<span class=\"string\">&#x27;best&#x27;</span>, fontsize=<span class=\"number\">16</span>)</span><br><span class=\"line\">plt.grid(<span class=\"literal\">True</span>)</span><br><span class=\"line\">plt.show()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 结果中信息熵的峰值取决于 log 底数, e为底时峰值为0.7左右, 2为底峰值为1</span></span><br></pre></td></tr></table></figure>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_74_0.png\" alt=\"png\"></p>\n<h3 id=\"基尼系数与-ln\">基尼系数与-ln</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\">eps = <span class=\"number\">1e-4</span></span><br><span class=\"line\">p = np.linspace(eps, <span class=\"number\">1</span> - eps, <span class=\"number\">100</span>)</span><br><span class=\"line\">h = -(<span class=\"number\">1</span> - p) * np.log2(<span class=\"number\">1</span> - p) - p * np.log2(p)</span><br><span class=\"line\">gini = <span class=\"number\">2</span> * (<span class=\"number\">1</span> - p) * p</span><br><span class=\"line\"></span><br><span class=\"line\">plt.plot(p, gini, <span class=\"string\">&#x27;r-&#x27;</span>, lw=<span class=\"number\">3</span>)</span><br><span class=\"line\">plt.plot(p, h / <span class=\"number\">2</span>, <span class=\"string\">&#x27;g-&#x27;</span>, lw=<span class=\"number\">3</span>)</span><br><span class=\"line\">plt.title(<span class=\"string\">&#x27;Gini(p) / Ln(p)&#x27;</span>, fontsize=<span class=\"number\">16</span>)</span><br><span class=\"line\">plt.xlabel(<span class=\"string\">&#x27;p&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">plt.ylabel(<span class=\"string\">&#x27;H&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">plt.legend([<span class=\"string\">&#x27;Gini&#x27;</span>, <span class=\"string\">&#x27;Ln&#x27;</span>], loc=<span class=\"string\">&#x27;best&#x27;</span>, fontsize=<span class=\"number\">14</span>)</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"ML_files/ML_76_0.png\" alt=\"png\"></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://discover304.top/\">https://discover304.top/</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://www.bilibili.com/video/BV16L411w7oQ?p=6\">【上海交大】【腾讯】强强联合 机器学习+深度学习</a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://www.analyticsvidhya.com/blog/2018/08/dimensionality-reduction-techniques-python/\">The Ultimate Guide to 12 Dimensionality Reduction Techniques (with Python codes)</a></p>\n<p><a name='cite_note-4' href='#cite_ref-4'>[4]</a>: <a href=\"https://github.com/microsoft/ML-For-Beginners\">https://github.com/microsoft/ML-For-Beginners</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "人工智能",
                "信息论",
                "python",
                "机器学习"
            ]
        },
        {
            "id": "https://blog.weidows.tech/post/lang/python/AI/AI/",
            "url": "https://blog.weidows.tech/post/lang/python/AI/AI/",
            "title": "🐊All-about-AI",
            "date_published": "2022-03-18T16:13:49.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2023-04-20 18:30:24\n * @FilePath: \\Blog-private\\source\\_posts\\python\\AI\\AI.md\n * @Description:\n * @!: *********************************************************************\n-->\n<ul>\n<li>\n<details>\n  <summary> 文章封面图 (恐怖慎看) </summary>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RaxZ0b.png\" alt=\"RaxZ0b.png\"></p>\n<hr>\n</details>\n</li>\n</ul>\n<p>此篇为本博客中 AI 领域的根, 也可以当做目录 (因为篇幅太长,就给分开了)</p>\n<blockquote>\n<p>文中大量使用 LaTeX 公式, 如何写的可以看 <a href=\"../../../../experience/LaTeX\">🍹LaTeX~环形使者(?)</a> <br>\n强推大佬朋友的文章: <a href=\"https://discover304.top/2021/12/21/2021q4/123-ai-question-collection/\">【人工智能】面试问题整理</a></p>\n</blockquote>\n<ul>\n<li>\n<p>嗟叹</p>\n<p>炼丹界门派好多啊, 一派一传承</p>\n<p>师出少林, 修行武当, 行至小河, 探头一照</p>\n<p>欸, 爷竟是峨眉的 🐵</p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"体系概览\">体系概览</h2>\n<ul>\n<li>\n<p>人工智能是什么? <sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup><sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup></p>\n<blockquote>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVidNr.png\" alt=\"\"><br>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/RCPHaM.png\" alt=\"\"></p>\n</blockquote>\n</li>\n</ul>\n<p>下面包含细分文章的索引 (可点击跳转)</p>\n<blockquote class=\"pullquote mindmap mindmap-lg\"><ul>\n<li>AI\n<ul>\n<li>研究领域\n<ul>\n<li><a href=\"../ML\">机器学习</a>\n<ul>\n<li><a href=\"../DL\">深度学习</a></li>\n</ul>\n</li>\n<li>CV 计算机视觉\n<ul>\n<li>图像识别</li>\n<li>机器视觉</li>\n</ul>\n</li>\n<li>语音信息处理\n<ul>\n<li>文本-&gt;语音</li>\n<li>语音-&gt;文本</li>\n</ul>\n</li>\n<li>自然语言处理 NLP\n<ul>\n<li>文本生成</li>\n<li>文本分类</li>\n<li>翻译</li>\n<li>…</li>\n</ul>\n</li>\n<li>ROS 机器人系统</li>\n<li>专家系统</li>\n</ul>\n</li>\n<li>框架和库\n<ul>\n<li>Tenserflow</li>\n<li>Pytorch</li>\n<li>sklearn</li>\n<li>飞桨</li>\n<li>…</li>\n</ul>\n</li>\n<li>表示学习\n<ul>\n<li>表示\n<ul>\n<li>为了提高机器学习系统的准确率,就需要将输入信息转换为有效的特征</li>\n</ul>\n</li>\n<li>数据表示是机器学习的核心问题</li>\n<li>底层特征与高层语义之间存在语义鸿沟,如何在鸿沟上搭桥是表示学习的关键</li>\n<li>表示方法\n<ul>\n<li>局部表示/离散表示/符号表示\n<ul>\n<li>如: 红 绿 蓝</li>\n</ul>\n</li>\n<li>分布式表示\n<ul>\n<li>优点\n<ul>\n<li>表示能力强</li>\n<li>向量维度低</li>\n<li>相似度容易计算</li>\n</ul>\n</li>\n<li>例如: (255,0,0), (0,255,0)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>嵌入\n<ul>\n<li>将一个度量空间中的一些对象映射到另一个低维的度量空间中</li>\n<li>并尽可能保持不同对象之间的拓扑关系,比如自然语言中词的分布式表示</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"数据分析\">数据分析</h2>\n<blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li>数据分析\n<ul>\n<li>数据类型\n<ul>\n<li>数值 Numerical\n<ul>\n<li>离散 discrete</li>\n<li>连续 continuous</li>\n</ul>\n</li>\n<li>分类 Categorical\n<ul>\n<li>无法相互度量的数据,例如颜色</li>\n</ul>\n</li>\n<li>序数 Ordinal\n<ul>\n<li>类似分类数据,但可以相互度量</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>常用特殊值\n<ul>\n<li>均值 mean</li>\n<li>中值 median</li>\n<li>众数 mode</li>\n<li>标准差 std</li>\n<li>方差 var = std * std</li>\n<li>百分位数 percentile\n<ul>\n<li>返回一个数 x, 这个 x &gt;= 数组中百分之 percentile 的数</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"待办\">待办</h2>\n<h3 id=\"GAN\">GAN</h3>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Rsmdm0.png\" alt=\"\"></p>\n<p>搜集大量 x 与 y 类型数据, GAN 模型可以自动学习 x 与 y 之间的关系</p>\n<h3 id=\"异常检测-anomaly-detection\">异常检测-anomaly-detection</h3>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/Rsmvdm.png\" alt=\"\"></p>\n<h3 id=\"Glow\">Glow</h3>\n<p>Glow -&gt; Flow-based generative model</p>\n<p>生成网络属于 DNN,是一种常用的<a href=\"#%E5%8C%BA%E5%88%86%E6%9C%89-%E6%97%A0%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0\">无监督学习模型</a></p>\n<blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li>深度神经网络 DNN -&gt; 生成网络\n<ul>\n<li>生成对抗网络 GANs (Generative Adversarial Networks)</li>\n<li>变分自编码器 VAE (Variational Auto-Encoder)</li>\n<li>Pixel RNN/CNN</li>\n<li>流模型 Glow (Generative Flow)</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表\">借物表</h2>\n<style>.bbplayer{width: 100%; max-width: 850px; margin: auto}</style><div class=\"bbplayer\"><iframe class=\"bbplayer\" id=\"mmedia-JmakmvPTmrGonFnT\" src=\"https://player.bilibili.com/player.html?bvid=BV1J94y1f7u5&page=1&high_quality=1&danmaku=true&autoplay=0\" allowfullscreen=\"allowfullscreen\" scrolling=\"no\" border=\"0\" frameborder=\"0\" framespacing=\"0\" sandbox=\"allow-top-navigation allow-same-origin allow-forms allow-scripts allow-popups\"></iframe></div><script> document.getElementById(\"mmedia-JmakmvPTmrGonFnT\").style.height=document.getElementById(\"mmedia-JmakmvPTmrGonFnT\").scrollWidth*0.76+\"px\";\n    window.onresize = function(){\n      document.getElementById(\"mmedia-JmakmvPTmrGonFnT\").style.height=document.getElementById(\"mmedia-JmakmvPTmrGonFnT\").scrollWidth*0.76+\"px\";\n    }; </script>\n<style>.bbplayer{width: 100%; max-width: 850px; margin: auto}</style><div class=\"bbplayer\"><iframe class=\"bbplayer\" id=\"mmedia-LLKQaBsTCDJdFGys\" src=\"https://player.bilibili.com/player.html?bvid=BV16L411w7oQ&page=1&high_quality=1&danmaku=true&autoplay=0\" allowfullscreen=\"allowfullscreen\" scrolling=\"no\" border=\"0\" frameborder=\"0\" framespacing=\"0\" sandbox=\"allow-top-navigation allow-same-origin allow-forms allow-scripts allow-popups\"></iframe></div><script> document.getElementById(\"mmedia-LLKQaBsTCDJdFGys\").style.height=document.getElementById(\"mmedia-LLKQaBsTCDJdFGys\").scrollWidth*0.76+\"px\";\n    window.onresize = function(){\n      document.getElementById(\"mmedia-LLKQaBsTCDJdFGys\").style.height=document.getElementById(\"mmedia-LLKQaBsTCDJdFGys\").scrollWidth*0.76+\"px\";\n    }; </script>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://zhuanlan.zhihu.com/p/86794447\">一文看懂人工智能、机器学习、深度学习与神经网络之间的区别与关系</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://nndl.github.io/\">神经网络与深度学习</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "doing",
                "人工智能",
                "深度学习",
                "机器学习"
            ]
        },
        {
            "id": "https://blog.weidows.tech/post/experience/basic/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/",
            "url": "https://blog.weidows.tech/post/experience/basic/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/",
            "title": "🌈基础知识",
            "date_published": "2021-03-25T03:32:45.000Z",
            "content_html": "<h1>基础知识</h1>\n<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2022-09-15 22:48:51\n * @FilePath: \\Blog-private\\source\\_posts\\experience\\basic\\基础知识.md\n * @Description:\n * @!: *********************************************************************\n-->\n<blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li><a href=\"#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86\">基础知识</a>\n<ul>\n<li><a href=\"#%E6%80%9D%E7%BB%B4%E5%AF%BC%E5%9B%BE\">思维导图</a></li>\n<li><a href=\"#%E7%A1%AC%E4%BB%B6\">硬件</a>\n<ul>\n<li><a href=\"#%E5%8E%9F%E5%8F%8D%E8%A1%A5%E7%A0%81\">原反补码</a></li>\n<li><a href=\"#%E5%8D%95%E7%89%87%E6%9C%BA\">单片机</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%A4%8D%E5%8F%98%E5%87%BD%E6%95%B0\">复变函数</a>\n<ul>\n<li><a href=\"#%E5%A4%8D%E6%95%B0\">复数</a></li>\n</ul>\n</li>\n<li><a href=\"#%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C\">计算机网络</a>\n<ul>\n<li><a href=\"#%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82\">数据链路层</a>\n<ul>\n<li><a href=\"#%E5%AA%92%E4%BD%93%E6%8E%A5%E5%85%A5%E6%8E%A7%E5%88%B6%E5%88%86%E7%B1%BB\">媒体接入控制分类</a></li>\n<li><a href=\"#csmacd\">CSMA/CD</a></li>\n<li><a href=\"#mac-%E5%B1%82%E5%8D%8F%E8%AE%AE\">MAC 层协议</a></li>\n</ul>\n</li>\n<li><a href=\"#%E7%BD%91%E7%BB%9C%E5%B1%82\">网络层</a>\n<ul>\n<li><a href=\"#%E8%B7%AF%E7%94%B1%E9%80%89%E6%8B%A9%E5%8D%8F%E8%AE%AE\">路由选择协议</a></li>\n<li><a href=\"#%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF%E5%8D%8F%E8%AE%AE-rip-%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86\">路由信息协议 RIP 的基本工作原理</a></li>\n<li><a href=\"#%E5%BC%80%E6%94%BE%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E4%BC%98%E5%85%88-ospf-%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86\">开放最短路径优先 OSPF 的基本工作原理</a></li>\n<li><a href=\"#%E8%BE%B9%E7%95%8C%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AE-bgp\">边界网关协议 BGP</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E7%A6%BB%E6%95%A3\">离散</a>\n<ul>\n<li><a href=\"#%E5%9B%BE\">图</a></li>\n</ul>\n</li>\n<li><a href=\"#%E7%AE%97%E6%B3%95%E5%88%86%E6%9E%90%E4%B8%8E%E8%AE%BE%E8%AE%A1\">算法分析与设计</a>\n<ul>\n<li><a href=\"#%E9%A2%98%E7%9B%AE\">题目</a>\n<ul>\n<li><a href=\"#%E6%9C%80%E5%A4%A7%E5%9B%A2-%E6%9C%80%E5%A4%A7%E7%8B%AC%E7%AB%8B%E9%9B%86\">最大团-最大独立集</a></li>\n<li><a href=\"#01-%E8%83%8C%E5%8C%85\">01-背包</a></li>\n<li><a href=\"#%E7%9F%A9%E9%98%B5%E8%BF%9E%E4%B9%98\">矩阵连乘</a></li>\n<li><a href=\"#%E5%85%AB%E7%9A%87%E5%90%8E%E8%A7%A3%E6%B3%95%E9%80%9F%E8%AE%B0\">八皇后解法速记</a></li>\n<li><a href=\"#%E9%9A%8F%E6%9C%BA%E5%8C%96%E7%AE%97%E6%B3%95\">随机化算法</a></li>\n<li><a href=\"#%E6%B8%90%E8%BF%91%E9%98%B6%E9%AB%98%E4%BD%8E\">渐近阶高低</a></li>\n<li><a href=\"#%E6%95%B0%E8%AE%BA%E5%9B%9B%E5%A4%A7%E5%AE%9A%E7%90%86\">数论四大定理</a></li>\n<li><a href=\"#%E6%A3%8B%E7%9B%98%E8%A6%86%E7%9B%96%E9%97%AE%E9%A2%98\">棋盘覆盖问题</a></li>\n<li><a href=\"#%E4%BA%8C%E5%88%86%E6%90%9C%E7%B4%A2\">二分搜索</a></li>\n<li><a href=\"#%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91\">斐波那契</a></li>\n<li><a href=\"#%E6%9C%80%E9%95%BF%E5%85%AC%E5%85%B1%E5%AD%90%E5%BA%8F%E5%88%97\">最长公共子序列</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD\">人工智能</a></li>\n<li><a href=\"#%E9%9B%B6%E6%95%A3%E7%9A%84\">零散的</a>\n<ul>\n<li><a href=\"#%E6%B2%B3%E5%B7%A5%E5%A4%A7-uml\">河工大-UML</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%80%9F%E7%89%A9%E8%A1%A8\">借物表</a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<blockquote>\n<p>已录入 <a href=\"../../../others/LearnWay#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86\">😍Weidows-の成长路线#基础知识</a></p>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"思维导图\">思维导图</h2>\n<p>一些零散的不足以道,做成导图了</p>\n<blockquote class=\"pullquote mindmap mindmap-lg\"><ul>\n<li>基础知识\n<ul>\n<li>数据结构\n<ul>\n<li><a href=\"https://www.cnblogs.com/zmc940317/articles/10925497.html\">二叉树的前,中,后序遍历详解</a></li>\n</ul>\n</li>\n<li>操作系统\n<ul>\n<li><a href=\"../../../system/process-thread\">我给总结了一下: 🤷‍♂️ 进程,线程,CPU 核心,并行,并发大杂碎!</a></li>\n<li><a href=\"https://blog.csdn.net/qq_33414271/article/details/80245715\">一句话+一张图说清楚——银行家算法</a></li>\n<li><a href=\"https://blog.csdn.net/a745233700/article/details/86011504\">操作系统：经典进程同步问题 之 生产者-消费者问题、读者-写者问题、哲学家进餐问题</a></li>\n<li><a href=\"https://blog.csdn.net/lala_wang/article/details/81116781?utm_medium=distribute.pc_relevant.none-task-blog-baidujs_title-0&amp;spm=1001.2101.3001.4242\">调度算法的介绍及优缺点</a></li>\n</ul>\n</li>\n<li>编译原理\n<ul>\n<li><a href=\"https://blog.csdn.net/qq_39384184/article/details/86037568\">编译原理：总结</a></li>\n</ul>\n</li>\n<li>硬件\n<ul>\n<li><a href=\"https://www.bilibili.com/video/BV1sE411L7j5\">【一天掌握 51 单片机基础】<em>单片机原理及应用</em>东北大学（高宏亮 主讲）</a></li>\n</ul>\n</li>\n<li>数据库\n<ul>\n<li>MySQL\n<ul>\n<li><a href=\"https://www.bilibili.com/video/BV1NJ411J79W\">【狂神说 Java】MySQL 最新教程通俗易懂</a></li>\n<li><a href=\"https://blog.csdn.net/weixin_45483328/article/details/113759286?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.control&amp;dist_request_id=&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.control\">狂神说数据库笔记</a></li>\n</ul>\n</li>\n<li>MongoDB\n<ul>\n<li>有 MySQL 基础能很快上手</li>\n<li><a href=\"https://github.com/krislinzhao/StudyNotes/tree/master/MongoDB\">krislinzhao/StudyNotes</a></li>\n</ul>\n</li>\n<li>通用\n<ul>\n<li><a href=\"https://blog.csdn.net/wxwzy738/article/details/17590305\">MySQL 单列索引和组合索引的区别介绍</a>\n<ul>\n<li>质量相当高的文章</li>\n</ul>\n</li>\n<li><a href=\"https://mp.weixin.qq.com/s/3ZdACGiA0SutmbDxMeF-UA\">我们为什么要分库分表？</a>\n<ul>\n<li>这篇封神了,把我最近在数据库业务设计方面的疑问解决了.</li>\n</ul>\n</li>\n<li><a href=\"https://www.52pojie.cn/thread-1569242-1-1.html\">读写分离</a></li>\n</ul>\n</li>\n<li>课程\n<ul>\n<li><a href=\"https://www.docin.com/p-1564094016.html\">数据库考试试题及答案</a></li>\n<li><a href=\"https://www.cnblogs.com/Soprano/p/10659101.html\">子查询</a></li>\n</ul>\n</li>\n<li>Neo4j\n<ul>\n<li><a href=\"https://www.bilibili.com/video/BV1EB4y1a7Sf?p=15\">让所有程序员都能学懂的 Neo4j 数据库教程，B 站史上最实用的 Neo4j 数据库入门到实战学习教程</a></li>\n<li><a href=\"https://www.zmonster.me/2019/04/30/neo4j-introduction.html#org02654fb\">图数据库 Neo4j 的部署、数据导入和简单使用</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>算法-数学\n<ul>\n<li>傅里叶变换\n<ul>\n<li><a href=\"../%E9%80%9A%E4%BF%A1%E6%8A%80%E6%9C%AF#%E5%82%85%E9%87%8C%E5%8F%B6%E5%8F%98%E6%8D%A2\">👽 通信技术-开坑自埋</a></li>\n</ul>\n</li>\n<li>P/NP 问题\n<ul>\n<li><a href=\"https://baike.baidu.com/item/P%E5%AF%B9NP%E9%97%AE%E9%A2%98\">P 对 NP 问题</a></li>\n<li><a href=\"https://www.omegaxyz.com/2019/04/22/np/?hilite=%27filled%27,%27o.e.m%27\">算法复杂度与 NP 问题</a></li>\n<li><a href=\"http://www.cainiaoxueyuan.com/suanfa/4517.html\">贪婪算法案例、np 完全问题及 java 代码实现</a>\n<ul>\n<li>非常经典和值得探索的问题 (经验接收自@河北工业大学)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Hash-算法\n<ul>\n<li>用来校验文本/文件,主流有三类,不同算法产生的 hash code 不同\n<ul>\n<li>MD5</li>\n<li>CRC-32, CRC-64</li>\n<li>SHA-1, SHA-256, SHA-384, SHA-512</li>\n</ul>\n</li>\n<li>校验方法\n<ul>\n<li><a href=\"https://blog.csdn.net/weixin_30799995/article/details/94896898\">文件完整性校验</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>排序算法\n<ul>\n<li><a href=\"https://www.cnblogs.com/chengxiao/p/6194356.html\">图解排序算法(四)之归并排序</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>论文\n<ul>\n<li><a href=\"https://cloud.tencent.com/developer/news/231960\">如何将 CNKI 论文信息转换成你想要的参考文献格式</a>\n<ul>\n<li>关键时候挺好用的功能</li>\n</ul>\n</li>\n<li><a href=\"https://zhuanlan.zhihu.com/p/54344547\">word 操作技巧：有关脚注和尾注的使用方法</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"硬件\">硬件</h2>\n<h3 id=\"原反补码\">原反补码</h3>\n<ul>\n<li>\n<p>开局三张图,故事全靠编 🤣</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVtBQE.png\" alt=\"20210325114342\" />\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVtZcX.png\" alt=\"20210325114403\" />\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVtRJ9.png\" alt=\"20210325114419\" />\n</li>\n<li>\n<p>因为带有符号位的二进制数在计算机内计算时,原码和反码的运算结果都不是 100%正确,而且会有<code>+0</code>和<code>-0</code>两个零</p>\n</li>\n<li>\n<p>补码 100%正确,于是我们采用补码,而且补码只有一个零</p>\n<ul>\n<li>补码就是为了解决这两个问题的,没了.</li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3 id=\"单片机\">单片机</h3>\n<ul>\n<li>\n<p>标志寄存器内部的八位是分开使用的,作用不同,但功能都是作为标志位</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVtJm5.png\" alt=\"20210331121042\" />\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVtxyA.png\" alt=\"20210331122847\" />\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVtsVm.png\" alt=\"20210331122957\" />\n</li>\n</ul>\n<p><a href=\"https://www.jdzj.com/diangong/article/2018-2-3/95275-1.htm\">单片机时钟周期、机器周期、指令周期与总线周期</a></p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"复变函数\">复变函数</h2>\n<h3 id=\"复数\">复数</h3>\n<ul>\n<li>\n<p>运算<br>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVtqQz.png\" alt=\"20210402161142\" /></p>\n</li>\n<li>\n<p>一般表示<br>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVtorg.png\" alt=\"20210325170144\" /></p>\n</li>\n<li>\n<p>几何表示<br>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVtP3M.png\" alt=\"20210325170538\" /></p>\n</li>\n<li>\n<p>幂与根<br>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVtXZn.png\" alt=\"20210325181554\" /></p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"计算机网络\">计算机网络</h2>\n<blockquote>\n<p>摘自 <a href=\"https://space.bilibili.com/360996402/\">湖科大教书匠-计算机网络</a></p>\n</blockquote>\n<h3 id=\"数据链路层\">数据链路层</h3>\n<h4 id=\"媒体接入控制分类\">媒体接入控制分类</h4>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVSwgX.png\" alt=\"20210930170530\" />\n<h4 id=\"CSMA-CD\">CSMA/CD</h4>\n<blockquote>\n<p><a href=\"https://www.136.la/tech/show-132262.html\">2016.6.20 计算机网络复习要点第三章之 CSMA/CD 协议(示例代码)</a></p>\n</blockquote>\n<p>采用随机接入,当多个主机同时发送帧时会<code>发生碰撞/冲突</code>.无连接不可靠,尽力交付的服务.</p>\n<ul>\n<li>\n<p>CSMA/CD (载波监听多点接入/碰撞检测) 是以太网采用的<code>解决冲突</code>的方法</p>\n<ul>\n<li>多路接入 MA: 多个站点接入同一条总线上,竞争使用总线</li>\n<li>载波监听 CS: 站点发送数据前，先检查总线上是不是已经有数据在传输，如果有就暂缓发送，避免冲突。</li>\n<li>冲突检测: 边发送边对介质上电压信号进行检测，当电压摆动值超过一定门限时就认为发生了冲突。一旦发生冲突就停止发送数据，然后根据协议进行重传。</li>\n</ul>\n<hr>\n</li>\n<li>\n<p>在使用 CSMA/CD 协议时，一个站不可能同时进行发送和接收（但必须边发送边监听）。因此，使用 CSMA/CD 协议的以太网不可能进行全双工通信而只能进行半双工通信（双向交替通信）；</p>\n<ul>\n<li>\n<p>每一个站在自己发送数据之后的一小段时间内，存在着遭遇碰撞的可能性，这一小段时间是不确定的，它取决于另一个发送数据的站到本站的距离；</p>\n</li>\n<li>\n<p>最先发送数据帧的 A 站，在发送数据帧后至多经过时间 2r 就可知道所发送的数据帧是否遭受到碰撞；因此，以太网端到端往返时间 2r 称为争用期（碰撞窗口）；</p>\n</li>\n<li>\n<p>经过争用期还没有检测到碰撞，才能肯定后续发送的数据一定不会发送碰撞；</p>\n</li>\n<li>\n<p>凡是长度小于 64 字节的帧都是由于冲突而异常中止的无效帧，只要收到了这种无效帧，就应当立即将其丢弃；</p>\n</li>\n</ul>\n<hr>\n</li>\n<li>\n<p>采用截断二进制指数退避算法来确定碰撞后重传的时机</p>\n<ul>\n<li>\n<p>让发生碰撞的站停止发送数据后，不是等待信道变为空闲后就立即发送数据，而是推迟（退避）一个随机的时间</p>\n</li>\n<li>\n<p>单位回退时间通常取冲突窗口(争用期)的值 2r，即传输最小帧长 512bit 数据用时，叫作时槽。</p>\n</li>\n<li>\n<p>取 r, 0 ≤ r &lt; 2^k-1,重传的时延(退避时间)就是 r 倍的单位回退时间。</p>\n</li>\n<li>\n<p>K 为碰撞次数时。K=Min[重传次数，10]，当重传次数超过 10 时，K 就不在增大而是一直等于 10；当重传达 16 次仍不能成功时，则丢弃该帧，并向高层报告</p>\n</li>\n</ul>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVPP1b.png\" alt=\"20210930181153\" />\n</li>\n<li>\n<p>信道利用率</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GV4ggS.png\" alt=\"20210930191350\" />\n</li>\n<li>\n<p>帧发送/接收流程</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVPbu6.png\" alt=\"20210930191552\" />\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVL18C.png\" alt=\"20210930191636\" />\n</li>\n</ul>\n<hr>\n<h4 id=\"MAC-层协议\">MAC 层协议</h4>\n<blockquote>\n<ol>\n<li><a href=\"https://blog.csdn.net/t_home/article/details/90711643\">以太网 MAC 层基础知识学习</a></li>\n<li>小林 Coding - 图解网络</li>\n</ol>\n</blockquote>\n<ul>\n<li>\n<p>MAC (media access control) / (message authentication code)</p>\n<ul>\n<li>MAC 地址相同的设备只要不是同属一个数据链路就不会出现问题。同一网段下两设备都不能正常联网.</li>\n</ul>\n<blockquote>\n<p>I3E 注册管理结构 RA（Registration Authority）是局域网全球地址的法定管理机构[W-IEEERA]，负责分配前三个字节；前三个字节又称组织唯一标识符 OUI（Organizationally Unique Identifier），又称公司标识符（Company ID）[RFC 7042]。后三个字节由厂家自行指派称为扩展标识符（Extended Identifier）。总的一起叫做 EUI-48 扩展的唯一标识符（Extended Unique Identifier）。</p>\n</blockquote>\n<hr>\n</li>\n<li>\n<p>以太网 V2 的 MAC 帧格式(MAC 格式标准有两个，一个是 DIX Ethernet V2 标准，一个是 IEEE 的 802.3 标准)</p>\n<ul>\n<li>IEEE 802 标准中规定了一种 48 位的全球地址，此地址固化在适配器的 ROM 中（所以称为物理地址）。无线 LAN、蓝牙、以太网、FDDI、ATM 等设备都使用相同规格的 MAC 地址。</li>\n</ul>\n</li>\n<li>\n<p>MAC 地址字段</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVthY0.png\" alt=\"20210930194939\" />\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVAx90.png\" alt=\"20210930202539\" />\n<hr>\n</li>\n<li>\n<p>网络包至此(数据链路层)的图解</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GV4M7n.png\" alt=\"20210930204450\" />\n</li>\n</ul>\n<hr>\n<h3 id=\"网络层\">网络层</h3>\n<h4 id=\"路由选择协议\">路由选择协议</h4>\n<ul>\n<li>\n<p>动/静态路由选择</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GV4raC.png\" alt=\"20211022084950\" />\n</li>\n<li>\n<p>因特网<code>采用动态路由选择</code>,分层次自治</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVPc60.png\" alt=\"20211022085337\" />\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GV4u0E.png\" alt=\"20211022085557\" />\n</li>\n<li>\n<p>路由器基本结构</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GViD6S.png\" alt=\"20211022090722\" />\n</li>\n</ul>\n<h4 id=\"路由信息协议-RIP-的基本工作原理\">路由信息协议 RIP 的基本工作原理</h4>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVAFD6.png\" alt=\"20211022100415\" />\n<ul>\n<li>\n<p>RIP 会选择距离向量短的路由,而不管带宽 (距离相同的话使用负载均衡)</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVLHpn.png\" alt=\"20211022100624\" />\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVP7V1.png\" alt=\"20211022100656\" />\n</li>\n<li>\n<p>RIP 交换要点</p>\n<p>只和相邻路由器交换信息</p>\n<p>交换自己的路由表</p>\n<p>周期性交换 (比如 30s)</p>\n</li>\n<li>\n<p>举例: RIP 路由条目更新规则</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVA7lM.png\" alt=\"20211022115640\" />\n</li>\n<li>\n<p>坏消息传得慢/路由环路/距离无穷计数问题</p>\n<p>新更新的路由表被老版本覆盖,有几个措施可以<code>减少出现概率</code>或减小危害:</p>\n<ol>\n<li>\n<p>限制最大路径为 15</p>\n</li>\n<li>\n<p>路由表发生变化时立即发送更新报文 (触发更新)</p>\n</li>\n<li>\n<p>记录特定接口的路由信息,而不反向传递 (水平分割)</p>\n</li>\n</ol>\n</li>\n</ul>\n<hr>\n<h4 id=\"开放最短路径优先-OSPF-的基本工作原理\">开放最短路径优先 OSPF 的基本工作原理</h4>\n<ul>\n<li>\n<p>基本工作原理</p>\n<p>基于链路状态,使用最短路径优先,保证不会产生路由环路</p>\n<p>不限制网络规模,更新效率高,收敛速度快</p>\n<p>链路状态是指与哪些路由器相邻以及相应连路的代价 (费用/距离/时延/带宽等等)</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GV4yhY.png\" alt=\"20211022165456\" />\n</li>\n<li>\n<p>链路状态更新 &amp;&amp; 最短路径 SPF 计算</p>\n<p>每个路由器会产生链路状态通告(LSA),包含: 直连网络/邻居路由器得到链路状态</p>\n<p>LSA 封装在链路状态更新分组(LSU)中,采用洪泛法发送</p>\n<p>每个路由器通过链路状态数据库(LSDB)来接收 LSU 维护链路状态,各路由器 LSDB 最终一致</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVPeLC.png\" alt=\"20211022170324\" />\n</li>\n<li>\n<p>OSPF 工作过程 &amp;&amp; 五种数据分组</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVtuem.png\" alt=\"20211022170725\" />\n</li>\n<li>\n<p>邻居关系建立 &amp;&amp; 划分区域</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVPNyq.png\" alt=\"20211022174329\" />\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GV4Oh5.png\" alt=\"20211022174754\" />\n</li>\n</ul>\n<h4 id=\"边界网关协议-BGP\">边界网关协议 BGP</h4>\n<ul>\n<li>\n<p>路由选择</p>\n<p>不同自治系统内度量路由的代价可能是不同的,所以无法通过代价度量来寻找最佳路由</p>\n<p>自治系统间路由选择还需要考虑政治,经济,安全等因素</p>\n<p>BGP 力求找一条不兜圈子的较好的路由线路,而不是找最佳路由</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GV44vY.png\" alt=\"20211022232434\" />\n</li>\n<li>\n<p>举例: BGP 路径向量应用</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVL4XX.png\" alt=\"20211022232856\" />\n</li>\n<li>\n<p>BGP-4 的四种报文</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVLwiq.png\" alt=\"20211022233905\" />\n</li>\n<li>\n<p>直接封装 xx 报文的协议</p>\n<p>RIP -&gt; UDP</p>\n<p>OSPF -&gt; IP</p>\n<p>BGP -&gt; TCP</p>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"离散\">离散</h2>\n<h3 id=\"图\">图</h3>\n<ul>\n<li>\n<p>有向图-邻接矩阵存储</p>\n<img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GVL5Lr.png\" alt=\"20211028200201\" />\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"算法分析与设计\">算法分析与设计</h2>\n<h3 id=\"题目\">题目</h3>\n<h4 id=\"最大团-最大独立集\">最大团-最大独立集</h4>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GhJOD6.png\" alt=\"\"></p>\n<p>最大团: 顶点间都相连的最多顶点数 24567 或 45679</p>\n<p>最大独立集: 顶点间都不直接相连的最多顶点数 158 或 168</p>\n<hr>\n<h4 id=\"01-背包\">01-背包</h4>\n<p>5 个物品,1 个背包，背包容量为 10.</p>\n<p>价值：8,10,4,5,5</p>\n<p>重量：6,4,2,2,3</p>\n<p>求将该 5 个物品装入背包的最大价值<code>20</code>,以及 x[6]的向量值<code>（0,0,1,0,1,1）</code>(后 5 个空选择哪个对应的向量值为 1)</p>\n<hr>\n<h4 id=\"矩阵连乘\">矩阵连乘</h4>\n<ul>\n<li>\n<p><code>A1 A2 A3 A4 A5</code> 五个矩阵连乘,通过下图判断怎么加括号使运算最少</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GhJ6Iq.png\" alt=\"\"></p>\n</li>\n<li>\n<p>不看 0 那一斜线和 0 上面的一位,如下</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GhA3Yz.png\" alt=\"\"></p>\n<p>第三列: 在 A2 断开</p>\n<p>第四列: 在 A2 断开</p>\n<p>第五列: 在 A2 和 A4 断开</p>\n</li>\n<li>\n<p>A1 A2 | A3 A4 | A5</p>\n<p>每组括起来就是结果: <code>(A1 A2)(A3 A4)A5</code></p>\n</li>\n</ul>\n<hr>\n<h4 id=\"八皇后解法速记\">八皇后解法速记</h4>\n<p>17582463<br>\n24683175<br>\n31758246<br>\n42736851</p>\n<p>通过镜像操作可以得到对面四种解法: 1-&gt;8, 2-&gt;7, 3-&gt;6, 4-&gt;5</p>\n<hr>\n<h4 id=\"随机化算法\">随机化算法</h4>\n<ul>\n<li>\n<p>舍伍德算法</p>\n<p>去掉问题最坏解，使得求解的时候的复杂度趋向于平均</p>\n</li>\n<li>\n<p>拉斯维加斯算法：</p>\n<p>问题求解时随机决策</p>\n<p>随机找，找到了一定是正确的，但是不一定能在有限的时间内找到正确的解</p>\n</li>\n<li>\n<p>蒙特卡洛算法</p>\n<p>以高概率给出一个正确的解，但是不能判定是不是正确的</p>\n<p>【主元素】随机找出一个元素，看看它有没有出现了很多次，如果是，就返回 true，否则返回 false。<br>\n返回 true 一定能确定有主元素，但是返回 false 的时候不一定能确定没有主元素。</p>\n<p>【是否正确】<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>&lt;</mo><mi>p</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">\\frac{1}{2}&lt;p&lt;1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7335em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1</span></span></span></span>,如果得到正确解的概率不小于 p，则称该蒙特卡洛算法是 p 正确的，<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>p</mi><mo>−</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding=\"application/x-tex\">p-\\frac{1}{2}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1901em;vertical-align:-0.345em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8451em;\"><span style=\"top:-2.655em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.394em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.345em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span> 是该算法的优势<br>\n【一致】如果对于同一个实例，算法不会给出两个正确的解答，那么称这个蒙特卡洛算法是一致的<br>\n【提高正确率】执行若干次，选择频次最高的<br>\n<sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup></p>\n</li>\n</ul>\n<hr>\n<h4 id=\"渐近阶高低\">渐近阶高低</h4>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>O</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mi>O</mi><mo stretchy=\"false\">(</mo><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mi>log</mi><mo>⁡</mo><mi>n</mi><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>2</mn></msup><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mn>3</mn></msup><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mi>k</mi></msup><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mn>2</mn><mi>n</mi></msup><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mi>O</mi><mo stretchy=\"false\">(</mo><mi>n</mi><mo stretchy=\"false\">!</mo><mo stretchy=\"false\">)</mo><mo>&lt;</mo><mi>O</mi><mo stretchy=\"false\">(</mo><msup><mi>n</mi><mi>n</mi></msup><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">\nO(1) &lt; O(\\log{n})) &lt; O(n) &lt; O(n\\log{n}) &lt; O(n^2) &lt; O(n^3) &lt; O(n^k) &lt; O(2^n) &lt; O(n!) &lt; O(n^n)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span><span class=\"mclose\">))</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mop\">lo<span style=\"margin-right:0.01389em;\">g</span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">n</span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0641em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.0991em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8491em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">n</span><span class=\"mclose\">!)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">O</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\">n</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.6644em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\">n</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span></span> <sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup></p>\n<hr>\n<h4 id=\"数论四大定理\">数论四大定理</h4>\n<p>威尔逊定理, 欧拉定理, 中国剩余定理, 费马小定理</p>\n<hr>\n<h4 id=\"棋盘覆盖问题\">棋盘覆盖问题</h4>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GhAJFm.png\" alt=\"\"></p>\n<ol>\n<li>根据黑的先画最中间绿色的</li>\n<li>根据绿色的画黄色的</li>\n<li>根据黄色画蓝色的</li>\n<li>可以确定答案了<br>\n<sup id='cite_ref-3'><a href=\"#cite_note-3\">[3]</a></sup></li>\n</ol>\n<hr>\n<h4 id=\"二分搜索\">二分搜索</h4>\n<figure class=\"highlight css\"><table><tr><td class=\"code\"><pre><span class=\"line\">（<span class=\"number\">1</span>）给定从小到达已排好序的<span class=\"number\">2021</span>个整数，存放在数组<span class=\"selector-tag\">a</span><span class=\"selector-attr\">[2021]</span>中，执行以下BinarySearch()函数，需要查找的特定元素<span class=\"attribute\">x</span>。</span><br><span class=\"line\">问<span class=\"number\">1</span>：当<span class=\"attribute\">x</span> &gt; <span class=\"selector-tag\">a</span><span class=\"selector-attr\">[2020]</span>时，查找不到元素<span class=\"attribute\">x</span>时，比较了______ 次。</span><br><span class=\"line\">问<span class=\"number\">2</span>：当<span class=\"attribute\">x</span> &lt; <span class=\"selector-tag\">a</span><span class=\"selector-attr\">[0]</span>时，查找不到元素<span class=\"attribute\">x</span>时，比较了______ 次。</span><br><span class=\"line\"></span><br><span class=\"line\">（<span class=\"number\">2</span>）给定从小到达已排好序的<span class=\"number\">2048</span>个整数，存放在数组<span class=\"selector-tag\">a</span><span class=\"selector-attr\">[2048]</span>中，执行以下BinarySearch()函数，需要查找的特定元素<span class=\"attribute\">x</span>。</span><br><span class=\"line\">问<span class=\"number\">3</span>：当<span class=\"attribute\">x</span> &gt; <span class=\"selector-tag\">a</span><span class=\"selector-attr\">[2047]</span>时，查找不到元素<span class=\"attribute\">x</span>时，比较了______ 次。</span><br><span class=\"line\">问<span class=\"number\">4</span>：当<span class=\"attribute\">x</span> &lt; <span class=\"selector-tag\">a</span><span class=\"selector-attr\">[0]</span>时，查找不到元素<span class=\"attribute\">x</span>时，比较了______ 次。</span><br></pre></td></tr></table></figure>\n<p>11 10 12 11</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>2020</mn><mo stretchy=\"false\">]</mo><mo>&lt;</mo><msup><mn>2</mn><mn>11</mn></msup></mrow><annotation encoding=\"application/x-tex\">[0,2020] &lt; 2^{11}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2020</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span></span></span></span></span></span></span></span> -&gt; k1=11 k2=11-1</p>\n<p><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><msup><mn>2</mn><mn>11</mn></msup><mo>&lt;</mo><mo>=</mo><mo stretchy=\"false\">[</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>4047</mn><mo stretchy=\"false\">]</mo><mo>&lt;</mo><msup><mn>2</mn><mn>12</mn></msup></mrow><annotation encoding=\"application/x-tex\">2^{11} &lt;= [0,4047] &lt; 2^{12}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8532em;vertical-align:-0.0391em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">11</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">[</span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">4047</span><span class=\"mclose\">]</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8141em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">12</span></span></span></span></span></span></span></span></span></span></span></span> -&gt; k3=12 k4=12-1</p>\n<hr>\n<h4 id=\"斐波那契\">斐波那契</h4>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GhA2nS.png\" alt=\"\"></p>\n<p>F()执行 15 次, f(1) 3 次</p>\n<hr>\n<h4 id=\"最长公共子序列\">最长公共子序列</h4>\n<ul>\n<li>\n<p>填写 C 表和 B 表 (不知道还有什么学校教这种老套,反正是考点没的办法了…)</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GhA8wn.png\" alt=\"\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GhAKhR.png\" alt=\"\"></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/GhAkWA.png\" alt=\"\"></p>\n</li>\n<li>\n<p>思路</p>\n<p>C/B 表同时写不要分开先后写,只不过 B 表要根据 C 表写</p>\n<figure class=\"highlight c\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// c[行][列]  b[行][列]</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (i = <span class=\"number\">1</span>; i &lt; m; i++) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">for</span> (j = <span class=\"number\">1</span>; j &lt; n; j++) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// 首先判断行列字符是否一样,相同的话</span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (x[i] == y[j]) &#123;</span><br><span class=\"line\">      c[i][j] = c[i - <span class=\"number\">1</span>][j - <span class=\"number\">1</span>] + <span class=\"number\">1</span>; <span class=\"comment\">//   c[i][j]=C表左上角+1</span></span><br><span class=\"line\">      b[i][j] = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果行列字符不一样,判断C表上面一格是否&gt;=左边,如果true</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (c[i - <span class=\"number\">1</span>][j] &gt;= c[i][j - <span class=\"number\">1</span>]) &#123;</span><br><span class=\"line\">      c[i][j] = c[i - <span class=\"number\">1</span>][j]; <span class=\"comment\">//           c[i][j]=C表上面一格</span></span><br><span class=\"line\">      b[i][j] = <span class=\"number\">2</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">// 如果行列字符不一样,判断C表上面一格是否&gt;=左边,如果false</span></span><br><span class=\"line\">    &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">      c[i][j] = c[i][j - <span class=\"number\">1</span>]; <span class=\"comment\">//           c[i][j]=C表左边一格</span></span><br><span class=\"line\">      b[i][j] = <span class=\"number\">3</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"人工智能\">人工智能</h2>\n<blockquote>\n<p><a href=\"../AI\">🐊 人工智能笔记</a></p>\n</blockquote>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"零散的\">零散的</h2>\n<h3 id=\"河工大-UML\">河工大-UML</h3>\n<p>这是河北工业大学-刘洪普老师的 UML 课程截图记录</p>\n<p>讲的领域很广, 互联网领域架构, 计算机底层交互/操作系统设计, AI 领域, 并行计算…etc, <code>i了i了</code></p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R1Uw16.jpg\" alt=\"\"></p>\n<p>并发程序: 指的是具有并行处理能力的程序(多线程/协程), 当遇到单核 U 或者环境不适合时会变为顺序执行的程序</p>\n<p>同一机子内多个进程可以通过操作系统来完成进程间通信, Socket 实现的是不同机子之间通过网络来进行进程间的通信</p>\n<blockquote>\n<p>关于分布式并行计算, 这里引 Linus 说的: <br>\n放弃吧。“并行就是未来”的说法就是一片浮云。 <sup id='cite_ref-4'><a href=\"#cite_note-4\">[4]</a></sup></p>\n</blockquote>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R1Ujyo.jpg\" alt=\"\"></p>\n<ul>\n<li>\n<p>显卡: 3d 计算加速卡,图形处理需要做大量线性代数向量运算(3 维模型的坐标转换和投影), 取决于向量运算的数学性质, 其可以通过并行运算来加速处理,区别如下:</p>\n<p>CPU 的这种逻辑运算可以通过分支预测来加速,但是必须顺序执行 (这也就限制了一些程序吃不到多核性能, 两核 3G 打不过一核 5G 的)</p>\n<p>GPU 的运算独立, 简单看来核心越多算的越快,这种计算方式叫<code>向量化计算</code></p>\n<figure class=\"highlight ini\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># CPU</span></span><br><span class=\"line\"><span class=\"attr\">C</span> = A + B</span><br><span class=\"line\"><span class=\"attr\">B</span> = A + C</span><br><span class=\"line\"><span class=\"attr\">A</span> = B + C</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># GPU</span></span><br><span class=\"line\"><span class=\"attr\">A1</span> = B1 + C1</span><br><span class=\"line\"><span class=\"attr\">A2</span> = B2 + C2</span><br><span class=\"line\"><span class=\"attr\">A3</span> = B3 + C3</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p>CPU 核心少而且更适合做逻辑运算, 把向量运算能力加进 CPU (也就是如今的 TPU) 并不是很合适, 所以独立出来了显卡 (一般核心数量上千,高出 CPU 两个量级)</p>\n<p><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/blog/R1gRMt.jpg\" alt=\"\"></p>\n<p>深度学习就是要做大量的线性计算和非线性计算(最终也是通过数学转化为线性计算), 所以炼丹也是吃显卡</p>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://www.nowcoder.com/questionTerminal/7401d66e14e84279ba278ce04e735deb?page=1&amp;onlyReference=false\">https://www.nowcoder.com/questionTerminal/7401d66e14e84279ba278ce04e735deb?page=1&amp;onlyReference=false</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://www.geek-share.com/detail/2771384952.html\">随机化算法-舍伍德算法&amp;拉斯维加斯算法&amp;蒙特卡洛算法</a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://blog.csdn.net/qq_30268545/article/details/80600064\">棋盘覆盖问题-分治法</a></p>\n<p><a name='cite_note-4' href='#cite_ref-4'>[4]</a>: <a href=\"https://www.dell.com/community/%E7%BB%BC%E5%90%88%E8%AE%A8%E8%AE%BA%E5%8C%BA/Linux%E4%B9%8B%E7%88%B6Linus%E8%AF%B4-%E5%B9%B6%E8%A1%8C%E8%AE%A1%E7%AE%97%E5%9F%BA%E6%9C%AC%E4%B8%8A%E5%B0%B1%E6%98%AF%E6%B5%AA%E8%B4%B9%E5%A4%A7%E5%AE%B6%E7%9A%84%E6%97%B6%E9%97%B4/td-p/7047422\">Linux 之父 Linus 说：并行计算基本上就是浪费大家的时间</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "备忘录",
                "算法",
                "笔记",
                "操作系统",
                "计网",
                "硬件",
                "OneNote",
                "复变函数",
                "人工智能"
            ]
        }
    ]
}