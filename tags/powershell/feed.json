{
    "version": "https://jsonfeed.org/version/1",
    "title": "⭐️齐下无贰⭐️ • All posts by \"powershell\" tag",
    "description": "May all the beauty be bless.✨",
    "home_page_url": "https://weidows.github.io",
    "items": [
        {
            "id": "https://weidows.github.io/post/experience/shell/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/",
            "url": "https://weidows.github.io/post/experience/shell/%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7/",
            "title": "🥱戏耍脚本中~ 奇技淫巧",
            "date_published": "2021-11-03T08:37:54.000Z",
            "content_html": "<h1> 戏耍脚本中~ 奇技淫巧 </h1>\n<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2022-02-23 03:23:29\n * @FilePath: \\Blog-private\\source\\_posts\\experience\\shell\\ 奇技淫巧.md\n * @Description:\n * @!: *********************************************************************\n--><blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li><a href=\"#%E6%88%8F%E8%80%8D%E8%84%9A%E6%9C%AC%E4%B8%AD%E5%A5%87%E6%8A%80%E6%B7%AB%E5%B7%A7\"> 戏耍脚本中~ 奇技淫巧 </a>\n<ul>\n<li><a href=\"#%E5%8F%82%E6%95%B0%E5%88%A4%E7%A9%BA\"> 参数判空 </a>\n<ul>\n<li><a href=\"#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%8B%BC%E6%8E%A5%E5%88%A4%E5%AE%9A\"> 字符串拼接判定 </a></li>\n<li><a href=\"#%E8%AF%AD%E6%B3%95%E5%88%A4%E5%AE%9A\"> 语法判定 </a></li>\n</ul>\n</li>\n<li><a href=\"#%E7%A8%8B%E5%BA%8F%E5%8D%A0%E7%94%A8\"> 程序占用 </a></li>\n<li><a href=\"#echo\">echo</a></li>\n<li><a href=\"#scoop\">Scoop</a>\n<ul>\n<li><a href=\"#portable\">portable</a></li>\n<li><a href=\"#%E8%A7%A3%E5%89%96-exe\"> 解剖 -exe</a></li>\n</ul>\n</li>\n<li><a href=\"#%E5%88%A4%E6%96%AD%E6%98%AF%E5%90%A6%E5%90%AB%E6%9C%89%E6%9F%90%E5%AD%97%E7%AC%A6%E4%B8%B2\"> 判断是否含有某字符串 </a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"参数判空\"> 参数判空 </h2>\n<h3 id=\"字符串拼接判定\"> 字符串拼接判定 </h3>\n<ul>\n<li>\n<p> 有时候我们想判断一个变量是不是空的, 会变得有些棘手 </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if [$&#123;abc&#125; != &quot;&quot;]; then</span><br><span class=\"line\">  echo $&#123;abc&#125;</span><br><span class=\"line\">fi</span><br></pre></td></tr></table></figure>\n<p> 我们的想法是判断是否存在 abc 这个变量, 实际上这样写并不行, 没有这个变量的话会变成下面的样子:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if [!= &quot;&quot;]; then</span><br><span class=\"line\">  echo $&#123;abc&#125;</span><br><span class=\"line\">fi</span><br></pre></td></tr></table></figure>\n<p> 这样肯定会报错的 </p>\n<hr>\n</li>\n<li>\n<p> 改一下, 比如添加冗余校验字符 </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">abc = &quot;abc&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">if [a$&#123;abc&#125; != a]; then</span><br><span class=\"line\">  echo $&#123;abc&#125;</span><br><span class=\"line\">fi</span><br></pre></td></tr></table></figure>\n<hr>\n</li>\n<li>\n<p><code>bat 中引号也会视为变量一部分 </code>, 所以:</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> &quot;<span class=\"variable\">%DIRNAME%</span>&quot; == &quot;&quot; <span class=\"built_in\">set</span> DIRNAME=.</span><br></pre></td></tr></table></figure>\n<p> 或者:</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">set</span> abc=&quot;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"variable\">%abc%</span>==&quot;&quot; then (</span><br><span class=\"line\">  <span class=\"built_in\">echo</span> &quot;abc&quot;</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<hr>\n<h3 id=\"语法判定\"> 语法判定 </h3>\n<ul>\n<li>\n<p>shell 的语法:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">if [-n &quot;$&#123;abc&#125;&quot;]; then</span><br><span class=\"line\">  echo $&#123;abc&#125;</span><br><span class=\"line\">fi</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p>bat 语法:</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">if</span> <span class=\"keyword\">not</span> <span class=\"keyword\">defined</span> abc (</span><br><span class=\"line\">  <span class=\"built_in\">echo</span> &#x27;abc&#x27; <span class=\"keyword\">not</span> <span class=\"keyword\">defined</span>.</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"程序占用\"> 程序占用 </h2>\n<ul>\n<li>\n<p> 如果你用过 aria2 的话肯定会遇到一个头疼的事: <code> 如何开机后台自动启动它 </code></p>\n<ol>\n<li>\n<p> 它的程序本身不带有开机启动, 需要另外写启动脚本 </p>\n</li>\n<li>\n<p> 它无法后台启动, 必然会占据一个控制台程序的前台 </p>\n</li>\n</ol>\n</li>\n<li>\n<p> 网上找到了比较好用的方法: <code>vbs 脚本 </code></p>\n<figure class=\"highlight vbs\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CreateObject</span>(<span class=\"string\">&quot;WScript.Shell&quot;</span>).Run <span class=\"string\">&quot;aria2c --conf-path=D:\\Game\\Scoop\\persist\\aria2\\conf&quot;</span>,<span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n<p> 由于我平时用 bat 管理电脑, 单独编写执行一个 vbs 脚本略显多余, 所以直接结合进 bat 脚本里, 用完就删针刺激:</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">echo</span> CreateObject(&quot;WScript.Shell&quot;).Run &quot;aria2c --conf-<span class=\"built_in\">path</span>=D:\\Game\\Scoop\\persist\\aria2\\conf&quot;,<span class=\"number\">0</span> &gt; aria2.vbs</span><br><span class=\"line\">cscript //Nologo aria2.vbs</span><br><span class=\"line\"><span class=\"built_in\">del</span> aria2.vbs</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"echo\">echo</h2>\n<ul>\n<li>\n<p> 看到一个脚本中这么写, 乍一看蒙了:</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">CLS</span>&amp;<span class=\"built_in\">ECHO</span>.&amp;<span class=\"built_in\">ECHO</span> 完成, 以下选项自选：</span><br><span class=\"line\"><span class=\"built_in\">ECHO</span>.&amp;<span class=\"built_in\">ECHO</span> <span class=\"number\">1</span>、启用视频播放程序 (会驻留进程)</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p> 实际上只是把几个命令压缩到了一行 </p>\n<figure class=\"highlight avrasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">cls</span>   <span class=\"meta\"># 清屏 </span></span><br><span class=\"line\">echo. <span class=\"meta\"># 换行 </span></span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"Scoop-4\">Scoop</h2>\n<h3 id=\"portable\">portable</h3>\n<p> 我们可以通过创建虚拟链接把 C 盘中的 runtime 数据 -&gt; scoop/persist 内 </p>\n<ul>\n<li>\n<p> 此片段可自动判断 <code>remix-ide / .remix-ipfsnode / .cache_remix_ide</code> 所在目录是 <code>USERPROFILE / APPDATA</code></p>\n<p> 并将数据移动到 persist 内, 创建虚拟链接 </p>\n<p><code> 需要注意只能是文件夹, 不能是文件!!!</code></p>\n<figure class=\"highlight nsis\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;foreach (<span class=\"variable\">$folder</span> in @(&#x27;remix-ide&#x27;, &#x27;.remix-ipfsnode&#x27;, &#x27;.cache_remix_ide&#x27;)) &#123;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;  if (Test-Path \\&quot;</span><span class=\"variable\">$env</span>:USERPROFILE\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;) &#123;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;    <span class=\"variable\">$runtimeCache</span> = \\&quot;</span><span class=\"variable\">$env</span>:USERPROFILE\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;    <span class=\"variable\">$runtimeCachePersist</span> = \\&quot;</span><span class=\"variable\">$persist_dir</span>\\\\USERPROFILE\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;  &#125; else &#123;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;    if (Test-Path \\&quot;</span><span class=\"variable\">$env</span>:APPDATA\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;) &#123;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;      <span class=\"variable\">$runtimeCache</span> = \\&quot;</span><span class=\"variable\">$env</span>:APPDATA\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;      <span class=\"variable\">$runtimeCachePersist</span> = \\&quot;</span><span class=\"variable\">$persist_dir</span>\\\\APPDATA\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;    &#125; else &#123;continue&#125;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;  &#125;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;  if (Test-Path <span class=\"variable\">$runtimeCachePersist</span>) &#123;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;    Remove-Item <span class=\"variable\">$runtimeCache</span> -Force -Recurse -ErrorAction SilentlyContinue&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;    New-Item -Type Junction -Path <span class=\"variable\">$runtimeCache</span> -Target <span class=\"variable\">$runtimeCachePersist</span> | Out-Null&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;  &#125; else &#123;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;    mkdir <span class=\"variable\">$runtimeCache</span>&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;    Move-Item <span class=\"variable\">$runtimeCache</span> <span class=\"variable\">$runtimeCachePersist</span> -Force&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;    New-Item -Type Junction -Path <span class=\"variable\">$runtimeCache</span> -Target <span class=\"variable\">$runtimeCachePersist</span> | Out-Null&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;  &#125;&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;&#125;&quot;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p> 以及配对的 uninstaller:</p>\n<figure class=\"highlight nsis\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;uninstaller&quot;</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">&quot;script&quot;</span>: [</span><br><span class=\"line\">        <span class=\"string\">&quot;foreach (<span class=\"variable\">$folder</span> in @(&#x27;remix-ide&#x27;, &#x27;.remix-ipfsnode&#x27;, &#x27;.cache_remix_ide&#x27;)) &#123;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;  if (Test-Path \\&quot;</span><span class=\"variable\">$env</span>:USERPROFILE\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;) &#123;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;    <span class=\"variable\">$runtimeCache</span> = \\&quot;</span><span class=\"variable\">$env</span>:USERPROFILE\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;    <span class=\"variable\">$runtimeCachePersist</span> = \\&quot;</span><span class=\"variable\">$persist_dir</span>\\\\USERPROFILE\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;  &#125; else &#123;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;    if (Test-Path \\&quot;</span><span class=\"variable\">$env</span>:APPDATA\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;) &#123;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;      <span class=\"variable\">$runtimeCache</span> = \\&quot;</span><span class=\"variable\">$env</span>:APPDATA\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;      <span class=\"variable\">$runtimeCachePersist</span> = \\&quot;</span><span class=\"variable\">$persist_dir</span>\\\\APPDATA\\\\<span class=\"variable\">$folder</span>\\<span class=\"string\">&quot;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;    &#125; else &#123;continue&#125;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;  &#125;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;  if (!(Test-Path <span class=\"variable\">$runtimeCachePersist</span>)) &#123; Move-Item <span class=\"variable\">$runtimeCache</span> <span class=\"variable\">$runtimeCachePersist</span> -Force -ErrorAction SilentlyContinue &#125;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;  else &#123; Remove-Item <span class=\"variable\">$runtimeCache</span> -Force -Recurse -ErrorAction SilentlyContinue &#125;&quot;</span>,</span><br><span class=\"line\">        <span class=\"string\">&quot;&#125;&quot;</span></span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;,</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<hr>\n<h3 id=\"解剖 -exe\"> 解剖 -exe</h3>\n<ul>\n<li>\n<p> 此片段可以把常见的 <code>.exe -&gt; .exe#/dl.7z</code> 中的文件提取出来 </p>\n<figure class=\"highlight lsl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">&quot;Expand-7zipArchive <span class=\"subst\">\\&quot;</span>$dir<span class=\"subst\">\\\\</span>`$PLUGINSDIR<span class=\"subst\">\\\\</span>app-64.7z<span class=\"subst\">\\&quot;</span> <span class=\"subst\">\\&quot;</span>$dir<span class=\"subst\">\\&quot;</span>&quot;</span>,</span><br><span class=\"line\"><span class=\"string\">&quot;Remove-Item -Recurse -Force <span class=\"subst\">\\&quot;</span>$dir<span class=\"subst\">\\\\</span>`$PLUGINSDIR<span class=\"subst\">\\&quot;</span>&quot;</span>,</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"判断是否含有某字符串\"> 判断是否含有某字符串 </h2>\n<ul>\n<li>\n<p> 如下, 可以判断.gitignore 中是否含有 ‘backup’</p>\n<figure class=\"highlight bat\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cat <span class=\"variable\">%BACKUP_DIR%</span>\\.gitignore | <span class=\"built_in\">findstr</span> backup &gt;<span class=\"built_in\">nul</span> || (</span><br><span class=\"line\">    <span class=\"built_in\">echo</span> backup&gt;&gt; <span class=\"variable\">%BACKUP_DIR%</span>\\.gitignore</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "shell",
                "powershell"
            ]
        },
        {
            "id": "https://weidows.github.io/post/experience/shell/pwsh/",
            "url": "https://weidows.github.io/post/experience/shell/pwsh/",
            "title": "🉑pwsh 极致专攻",
            "date_published": "2020-10-13T15:25:31.000Z",
            "content_html": "<h1>pwsh 极致专攻 </h1>\n<!--\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2022-02-23 03:22:48\n * @FilePath: \\Blog-private\\source\\_posts\\experience\\shell\\pwsh.md\n--><blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li><a href=\"#pwsh-%E6%9E%81%E8%87%B4%E4%B8%93%E6%94%BB\">pwsh 极致专攻 </a>\n<ul>\n<li><a href=\"#%E9%A2%84%E8%A7%88\"> 预览 </a></li>\n<li><a href=\"#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE\"> 环境配置 </a></li>\n<li><a href=\"#%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6\"> 安装插件 </a></li>\n<li><a href=\"#%E5%90%AF%E7%94%A8%E4%B8%BB%E9%A2%98%E5%8F%8A%E6%8F%92%E4%BB%B6\"> 启用主题及插件 </a></li>\n<li><a href=\"#oh-my-posh\">oh-my-posh</a></li>\n<li><a href=\"#%E5%90%AF%E7%94%A8%E7%AE%A1%E7%90%86%E5%91%98%E6%A8%A1%E5%BC%8F\"> 启用管理员模式 </a></li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<h2 id=\"预览\"> 预览 </h2>\n<p><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/post/L26PcmM3KnW9YfT.jpg\" alt=\"siDz8M1QlGIanE3\"></p>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"环境配置 -3\"> 环境配置 </h2>\n<ul>\n<li>\n<p> 不同于 Windows 自带的 Windows PowerShell, 这个 PowerShell(也叫 posh/pwsh) 需要另行安装 (百度搜, 安装上就行)</p>\n<ul>\n<li>\n<p> 配置环境变量:Path 里面 + <code>D:\\Game\\Demo\\PowerShell\\</code></p>\n</li>\n<li>\n<p> 如果用 VScode 的话, 实际上不设置环境变量也行, 因为在 VScode 内需要指定 powershell 路径 </p>\n</li>\n</ul>\n</li>\n<li>\n<p>Scoop 安装全自动, 不需要配置.</p>\n<figure class=\"highlight mipsasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">scoop </span><span class=\"keyword\">install </span>pwsh</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<hr>\n<h2 id=\"安装插件\"> 安装插件 </h2>\n<ul>\n<li>\n<p><code>oh-my-posh</code> (Posh 增强主题)</p>\n<figure class=\"highlight mathematica\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Install</span><span class=\"operator\">-</span><span class=\"built_in\">Module</span> <span class=\"variable\">oh</span><span class=\"operator\">-</span><span class=\"variable\">my</span><span class=\"operator\">-</span><span class=\"variable\">posh</span></span><br></pre></td></tr></table></figure>\n<img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/post/1d9Xs6ADR3MaNCy.png\" alt=\"20211029164044\" />\n<hr>\n</li>\n<li>\n<p><code>PoshFuck</code></p>\n<p> 不必在意格式, 复制就行 </p>\n<figure class=\"highlight reasonml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Set-ExecutionPolicy RemoteSigned</span><br><span class=\"line\">  iex ((<span class=\"keyword\">new</span>-<span class=\"keyword\">object</span> net.webclient).<span class=\"constructor\">DownloadString(&#x27;<span class=\"params\">https</span>:<span class=\"operator\">/</span><span class=\"operator\">/</span><span class=\"params\">raw</span>.<span class=\"params\">githubusercontent</span>.<span class=\"params\">com</span><span class=\"operator\">/</span><span class=\"params\">mattparkes</span><span class=\"operator\">/</span>PoShFuck<span class=\"operator\">/</span><span class=\"params\">master</span><span class=\"operator\">/</span>Install-TheFucker.<span class=\"params\">ps1</span>&#x27;)</span>)</span><br></pre></td></tr></table></figure>\n<img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/post/JMwQv4UEDaZ1sob.png\" alt=\"20211029164014\" />\n<hr>\n</li>\n<li>\n<p><code>posh-git</code> (用于扩展 Posh 里的 Git 自动补全)</p>\n<figure class=\"highlight mathematica\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Install</span><span class=\"operator\">-</span><span class=\"built_in\">Module</span> <span class=\"variable\">posh</span><span class=\"operator\">-</span><span class=\"variable\">git</span></span><br></pre></td></tr></table></figure>\n<img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/post/6wLnWidyZxf7IsT.png\" alt=\"20211029163651\" />\n<hr>\n</li>\n<li>\n<p><code>PSReadline</code> (Windows 自带, 可以直接使用)</p>\n<ul>\n<li>\n<p> 预测显示历史命令 </p>\n</li>\n<li>\n<p> 上下左右高级补全 </p>\n</li>\n</ul>\n<img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/post/qRsYkhSwMc4JezU.png\" alt=\"20210703123813\" />\n</li>\n</ul>\n<hr>\n<h2 id=\"启用主题及插件\"> 启用主题及插件 </h2>\n<blockquote>\n<p><a href=\"https://github.com/Weidows-projects/Programming-Configuration/blob/master/others/PowerShell/Microsoft.PowerShell_profile.ps1\"> 我的配置文件链接 </a></p>\n</blockquote>\n<ul>\n<li>\n<p><code> 启用主题 </code>: ~/ 文档 /PowerShell/Microsoft.PowerShell_profile.ps1 / $profile 加上以下字段 </p>\n<figure class=\"highlight coq\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Import</span>-<span class=\"keyword\">Module</span> oh-my-posh</span><br><span class=\"line\"><span class=\"keyword\">Import</span>-<span class=\"keyword\">Module</span> posh-git</span><br><span class=\"line\"><span class=\"keyword\">Set</span>-PoshPrompt -Theme powerlevel10k_classic</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p><code>Posh 中类似 Linux 形式补全 </code> (按 Tab 自动补, 非常实用)</p>\n<img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/post/RoPeDmafdlTrK4S.png\" alt=\"MouseInc 122640\" />\n<figure class=\"highlight mathematica\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">Set</span><span class=\"operator\">-</span><span class=\"variable\">PSReadlineKeyHandler</span> <span class=\"operator\">-</span><span class=\"built_in\">Key</span> <span class=\"built_in\">Tab</span> <span class=\"operator\">-</span><span class=\"built_in\">Function</span> <span class=\"variable\">MenuComplete</span></span><br></pre></td></tr></table></figure>\n<hr>\n</li>\n<li>\n<p><code>Posh-Fuck</code>, 类似 <code>Zsh-theFuck</code></p>\n<ul>\n<li> 用法: <code>fuck</code> / <code>fuck!</code> / <code>WTF</code> / <code>Get-Fucked</code></li>\n</ul>\n<figure class=\"highlight coq\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">Import</span>-<span class=\"keyword\">Module</span> PoShFuck</span><br></pre></td></tr></table></figure>\n<hr>\n</li>\n<li>\n<p><code>PSReadline</code></p>\n<figure class=\"highlight mathematica\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"type\">#</span> <span class=\"variable\">Enable</span> <span class=\"variable\">Prediction</span> <span class=\"variable\">History</span></span><br><span class=\"line\"><span class=\"built_in\">Set</span><span class=\"operator\">-</span><span class=\"variable\">PSReadLineOption</span> <span class=\"operator\">-</span><span class=\"variable\">PredictionSource</span> <span class=\"variable\">History</span></span><br><span class=\"line\"><span class=\"type\">##</span> <span class=\"variable\">Advanced</span> <span class=\"variable\">Autocompletion</span> <span class=\"variable\">for</span> <span class=\"variable\">arrow</span> <span class=\"variable\">keys</span></span><br><span class=\"line\"><span class=\"built_in\">Set</span><span class=\"operator\">-</span><span class=\"variable\">PSReadlineKeyHandler</span> <span class=\"operator\">-</span><span class=\"built_in\">Key</span> <span class=\"built_in\">UpArrow</span> <span class=\"operator\">-</span><span class=\"built_in\">Function</span> <span class=\"variable\">HistorySearchBackward</span></span><br><span class=\"line\"><span class=\"built_in\">Set</span><span class=\"operator\">-</span><span class=\"variable\">PSReadlineKeyHandler</span> <span class=\"operator\">-</span><span class=\"built_in\">Key</span> <span class=\"built_in\">DownArrow</span> <span class=\"operator\">-</span><span class=\"built_in\">Function</span> <span class=\"variable\">HistorySearchForward</span></span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p> 这个文件实际上是 PowerShell 打开时默认加载的指令集, 可以自定义添加命令, 如:</p>\n<ul>\n<li> 清除打开时的版本信息, 在最后一行添加: <code>clear</code></li>\n</ul>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"oh-my-posh\">oh-my-posh</h2>\n<ul>\n<li>\n<p> 查看所有主题 </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Get-PoshThemes</span><br></pre></td></tr></table></figure>\n</li>\n<li>\n<p> 用法:</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Set-PoshPrompt -Theme xxx</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<p><a><img src=\"https://cdn.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"启用管理员模式\"> 启用管理员模式 </h2>\n<ul>\n<li> 作用就是让右键文件时出现管理员权限\n<ul>\n<li> 实际上没啥用, 并不太推荐使用.</li>\n<li> 这个东西与上面 PowerShell 没啥关系 </li>\n</ul>\n</li>\n</ul>\n<figure class=\"highlight awk\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">reg add <span class=\"string\">&quot;HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Session Manager\\Kernel&quot;</span> <span class=\"regexp\">/v DisableTsx /</span>t REG_DWORD <span class=\"regexp\">/d 0 /</span>f</span><br></pre></td></tr></table></figure>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "备忘录",
                "shell",
                "powershell"
            ]
        }
    ]
}