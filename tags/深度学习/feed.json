{
    "version": "https://jsonfeed.org/version/1",
    "title": "⭐️齐下无贰⭐️ • All posts by \"深度学习\" tag",
    "description": "May all the beauty be bless.✨",
    "home_page_url": "https://weidows.github.io",
    "items": [
        {
            "id": "https://weidows.github.io/post/python/code/MM-Detection/",
            "url": "https://weidows.github.io/post/python/code/MM-Detection/",
            "title": "🐳MM-Detection-Colab",
            "date_published": "2022-06-07T09:06:50.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2022-04-20 23:11:24\n * @FilePath: \\Blog-private\\scaffolds\\post.md\n * @Description:\n * @!: *********************************************************************\n-->\n<h2 id=\"序-3\">序</h2>\n<ul>\n<li>\n<p>Colab 平台对于 <code>轻量级/边缘计算</code> 比较方便, 尤其是对这种教程性质的 notebook, 分享和运行都开箱即用</p>\n</li>\n<li>\n<p>但另一方面:</p>\n<p><code>因</code>: 免费版的 Colab 所给的硬件资源不是很稳定, 用太久的话会分不到 GPU, 虽然给的 GPU 肯定是比自己的开发机强很多, 但是跑大型项目肯定带不动 (而且 Colab 单次运行最多持续 6h, 一段时间没动作的话会断连, 断开后再过一阵 runtime 会被重置)</p>\n</li>\n<li>\n<p><code>果</code>: 可以用它来学习下怎么搭环境以及一些小测试</p>\n<p>毕竟生产服务器申请不易 / 环境也不能乱动</p>\n<p>受系统和网络限制, 在开发机搭环境并不理想</p>\n</li>\n</ul>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"装环境-2\">装环境</h2>\n<blockquote>\n<p>从安装到放弃到爬出坑 :( <br>\n跟着这几篇装的环境:<sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup><sup id='cite_ref-3'><a href=\"#cite_note-3\">[3]</a></sup>, 有借鉴意义但是指导不明确 <br>\n个人先跟着官方出的视频教程和 openbayes 上的 notebook 试了试水, 很深 <sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup>; 最后找到一个源库 tutorial-fork 的 colab-notebook <sup id='cite_ref-4'><a href=\"#cite_note-4\">[4]</a></sup> \\</p>\n</blockquote>\n<p>预先装上 cuda, cudnn (colab自带)</p>\n<p>依赖链: <code>cuda -&gt; pytorch -&gt; mmcv-full -&gt; mmdet</code></p>\n<p>每一步依赖前面环境的版本, 即使后面能装上也可能不适配, 任何一步有问题都 can’t-run</p>\n<p><img src=\"https://www.helloimg.com/images/2022/06/06/ZtZpOm.png\" alt=\"\"></p>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ====================可选, colab并不自带conda=====================</span></span><br><span class=\"line\">!conda create -n openmmlab -y</span><br><span class=\"line\">!conda activate openmmlab</span><br><span class=\"line\">!conda init</span><br></pre></td></tr></table></figure>\n<pre><code>/bin/bash: conda: command not found\n/bin/bash: conda: command not found\n/bin/bash: conda: command not found\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ================== 一键装好环境 =======================</span></span><br><span class=\"line\"><span class=\"comment\"># 如果这里有问题可以重启一下内核: 代码执行程序 -&gt; 重新启动代码执行程序</span></span><br><span class=\"line\"></span><br><span class=\"line\">!python -m pip install --upgrade pip</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 注意对应机子配置: https://pytorch.org/</span></span><br><span class=\"line\"><span class=\"comment\"># install dependencies: (use cu111 because colab has CUDA 11.1)</span></span><br><span class=\"line\">%pip install torch==<span class=\"number\">1.9</span><span class=\"number\">.0</span>+cu111 torchvision==<span class=\"number\">0.10</span><span class=\"number\">.0</span>+cu111 -f https://download.pytorch.org/whl/torch_stable.html</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># windows 平台不用装了, 一定会卡在这</span></span><br><span class=\"line\"><span class=\"comment\"># https://github.com/open-mmlab/mmcv/blob/master/README_zh-CN.md</span></span><br><span class=\"line\">%pip install mmcv-full -f https://download.openmmlab.com/mmcv/dist/cu111/torch1<span class=\"number\">.9</span><span class=\"number\">.0</span>/index.html</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 与pip/conda同级的专门给mm-lab用的包管理器, 报错率很高</span></span><br><span class=\"line\">%pip install openmim</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 依赖 mmcv, 如果用mim装的话大概率有问题</span></span><br><span class=\"line\">%pip install mmsegmentation</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 后面要用到源码库的 config, 可选用源库安装</span></span><br><span class=\"line\">%pip install mmdet</span><br><span class=\"line\"><span class=\"comment\"># !rm -rf /content/mmdetection</span></span><br><span class=\"line\">!git clone https://github.com/<span class=\"built_in\">open</span>-mmlab/mmdetection.git</span><br><span class=\"line\">%cd mmdetection</span><br><span class=\"line\"><span class=\"comment\"># %pip install -e .</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 后续当前路径为 /content/mmdetection</span></span><br></pre></td></tr></table></figure>\n<pre><code>Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\nRequirement already satisfied: pip in /usr/local/lib/python3.7/dist-packages (21.1.3)\nCollecting pip\n  Downloading pip-22.1.2-py3-none-any.whl (2.1 MB)\n\u001b[K     |████████████████████████████████| 2.1 MB 4.8 MB/s \n\u001b[?25hInstalling collected packages: pip\n  Attempting uninstall: pip\n    Found existing installation: pip 21.1.3\n    Uninstalling pip-21.1.3:\n      Successfully uninstalled pip-21.1.3\nSuccessfully installed pip-22.1.2\nLooking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\nLooking in links: https://download.pytorch.org/whl/torch_stable.html\nCollecting torch==1.9.0+cu111\n  Downloading https://download.pytorch.org/whl/cu111/torch-1.9.0%2Bcu111-cp37-cp37m-linux_x86_64.whl (2041.3 MB)\n\u001b[2K     \u001b[91m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[91m╸\u001b[0m \u001b[32m2.0/2.0 GB\u001b[0m \u001b[31m81.2 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0mtcmalloc: large alloc 2041348096 bytes == 0x2a2a000 @  0x7fdbaca001e7 0x4a3940 0x4a39cc 0x592b76 0x4df71e 0x59afff 0x515655 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x593dd7 0x511e2c 0x549576 0x593fce 0x548ae9 0x5127f1 0x549576 0x593fce 0x511e2c\n\u001b[2K     \u001b[91m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[91m╸\u001b[0m \u001b[32m2.0/2.0 GB\u001b[0m \u001b[31m88.6 MB/s\u001b[0m eta \u001b[36m0:00:01\u001b[0mtcmalloc: large alloc 2551685120 bytes == 0x7c4f2000 @  0x7fdbaca01615 0x592b76 0x4df71e 0x59afff 0x515655 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x593dd7 0x511e2c 0x549576 0x593fce 0x548ae9 0x5127f1 0x549576 0x593fce 0x511e2c 0x549576 0x593fce\ntcmalloc: large alloc 2041348096 bytes == 0x2a2a000 @  0x7fdbaca001e7 0x4a3940 0x5b438c 0x5b46f7 0x59afff 0x515655 0x549576 0x593fce 0x511e2c 0x549576 0x593fce 0x511e2c 0x549576 0x4bcb19 0x59c019 0x595ef6 0x5fbece 0x594b72 0x548cc1 0x51566f 0x593dd7 0x548ae9 0x51566f 0x549576 0x593fce 0x548ae9 0x51566f 0x549576 0x593fce 0x548ae9 0x5127f1\n\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m2.0/2.0 GB\u001b[0m \u001b[31m858.4 kB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hCollecting torchvision==0.10.0+cu111\n  Downloading https://download.pytorch.org/whl/cu111/torchvision-0.10.0%2Bcu111-cp37-cp37m-linux_x86_64.whl (23.2 MB)\n\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m23.2/23.2 MB\u001b[0m \u001b[31m38.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hRequirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from torch==1.9.0+cu111) (4.2.0)\nRequirement already satisfied: pillow&gt;=5.3.0 in /usr/local/lib/python3.7/dist-packages (from torchvision==0.10.0+cu111) (7.1.2)\nRequirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from torchvision==0.10.0+cu111) (1.21.6)\nInstalling collected packages: torch, torchvision\n  Attempting uninstall: torch\n    Found existing installation: torch 1.11.0+cu113\n    Uninstalling torch-1.11.0+cu113:\n      Successfully uninstalled torch-1.11.0+cu113\n  Attempting uninstall: torchvision\n    Found existing installation: torchvision 0.12.0+cu113\n    Uninstalling torchvision-0.12.0+cu113:\n      Successfully uninstalled torchvision-0.12.0+cu113\n\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\ntorchtext 0.12.0 requires torch==1.11.0, but you have torch 1.9.0+cu111 which is incompatible.\ntorchaudio 0.11.0+cu113 requires torch==1.11.0, but you have torch 1.9.0+cu111 which is incompatible.\u001b[0m\u001b[31m\n\u001b[0mSuccessfully installed torch-1.9.0+cu111 torchvision-0.10.0+cu111\n\u001b[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\u001b[0m\u001b[33m\n\u001b[0mLooking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\nLooking in links: https://download.openmmlab.com/mmcv/dist/cu111/torch1.9.0/index.html\nCollecting mmcv-full\n  Downloading https://download.openmmlab.com/mmcv/dist/cu111/torch1.9.0/mmcv_full-1.5.2-cp37-cp37m-manylinux1_x86_64.whl (45.6 MB)\n\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m45.6/45.6 MB\u001b[0m \u001b[31m7.8 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hCollecting addict\n  Downloading addict-2.4.0-py3-none-any.whl (3.8 kB)\nRequirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (21.3)\nRequirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (1.21.6)\nCollecting yapf\n  Downloading yapf-0.32.0-py2.py3-none-any.whl (190 kB)\n\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m190.2/190.2 kB\u001b[0m \u001b[31m6.0 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hRequirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (3.13)\nRequirement already satisfied: opencv-python&gt;=3 in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (4.1.2.30)\nRequirement already satisfied: Pillow in /usr/local/lib/python3.7/dist-packages (from mmcv-full) (7.1.2)\nRequirement already satisfied: pyparsing!=3.0.5,&gt;=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging-&gt;mmcv-full) (3.0.9)\nInstalling collected packages: yapf, addict, mmcv-full\nSuccessfully installed addict-2.4.0 mmcv-full-1.5.2 yapf-0.32.0\n\u001b[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\u001b[0m\u001b[33m\n\u001b[0mLooking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\nCollecting openmim\n  Downloading openmim-0.1.5.tar.gz (35 kB)\n  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25hdone\nRequirement already satisfied: Click==7.1.2 in /usr/local/lib/python3.7/dist-packages (from openmim) (7.1.2)\nCollecting colorama\n  Downloading colorama-0.4.4-py2.py3-none-any.whl (16 kB)\nRequirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from openmim) (2.23.0)\nCollecting model-index\n  Downloading model_index-0.1.11-py3-none-any.whl (34 kB)\nRequirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from openmim) (1.3.5)\nRequirement already satisfied: tabulate in /usr/local/lib/python3.7/dist-packages (from openmim) (0.8.9)\nRequirement already satisfied: markdown in /usr/local/lib/python3.7/dist-packages (from model-index-&gt;openmim) (3.3.7)\nRequirement already satisfied: pyyaml in /usr/local/lib/python3.7/dist-packages (from model-index-&gt;openmim) (3.13)\nCollecting ordered-set\n  Downloading ordered_set-4.1.0-py3-none-any.whl (7.6 kB)\nRequirement already satisfied: python-dateutil&gt;=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;openmim) (2.8.2)\nRequirement already satisfied: numpy&gt;=1.17.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;openmim) (1.21.6)\nRequirement already satisfied: pytz&gt;=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas-&gt;openmim) (2022.1)\nRequirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;openmim) (2022.5.18.1)\nRequirement already satisfied: idna&lt;3,&gt;=2.5 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;openmim) (2.10)\nRequirement already satisfied: urllib3!=1.25.0,!=1.25.1,&lt;1.26,&gt;=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;openmim) (1.24.3)\nRequirement already satisfied: chardet&lt;4,&gt;=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests-&gt;openmim) (3.0.4)\nRequirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.7.3-&gt;pandas-&gt;openmim) (1.15.0)\nRequirement already satisfied: importlib-metadata&gt;=4.4 in /usr/local/lib/python3.7/dist-packages (from markdown-&gt;model-index-&gt;openmim) (4.11.4)\nRequirement already satisfied: typing-extensions&gt;=3.6.4 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata&gt;=4.4-&gt;markdown-&gt;model-index-&gt;openmim) (4.2.0)\nRequirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata&gt;=4.4-&gt;markdown-&gt;model-index-&gt;openmim) (3.8.0)\nBuilding wheels for collected packages: openmim\n  Building wheel for openmim (setup.py) ... \u001b[?25l\u001b[?25hdone\n  Created wheel for openmim: filename=openmim-0.1.5-py2.py3-none-any.whl size=42503 sha256=a20baa555947a826ad1fb5c6b5c7282eb538ed92cf4e3dfec2f7eb3044005554\n  Stored in directory: /root/.cache/pip/wheels/16/8b/e1/bdebbbc687aa50224a5ce46fe97a040a0c59f92b34bfc750b6\nSuccessfully built openmim\nInstalling collected packages: ordered-set, colorama, model-index, openmim\nSuccessfully installed colorama-0.4.4 model-index-0.1.11 openmim-0.1.5 ordered-set-4.1.0\n\u001b[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\u001b[0m\u001b[33m\n\u001b[0mLooking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\nCollecting mmsegmentation\n  Downloading mmsegmentation-0.25.0-py3-none-any.whl (804 kB)\n\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m805.0/805.0 kB\u001b[0m \u001b[31m14.6 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hRequirement already satisfied: prettytable in /usr/local/lib/python3.7/dist-packages (from mmsegmentation) (3.3.0)\nRequirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from mmsegmentation) (21.3)\nRequirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from mmsegmentation) (3.2.2)\nRequirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from mmsegmentation) (1.21.6)\nCollecting mmcls&gt;=0.20.1\n  Downloading mmcls-0.23.1-py2.py3-none-any.whl (577 kB)\n\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m577.3/577.3 kB\u001b[0m \u001b[31m53.2 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hRequirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;mmsegmentation) (1.4.2)\nRequirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;mmsegmentation) (0.11.0)\nRequirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;mmsegmentation) (3.0.9)\nRequirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;mmsegmentation) (2.8.2)\nRequirement already satisfied: wcwidth in /usr/local/lib/python3.7/dist-packages (from prettytable-&gt;mmsegmentation) (0.2.5)\nRequirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from prettytable-&gt;mmsegmentation) (4.11.4)\nRequirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver&gt;=1.0.1-&gt;matplotlib-&gt;mmsegmentation) (4.2.0)\nRequirement already satisfied: six&gt;=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil&gt;=2.1-&gt;matplotlib-&gt;mmsegmentation) (1.15.0)\nRequirement already satisfied: zipp&gt;=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata-&gt;prettytable-&gt;mmsegmentation) (3.8.0)\nInstalling collected packages: mmcls, mmsegmentation\nSuccessfully installed mmcls-0.23.1 mmsegmentation-0.25.0\n\u001b[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\u001b[0m\u001b[33m\n\u001b[0mLooking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\nCollecting mmdet\n  Downloading mmdet-2.25.0-py3-none-any.whl (1.4 MB)\n\u001b[2K     \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.4/1.4 MB\u001b[0m \u001b[31m21.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n\u001b[?25hRequirement already satisfied: matplotlib in /usr/local/lib/python3.7/dist-packages (from mmdet) (3.2.2)\nRequirement already satisfied: pycocotools in /usr/local/lib/python3.7/dist-packages (from mmdet) (2.0.4)\nRequirement already satisfied: six in /usr/local/lib/python3.7/dist-packages (from mmdet) (1.15.0)\nCollecting terminaltables\n  Downloading terminaltables-3.1.10-py2.py3-none-any.whl (15 kB)\nRequirement already satisfied: numpy in /usr/local/lib/python3.7/dist-packages (from mmdet) (1.21.6)\nRequirement already satisfied: pyparsing!=2.0.4,!=2.1.2,!=2.1.6,&gt;=2.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;mmdet) (3.0.9)\nRequirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;mmdet) (1.4.2)\nRequirement already satisfied: python-dateutil&gt;=2.1 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;mmdet) (2.8.2)\nRequirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.7/dist-packages (from matplotlib-&gt;mmdet) (0.11.0)\nRequirement already satisfied: typing-extensions in /usr/local/lib/python3.7/dist-packages (from kiwisolver&gt;=1.0.1-&gt;matplotlib-&gt;mmdet) (4.2.0)\nInstalling collected packages: terminaltables, mmdet\nSuccessfully installed mmdet-2.25.0 terminaltables-3.1.10\n\u001b[33mWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\u001b[0m\u001b[33m\n\u001b[0mCloning into 'mmdetection'...\nremote: Enumerating objects: 24927, done.\u001b[K\nremote: Counting objects: 100% (11/11), done.\u001b[K\nremote: Compressing objects: 100% (10/10), done.\u001b[K\nremote: Total 24927 (delta 2), reused 8 (delta 1), pack-reused 24916\u001b[K\nReceiving objects: 100% (24927/24927), 37.75 MiB | 31.35 MiB/s, done.\nResolving deltas: 100% (17469/17469), done.\n/content/mmdetection\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 验证安装</span></span><br><span class=\"line\">!nvcc -V</span><br><span class=\"line\">!pip <span class=\"built_in\">list</span> | grep mm</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> mmcv <span class=\"keyword\">import</span> collect_env</span><br><span class=\"line\">collect_env()</span><br></pre></td></tr></table></figure>\n<pre><code>nvcc: NVIDIA (R) Cuda compiler driver\nCopyright (c) 2005-2020 NVIDIA Corporation\nBuilt on Mon_Oct_12_20:09:46_PDT_2020\nCuda compilation tools, release 11.1, V11.1.105\nBuild cuda_11.1.TC455_06.29190527_0\ncommunity                     1.0.0b1\ngoogleapis-common-protos      1.56.2\nmmcls                         0.23.1\nmmcv-full                     1.5.2\nmmdet                         2.25.0\nmmsegmentation                0.25.0\npyviz-comms                   2.2.0\nsnowballstemmer               2.2.0\ntorchsummary                  1.5.1\n\n\n\n\n\n&#123;'CUDA available': True,\n 'CUDA_HOME': '/usr/local/cuda',\n 'GCC': 'x86_64-linux-gnu-gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0',\n 'GPU 0': 'Tesla T4',\n 'MMCV': '1.5.2',\n 'MMCV CUDA Compiler': '11.1',\n 'MMCV Compiler': 'GCC 7.3',\n 'NVCC': 'Cuda compilation tools, release 11.1, V11.1.105',\n 'OpenCV': '4.1.2',\n 'PyTorch': '1.9.0+cu111',\n 'PyTorch compiling details': 'PyTorch built with:\\n  - GCC 7.3\\n  - C++ Version: 201402\\n  - Intel(R) Math Kernel Library Version 2020.0.0 Product Build 20191122 for Intel(R) 64 architecture applications\\n  - Intel(R) MKL-DNN v2.1.2 (Git Hash 98be7e8afa711dc9b66c8ff3504129cb82013cdb)\\n  - OpenMP 201511 (a.k.a. OpenMP 4.5)\\n  - NNPACK is enabled\\n  - CPU capability usage: AVX2\\n  - CUDA Runtime 11.1\\n  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86\\n  - CuDNN 8.0.5\\n  - Magma 2.5.2\\n  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.1, CUDNN_VERSION=8.0.5, CXX_COMPILER=/opt/rh/devtoolset-7/root/usr/bin/c++, CXX_FLAGS= -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-sign-compare -Wno-unused-parameter -Wno-unused-variable -Wno-unused-function -Wno-unused-result -Wno-unused-local-typedefs -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.9.0, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, \\n',\n 'Python': '3.7.13 (default, Apr 24 2022, 01:04:09) [GCC 7.5.0]',\n 'TorchVision': '0.10.0+cu111',\n 'sys.platform': 'linux'&#125;\n</code></pre>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"测试-5\">测试</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># mim 也可以用来search/download,不过 doc 在捉迷藏..不知道怎么用</span></span><br><span class=\"line\"><span class=\"comment\"># https://github.com/open-mmlab/mmdetection/tree/master/configs/mask_rcnn</span></span><br><span class=\"line\"><span class=\"comment\"># 跟教程一样的命令...失效了?</span></span><br><span class=\"line\"><span class=\"comment\"># !mim search mmdet --model &#x27;mask r-cnn&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># !mim download mmdet --config mask_rcnn_r50_fpn_2x_coco --dest ./_model</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 下载并分别测试下面两个 pre-trained model-checkpoints</span></span><br><span class=\"line\">!mkdir checkpoints</span><br><span class=\"line\">!wget -c https://download.openmmlab.com/mmdetection/v2<span class=\"number\">.0</span>/mask_rcnn/mask_rcnn_r50_fpn_2x_coco/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-<span class=\"number\">0.392</span>__segm_mAP-<span class=\"number\">0.354_20200505_003907</span>-3e542a40.pth \\</span><br><span class=\"line\">      -O checkpoints/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-<span class=\"number\">0.392</span>__segm_mAP-<span class=\"number\">0.354_20200505_003907</span>-3e542a40.pth</span><br><span class=\"line\">!wget -c https://download.openmmlab.com/mmdetection/v2<span class=\"number\">.0</span>/faster_rcnn/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth \\</span><br><span class=\"line\">      -O checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>--2022-06-07 15:03:24--  https://download.openmmlab.com/mmdetection/v2.0/mask_rcnn/mask_rcnn_r50_fpn_2x_coco/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-0.392__segm_mAP-0.354_20200505_003907-3e542a40.pth\nResolving download.openmmlab.com (download.openmmlab.com)... 47.252.96.28\nConnecting to download.openmmlab.com (download.openmmlab.com)|47.252.96.28|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 177866862 (170M) [application/octet-stream]\nSaving to: ‘checkpoints/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-0.392__segm_mAP-0.354_20200505_003907-3e542a40.pth’\n\ncheckpoints/mask_rc 100%[===================&gt;] 169.63M  8.23MB/s    in 22s     \n\n2022-06-07 15:03:47 (7.65 MB/s) - ‘checkpoints/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-0.392__segm_mAP-0.354_20200505_003907-3e542a40.pth’ saved [177866862/177866862]\n\n--2022-06-07 15:03:48--  https://download.openmmlab.com/mmdetection/v2.0/faster_rcnn/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth\nResolving download.openmmlab.com (download.openmmlab.com)... 47.252.96.28\nConnecting to download.openmmlab.com (download.openmmlab.com)|47.252.96.28|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 167291982 (160M) [application/octet-stream]\nSaving to: ‘checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth’\n\ncheckpoints/faster_ 100%[===================&gt;] 159.54M  9.11MB/s    in 18s     \n\n2022-06-07 15:04:06 (9.04 MB/s) - ‘checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth’ saved [167291982/167291982]\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> mmdet.apis <span class=\"keyword\">import</span> init_detector, inference_detector, show_result_pyplot</span><br><span class=\"line\"></span><br><span class=\"line\">config = <span class=\"string\">&#x27;configs/mask_rcnn/mask_rcnn_r50_fpn_2x_coco.py&#x27;</span></span><br><span class=\"line\">checkpoint = <span class=\"string\">&#x27;checkpoints/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-0.392__segm_mAP-0.354_20200505_003907-3e542a40.pth&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 在 CPU 上需要设置 device=&#x27;cpu&#x27; ; GPU 上设置 device=&#x27;cuda:0&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># 使用 mmdetection 源库自带的 demo/demo.jpg</span></span><br><span class=\"line\">model = init_detector(config, checkpoint, device=<span class=\"string\">&#x27;cuda:0&#x27;</span>) </span><br><span class=\"line\">result = inference_detector(model, <span class=\"string\">&#x27;demo/demo.jpg&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">show_result_pyplot(model, <span class=\"string\">&#x27;demo/demo.jpg&#x27;</span>, result)</span><br></pre></td></tr></table></figure>\n<pre><code>load checkpoint from local path: checkpoints/mask_rcnn_r50_fpn_2x_coco_bbox_mAP-0.392__segm_mAP-0.354_20200505_003907-3e542a40.pth\n\n\n/content/mmdetection/mmdet/datasets/utils.py:70: UserWarning: &quot;ImageToTensor&quot; pipeline is replaced by &quot;DefaultFormatBundle&quot; for batch inference. It is recommended to manually replace it in the test data pipeline in your config file.\n  'data pipeline in your config file.', UserWarning)\n/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)\n  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)\n</code></pre>\n<p><img src=\"MM-Detection_files/MM-Detection_7_2.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> mmcv</span><br><span class=\"line\"><span class=\"keyword\">from</span> mmcv.runner <span class=\"keyword\">import</span> load_checkpoint</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> mmdet.apis <span class=\"keyword\">import</span> inference_detector, show_result_pyplot</span><br><span class=\"line\"><span class=\"keyword\">from</span> mmdet.models <span class=\"keyword\">import</span> build_detector</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Choose to use a config and initialize the detector</span></span><br><span class=\"line\">config = <span class=\"string\">&#x27;configs/faster_rcnn/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco.py&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># Setup a checkpoint file to load</span></span><br><span class=\"line\">checkpoint = <span class=\"string\">&#x27;checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Set the device to be used for evaluation</span></span><br><span class=\"line\">device=<span class=\"string\">&#x27;cuda:0&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Load the config</span></span><br><span class=\"line\">config = mmcv.Config.fromfile(config)</span><br><span class=\"line\"><span class=\"comment\"># Set pretrained to be None since we do not need pretrained model here</span></span><br><span class=\"line\">config.model.pretrained = <span class=\"literal\">None</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Initialize the detector</span></span><br><span class=\"line\">model = build_detector(config.model)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Load checkpoint</span></span><br><span class=\"line\">checkpoint = load_checkpoint(model, checkpoint, map_location=device)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Set the classes of models for inference</span></span><br><span class=\"line\">model.CLASSES = checkpoint[<span class=\"string\">&#x27;meta&#x27;</span>][<span class=\"string\">&#x27;CLASSES&#x27;</span>]</span><br><span class=\"line\"><span class=\"comment\"># We need to set the model&#x27;s cfg for inference</span></span><br><span class=\"line\">model.cfg = config</span><br><span class=\"line\"><span class=\"comment\"># Convert the model to GPU</span></span><br><span class=\"line\">model.to(device)</span><br><span class=\"line\"><span class=\"comment\"># Convert the model into evaluation mode</span></span><br><span class=\"line\">model.<span class=\"built_in\">eval</span>()</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Use the detector to do inference</span></span><br><span class=\"line\">img = <span class=\"string\">&#x27;demo/demo.jpg&#x27;</span></span><br><span class=\"line\">result = inference_detector(model, img)</span><br><span class=\"line\"><span class=\"comment\"># Let&#x27;s plot the result</span></span><br><span class=\"line\">show_result_pyplot(model, img, result, score_thr=<span class=\"number\">0.3</span>)</span><br></pre></td></tr></table></figure>\n<pre><code>load checkpoint from local path: checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth\n\n\n/content/mmdetection/mmdet/datasets/utils.py:70: UserWarning: &quot;ImageToTensor&quot; pipeline is replaced by &quot;DefaultFormatBundle&quot; for batch inference. It is recommended to manually replace it in the test data pipeline in your config file.\n  'data pipeline in your config file.', UserWarning)\n/usr/local/lib/python3.7/dist-packages/torch/nn/functional.py:718: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)\n  return torch.max_pool2d(input, kernel_size, stride, padding, dilation, ceil_mode)\n</code></pre>\n<p><img src=\"MM-Detection_files/MM-Detection_8_2.png\" alt=\"png\"></p>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"Custom-training\">Custom-training</h2>\n<ol>\n<li>\n<p>选择+下载预训练模型和数据集</p>\n<p>参数解释: <code>mask_rcnn_r50_fpn_2x_coco</code></p>\n<p>mask_rcnn 中不同的 backbone (主干网络)</p>\n<p>r50: 50层ResNet</p>\n<p>fpn: 特征金字塔</p>\n<p>2x: learning rate schedule</p>\n</li>\n<li>\n<p>定义数据集类 + config</p>\n</li>\n<li>\n<p>调用 API 训练 + 评估</p>\n</li>\n<li>\n<p>用训练好的模型推理测试</p>\n</li>\n</ol>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># pre-trained model 在上面下载好了, 这里只下载数据集</span></span><br><span class=\"line\">!wget https://download.openmmlab.com/mmdetection/data/kitti_tiny.<span class=\"built_in\">zip</span></span><br><span class=\"line\">!unzip kitti_tiny.<span class=\"built_in\">zip</span> &gt; /dev/null</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Let&#x27;s take a look at the dataset image</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> mmcv</span><br><span class=\"line\"><span class=\"keyword\">import</span> matplotlib.pyplot <span class=\"keyword\">as</span> plt</span><br><span class=\"line\"></span><br><span class=\"line\">img = mmcv.imread(<span class=\"string\">&#x27;kitti_tiny/training/image_2/000073.jpeg&#x27;</span>)</span><br><span class=\"line\">plt.figure(figsize=(<span class=\"number\">15</span>, <span class=\"number\">10</span>))</span><br><span class=\"line\">plt.imshow(mmcv.bgr2rgb(img))</span><br><span class=\"line\">plt.show()</span><br></pre></td></tr></table></figure>\n<pre><code>--2022-06-07 15:40:35--  https://download.openmmlab.com/mmdetection/data/kitti_tiny.zip\nResolving download.openmmlab.com (download.openmmlab.com)... 47.252.96.28\nConnecting to download.openmmlab.com (download.openmmlab.com)|47.252.96.28|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 6918271 (6.6M) [application/zip]\nSaving to: ‘kitti_tiny.zip’\n\nkitti_tiny.zip      100%[===================&gt;]   6.60M  8.72MB/s    in 0.8s    \n\n2022-06-07 15:40:37 (8.72 MB/s) - ‘kitti_tiny.zip’ saved [6918271/6918271]\n</code></pre>\n<p><img src=\"MM-Detection_files/MM-Detection_10_1.png\" alt=\"png\"></p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 自定义数据集格式 &#x27;KittiTinyDataset&#x27; 并注册到 mmdet</span></span><br><span class=\"line\"><span class=\"keyword\">import</span> copy</span><br><span class=\"line\"><span class=\"keyword\">import</span> os.path <span class=\"keyword\">as</span> osp</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">import</span> mmcv</span><br><span class=\"line\"><span class=\"keyword\">import</span> numpy <span class=\"keyword\">as</span> np</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">from</span> mmdet.datasets.builder <span class=\"keyword\">import</span> DATASETS</span><br><span class=\"line\"><span class=\"keyword\">from</span> mmdet.datasets.custom <span class=\"keyword\">import</span> CustomDataset</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@DATASETS.register_module()</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">KittiTinyDataset</span>(<span class=\"title class_ inherited__\">CustomDataset</span>):</span><br><span class=\"line\"></span><br><span class=\"line\">    CLASSES = (<span class=\"string\">&#x27;Car&#x27;</span>, <span class=\"string\">&#x27;Pedestrian&#x27;</span>, <span class=\"string\">&#x27;Cyclist&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">def</span> <span class=\"title function_\">load_annotations</span>(<span class=\"params\">self, ann_file</span>):</span><br><span class=\"line\">        cat2label = &#123;k: i <span class=\"keyword\">for</span> i, k <span class=\"keyword\">in</span> <span class=\"built_in\">enumerate</span>(self.CLASSES)&#125;</span><br><span class=\"line\">        <span class=\"comment\"># load image list from file</span></span><br><span class=\"line\">        image_list = mmcv.list_from_file(self.ann_file)</span><br><span class=\"line\">    </span><br><span class=\"line\">        data_infos = []</span><br><span class=\"line\">        <span class=\"comment\"># convert annotations to middle format</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> image_id <span class=\"keyword\">in</span> image_list:</span><br><span class=\"line\">            filename = <span class=\"string\">f&#x27;<span class=\"subst\">&#123;self.img_prefix&#125;</span>/<span class=\"subst\">&#123;image_id&#125;</span>.jpeg&#x27;</span></span><br><span class=\"line\">            image = mmcv.imread(filename)</span><br><span class=\"line\">            height, width = image.shape[:<span class=\"number\">2</span>]</span><br><span class=\"line\">    </span><br><span class=\"line\">            data_info = <span class=\"built_in\">dict</span>(filename=<span class=\"string\">f&#x27;<span class=\"subst\">&#123;image_id&#125;</span>.jpeg&#x27;</span>, width=width, height=height)</span><br><span class=\"line\">    </span><br><span class=\"line\">            <span class=\"comment\"># load annotations</span></span><br><span class=\"line\">            label_prefix = self.img_prefix.replace(<span class=\"string\">&#x27;image_2&#x27;</span>, <span class=\"string\">&#x27;label_2&#x27;</span>)</span><br><span class=\"line\">            lines = mmcv.list_from_file(osp.join(label_prefix, <span class=\"string\">f&#x27;<span class=\"subst\">&#123;image_id&#125;</span>.txt&#x27;</span>))</span><br><span class=\"line\">    </span><br><span class=\"line\">            content = [line.strip().split(<span class=\"string\">&#x27; &#x27;</span>) <span class=\"keyword\">for</span> line <span class=\"keyword\">in</span> lines]</span><br><span class=\"line\">            bbox_names = [x[<span class=\"number\">0</span>] <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> content]</span><br><span class=\"line\">            bboxes = [[<span class=\"built_in\">float</span>(info) <span class=\"keyword\">for</span> info <span class=\"keyword\">in</span> x[<span class=\"number\">4</span>:<span class=\"number\">8</span>]] <span class=\"keyword\">for</span> x <span class=\"keyword\">in</span> content]</span><br><span class=\"line\">    </span><br><span class=\"line\">            gt_bboxes = []</span><br><span class=\"line\">            gt_labels = []</span><br><span class=\"line\">            gt_bboxes_ignore = []</span><br><span class=\"line\">            gt_labels_ignore = []</span><br><span class=\"line\">    </span><br><span class=\"line\">            <span class=\"comment\"># filter &#x27;DontCare&#x27;</span></span><br><span class=\"line\">            <span class=\"keyword\">for</span> bbox_name, bbox <span class=\"keyword\">in</span> <span class=\"built_in\">zip</span>(bbox_names, bboxes):</span><br><span class=\"line\">                <span class=\"keyword\">if</span> bbox_name <span class=\"keyword\">in</span> cat2label:</span><br><span class=\"line\">                    gt_labels.append(cat2label[bbox_name])</span><br><span class=\"line\">                    gt_bboxes.append(bbox)</span><br><span class=\"line\">                <span class=\"keyword\">else</span>:</span><br><span class=\"line\">                    gt_labels_ignore.append(-<span class=\"number\">1</span>)</span><br><span class=\"line\">                    gt_bboxes_ignore.append(bbox)</span><br><span class=\"line\"></span><br><span class=\"line\">            data_anno = <span class=\"built_in\">dict</span>(</span><br><span class=\"line\">                bboxes=np.array(gt_bboxes, dtype=np.float32).reshape(-<span class=\"number\">1</span>, <span class=\"number\">4</span>),</span><br><span class=\"line\">                labels=np.array(gt_labels, dtype=np.long),</span><br><span class=\"line\">                bboxes_ignore=np.array(gt_bboxes_ignore,</span><br><span class=\"line\">                                       dtype=np.float32).reshape(-<span class=\"number\">1</span>, <span class=\"number\">4</span>),</span><br><span class=\"line\">                labels_ignore=np.array(gt_labels_ignore, dtype=np.long))</span><br><span class=\"line\"></span><br><span class=\"line\">            data_info.update(ann=data_anno)</span><br><span class=\"line\">            data_infos.append(data_info)</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">return</span> data_infos</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># mmdet 配置</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> mmcv <span class=\"keyword\">import</span> Config</span><br><span class=\"line\"><span class=\"keyword\">from</span> mmdet.apis <span class=\"keyword\">import</span> set_random_seed</span><br><span class=\"line\"></span><br><span class=\"line\">cfg = Config.fromfile(<span class=\"string\">&#x27;configs/faster_rcnn/faster_rcnn_r50_caffe_fpn_mstrain_1x_coco.py&#x27;</span>)</span><br><span class=\"line\"><span class=\"comment\"># If we need to finetune a model based on a pre-trained detector, we need to use load_from to set the path of checkpoints.</span></span><br><span class=\"line\">cfg.load_from = <span class=\"string\">&#x27;checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Modify dataset type and path</span></span><br><span class=\"line\">cfg.dataset_type = <span class=\"string\">&#x27;KittiTinyDataset&#x27;</span></span><br><span class=\"line\">cfg.data_root = <span class=\"string\">&#x27;kitti_tiny/&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">cfg.data.test.<span class=\"built_in\">type</span> = <span class=\"string\">&#x27;KittiTinyDataset&#x27;</span></span><br><span class=\"line\">cfg.data.test.data_root = <span class=\"string\">&#x27;kitti_tiny/&#x27;</span></span><br><span class=\"line\">cfg.data.test.ann_file = <span class=\"string\">&#x27;train.txt&#x27;</span></span><br><span class=\"line\">cfg.data.test.img_prefix = <span class=\"string\">&#x27;training/image_2&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">cfg.data.train.<span class=\"built_in\">type</span> = <span class=\"string\">&#x27;KittiTinyDataset&#x27;</span></span><br><span class=\"line\">cfg.data.train.data_root = <span class=\"string\">&#x27;kitti_tiny/&#x27;</span></span><br><span class=\"line\">cfg.data.train.ann_file = <span class=\"string\">&#x27;train.txt&#x27;</span></span><br><span class=\"line\">cfg.data.train.img_prefix = <span class=\"string\">&#x27;training/image_2&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\">cfg.data.val.<span class=\"built_in\">type</span> = <span class=\"string\">&#x27;KittiTinyDataset&#x27;</span></span><br><span class=\"line\">cfg.data.val.data_root = <span class=\"string\">&#x27;kitti_tiny/&#x27;</span></span><br><span class=\"line\">cfg.data.val.ann_file = <span class=\"string\">&#x27;val.txt&#x27;</span></span><br><span class=\"line\">cfg.data.val.img_prefix = <span class=\"string\">&#x27;training/image_2&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># modify num classes of the model in box head</span></span><br><span class=\"line\">cfg.model.roi_head.bbox_head.num_classes = <span class=\"number\">3</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Set up working dir to save files and logs.</span></span><br><span class=\"line\">cfg.work_dir = <span class=\"string\">&#x27;./tutorial_exps&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># The original learning rate (LR) is set for 8-GPU training.</span></span><br><span class=\"line\"><span class=\"comment\"># We divide it by 8 since we only use one GPU.</span></span><br><span class=\"line\">cfg.optimizer.lr = <span class=\"number\">0.02</span> / <span class=\"number\">8</span></span><br><span class=\"line\">cfg.lr_config.warmup = <span class=\"literal\">None</span></span><br><span class=\"line\">cfg.log_config.interval = <span class=\"number\">10</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Change the evaluation metric since we use customized dataset.</span></span><br><span class=\"line\">cfg.evaluation.metric = <span class=\"string\">&#x27;mAP&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># We can set the evaluation interval to reduce the evaluation times</span></span><br><span class=\"line\">cfg.evaluation.interval = <span class=\"number\">12</span></span><br><span class=\"line\"><span class=\"comment\"># We can set the checkpoint saving interval to reduce the storage cost</span></span><br><span class=\"line\">cfg.checkpoint_config.interval = <span class=\"number\">12</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Set seed thus the results are more reproducible</span></span><br><span class=\"line\">cfg.seed = <span class=\"number\">0</span></span><br><span class=\"line\">set_random_seed(<span class=\"number\">0</span>, deterministic=<span class=\"literal\">False</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">cfg.device=<span class=\"string\">&#x27;cuda&#x27;</span></span><br><span class=\"line\">cfg.gpu_ids = <span class=\"built_in\">range</span>(<span class=\"number\">1</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># We can also use tensorboard to log the training process</span></span><br><span class=\"line\">cfg.log_config.hooks = [</span><br><span class=\"line\">    <span class=\"built_in\">dict</span>(<span class=\"built_in\">type</span>=<span class=\"string\">&#x27;TextLoggerHook&#x27;</span>),</span><br><span class=\"line\">    <span class=\"built_in\">dict</span>(<span class=\"built_in\">type</span>=<span class=\"string\">&#x27;TensorboardLoggerHook&#x27;</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># We can initialize the logger for training and have a look at the final config used for training</span></span><br><span class=\"line\"><span class=\"comment\"># print(f&#x27;Config:\\n&#123;cfg.pretty_text&#125;&#x27;)</span></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># Train a new detector</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> mmdet.datasets <span class=\"keyword\">import</span> build_dataset</span><br><span class=\"line\"><span class=\"keyword\">from</span> mmdet.models <span class=\"keyword\">import</span> build_detector</span><br><span class=\"line\"><span class=\"keyword\">from</span> mmdet.apis <span class=\"keyword\">import</span> train_detector</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Build dataset</span></span><br><span class=\"line\">datasets = [build_dataset(cfg.data.train)]</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Build the detector</span></span><br><span class=\"line\">model = build_detector(cfg.model)</span><br><span class=\"line\"><span class=\"comment\">#  build_detector( cfg.model, train_cfg=cfg.get(&#x27;train_cfg&#x27;), test_cfg=cfg.get(&#x27;test_cfg&#x27;))</span></span><br><span class=\"line\"><span class=\"comment\"># Add an attribute for visualization convenience</span></span><br><span class=\"line\">model.CLASSES = datasets[<span class=\"number\">0</span>].CLASSES</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># Create work_dir</span></span><br><span class=\"line\">mmcv.mkdir_or_exist(osp.abspath(cfg.work_dir))</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 报错:AttributeError: &#x27;ConfigDict&#x27; object has no attribute &#x27;device&#x27;</span></span><br><span class=\"line\"><span class=\"comment\"># https://github.com/open-mmlab/mmdetection/issues/7901</span></span><br><span class=\"line\"><span class=\"comment\"># 在上面 cfg 添加了 cfg.device=&#x27;cuda&#x27;</span></span><br><span class=\"line\">train_detector(model, datasets, cfg, distributed=<span class=\"literal\">False</span>, validate=<span class=\"literal\">True</span>)</span><br></pre></td></tr></table></figure>\n<pre><code>/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:54: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.\nDeprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\n/usr/local/lib/python3.7/dist-packages/ipykernel_launcher.py:57: DeprecationWarning: `np.long` is a deprecated alias for `np.compat.long`. To silence this warning, use `np.compat.long` by itself. In the likely event your code does not need to work on Python 2 you can use the builtin `int` for which `np.compat.long` is itself an alias. Doing this will not modify any behaviour and is safe. When replacing `np.long`, you may wish to use e.g. `np.int64` or `np.int32` to specify the precision. If you wish to review your current use, check the release note link for additional information.\nDeprecated in NumPy 1.20; for more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations\n/content/mmdetection/mmdet/datasets/custom.py:180: UserWarning: CustomDataset does not support filtering empty gt images.\n  'CustomDataset does not support filtering empty gt images.')\n2022-06-07 16:41:00,736 - mmdet - INFO - Automatic scaling of learning rate (LR) has been disabled.\n2022-06-07 16:41:00,899 - mmdet - INFO - load checkpoint from local path: checkpoints/faster_rcnn_r50_caffe_fpn_mstrain_3x_coco_20210526_095054-1f77628b.pth\n2022-06-07 16:41:01,026 - mmdet - WARNING - The model and loaded state dict do not match exactly\n\nsize mismatch for roi_head.bbox_head.fc_cls.weight: copying a param with shape torch.Size([81, 1024]) from checkpoint, the shape in current model is torch.Size([4, 1024]).\nsize mismatch for roi_head.bbox_head.fc_cls.bias: copying a param with shape torch.Size([81]) from checkpoint, the shape in current model is torch.Size([4]).\nsize mismatch for roi_head.bbox_head.fc_reg.weight: copying a param with shape torch.Size([320, 1024]) from checkpoint, the shape in current model is torch.Size([12, 1024]).\nsize mismatch for roi_head.bbox_head.fc_reg.bias: copying a param with shape torch.Size([320]) from checkpoint, the shape in current model is torch.Size([12]).\n2022-06-07 16:41:01,035 - mmdet - INFO - Start running, host: root@7a73f7b358c4, work_dir: /content/mmdetection/tutorial_exps\n2022-06-07 16:41:01,037 - mmdet - INFO - Hooks will be executed in the following order:\nbefore_run:\n(VERY_HIGH   ) StepLrUpdaterHook                  \n(NORMAL      ) CheckpointHook                     \n(LOW         ) EvalHook                           \n(VERY_LOW    ) TextLoggerHook                     \n(VERY_LOW    ) TensorboardLoggerHook              \n -------------------- \nbefore_train_epoch:\n(VERY_HIGH   ) StepLrUpdaterHook                  \n(NORMAL      ) NumClassCheckHook                  \n(LOW         ) IterTimerHook                      \n(LOW         ) EvalHook                           \n(VERY_LOW    ) TextLoggerHook                     \n(VERY_LOW    ) TensorboardLoggerHook              \n -------------------- \nbefore_train_iter:\n(VERY_HIGH   ) StepLrUpdaterHook                  \n(LOW         ) IterTimerHook                      \n(LOW         ) EvalHook                           \n -------------------- \nafter_train_iter:\n(ABOVE_NORMAL) OptimizerHook                      \n(NORMAL      ) CheckpointHook                     \n(LOW         ) IterTimerHook                      \n(LOW         ) EvalHook                           \n(VERY_LOW    ) TextLoggerHook                     \n(VERY_LOW    ) TensorboardLoggerHook              \n -------------------- \nafter_train_epoch:\n(NORMAL      ) CheckpointHook                     \n(LOW         ) EvalHook                           \n(VERY_LOW    ) TextLoggerHook                     \n(VERY_LOW    ) TensorboardLoggerHook              \n -------------------- \nbefore_val_epoch:\n(NORMAL      ) NumClassCheckHook                  \n(LOW         ) IterTimerHook                      \n(VERY_LOW    ) TextLoggerHook                     \n(VERY_LOW    ) TensorboardLoggerHook              \n -------------------- \nbefore_val_iter:\n(LOW         ) IterTimerHook                      \n -------------------- \nafter_val_iter:\n(LOW         ) IterTimerHook                      \n -------------------- \nafter_val_epoch:\n(VERY_LOW    ) TextLoggerHook                     \n(VERY_LOW    ) TensorboardLoggerHook              \n -------------------- \nafter_run:\n(VERY_LOW    ) TextLoggerHook                     \n(VERY_LOW    ) TensorboardLoggerHook              \n -------------------- \n2022-06-07 16:41:01,038 - mmdet - INFO - workflow: [('train', 1)], max: 12 epochs\n2022-06-07 16:41:01,040 - mmdet - INFO - Checkpoints will be saved to /content/mmdetection/tutorial_exps by HardDiskBackend.\n2022-06-07 16:41:17,697 - mmdet - INFO - Epoch [1][10/25]\tlr: 2.500e-03, eta: 0:04:25, time: 0.914, data_time: 0.236, memory: 2790, loss_rpn_cls: 0.0267, loss_rpn_bbox: 0.0173, loss_cls: 0.5377, acc: 81.6211, loss_bbox: 0.3947, loss: 0.9764\n2022-06-07 16:41:21,039 - mmdet - INFO - Epoch [1][20/25]\tlr: 2.500e-03, eta: 0:02:54, time: 0.334, data_time: 0.023, memory: 2790, loss_rpn_cls: 0.0149, loss_rpn_bbox: 0.0119, loss_cls: 0.1753, acc: 93.4570, loss_bbox: 0.3254, loss: 0.5275\n2022-06-07 16:41:28,575 - mmdet - INFO - Epoch [2][10/25]\tlr: 2.500e-03, eta: 0:02:16, time: 0.558, data_time: 0.232, memory: 2790, loss_rpn_cls: 0.0167, loss_rpn_bbox: 0.0138, loss_cls: 0.1519, acc: 94.7656, loss_bbox: 0.2673, loss: 0.4497\n2022-06-07 16:41:31,944 - mmdet - INFO - Epoch [2][20/25]\tlr: 2.500e-03, eta: 0:02:01, time: 0.337, data_time: 0.023, memory: 2790, loss_rpn_cls: 0.0128, loss_rpn_bbox: 0.0127, loss_cls: 0.1325, acc: 94.9316, loss_bbox: 0.2084, loss: 0.3664\n2022-06-07 16:41:39,445 - mmdet - INFO - Epoch [3][10/25]\tlr: 2.500e-03, eta: 0:01:48, time: 0.569, data_time: 0.236, memory: 2790, loss_rpn_cls: 0.0059, loss_rpn_bbox: 0.0102, loss_cls: 0.0972, acc: 96.2500, loss_bbox: 0.1600, loss: 0.2733\n2022-06-07 16:41:42,958 - mmdet - INFO - Epoch [3][20/25]\tlr: 2.500e-03, eta: 0:01:40, time: 0.349, data_time: 0.024, memory: 2790, loss_rpn_cls: 0.0088, loss_rpn_bbox: 0.0133, loss_cls: 0.1474, acc: 94.4336, loss_bbox: 0.2652, loss: 0.4346\n2022-06-07 16:41:50,449 - mmdet - INFO - Epoch [4][10/25]\tlr: 2.500e-03, eta: 0:01:31, time: 0.562, data_time: 0.231, memory: 2790, loss_rpn_cls: 0.0064, loss_rpn_bbox: 0.0134, loss_cls: 0.1168, acc: 95.5566, loss_bbox: 0.2201, loss: 0.3567\n2022-06-07 16:41:53,973 - mmdet - INFO - Epoch [4][20/25]\tlr: 2.500e-03, eta: 0:01:25, time: 0.353, data_time: 0.027, memory: 2790, loss_rpn_cls: 0.0035, loss_rpn_bbox: 0.0117, loss_cls: 0.1179, acc: 95.5566, loss_bbox: 0.2133, loss: 0.3464\n2022-06-07 16:42:01,892 - mmdet - INFO - Epoch [5][10/25]\tlr: 2.500e-03, eta: 0:01:18, time: 0.595, data_time: 0.237, memory: 2790, loss_rpn_cls: 0.0040, loss_rpn_bbox: 0.0092, loss_cls: 0.1003, acc: 96.2695, loss_bbox: 0.2087, loss: 0.3223\n2022-06-07 16:42:05,430 - mmdet - INFO - Epoch [5][20/25]\tlr: 2.500e-03, eta: 0:01:13, time: 0.352, data_time: 0.024, memory: 2790, loss_rpn_cls: 0.0037, loss_rpn_bbox: 0.0107, loss_cls: 0.0903, acc: 96.7090, loss_bbox: 0.1845, loss: 0.2892\n2022-06-07 16:42:12,992 - mmdet - INFO - Epoch [6][10/25]\tlr: 2.500e-03, eta: 0:01:07, time: 0.567, data_time: 0.232, memory: 2790, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0082, loss_cls: 0.0786, acc: 97.1777, loss_bbox: 0.1799, loss: 0.2685\n2022-06-07 16:42:16,595 - mmdet - INFO - Epoch [6][20/25]\tlr: 2.500e-03, eta: 0:01:02, time: 0.363, data_time: 0.027, memory: 2790, loss_rpn_cls: 0.0029, loss_rpn_bbox: 0.0100, loss_cls: 0.0891, acc: 96.5332, loss_bbox: 0.1856, loss: 0.2876\n2022-06-07 16:42:24,486 - mmdet - INFO - Epoch [7][10/25]\tlr: 2.500e-03, eta: 0:00:56, time: 0.591, data_time: 0.238, memory: 2790, loss_rpn_cls: 0.0043, loss_rpn_bbox: 0.0096, loss_cls: 0.0904, acc: 96.6113, loss_bbox: 0.1740, loss: 0.2783\n2022-06-07 16:42:28,147 - mmdet - INFO - Epoch [7][20/25]\tlr: 2.500e-03, eta: 0:00:52, time: 0.364, data_time: 0.023, memory: 2790, loss_rpn_cls: 0.0019, loss_rpn_bbox: 0.0116, loss_cls: 0.0926, acc: 96.1816, loss_bbox: 0.1774, loss: 0.2835\n2022-06-07 16:42:35,802 - mmdet - INFO - Epoch [8][10/25]\tlr: 2.500e-03, eta: 0:00:45, time: 0.572, data_time: 0.232, memory: 2790, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0091, loss_cls: 0.0777, acc: 96.8262, loss_bbox: 0.1420, loss: 0.2314\n2022-06-07 16:42:39,346 - mmdet - INFO - Epoch [8][20/25]\tlr: 2.500e-03, eta: 0:00:41, time: 0.354, data_time: 0.025, memory: 2790, loss_rpn_cls: 0.0036, loss_rpn_bbox: 0.0082, loss_cls: 0.0777, acc: 97.2168, loss_bbox: 0.1590, loss: 0.2485\n2022-06-07 16:42:46,922 - mmdet - INFO - Epoch [9][10/25]\tlr: 2.500e-04, eta: 0:00:35, time: 0.565, data_time: 0.232, memory: 2790, loss_rpn_cls: 0.0026, loss_rpn_bbox: 0.0082, loss_cls: 0.0658, acc: 97.4902, loss_bbox: 0.1351, loss: 0.2116\n2022-06-07 16:42:50,443 - mmdet - INFO - Epoch [9][20/25]\tlr: 2.500e-04, eta: 0:00:31, time: 0.352, data_time: 0.024, memory: 2790, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0066, loss_cls: 0.0571, acc: 97.8418, loss_bbox: 0.1133, loss: 0.1783\n2022-06-07 16:42:58,001 - mmdet - INFO - Epoch [10][10/25]\tlr: 2.500e-04, eta: 0:00:25, time: 0.567, data_time: 0.233, memory: 2790, loss_rpn_cls: 0.0034, loss_rpn_bbox: 0.0081, loss_cls: 0.0678, acc: 97.3926, loss_bbox: 0.1332, loss: 0.2125\n2022-06-07 16:43:01,493 - mmdet - INFO - Epoch [10][20/25]\tlr: 2.500e-04, eta: 0:00:21, time: 0.350, data_time: 0.023, memory: 2790, loss_rpn_cls: 0.0008, loss_rpn_bbox: 0.0059, loss_cls: 0.0594, acc: 97.6758, loss_bbox: 0.1294, loss: 0.1955\n2022-06-07 16:43:09,042 - mmdet - INFO - Epoch [11][10/25]\tlr: 2.500e-04, eta: 0:00:15, time: 0.567, data_time: 0.234, memory: 2790, loss_rpn_cls: 0.0009, loss_rpn_bbox: 0.0069, loss_cls: 0.0638, acc: 97.6270, loss_bbox: 0.1217, loss: 0.1932\n2022-06-07 16:43:12,554 - mmdet - INFO - Epoch [11][20/25]\tlr: 2.500e-04, eta: 0:00:11, time: 0.351, data_time: 0.023, memory: 2790, loss_rpn_cls: 0.0014, loss_rpn_bbox: 0.0073, loss_cls: 0.0571, acc: 97.8711, loss_bbox: 0.1212, loss: 0.1869\n2022-06-07 16:43:20,107 - mmdet - INFO - Epoch [12][10/25]\tlr: 2.500e-05, eta: 0:00:05, time: 0.567, data_time: 0.232, memory: 2790, loss_rpn_cls: 0.0017, loss_rpn_bbox: 0.0061, loss_cls: 0.0563, acc: 97.9199, loss_bbox: 0.1246, loss: 0.1887\n2022-06-07 16:43:23,598 - mmdet - INFO - Epoch [12][20/25]\tlr: 2.500e-05, eta: 0:00:01, time: 0.349, data_time: 0.024, memory: 2790, loss_rpn_cls: 0.0016, loss_rpn_bbox: 0.0048, loss_cls: 0.0511, acc: 97.9297, loss_bbox: 0.0946, loss: 0.1520\n2022-06-07 16:43:25,323 - mmdet - INFO - Saving checkpoint at 12 epochs\n\n\n[&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;] 25/25, 9.8 task/s, elapsed: 3s, ETA:     0s\n---------------iou_thr: 0.5---------------\n\n\n2022-06-07 16:43:30,260 - mmdet - INFO - \n+------------+-----+------+--------+-------+\n| class      | gts | dets | recall | ap    |\n+------------+-----+------+--------+-------+\n| Car        | 62  | 133  | 0.984  | 0.888 |\n| Pedestrian | 13  | 40   | 0.846  | 0.768 |\n| Cyclist    | 7   | 50   | 0.571  | 0.114 |\n+------------+-----+------+--------+-------+\n| mAP        |     |      |        | 0.590 |\n+------------+-----+------+--------+-------+\n2022-06-07 16:43:30,268 - mmdet - INFO - Epoch(val) [12][25]\tAP50: 0.5900, mAP: 0.5899\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># load tensorboard in colab</span></span><br><span class=\"line\">%load_ext tensorboard</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># see curves in tensorboard</span></span><br><span class=\"line\">%tensorboard --logdir ./tutorial_exps</span><br></pre></td></tr></table></figure>\n<pre><code>&lt;IPython.core.display.Javascript object&gt;\n</code></pre>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">img = mmcv.imread(<span class=\"string\">&#x27;kitti_tiny/training/image_2/000068.jpeg&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">model.cfg = cfg</span><br><span class=\"line\">result = inference_detector(model, img)</span><br><span class=\"line\">show_result_pyplot(model, img, result)</span><br></pre></td></tr></table></figure>\n<p><img src=\"MM-Detection_files/MM-Detection_15_0.png\" alt=\"png\"></p>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表-37\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://openbayes.com/console/wrh/containers/t93t3LTXlgU\">https://openbayes.com/console/wrh/containers/t93t3LTXlgU</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://zhuanlan.zhihu.com/p/163645165\">MMDetection 2.3 安装教程</a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://mmdetection.readthedocs.io/zh_CN/latest/get_started.html#mmdetection\">https://mmdetection.readthedocs.io/zh_CN/latest/get_started.html#mmdetection</a></p>\n<p><a name='cite_note-4' href='#cite_ref-4'>[4]</a>: <a href=\"https://colab.research.google.com/github/ZwwWayne/mmdetection/blob/update-colab/demo/MMDet_Tutorial.ipynb#scrollTo=8M5KUnX7Np3h\">https://colab.research.google.com/github/ZwwWayne/mmdetection/blob/update-colab/demo/MMDet_Tutorial.ipynb#scrollTo=8M5KUnX7Np3h</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "深度学习",
                "colab",
                "mmdetection"
            ]
        },
        {
            "id": "https://weidows.github.io/post/python/code/DL/",
            "url": "https://weidows.github.io/post/python/code/DL/",
            "title": "👩‍❤️‍💋‍👨Code-4-Deep-Learning",
            "date_published": "2022-04-20T16:26:11.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2022-04-20 23:11:24\n * @FilePath: \\Blog-private\\scaffolds\\post.md\n * @Description:\n * @!: *********************************************************************\n-->\n<h2 id=\"序\">序</h2>\n<p>此文为其他文章的代码部分:</p>\n<blockquote>\n<p><a href=\"../../AI/DL\">⚡再啃-Deep-Learning</a></p>\n</blockquote>\n<p>也提供了 notebook 形式: <a href=\"https://github.com/Weidows-projects/public-post/blob/main/notebook/DL/DL.ipynb\">代码地址</a></p>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"神经网络\">神经网络</h2>\n<h3 id=\"感知器\">感知器</h3>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">AND</span>(<span class=\"params\">x1, x2</span>):</span><br><span class=\"line\">    w1, w2, theta = <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.7</span></span><br><span class=\"line\">    tmp = x1 * w1 + x2 * w2</span><br><span class=\"line\">    <span class=\"keyword\">if</span> tmp &lt;= theta:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">OR</span>(<span class=\"params\">x1, x2</span>):</span><br><span class=\"line\">    w1, w2, theta = <span class=\"number\">0.5</span>, <span class=\"number\">0.5</span>, <span class=\"number\">0.2</span></span><br><span class=\"line\">    tmp = x1 * w1 + x2 * w2</span><br><span class=\"line\">    <span class=\"keyword\">if</span> tmp &lt;= theta:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 非门只取一个输入,另一个不管</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">NOT</span>(<span class=\"params\">x1, x2</span>):</span><br><span class=\"line\">    w1, w2, theta = -<span class=\"number\">1</span>, <span class=\"number\">0</span>, <span class=\"number\">0</span></span><br><span class=\"line\">    tmp = x1 * w1 + x2 * w2 + <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> tmp</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 异或门是非线性运算, 需要多层感知器组合</span></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">XOR</span>(<span class=\"params\">x1, x2</span>):</span><br><span class=\"line\">    <span class=\"comment\"># 异或门 = (与非门 与 或门)</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> AND(OR(x1, x2), <span class=\"keyword\">not</span> AND(x1, x2))</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(AND(<span class=\"number\">0</span>, <span class=\"number\">1</span>), AND(<span class=\"number\">1</span>, <span class=\"number\">1</span>), OR(<span class=\"number\">0</span>, <span class=\"number\">1</span>), OR(<span class=\"number\">0</span>, <span class=\"number\">0</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(NOT(<span class=\"number\">0</span>, <span class=\"number\">1</span>), NOT(<span class=\"number\">1</span>, <span class=\"number\">1</span>), NOT(<span class=\"number\">0</span>, <span class=\"number\">0</span>), NOT(<span class=\"number\">1</span>, <span class=\"number\">0</span>))</span><br><span class=\"line\"><span class=\"built_in\">print</span>(XOR(<span class=\"number\">0</span>, <span class=\"number\">1</span>), XOR(<span class=\"number\">1</span>, <span class=\"number\">1</span>), XOR(<span class=\"number\">0</span>, <span class=\"number\">0</span>), XOR(<span class=\"number\">1</span>, <span class=\"number\">0</span>))</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>0 1 1 0\n1 0 1 0\n1 0 0 1\n</code></pre>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表-35\">借物表</h2>\n<p>暂无…</p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "python",
                "人工智能",
                "深度学习"
            ]
        },
        {
            "id": "https://weidows.github.io/post/python/AI/DL/",
            "url": "https://weidows.github.io/post/python/AI/DL/",
            "title": "⚡再啃-Deep-Learning",
            "date_published": "2022-04-20T16:07:12.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2022-06-14 21:06:14\n * @FilePath: \\Blog-private\\source\\_posts\\python\\AI\\DL.md\n * @Description:\n * @!: *********************************************************************\n-->\n<blockquote class=\"pullquote mindmap mindmap-lg\"><ul>\n<li>再啃-Deep-Learning\n<ul>\n<li>深度学习\n<ul>\n<li>一个好的表示学习策略必须具备一定的深度</li>\n<li>特征\n<ul>\n<li>像是宰鱼要分多步,每步使用不同方式/工具</li>\n<li>通常从底层特征开始经过多步非线性转换才能得到好的高层语义表示</li>\n</ul>\n</li>\n<li>特点\n<ul>\n<li>增加特征重用性,指数级增加表示能力</li>\n</ul>\n</li>\n<li><a href=\"https://www.helloimg.com/images/2022/03/10/RCdJ0c.png\">表示学习与深度学习关系</a></li>\n<li>关键问题: 贡献度分配\n<ul>\n<li>不同组件/参数对系统输出结果的影响权重</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>神经网路\n<ul>\n<li>人工神经网络\n<ul>\n<li>由大量神经元及它们之间的有向连接构成</li>\n<li>三方面\n<ul>\n<li>神经元/感知器</li>\n<li>网络的拓扑结构\n<ul>\n<li>LeNet</li>\n<li>AlexNet</li>\n<li>VGGNet</li>\n<li>ResNet</li>\n</ul>\n</li>\n<li>学习算法</li>\n</ul>\n</li>\n<li><a href=\"https://www.helloimg.com/images/2022/03/19/Rat37q.png\">分类</a>\n<ul>\n<li>单类网络\n<ul>\n<li>前馈网络</li>\n<li>记忆网络</li>\n<li>图网络</li>\n</ul>\n</li>\n<li>复合型网络</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>贡献度分配问题\n<ul>\n<li>不同 component 或 param 对最终系统输出结果的贡献</li>\n<li>利用偏导数求解贡献度</li>\n</ul>\n</li>\n<li>发展史\n<ul>\n<li>模型提出</li>\n<li>冰河期</li>\n<li>反向传播算法引起的复兴</li>\n<li>流行度降低</li>\n<li>深度学习崛起</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>MMDetection\n<ul>\n<li>图像分类\n<ul>\n<li>模型发展\n<ul>\n<li>LeNet-5 (1998)</li>\n<li>AlexNet (2012)</li>\n<li>VGGNet (2014)</li>\n<li>GoogleNet (2014)</li>\n<li>ResNet (2015)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>模型训练\n<ul>\n<li>配置文件\n<ul>\n<li>模型结构\n<ul>\n<li>模型有几层</li>\n<li>每层多少通道数</li>\n</ul>\n</li>\n<li>数据集\n<ul>\n<li>数据集划分\n<ul>\n<li>常用的有 COCO 格式, <code>annotation/test.json -&gt; test/images</code></li>\n</ul>\n</li>\n<li>数据文件路径</li>\n<li>数据增强策略</li>\n</ul>\n</li>\n<li>训练策略\n<ul>\n<li>梯度下降算法</li>\n<li>学习率参数</li>\n<li>batch_size</li>\n<li>训练总轮次</li>\n<li>学习率变化策略</li>\n</ul>\n</li>\n<li>runtime / 运行时\n<ul>\n<li>GPU</li>\n<li>分布式环境配置</li>\n</ul>\n</li>\n<li>一些辅助功能\n<ul>\n<li>打印日志</li>\n<li>checkpoint / 定时保存</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>MMDetection3D</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<blockquote>\n<p>由于 DL 是 ML 的子问题, 所以此篇着重写 <a href=\"../ML\">🥵 硬啃-Machine-Learning</a> 里面涉及甚少的 (解耦) <br>\n有一些 (比如损失函数, 梯度下降) 隶属于 ML &gt; DL ,所以堆在了 ML 里面</p>\n</blockquote>\n<blockquote>\n<ul>\n<li>本篇所用到的代码在这: <br>\n<a href=\"../../code/DL\">👩‍❤️‍💋‍👨Code-4-Deep-Learning</a> <br>\n<a href=\"../../code/MM-Detection\">🐳MM-Detection-Colab</a></li>\n</ul>\n</blockquote>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"ML-2-DL\">ML-2-DL</h2>\n<ul>\n<li>\n<p>简单解释 DL 到底在做什么?</p>\n<p>传统 ML 就像是在教小学生如何通过一系列<code>固定公式</code>搞出来一个结果,在公式不太复杂/运算量不太大时, 教起来还好</p>\n<p>那怎么教一个小学生高数题呢? 也是可以让他死记硬背公式的,但是效果并不好</p>\n<p>DL 就像是在教他转换思想 (函数,导数,积分…), 遇到题目后,具体套什么公式, 由小学生自己找到</p>\n</li>\n</ul>\n<p>DL 不像 ML 一样泛泛, 对每种任务有针对性的设计</p>\n<hr>\n<div class=\"tabs\" id=\"优点\"><ul class=\"nav-tabs\"><li class=\"tab active\"><button type=\"button\" data-href=\"#优点-1\">优点</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#优点-2\">缺点</button></li></ul><div class=\"tab-contents\"><div class=\"tab-item-content active\" id=\"优点-1\"><p>就像上面提到的, 传统 ML 需要人教给机器特征工程 (固定公式), 模型越复杂, 人的提取方法和特征结果会越差</p>\n<p>DL 对特征的处理方法/结果要优于人类 (比如深层次人类无法察觉的特征关系)</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"优点-2\"><p>DL 模型的能力是 (人类传授的基本功 + 题海战术) 得来的;</p>\n<ol>\n<li>刷题少时反不如套公式</li>\n<li>基本功构建成本高</li>\n<li>可解释性差 (虽然基本功是你教的,但你不知道机器是用的什么歪门邪道的心法)</li>\n</ol><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div></div></div>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"神经网路\">神经网路</h2>\n<p>大多知名的模型都是属于 <code>深度神经网络</code> 的, 比如 CNN, RNN, GAN …</p>\n<h3 id=\"神经元-感知器\">神经元-感知器</h3>\n<ul>\n<li>\n<p>感知器就是一个神经元, 神经网络的组成单元, 可自学习为回归/分类器</p>\n<p><img src=\"https://www.helloimg.com/images/2022/03/10/RC0tEP.png\" alt=\"\"></p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><mi>f</mi><mo stretchy=\"false\">(</mo><mi>w</mi><mn>1</mn><mo>⋅</mo><mi>x</mi><mn>1</mn><mo>+</mo><mi>w</mi><mn>2</mn><mo>⋅</mo><mi>x</mi><mn>2</mn><mo>+</mo><mi>b</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y = f(w1 \\cdot x1 + w2 \\cdot x2 + b)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7278em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">x</span><span class=\"mord\">2</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>当调整 <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo separator=\"true\">,</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">w,b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> 时,可以得到不同的变体逻辑运算(比如与或非);</p>\n<p>给定训练数据集, <span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>w</mi><mo separator=\"true\">,</mo><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">w,b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span> 可以通过学习自动调整</p>\n<hr>\n</li>\n<li>\n<p>学习规则核心思想: <code>错误驱动</code></p>\n<ol>\n<li>权值初始化</li>\n<li>输入样本对</li>\n<li>计算输出</li>\n<li>根据感知器学习规则调整权值</li>\n<li>返回到步骤 2. 输入下一对样本,周而复始直到对所有样本,感知器的实际输出与期望输出相等</li>\n</ol>\n<hr>\n</li>\n<li>\n<details>\n  <summary> 例题 </summary>\n<hr>\n<p><img src=\"https://www.helloimg.com/images/2022/03/19/Raxa9S.png\" alt=\"\"></p>\n<ol>\n<li>初始化向量</li>\n</ol>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mo>⇒</mo><msup><mi>W</mi><mi>T</mi></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">W(0) = (0.5,1,-1,0)^T \\rArr W^T(0) = (0.5,1,-1,0)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">⇒</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<ol start=\"2\">\n<li>输入样本</li>\n<li>计算输出</li>\n</ol>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>W</mi><mi>T</mi></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><msup><mi>X</mi><mn>1</mn></msup><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>⋅</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mo>=</mo><mn>2.5</mn></mrow><annotation encoding=\"application/x-tex\">W^T(0)X^1 = (0.5,1,-1,0) \\cdot (-1,1,-2,0)^T = 2.5\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1.1413em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">2.5</span></span></span></span></span></p>\n<ol start=\"4\">\n<li>调整权值,这里使用上面<a href=\"#%E6%BF%80%E6%B4%BB%E5%87%BD%E6%95%B0\">#激活函数</a>的阶跃函数例子</li>\n</ol>\n<p>权向量第一个分量也就是 0.5 为阈值</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mtable rowspacing=\"0.25em\" columnalign=\"right left\" columnspacing=\"0em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><msup><mi>o</mi><mn>1</mn></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">(</mo><msup><mi>W</mi><mi>T</mi></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><msup><mi>X</mi><mn>1</mn></msup><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mn>2.5</mn><mo stretchy=\"false\">)</mo><mo>=</mo><mn>1</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>W</mi><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mi>η</mi><mrow><mo fence=\"true\">[</mo><msup><mi>d</mi><mn>1</mn></msup><mo>−</mo><msup><mi>o</mi><mn>1</mn></msup><mo stretchy=\"false\">(</mo><mn>0</mn><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><msup><mi>X</mi><mn>1</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.5</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mo>+</mo><mn>0.1</mn><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence=\"true\">(</mo><mrow><mn mathvariant=\"bold\">0.7</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0.8</mn><mo separator=\"true\">,</mo><mo>−</mo><mn mathvariant=\"bold\">0.6</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0</mn><msup><mo stretchy=\"false\">)</mo><mi mathvariant=\"bold\">T</mi></msup></mrow></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>W</mi><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mi>η</mi><mrow><mo fence=\"true\">[</mo><msup><mi>d</mi><mn>2</mn></msup><mo>−</mo><msup><mi>o</mi><mn>2</mn></msup><mo stretchy=\"false\">(</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><msup><mi>X</mi><mn>2</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.7</mn><mo separator=\"true\">,</mo><mn>0.8</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>0.6</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mo>+</mo><mn>0.1</mn><mo stretchy=\"false\">[</mo><mo>−</mo><mn>1</mn><mo>−</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0</mn><mo separator=\"true\">,</mo><mn>1.5</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>0.5</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence=\"true\">(</mo><mrow><mn mathvariant=\"bold\">0.7</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0.8</mn><mo separator=\"true\">,</mo><mo>−</mo><mn mathvariant=\"bold\">0.6</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0</mn><msup><mo stretchy=\"false\">)</mo><mi mathvariant=\"bold\">T</mi></msup></mrow></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mtext> </mtext></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mi>W</mi><mo stretchy=\"false\">(</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mi>W</mi><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo>+</mo><mi>η</mi><mrow><mo fence=\"true\">[</mo><msup><mi>d</mi><mn>3</mn></msup><mo>−</mo><msup><mi>o</mi><mn>3</mn></msup><mo stretchy=\"false\">(</mo><mn>2</mn><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><msup><mi>X</mi><mn>3</mn></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mo stretchy=\"false\">(</mo><mn>0.7</mn><mo separator=\"true\">,</mo><mn>0.8</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>0.6</mn><mo separator=\"true\">,</mo><mn>0</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup><mo>+</mo><mn>0.1</mn><mo stretchy=\"false\">[</mo><mn>1</mn><mo>−</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo stretchy=\"false\">)</mo><mo stretchy=\"false\">]</mo><mo stretchy=\"false\">(</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mo>−</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>0.5</mn><msup><mo stretchy=\"false\">)</mo><mi>T</mi></msup></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"true\"><mrow><mrow></mrow><mo>=</mo><mrow><mo fence=\"true\">(</mo><mrow><mn mathvariant=\"bold\">0.5</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0.6</mn><mo separator=\"true\">,</mo><mo>−</mo><mn mathvariant=\"bold\">0.4</mn><mo separator=\"true\">,</mo><mn mathvariant=\"bold\">0.1</mn><msup><mo stretchy=\"false\">)</mo><mi mathvariant=\"bold\">T</mi></msup></mrow></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding=\"application/x-tex\">\\begin{aligned}\n  o^1(0) &amp;= sgn(W^T(0)X^1) \\\\\n  &amp;= sgn(2.5) = 1\n\n    \\\\ \\ \\\\\n\n    W(1) &amp;=W(0) + \\eta \\left[d^{1}-o^{1}(0)\\right] X^{1} \\\\\n  &amp;= (0.5,1,-1,0)^{T} + 0.1 (- 1- 1)(-1,1,-2,0)^{T} \\\\\n  &amp;= \\left(\\mathbf{0.7,0.8,-0.6,0)^{T}}\\right.\n\n    \\\\ \\ \\\\\n\n    W(2) &amp;=W(1) + \\eta \\left[d^{2}-o^{2}(1)\\right] X^{2} \\\\\n  &amp;= (0.7,0.8,-0.6,0)^{T} + 0.1 [- 1-(- 1)](-1,0,1.5,-0.5)^{T} \\\\\n  &amp;= \\left(\\mathbf{0.7,0.8,-0.6,0)^{T}}\\right.\n\n    \\\\ \\ \\\\\n\n    W(3) &amp;=W(2) + \\eta \\left[d^{3}-o^{3}(2)\\right] X^{3} \\\\\n  &amp;= (0.7,0.8,-0.6,0)^{T} + 0.1 [1-(- 1)](-1,-1,1,0.5)^{T} \\\\\n  &amp;= \\left(\\mathbf{0.5,0.6,-0.4,0.1)^{T}}\\right.\n\\end{aligned}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:21.4375em;vertical-align:-10.4687em;\"></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-r\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.9687em;\"><span style=\"top:-13.0774em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span></span></span><span style=\"top:-11.5774em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-10.0774em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:-8.5533em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span></span></span><span style=\"top:-7.002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-5.4487em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:-3.9487em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:-2.4246em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span></span></span><span style=\"top:-0.8733em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:0.68em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:2.18em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mspace\"> </span></span></span><span style=\"top:3.7041em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">3</span><span class=\"mclose\">)</span></span></span><span style=\"top:5.2555em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span><span style=\"top:6.8087em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.4687em;\"><span></span></span></span></span></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.9687em;\"><span style=\"top:-13.0774em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span><span class=\"mclose\">)</span></span></span><span style=\"top:-11.5774em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord\">2.5</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">1</span></span></span><span style=\"top:-8.5533em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">0</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-7.002em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">0.1</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-5.4487em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathbf\">0.7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0.8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord mathbf\">0.6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8933em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">T</span></span></span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:-2.4246em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">1</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:-0.8733em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">0.1</span><span class=\"mopen\">[</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mclose\">)]</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.5</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:0.68em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathbf\">0.7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0.8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord mathbf\">0.6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8933em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">T</span></span></span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=\"top:3.7041em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.13889em;\">W</span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">η</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">[</span></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord\">2</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">]</span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.07847em;\">X</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:5.2555em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">0.7</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.8</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">0.1</span><span class=\"mopen\">[</span><span class=\"mord\">1</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mclose\">)]</span><span class=\"mopen\">(</span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">0.5</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">T</span></span></span></span></span></span></span></span></span></span></span><span style=\"top:6.8087em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord\"></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\"><span class=\"delimsizing size1\">(</span></span><span class=\"mord\"><span class=\"mord mathbf\">0.5</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0.6</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">−</span><span class=\"mord mathbf\">0.4</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathbf\">0.1</span><span class=\"mclose\"><span class=\"mclose\">)</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8933em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathbf mtight\">T</span></span></span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:10.4687em;\"><span></span></span></span></span></span></span></span></span></span></span></span></p>\n<ol start=\"5\">\n<li>返回 2. 直到</li>\n</ol>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msup><mi>d</mi><mi>P</mi></msup><mo>−</mo><msup><mi>o</mi><mi>P</mi></msup><mo>=</mo><mn>0</mn><mspace width=\"2em\"/><mo stretchy=\"false\">(</mo><mi>p</mi><mo>=</mo><mn>1</mn><mo separator=\"true\">,</mo><mn>2</mn><mo separator=\"true\">,</mo><mn>3</mn><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">d^{P} - o^{P} = 0 \\qquad (p = 1,2,3)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9747em;vertical-align:-0.0833em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">d</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8913em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">o</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8913em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.13889em;\">P</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">0</span><span class=\"mspace\" style=\"margin-right:2em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">p</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\">1</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">2</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord\">3</span><span class=\"mclose\">)</span></span></span></span></span></p>\n</details>\n</li>\n</ul>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"前馈神经网络\">前馈神经网络</h3>\n<p>把若干个感知器叠几层, 形成单向类网状结构, 称为多层前馈神经网络 (Multi-layer Feedforward Neural Networks), <code>前馈</code> 是指前一层输出作为后一层输入</p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/06/R0fC7h.png\" alt=\"\"></p>\n<ul>\n<li>\n<p>每个箭头直线代表一个 “向量”:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><msubsup><mi>w</mi><mrow><mi>a</mi><mtext> </mtext><mi>b</mi></mrow><mi>k</mi></msubsup></mrow><annotation encoding=\"application/x-tex\">w ^{k}  _{a \\ b}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1461em;vertical-align:-0.247em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.02691em;\">w</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8991em;\"><span style=\"top:-2.453em;margin-left:-0.0269em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\">a</span><span class=\"mspace mtight\"><span class=\"mtight\"> </span></span><span class=\"mord mathnormal mtight\">b</span></span></span></span><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mathnormal mtight\" style=\"margin-right:0.03148em;\">k</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.247em;\"><span></span></span></span></span></span></span></span></span></span></span></p>\n<p>k: 权重</p>\n<p>a: 前一层第 a 个神经元</p>\n<p>b: 后一层第 b 个神经元</p>\n<hr>\n</li>\n<li>\n<p>同一层感知器之间不相连, 与前后两层全相连, 为<code>全连接神经网络</code> (fully-connected neural network)</p>\n<p>这种网络有硬性缺点:</p>\n<ol>\n<li>丢失数据的空间信息 (比如 3d 图像会展开为向量)</li>\n<li>参数量太多,难训</li>\n<li>层级浅, 大量参数易过拟合</li>\n</ol>\n<p>后面 CNN 对此缺点做了优化</p>\n</li>\n</ul>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"反向传播\">反向传播</h3>\n<ul>\n<li>\n<p>反向传播/误差反向传播 (Backpropagation algorithm), 根据输出层输出值来反向调整隐藏层权重的一种方法</p>\n<ul>\n<li>\n<p>我们常用 <code>梯度下降方法</code> 来更新权重, 梯度下降应用于有明确求导/可求出误差的情况</p>\n</li>\n<li>\n<p>但是对于含有多个隐藏层的神经网络, 隐藏层求不出误差, 只有输出层有</p>\n</li>\n<li>\n<p>反向传播就是一个把输出层误差反向传播到隐藏层的过程</p>\n</li>\n</ul>\n</li>\n<li>\n<p>图解 <sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup></p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/07/RNeqlm.png\" alt=\"\"></p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/07/RNexIh.png\" alt=\"\"></p>\n<p>实现原理就是求偏导</p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/08/RNeWuu.png\" alt=\"\"></p>\n</li>\n</ul>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"卷积神经网络-CNN\">卷积神经网络-CNN</h3>\n<p>卷积神经网络(Convolutional Neural Network，CNN), 视觉领域难以撼动的老大</p>\n<h4 id=\"what\">what</h4>\n<p>对于一个 .mp3 的音乐 (频域记录, .wav 是时域记录), 某一时间点的音波可以<code>假定认为</code>是多个函数交杂而成的</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>y</mi><mo>=</mo><msub><mi>h</mi><mtext>耳机音效</mtext></msub><mrow><mo fence=\"true\">[</mo><msub><mi>f</mi><mtext>人声</mtext></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo>∗</mo><msub><mi>g</mi><mtext>乐器</mtext></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo><mo fence=\"true\">]</mo></mrow><mo>∗</mo><msub><mi>i</mi><mtext>响度</mtext></msub><mo stretchy=\"false\">(</mo><mi>t</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">y = h_{耳机音效} \\left[ f_{人声}(t) * g_{乐器}(t) \\right] * i_{响度}(t)\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">h</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">耳机音效</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"minner\"><span class=\"mopen delimcenter\" style=\"top:0em;\">[</span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.1076em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">人声</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">乐器</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span><span class=\"mclose delimcenter\" style=\"top:0em;\">]</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">∗</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"msupsub\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.3283em;\"><span style=\"top:-2.55em;margin-left:0em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord cjk_fallback mtight\">响度</span></span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.15em;\"><span></span></span></span></span></span></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">t</span><span class=\"mclose\">)</span></span></span></span></span></p>\n<p>某一时间点的音波,就是这一堆函数的<code>卷积</code>, 简单来说就是在某个维度上 <code>加权 + 叠加</code></p>\n<hr>\n<h4 id=\"结构\">结构</h4>\n<p><img src=\"https://www.helloimg.com/images/2022/05/18/RytYZQ.png\" alt=\"\"><div class=\"mermaid-wrap\"><pre class=\"mermaid-src\" hidden>\n  graph TB\n  输入层 --&gt;\n  卷积层(卷积层 Convolutional-layer) --&gt;\n  激活层(激活&#x2F;ReLU层 Activation-layer) --&gt;\n  池化层(池化&#x2F;子采样&#x2F;下采样层 Pooling-layer) --&gt;\n  全连接网络(全连接网络 fully-connected-layer) --&gt;\n  输出层\n  </pre></div></p>\n<ol>\n<li>卷积层: 就像是多个科目 (卷积核) 的老师给出试卷, 让&quot;输入&quot;做答</li>\n<li>激活层: 不同科目老师判卷,得出有没有及格,及格的话计多少分</li>\n<li>池化层: 成绩取最大值或者平均值, 减少计算量</li>\n<li>全连接层: 年级排名</li>\n<li>输出层: 是否获奖(二分类) / 排名前百分之几十(多分类)</li>\n</ol>\n<hr>\n<h4 id=\"卷积层\">卷积层</h4>\n<p><img src=\"https://www.helloimg.com/images/2022/05/09/RNJpTz.png\" alt=\"\"></p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/19/Ry4FoP.png\" alt=\"\"></p>\n<p>可以直观看出, 其作用为 <code>降维</code> 和 <code>提取特征</code></p>\n<hr>\n<h4 id=\"激活层\">激活层</h4>\n<blockquote>\n<p>将输入信号的总和转换为输出信号的函数被称为激活函数</p>\n</blockquote>\n<ul>\n<li>\n<p>如下为一种简单实现: 阶跃函数:</p>\n<p><img src=\"https://www.helloimg.com/images/2022/03/18/RaxGG1.png\" alt=\"RaxGG1.png\"></p>\n<p>其阈值是可以改变的:</p>\n<p><span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>s</mi><mi>g</mi><mi>n</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mo>=</mo><mrow><mo fence=\"true\">{</mo><mtable rowspacing=\"0.36em\" columnalign=\"left left\" columnspacing=\"1em\"><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mi>x</mi><mo>&gt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mn>0</mn></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mi>x</mi><mo>=</mo><mn>0</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mo>−</mo><mn>1</mn></mrow></mstyle></mtd><mtd><mstyle scriptlevel=\"0\" displaystyle=\"false\"><mrow><mi>i</mi><mi>f</mi><mtext> </mtext><mi>x</mi><mo>&lt;</mo><mn>0</mn></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding=\"application/x-tex\">sgn(x) =\n\\begin{cases}\n  1 &amp; if \\ x &gt; 0 \\\\\n  0 &amp; if \\ x = 0 \\\\\n  -1 &amp; if \\ x &lt; 0\n\\end{cases}\n</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\">s</span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">g</span><span class=\"mord mathnormal\">n</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:4.32em;vertical-align:-1.91em;\"></span><span class=\"minner\"><span class=\"mopen\"><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.35em;\"><span style=\"top:-2.2em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎩</span></span></span><span style=\"top:-2.192em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.316em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style=\"top:-3.15em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎨</span></span></span><span style=\"top:-4.292em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span style=\"height:0.316em;width:0.8889em;\"><svg xmlns=\"http://www.w3.org/2000/svg\" width='0.8889em' height='0.316em' style='width:0.8889em' viewBox='0 0 888.89 316' preserveAspectRatio='xMinYMin'><path d='M384 0 H504 V316 H384z M384 0 H504 V316 H384z'/></svg></span></span><span style=\"top:-4.6em;\"><span class=\"pstrut\" style=\"height:3.15em;\"></span><span class=\"delimsizinginner delim-size4\"><span>⎧</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.85em;\"><span></span></span></span></span></span></span><span class=\"mord\"><span class=\"mtable\"><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.41em;\"><span style=\"top:-4.41em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">1</span></span></span><span style=\"top:-2.97em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">0</span></span></span><span style=\"top:-1.53em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord\">−</span><span class=\"mord\">1</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.91em;\"><span></span></span></span></span></span><span class=\"arraycolsep\" style=\"width:1em;\"></span><span class=\"col-align-l\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:2.41em;\"><span style=\"top:-4.41em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&gt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-2.97em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span><span style=\"top:-1.53em;\"><span class=\"pstrut\" style=\"height:3.008em;\"></span><span class=\"mord\"><span class=\"mord mathnormal\">i</span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mspace\"> </span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">&lt;</span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord\">0</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.91em;\"><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span></p>\n</li>\n<li>\n<p>还有很多其他的激活函数, 用途各异, 详见<sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup></p>\n<p>sigmoid 函数</p>\n<p>tanh 双曲正切函数</p>\n<p>ReLU (Rectified Linear Units, 修正线性单元, CNN 常用)</p>\n<p>…</p>\n</li>\n</ul>\n<hr>\n<h4 id=\"池化层\">池化层</h4>\n<p><img src=\"https://www.helloimg.com/images/2022/05/19/Ry4PS6.png\" alt=\"\"></p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/19/Ry4apn.png\" alt=\"\"></p>\n<p>一方面, 缩小分辨率降低运算量, 一方面扩大神经元的<code>感受野</code> (特征捕获范围)</p>\n<p>也就使得层次越深, 单位神经元在有损条件下捕获特征/语义信息的范围越大</p>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"MMDetection\">MMDetection</h2>\n<blockquote>\n<p>参考课程 <sup id='cite_ref-3'><a href=\"#cite_note-3\">[3]</a></sup> <br>\n<img src=\"https://www.helloimg.com/images/2022/05/14/R7twWM.png\" alt=\"\"></p>\n</blockquote>\n<h3 id=\"图像分类\">图像分类</h3>\n<p><img src=\"https://www.helloimg.com/images/2022/05/19/Ry4Xmz.png\" alt=\"\"></p>\n<hr>\n<h3 id=\"目标检测\">目标检测</h3>\n<h4 id=\"第一阶段-问题与方案\">第一阶段-问题与方案</h4>\n<h5 id=\"图像分割\">图像分割</h5>\n<p>等大窗口 -&gt; 滑动窗口 -&gt; 多尺度滑窗 -&gt; 图像金字塔</p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/20/ZBmvYY.png\" alt=\"\"></p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/21/ZCV790.png\" alt=\"\"></p>\n<h5 id=\"区域提议\">区域提议</h5>\n<p>但上面设计需要做的分类数太多,难以满足实时性, 可以先用 <code>区域提议 Region Proposal</code> 提取出可能包含物体的区域</p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/21/ZCYq6P.png\" alt=\"\"></p>\n<h5 id=\"非极大值抑制\">非极大值抑制</h5>\n<p><img src=\"https://www.helloimg.com/images/2022/05/21/ZCYER6.png\" alt=\"\"></p>\n<hr>\n<h4 id=\"第二阶段-优化算法\">第二阶段-优化算法</h4>\n<h5 id=\"共享特征与-RoI-Pooling\">共享特征与-RoI-Pooling</h5>\n<p>对于每个提议框 -&gt; CNN 前传, 有大量重叠提议框(重复的卷积运算), 所以改进为: <code>全图单次 CNN 前传 -&gt; 全图特征图 -&gt; 根据提议框裁剪预测</code></p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/27/Z1PBTb.png\" alt=\"\"></p>\n<h5 id=\"RPN-区域提议网络\">RPN-区域提议网络</h5>\n<p>Region Proposal Network</p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/27/Z1PLwn.png\" alt=\"\"></p>\n<h5 id=\"FPN-特征金字塔网络\">FPN-特征金字塔网络</h5>\n<p><img src=\"https://www.helloimg.com/images/2022/05/27/Z1a3Gh.png\" alt=\"\"></p>\n<hr>\n<h4 id=\"Faster-RCNN\">Faster-RCNN</h4>\n<p><code>Faster - Region proposal - CNN</code> 一个很经典的例子, 应用上面的优化算法网络 <sup id='cite_ref-5'><a href=\"#cite_note-5\">[5]</a></sup></p>\n<blockquote>\n<p><img src=\"https://www.helloimg.com/images/2022/05/27/Z1Pnqz.png\" alt=\"\"> &gt; <img src=\"https://www.helloimg.com/images/2022/05/27/Z1aeNq.png\" alt=\"\"> &gt; <img src=\"https://www.helloimg.com/images/2022/06/11/ZLwNpK.png\" alt=\"\"></p>\n</blockquote>\n<hr>\n<h4 id=\"目标检测划分\">目标检测划分</h4>\n<p>可以通过下面三种形式划分 <sup id='cite_ref-6'><a href=\"#cite_note-6\">[6]</a></sup></p>\n<blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li>目标检测划分\n<ul>\n<li>stage\n<ul>\n<li>one-stage (单阶段)\n<ul>\n<li>RetinaNet</li>\n<li>YOLO</li>\n<li>FCOS</li>\n<li>RepPoints</li>\n</ul>\n</li>\n<li>two-stage (双阶段)\n<ul>\n<li>FasterRCNN</li>\n<li>CascadeRCNN</li>\n<li>LibraRCNN</li>\n<li>TridentNet</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>anchor (锚框)\n<ul>\n<li>anchor-based\n<ul>\n<li>FasterRCNN</li>\n<li>YOLO</li>\n</ul>\n</li>\n<li>anchor-free\n<ul>\n<li>FCOS</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>transformer\n<ul>\n<li>DETR</li>\n<li>Deformable DETR</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<div class=\"tabs\" id=\"双阶段\"><ul class=\"nav-tabs\"><li class=\"tab active\"><button type=\"button\" data-href=\"#双阶段-1\">单阶段</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#双阶段-2\">双阶段</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#双阶段-3\">无锚框算法</button></li></ul><div class=\"tab-contents\"><div class=\"tab-item-content active\" id=\"双阶段-1\"><p><img src=\"https://www.helloimg.com/images/2022/05/30/ZeIeWv.png\" alt=\"\"></p>\n<p>单阶段最常用的就是 YOLO (You Only Look Once), 每代都会有设计更新和优化,如下为 v3 设计</p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/30/ZeImDX.png\" alt=\"\"></p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"双阶段-2\"><p>上面介绍的都是双阶段算法,与单阶段区别主要在于<code>是否有区域提议阶段</code>, 单阶段算法只通过不同尺寸的锚框(检测头)进行物体预测</p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/27/Z1aqjr.png\" alt=\"\"></p>\n<p>具体来看,与上面网络结合:</p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/30/ZeDKUA.png\" alt=\"\"></p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"双阶段-3\"><p>另一类分支, 有锚框的话会有大量超参使模型复杂度上升, 无锚框的话性能又会下降</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div></div></div>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"模型构建流程\">模型构建流程</h3>\n<p>现阶段 AI 领域把很多算法模块化了, 提出的新算法大多也是对某一功能模块的改进, 构建一个大型模型可以像是装高达一样挑选合适的算法/网络模块进行组合.</p>\n<p>mmdet 就是蛮复杂的, 抽象成了多个功能模块 <sup id='cite_ref-6'><a href=\"#cite_note-6\">[6]</a></sup>, 每个功能模块又有多个实现算法.</p>\n<p><img src=\"https://www.helloimg.com/images/2022/06/11/ZLwyeM.png\" alt=\"\"></p>\n<p><img src=\"https://www.helloimg.com/images/2022/06/11/ZL05TP.png\" alt=\"\"></p>\n<div class=\"tabs\" id=\"backbone\"><ul class=\"nav-tabs\"><li class=\"tab active\"><button type=\"button\" data-href=\"#backbone-1\">backbone</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#backbone-2\">neck</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#backbone-3\">enhance</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#backbone-4\">head</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#backbone-5\">BBox</button></li><li class=\"tab\"><button type=\"button\" data-href=\"#backbone-6\">tricks</button></li></ul><div class=\"tab-contents\"><div class=\"tab-item-content active\" id=\"backbone-1\"><p>backbone (主干网络) 经常会在预训练模型选取时看到, 作用为<code>特征提取</code>, 常见的比如 50 层 ResNet -&gt; R-50</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"backbone-2\"><p>neck 是对 backbone 提取的特征进行融合/增强, 然后传给 head. 常见的 neck 为 FPN (特征金字塔网络)</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"backbone-3\"><blockquote>\n<p>enhance 是即插即用、能够对特征进行增强的模块</p>\n</blockquote><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"backbone-4\"><p>Head 检测头模块是对模型性能影响最显著的地方, 有框坐标回归和目标分类两个分支</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"backbone-5\"><p>Bonding Box 是检测头模块的一个分支, 它的作用是对检测结果进行回归, 得到框坐标<br>\n功能模块有 BBox 分配 (进行正负样本定义或者正负样本分配),采样,编解码,后处理, 以及对应的 loss</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div><div class=\"tab-item-content\" id=\"backbone-6\"><p>tricks 就是训练/测试的技巧/配置, 大部分的调参工作就是在调整这部分, 比如 batch, Lr, 数据增强等…</p><button type=\"button\" class=\"tab-to-top\" aria-label=\"scroll to top\"><i class=\"fas fa-arrow-up\"></i></button></div></div></div>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h3 id=\"模型训练\">模型训练</h3>\n<p>MMDetection 基本结构: <code>依赖 + [模型] + 数据集 + 配置文件 -&gt; Trainable</code></p>\n<h4 id=\"dataset-COCO\">dataset-COCO</h4>\n<p>数据集分很多格式, 常见的比如 COCO:</p>\n<figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dataset_type = <span class=\"string\">&#x27;CocoDataset&#x27;</span></span><br><span class=\"line\">data_root = <span class=\"string\">&#x27;data/coco/&#x27;</span></span><br><span class=\"line\">data = <span class=\"built_in\">dict</span>(</span><br><span class=\"line\">  samples_per_gpu=<span class=\"number\">2</span>,</span><br><span class=\"line\">  workers_per_gpu=<span class=\"number\">2</span>,</span><br><span class=\"line\">  train=<span class=\"built_in\">dict</span>(</span><br><span class=\"line\">    <span class=\"built_in\">type</span>=dataset_type,</span><br><span class=\"line\">    ann_file=data_root + <span class=\"string\">&#x27;annotations/instances_train2017.json&#x27;</span>,</span><br><span class=\"line\">    img_prefix=data_root + <span class=\"string\">&#x27;train2017/&#x27;</span>,</span><br><span class=\"line\">    pipeline=train_pipeline),</span><br><span class=\"line\">  val=<span class=\"built_in\">dict</span>(</span><br><span class=\"line\">    <span class=\"built_in\">type</span>=dataset_type,</span><br><span class=\"line\">    ann_file=data_root + <span class=\"string\">&#x27;annotations/instances_val2017.json&#x27;</span>,</span><br><span class=\"line\">    img_prefix=data_root + <span class=\"string\">&#x27;val2017/&#x27;</span>,</span><br><span class=\"line\">    pipeline=test_pipeline),</span><br><span class=\"line\">  test=<span class=\"built_in\">dict</span>(</span><br><span class=\"line\">    <span class=\"built_in\">type</span>=dataset_type,</span><br><span class=\"line\">    ann_file=data_root + <span class=\"string\">&#x27;annotations/instances_val2017.json&#x27;</span>,</span><br><span class=\"line\">    img_prefix=data_root + <span class=\"string\">&#x27;val2017/&#x27;</span>,</span><br><span class=\"line\">    pipeline=test_pipeline)</span><br><span class=\"line\">)</span><br></pre></td></tr></table></figure>\n<h4 id=\"pipeline\">pipeline</h4>\n<p><img src=\"https://www.helloimg.com/images/2022/05/30/Zezw9E.png\" alt=\"\"></p>\n<h4 id=\"Lr-Scheduler\">Lr-Scheduler</h4>\n<p>Learning Rate Scheduler 学习率策略, 常见模型中标注的 <code>1x 2x</code></p>\n<p><img src=\"https://www.helloimg.com/images/2022/05/30/Ze7rmt.png\" alt=\"\"></p>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"MMDetection3D\">MMDetection3D</h2>\n<p>入门一个技术, 需要大致概览一下, 正巧 MM-Lab 应时发布了教程 <sup id='cite_ref-4'><a href=\"#cite_note-4\">[4]</a></sup></p>\n<p>MMDetection3D 依赖于 MMDetection 和 MMSegmentation, 适用于检测和分割 3D 场景下的物体</p>\n<p><img src=\"https://www.helloimg.com/images/2022/06/11/ZLvvN9.png\" alt=\"\"></p>\n<p>点云 (point cloud) 数据是通过传感器获取的物体分布场景, 单目 3D 检测</p>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表-33\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://mp.weixin.qq.com/s/Um8wAtdxPcVN8ACiVtSgFg\">42 个激活函数的全面总结</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://discover304.top/2021/11/30/2021q4/107-1-dl-back/\">【深度学习】基础 叁：反向传播算法</a></p>\n<p><a name='cite_note-3' href='#cite_ref-3'>[3]</a>: <a href=\"https://www.bilibili.com/video/BV1ou411k7fD\">4 小时入门深度学习+实操 MMDetection 第一课</a></p>\n<p><a name='cite_note-4' href='#cite_ref-4'>[4]</a>: <a href=\"https://zhuanlan.zhihu.com/p/478307528\">带你玩转 3D 检测和分割（一）：MMDetection3D 整体框架介绍</a></p>\n<p><a name='cite_note-5' href='#cite_ref-5'>[5]</a>: <a href=\"https://zhuanlan.zhihu.com/p/31426458\">一文读懂 Faster RCNN</a></p>\n<p><a name='cite_note-6' href='#cite_ref-6'>[6]</a>: <a href=\"https://zhuanlan.zhihu.com/p/337375549\">轻松掌握 MMDetection 整体构建流程(一)</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "人工智能",
                "深度学习",
                "doing"
            ]
        },
        {
            "id": "https://weidows.github.io/post/python/AI/AI/",
            "url": "https://weidows.github.io/post/python/AI/AI/",
            "title": "🐊All-about-AI",
            "date_published": "2022-03-18T16:13:49.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2022-05-16 22:31:05\n * @FilePath: \\Blog-private\\source\\_posts\\python\\AI\\AI.md\n * @Description:\n * @!: *********************************************************************\n-->\n<ul>\n<li>\n<details>\n  <summary> 文章封面图 (恐怖慎看) </summary>\n<p><img src=\"https://www.helloimg.com/images/2022/03/19/RaxZ0b.png\" alt=\"RaxZ0b.png\"></p>\n<hr>\n</details>\n</li>\n</ul>\n<p>此篇为本博客中 AI 领域的根, 也可以当做目录 (因为篇幅太长,就给分开了)</p>\n<blockquote>\n<p>文中大量使用 LaTeX 公式, 如何写的可以看 <a href=\"../../../experience/LaTeX\">🍹LaTeX~环形使者(?)</a> <br>\n强推大佬朋友的文章: <a href=\"https://discover304.top/2021/12/21/2021q4/123-ai-question-collection/\">【人工智能】面试问题整理</a></p>\n</blockquote>\n<ul>\n<li>\n<p>嗟叹</p>\n<p>炼丹界门派好多啊, 一派一传承</p>\n<p>师出少林, 修行武当, 行至小河, 探头一照</p>\n<p>欸, 爷竟是峨眉的 🐵</p>\n</li>\n</ul>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"体系概览\">体系概览</h2>\n<ul>\n<li>\n<p>人工智能是什么? <sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup><sup id='cite_ref-2'><a href=\"#cite_note-2\">[2]</a></sup></p>\n<blockquote>\n<p><img src=\"https://www.helloimg.com/images/2022/02/27/GVidNr.png\" alt=\"\"><br>\n<img src=\"https://www.helloimg.com/images/2022/03/09/RCPHaM.png\" alt=\"\"></p>\n</blockquote>\n</li>\n</ul>\n<p>下面包含细分文章的索引 (可点击跳转)</p>\n<blockquote class=\"pullquote mindmap mindmap-lg\"><ul>\n<li>AI\n<ul>\n<li>研究领域\n<ul>\n<li><a href=\"../ML\">机器学习</a>\n<ul>\n<li><a href=\"../DL\">深度学习</a></li>\n</ul>\n</li>\n<li>CV 计算机视觉\n<ul>\n<li>图像识别</li>\n<li>机器视觉</li>\n</ul>\n</li>\n<li>语音信息处理\n<ul>\n<li>文本-&gt;语音</li>\n<li>语音-&gt;文本</li>\n</ul>\n</li>\n<li>自然语言处理 NLP\n<ul>\n<li>文本生成</li>\n<li>文本分类</li>\n<li>翻译</li>\n<li>…</li>\n</ul>\n</li>\n<li>ROS 机器人系统</li>\n<li>专家系统</li>\n</ul>\n</li>\n<li>框架和库\n<ul>\n<li>Tenserflow</li>\n<li>Pytorch</li>\n<li>sklearn</li>\n<li>飞桨</li>\n<li>…</li>\n</ul>\n</li>\n<li>表示学习\n<ul>\n<li>表示\n<ul>\n<li>为了提高机器学习系统的准确率,就需要将输入信息转换为有效的特征</li>\n</ul>\n</li>\n<li>数据表示是机器学习的核心问题</li>\n<li>底层特征与高层语义之间存在语义鸿沟,如何在鸿沟上搭桥是表示学习的关键</li>\n<li>表示方法\n<ul>\n<li>局部表示/离散表示/符号表示\n<ul>\n<li>如: 红 绿 蓝</li>\n</ul>\n</li>\n<li>分布式表示\n<ul>\n<li>优点\n<ul>\n<li>表示能力强</li>\n<li>向量维度低</li>\n<li>相似度容易计算</li>\n</ul>\n</li>\n<li>例如: (255,0,0), (0,255,0)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>嵌入\n<ul>\n<li>将一个度量空间中的一些对象映射到另一个低维的度量空间中</li>\n<li>并尽可能保持不同对象之间的拓扑关系,比如自然语言中词的分布式表示</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"数据分析-2\">数据分析</h2>\n<blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li>数据分析\n<ul>\n<li>数据类型\n<ul>\n<li>数值 Numerical\n<ul>\n<li>离散 discrete</li>\n<li>连续 continuous</li>\n</ul>\n</li>\n<li>分类 Categorical\n<ul>\n<li>无法相互度量的数据,例如颜色</li>\n</ul>\n</li>\n<li>序数 Ordinal\n<ul>\n<li>类似分类数据,但可以相互度量</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>常用特殊值\n<ul>\n<li>均值 mean</li>\n<li>中值 median</li>\n<li>众数 mode</li>\n<li>标准差 std</li>\n<li>方差 var = std * std</li>\n<li>百分位数 percentile\n<ul>\n<li>返回一个数 x, 这个 x &gt;= 数组中百分之 percentile 的数</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"待办\">待办</h2>\n<h3 id=\"GAN\">GAN</h3>\n<p><img src=\"https://www.helloimg.com/images/2022/04/08/Rsmdm0.png\" alt=\"\"></p>\n<p>搜集大量 x 与 y 类型数据, GAN 模型可以自动学习 x 与 y 之间的关系</p>\n<h3 id=\"异常检测-anomaly-detection\">异常检测-anomaly-detection</h3>\n<p><img src=\"https://www.helloimg.com/images/2022/04/08/Rsmvdm.png\" alt=\"\"></p>\n<h3 id=\"Glow\">Glow</h3>\n<p>Glow -&gt; Flow-based generative model</p>\n<p>生成网络属于 DNN,是一种常用的<a href=\"#%E5%8C%BA%E5%88%86%E6%9C%89-%E6%97%A0%E7%9B%91%E7%9D%A3%E5%AD%A6%E4%B9%A0\">无监督学习模型</a></p>\n<blockquote class=\"pullquote mindmap mindmap-md\"><ul>\n<li>深度神经网络 DNN -&gt; 生成网络\n<ul>\n<li>生成对抗网络 GANs (Generative Adversarial Networks)</li>\n<li>变分自编码器 VAE (Variational Auto-Encoder)</li>\n<li>Pixel RNN/CNN</li>\n<li>流模型 Glow (Generative Flow)</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p><a><img src=\"https://fastly.jsdelivr.net/gh/Weidows/Images/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"借物表-32\">借物表</h2>\n<style>.bbplayer{width: 100%; max-width: 850px; margin: auto}</style><div class=\"bbplayer\"><iframe class=\"bbplayer\" id=\"mmedia-nofsahRrgYKisIxH\" src=\"https://player.bilibili.com/player.html?bvid=BV1J94y1f7u5&page=1&high_quality=1&danmaku=true\" allowfullscreen=\"allowfullscreen\" scrolling=\"no\" border=\"0\" frameborder=\"0\" framespacing=\"0\" sandbox=\"allow-top-navigation allow-same-origin allow-forms allow-scripts allow-popups\"></iframe></div><script> document.getElementById(\"mmedia-nofsahRrgYKisIxH\").style.height=document.getElementById(\"mmedia-nofsahRrgYKisIxH\").scrollWidth*0.76+\"px\";\n    window.onresize = function(){\n      document.getElementById(\"mmedia-nofsahRrgYKisIxH\").style.height=document.getElementById(\"mmedia-nofsahRrgYKisIxH\").scrollWidth*0.76+\"px\";\n    }; </script>\n<style>.bbplayer{width: 100%; max-width: 850px; margin: auto}</style><div class=\"bbplayer\"><iframe class=\"bbplayer\" id=\"mmedia-WEomwIabPYSPabgJ\" src=\"https://player.bilibili.com/player.html?bvid=BV16L411w7oQ&page=1&high_quality=1&danmaku=true\" allowfullscreen=\"allowfullscreen\" scrolling=\"no\" border=\"0\" frameborder=\"0\" framespacing=\"0\" sandbox=\"allow-top-navigation allow-same-origin allow-forms allow-scripts allow-popups\"></iframe></div><script> document.getElementById(\"mmedia-WEomwIabPYSPabgJ\").style.height=document.getElementById(\"mmedia-WEomwIabPYSPabgJ\").scrollWidth*0.76+\"px\";\n    window.onresize = function(){\n      document.getElementById(\"mmedia-WEomwIabPYSPabgJ\").style.height=document.getElementById(\"mmedia-WEomwIabPYSPabgJ\").scrollWidth*0.76+\"px\";\n    }; </script>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://zhuanlan.zhihu.com/p/86794447\">一文看懂人工智能、机器学习、深度学习与神经网络之间的区别与关系</a></p>\n<p><a name='cite_note-2' href='#cite_ref-2'>[2]</a>: <a href=\"https://nndl.github.io/\">神经网络与深度学习</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "人工智能",
                "机器学习",
                "深度学习",
                "doing"
            ]
        }
    ]
}