{
    "version": "https://jsonfeed.org/version/1",
    "title": "⭐️齐下无贰⭐️ • All posts by \"概率论\" tag",
    "description": "May all the beauty be bless.✨",
    "home_page_url": "https://weidows.github.io",
    "items": [
        {
            "id": "https://weidows.github.io/post/lang/python/code/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%8F%91%E7%94%9F%E5%99%A8/",
            "url": "https://weidows.github.io/post/lang/python/code/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%E5%8F%91%E7%94%9F%E5%99%A8/",
            "title": "♾️伪随机数发生器",
            "date_published": "2022-06-30T16:59:59.000Z",
            "content_html": "<!--\n * @?: *********************************************************************\n * @Author: Weidows\n * @LastEditors: Weidows\n * @LastEditTime: 2023-04-20 18:30:39\n * @FilePath: \\Blog-private\\source\\_posts\\python\\code\\伪随机数发生器.md\n * @Description:\n * @!: *********************************************************************\n-->\n<h2 id=\"序\">序</h2>\n<p>此发生器基于空间数组, 随机种子来自于 time 时间戳末尾位</p>\n<p>随着 random 次数增加, array 不确定度持续<code>叠加</code>, 每位概率会有一定波动但不会出现偏倚或黑洞</p>\n<p>熵来自于每次 update 的位置和次序, 淡化了某时刻 timestamp 和算力的影响</p>\n<p>思想类似卷积, 把过去与当前状态持续叠加到对未来的影响中</p>\n<ul>\n<li>\n<p>现有缺陷</p>\n<ol>\n<li>无法保证 <code>恒定的概率</code> 或者说 <code>等概率随机</code>, 但可以近似做到 <code>自然随机</code></li>\n<li>array 需要预热, 预热效果也会影响一定范围内的随机数质量</li>\n<li>小批量随机效果贼差</li>\n</ol>\n</li>\n</ul>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"代码\">代码</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">from</span> datetime <span class=\"keyword\">import</span> datetime</span><br><span class=\"line\"></span><br><span class=\"line\">array = [i <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">random</span>():</span><br><span class=\"line\">    time_str = <span class=\"built_in\">str</span>(datetime.now().timestamp())</span><br><span class=\"line\">    <span class=\"keyword\">if</span> <span class=\"built_in\">len</span>(time_str) == <span class=\"number\">16</span>: index = <span class=\"number\">0</span></span><br><span class=\"line\">    <span class=\"keyword\">else</span>:</span><br><span class=\"line\">        index = <span class=\"built_in\">int</span>(time_str[-<span class=\"number\">1</span>])</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># core: 每次 random, 使 index 位加上下一位的数字</span></span><br><span class=\"line\">    array[index] = (array[index] + array[(<span class=\"number\">1</span> + index) % <span class=\"built_in\">len</span>(array)]) % <span class=\"number\">10</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">return</span> array[index]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">def</span> <span class=\"title function_\">measure</span>(<span class=\"params\">random_times</span>):</span><br><span class=\"line\">    times = [<span class=\"number\">0</span> <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>)]</span><br><span class=\"line\">    <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(random_times):</span><br><span class=\"line\">        num = random()</span><br><span class=\"line\">        times[num] += <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">        random_times_div_10 = random_times // <span class=\"number\">10</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> i % random_times_div_10 == <span class=\"number\">0</span>:</span><br><span class=\"line\">            <span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>):</span><br><span class=\"line\">                times[i] = times[i] / random_times_div_10</span><br><span class=\"line\">            <span class=\"built_in\">print</span>(times)</span><br><span class=\"line\">            times = [<span class=\"number\">0</span> <span class=\"keyword\">for</span> _ <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>)]</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">if</span> __name__ == <span class=\"string\">&#x27;__main__&#x27;</span>:</span><br><span class=\"line\">    <span class=\"comment\"># print(random())</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\"># 数量太小, 算力太大把随机度给淹了</span></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;1K 个随机数 0-9 平均概率:&quot;</span>)</span><br><span class=\"line\">    measure(<span class=\"number\">1_000</span>)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">print</span>()</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(<span class=\"string\">&quot;1M 个随机数 0-9 平均概率:&quot;</span>)</span><br><span class=\"line\">    measure(<span class=\"number\">1_000_000</span>)</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<pre><code>1K 个随机数 0-9 平均概率:\n[0.0, 0.0, 0.0, 0.01, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\n[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]\n[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]\n[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]\n[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]\n[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]\n[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]\n[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]\n[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]\n[0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1]\n\n1M 个随机数 0-9 平均概率:\n[0.0, 0.0, 0.0, 1e-05, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]\n[0.08707, 0.09659, 0.07117, 0.09658, 0.08152, 0.11249, 0.08783, 0.15348, 0.07114, 0.14213]\n[0.07329, 0.09794, 0.08054, 0.11958, 0.08392, 0.09796, 0.07334, 0.10519, 0.08776, 0.18048]\n[0.11594, 0.10057, 0.09201, 0.12211, 0.05934, 0.10781, 0.05929, 0.10423, 0.08083, 0.15787]\n[0.11348, 0.09361, 0.09942, 0.09361, 0.08974, 0.11739, 0.1132, 0.09622, 0.08972, 0.09361]\n[0.09697, 0.08811, 0.07557, 0.13141, 0.0873, 0.10951, 0.07558, 0.08811, 0.09013, 0.15731]\n[0.09858, 0.07631, 0.11606, 0.07633, 0.13287, 0.07633, 0.09857, 0.09382, 0.1125, 0.11863]\n[0.07433, 0.12053, 0.07844, 0.11426, 0.07381, 0.11784, 0.09136, 0.12198, 0.09004, 0.11741]\n[0.07852, 0.09592, 0.11335, 0.12832, 0.0749, 0.09957, 0.07491, 0.12733, 0.07851, 0.12867]\n[0.07114, 0.11785, 0.08166, 0.15484, 0.06758, 0.11358, 0.06757, 0.12409, 0.09167, 0.11002]\n</code></pre>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"位运算数值分布\">位运算数值分布</h2>\n<figure class=\"highlight python\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;XOR:&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>):</span><br><span class=\"line\">    arr = []</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>):</span><br><span class=\"line\">        arr.append(j ^ i)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(arr)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;OR:&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>):</span><br><span class=\"line\">    arr = []</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>):</span><br><span class=\"line\">        arr.append(j | i)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(arr)</span><br><span class=\"line\"><span class=\"comment\"># 产生 &#x27;7&#x27; 黑洞 (array 内都是 7)</span></span><br><span class=\"line\"><span class=\"comment\"># 10M 个随机数 0-9 平均概率:</span></span><br><span class=\"line\"><span class=\"comment\"># [0.0, 0.0, 0.0, 0.0, 0.0, 1e-06, 0.0, 0.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [0.0, 1.6e-05, 0.0, 0.035234, 0.0, 6e-06, 0.0, 0.933694, 0.0, 0.03105]</span></span><br><span class=\"line\"><span class=\"comment\"># [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">print</span>(<span class=\"string\">&quot;AND:&quot;</span>)</span><br><span class=\"line\"><span class=\"keyword\">for</span> i <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>):</span><br><span class=\"line\">    arr = []</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">for</span> j <span class=\"keyword\">in</span> <span class=\"built_in\">range</span>(<span class=\"number\">10</span>):</span><br><span class=\"line\">        arr.append(j &amp; i)</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"built_in\">print</span>(arr)</span><br><span class=\"line\"><span class=\"comment\"># 产生 &#x27;0&#x27; 黑洞 (array 内都是 0)</span></span><br><span class=\"line\"><span class=\"comment\"># 10M 个随机数 0-9 平均概率:</span></span><br><span class=\"line\"><span class=\"comment\"># [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1e-06, 0.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [0.992248, 0.0, 0.002597, 0.0, 0.000949, 0.0, 0.001722, 0.0, 0.002484, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</span></span><br><span class=\"line\"><span class=\"comment\"># [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]</span></span><br></pre></td></tr></table></figure>\n<pre><code>XOR:\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n[1, 0, 3, 2, 5, 4, 7, 6, 9, 8]\n[2, 3, 0, 1, 6, 7, 4, 5, 10, 11]\n[3, 2, 1, 0, 7, 6, 5, 4, 11, 10]\n[4, 5, 6, 7, 0, 1, 2, 3, 12, 13]\n[5, 4, 7, 6, 1, 0, 3, 2, 13, 12]\n[6, 7, 4, 5, 2, 3, 0, 1, 14, 15]\n[7, 6, 5, 4, 3, 2, 1, 0, 15, 14]\n[8, 9, 10, 11, 12, 13, 14, 15, 0, 1]\n[9, 8, 11, 10, 13, 12, 15, 14, 1, 0]\nOR:\n[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]\n[1, 1, 3, 3, 5, 5, 7, 7, 9, 9]\n[2, 3, 2, 3, 6, 7, 6, 7, 10, 11]\n[3, 3, 3, 3, 7, 7, 7, 7, 11, 11]\n[4, 5, 6, 7, 4, 5, 6, 7, 12, 13]\n[5, 5, 7, 7, 5, 5, 7, 7, 13, 13]\n[6, 7, 6, 7, 6, 7, 6, 7, 14, 15]\n[7, 7, 7, 7, 7, 7, 7, 7, 15, 15]\n[8, 9, 10, 11, 12, 13, 14, 15, 8, 9]\n[9, 9, 11, 11, 13, 13, 15, 15, 9, 9]\nAND:\n[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]\n[0, 1, 0, 1, 0, 1, 0, 1, 0, 1]\n[0, 0, 2, 2, 0, 0, 2, 2, 0, 0]\n[0, 1, 2, 3, 0, 1, 2, 3, 0, 1]\n[0, 0, 0, 0, 4, 4, 4, 4, 0, 0]\n[0, 1, 0, 1, 4, 5, 4, 5, 0, 1]\n[0, 0, 2, 2, 4, 4, 6, 6, 0, 0]\n[0, 1, 2, 3, 4, 5, 6, 7, 0, 1]\n[0, 0, 0, 0, 0, 0, 0, 0, 8, 8]\n[0, 1, 0, 1, 0, 1, 0, 1, 8, 9]\n</code></pre>\n<p><a><img src= \"https://pan.weidows.tech/d/local/img/loading.svg\" data-lazy-src=\"https://pan.weidows.tech/d/local/img/divider.png\" alt=\"分割线\"></a></p>\n<h2 id=\"golang-验证码-随机数生成\">golang-验证码-随机数生成</h2>\n<p>最好不要用 rand.intn(), 位数太大时会溢出, 可以用递归来生成无限长的随机数 <sup id='cite_ref-1'><a href=\"#cite_note-1\">[1]</a></sup></p>\n<figure class=\"highlight go\"><table><tr><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">GetRandNum</span><span class=\"params\">(digit <span class=\"type\">int</span>)</span></span> (res <span class=\"type\">string</span>) &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> digit &lt; <span class=\"number\">1</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"string\">&quot;&quot;</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> digit &lt; <span class=\"number\">10</span> &#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">// int32 封顶 2^9, 2^10 会溢出</span></span><br><span class=\"line\">\t\tnum := rand.New(rand.NewSource(time.Now().UnixNano())).Int31n(<span class=\"type\">int32</span>(Pow10(digit)))</span><br><span class=\"line\">\t\tres = fmt.Sprintf(<span class=\"string\">&quot;%0&quot;</span>+strconv.Itoa(digit)+<span class=\"string\">&quot;v&quot;</span>, num)</span><br><span class=\"line\">\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\tnum := rand.New(rand.NewSource(time.Now().UnixNano())).Int31n(<span class=\"type\">int32</span>(Pow10(<span class=\"number\">9</span>)))</span><br><span class=\"line\">\t\tres = fmt.Sprintf(<span class=\"string\">&quot;%09v&quot;</span>, num) + GetRandNum(digit<span class=\"number\">-9</span>)</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">func</span> <span class=\"title\">GetVerifyCode</span><span class=\"params\">()</span></span> <span class=\"type\">string</span> &#123;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> GetRandNum(<span class=\"number\">6</span>)</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h2 id=\"借物表\">借物表</h2>\n<p><a name='cite_note-1' href='#cite_ref-1'>[1]</a>: <a href=\"https://github.com/Weidows/Golang/blob/master/utils/rand.go\">Golang/rand.go at master · Weidows/Golang</a></p>\n<script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kity@2.0.4/dist/kity.min.js\"></script><script type=\"text&#x2F;javascript\" src=\"https://unpkg.com/kityminder-core@1.4.50/dist/kityminder.core.min.js\"></script><script defer=\"true\" type=\"text&#x2F;javascript\" src=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.js\"></script><link rel=\"stylesheet\" type=\"text&#x2F;css\" href=\"https://unpkg.com/hexo-simple-mindmap@0.8.0/dist/mindmap.min.css\">",
            "tags": [
                "密码学",
                "概率论"
            ]
        }
    ]
}